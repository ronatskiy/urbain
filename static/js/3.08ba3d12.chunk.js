(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{62:function(e,t,r){"use strict";r.r(t);var o=r(2),a=r(3),i=r(7),n=r(4),c=r(6),s=function(){function e(){Object(o.a)(this,e)}return Object(a.a)(e,[{key:"propagate",value:function(e,t,r){}}]),e}(),l=r(34),h=r(9),p=r(25),u=r(22),f=r(29),d=r(1),y=r(8);r.d(t,"default",function(){return g});var g=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(i.a)(this,Object(n.a)(t).call(this))).soiSafetyCoefficient=1.5,e.maxStep=3600,e.minStepCount=100,e.maxPatchError=.001,e}return Object(c.a)(t,e),Object(a.a)(t,[{key:"propagate",value:function(e,t,r){if(!e instanceof l.a)throw new Error("Patched conics propagation requires TrajectoryComposite instance");if(!r.epoch)throw new Error("Patched conics propagation requires epoch in stop condition");e.clearAfterEpoch(t);var o,a=e.getComponentByEpoch(t),i=Math.max(t,a.epoch);a.maxEpoch=!1;do{(o=this._findNextTrajectory(a,i,r.epoch))&&(e.addComponent(o),i=o.epoch,a.maxEpoch=i,a=o)}while(o&&i<r.epoch)}},{key:"_findNextTrajectory",value:function(e,t,r){var o=y.a.starSystem.getObject(e.referenceFrame.originId),a=this._findOwnSoiCrossing(o,e,t),i=this._findChildSoiCrossing(o,e,t,r);if(!1===i&&!1===a)return!1;var n=!i||a&&a.epoch<i.epoch?a:i;return this._createExtensionTrajectory(e,n.newSoi,n.epoch)}},{key:"_findOwnSoiCrossing",value:function(e,t,r){var o=t.keplerianObject,a=o.getSphereCrossingTrueAnomaly(e.data.patchedConics.soiRadius);if(!a)return!1;for(var i=o.getEpochByTrueAnomaly(a[0]);i<r;)i+=o.period;return{epoch:i,newSoi:e.data.patchedConics.parentSoi}}},{key:"_findChildSoiCrossing",value:function(e,t,r,o){var a=t.keplerianObject,i=[],n=!0,c=!1,s=void 0;try{for(var l,h=e.data.patchedConics.childSois[Symbol.iterator]();!(n=(l=h.next()).done);n=!0){var p=l.value,u=p.trajectory.getKeplerianObjectByEpoch(r,t.referenceFrame),f=p.data.patchedConics.soiRadius,y=this._getPotentialApproachIntervals(u,a,r,o,f*this.soiSafetyCoefficient);if(!1!==y){var g=this._getPotentialApproachIntervals(a,u,r,o,f*this.soiSafetyCoefficient),v=Object(d.i)(y,g);if(!1!==v){!0===v&&(v=[[r,o]]),v.sort(function(e,t){return e[0]<t[0]?-1:e[0]>t[0]?1:0});var m=!1,b=!0,E=!1,w=void 0;try{for(var S,C=v[Symbol.iterator]();!(b=(S=C.next()).done);b=!0){var P=S.value;if(P[0]>o)break;if(!(P[1]<r)){P[0]<r&&(P[0]=r),P[1]>o&&(P[1]=o);for(var j=!0,_=Math.min(this.maxStep,(P[1]-P[0])/this.minStepCount),B=P[0],T=0;B<P[1];){var k=t.getPositionByEpoch(B).sub_(p.getPositionByEpoch(B)).mag-f;if(k<0){if(j){do{(B+=_)>P[1]&&(B=P[1]),k=t.getPositionByEpoch(B).sub_(p.getPositionByEpoch(B)).mag-f}while(k<0&&B<P[1]);if(k<0)break;continue}for(;Math.abs(k)>this.maxPatchError;)B+=_*=k/(T-k),T=k,k=t.getPositionByEpoch(B).sub_(p.getPositionByEpoch(B)).mag-f;i.push({epoch:B,newSoi:p}),m=!0;break}T=k,j=!1,B+=_}if(m)break}}}catch(I){E=!0,w=I}finally{try{b||null==C.return||C.return()}finally{if(E)throw w}}}}}}catch(I){c=!0,s=I}finally{try{n||null==h.return||h.return()}finally{if(c)throw s}}if(!i.length)return!1;for(var x=i[0],A=0;A<i.length;A++){var O=i[A];O.epoch<x.epoch&&(x=O)}return x}},{key:"_getPotentialApproachIntervals",value:function(e,t,r,o,a){var i=this._getRadialTaBounds(e,t,a);if(!1===i)return!1;var n,c=this._getVerticalTaBounds(e,t,r,a);if(c)n=Object(d.h)(c,i);else{if(!0===i)return!0;n=i}if(!1===n)return!1;var s,l,h=t.period,p=t.isElliptic?Math.floor((r-t.epoch)/h)*h:0,u=0,f=[];do{var y=!0,g=!1,v=void 0;try{for(var m,b=n[Symbol.iterator]();!(y=(m=b.next()).done);y=!0){var E=m.value;if(s=t.getEpochByTrueAnomaly(E[0])+p,(l=t.getEpochByTrueAnomaly(E[1])+p)<s&&(s-=h),l>u&&(u=l),!(l<r)){if(f.length>1e4)throw new Error("Infinite loop detected");f.push([s,l])}}}catch(w){g=!0,v=w}finally{try{y||null==b.return||b.return()}finally{if(g)throw v}}p+=h}while(u<o&&t.isElliptic);return f}},{key:"_getVerticalTaBounds",value:function(e,t,r,o){var a=e.getNormalVector(),i=t.getNormalVector(),n=e.getPeriapsisVector(),c=a.cross(i),s=t.getPeriapsisVector(),l=a.angle(i),h=c.angle(n);n.cross(c).angle(a)>Math.PI/2&&(h=d.b-h);var p=c.angle(s);return c.cross(s).angle(i)>Math.PI/2&&(p=d.b-p),new u.a(t.ecc,t.sma,p,l,h,t.m0,t.epoch,t.mu,!1).getPlaneCrossingTrueAnomaly(o)}},{key:"_getRadialTaBounds",value:function(e,t,r){var o=e.getPeriapsisRadius()-r,a=e.getApoapsisRadius()+r,i=t.getSphereCrossingTrueAnomaly(o),n=t.getSphereCrossingTrueAnomaly(a);return e.isHyperbolic?t.isHyperbolic?!i||[[-1/0,i[1]-d.b],[i[0],1/0]]:i?[i]:t.getApoapsisRadius()>=o:t.isHyperbolic?!!n&&(i?[[n[1]-d.b,i[1]-d.b],[i[0],n[0]]]:[[n[1]-d.b,n[0]]]):i?n?[[i[0],n[0]],[n[1],i[1]]]:[i]:n?[[n[1],n[0]]]:t.getPeriapsisRadius()<a&&t.getApoapsisRadius()>o}},{key:"_createExtensionTrajectory",value:function(e,t,r){var o=y.a.starSystem.getReferenceFrame(h.d.buildId(t.id,h.c.INERTIAL_ECLIPTIC)),a=o.stateVectorFromBaseReferenceFrameByEpoch(r,e.getStateByEpoch(r)),i=new p.a(o.id,u.a.createFromState(a,t.physicalModel.mu,r));return i.minEpoch=r,i.maxEpoch=!1,i.isEditable=!1,i.setVisualModel(new f.a(i,{color:e.visualModel.standardColor,minEpoch:null,maxEpoch:null})),i}}]),t}(s)}}]);
//# sourceMappingURL=3.08ba3d12.chunk.js.map