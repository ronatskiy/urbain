webpackJsonp([1,2],{193:function(e,t,r){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),t}}(),i=function(){function e(){o(this,e),this._classes={}}return n(e,[{key:"_addClass",value:function(e,t){this._classes[e]=t}},{key:"getClass",value:function(e){if(void 0===this._classes[e])throw new Error("Unknown module class: "+e);return this._classes[e]}},{key:"init",value:function(){}}]),e}();t.a=i},194:function(e,t,r){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),t}}(),i=function(){function e(){o(this,e)}return n(e,[{key:"propagate",value:function(e,t,r){}}]),e}();t.a=i},52:function(e,t,r){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=r(194),c=r(25),s=r(3),u=r(19),l=r(13),f=r(26),p=r(2),h=r(1),y=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),t}}(),d=function(e){function t(){o(this,t);var e=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.soiSafetyCoefficient=1.5,e.maxStep=3600,e.minStepCount=100,e.maxPatchError=.001,e}return i(t,e),y(t,[{key:"propagate",value:function(e,t,r){if(!e instanceof c.a)throw new Error("Patched conics propagation requires TrajectoryComposite instance");if(!r.epoch)throw new Error("Patched conics propagation requires epoch in stop condition");e.clearAfterEpoch(t);var o=e.getComponentByEpoch(t),n=Math.max(t,o.epoch),i=void 0;o.maxEpoch=!1;do{(i=this._findNextTrajectory(o,n,r.epoch))&&(e.addComponent(i),n=i.epoch,o.maxEpoch=n,o=i)}while(i&&n<r.epoch)}},{key:"_findNextTrajectory",value:function(e,t,r){var o=h.a.starSystem.getObject(e.referenceFrame.originId),n=this._findOwnSoiCrossing(o,e,t),i=this._findChildSoiCrossing(o,e,t,r);if(!1===i&&!1===n)return!1;var a=!i||n&&n.epoch<i.epoch?n:i;return this._createExtensionTrajectory(e,a.newSoi,a.epoch)}},{key:"_findOwnSoiCrossing",value:function(e,t,r){var o=t.keplerianObject,n=o.getSphereCrossingTrueAnomaly(e.data.patchedConics.soiRadius);if(!n)return!1;for(var i=o.getEpochByTrueAnomaly(n[0]);i<r;)i+=o.period;return{epoch:i,newSoi:e.data.patchedConics.parentSoi}}},{key:"_findChildSoiCrossing",value:function(e,t,r,o){var n=t.keplerianObject,i=[],a=!0,c=!1,s=void 0;try{for(var u,l=e.data.patchedConics.childSois[Symbol.iterator]();!(a=(u=l.next()).done);a=!0){var f=u.value,h=f.trajectory.getKeplerianObjectByEpoch(r,t.referenceFrame),y=f.data.patchedConics.soiRadius,d=this._getPotentialApproachIntervals(h,n,r,o,y*this.soiSafetyCoefficient);if(!1!==d){var v=this._getPotentialApproachIntervals(n,h,r,o,y*this.soiSafetyCoefficient),b=Object(p.i)(d,v);if(!1!==b){!0===b&&(b=[[r,o]]),b.sort(function(e,t){return e[0]<t[0]?-1:e[0]>t[0]?1:0});var g=!1,m=!0,w=!1,_=void 0;try{for(var E,S=b[Symbol.iterator]();!(m=(E=S.next()).done);m=!0){var C=E.value;if(C[0]>o)break;if(!(C[1]<r)){C[0]<r&&(C[0]=r),C[1]>o&&(C[1]=o);for(var P=!0,j=Math.min(this.maxStep,(C[1]-C[0])/this.minStepCount),O=C[0],T=0;O<C[1];){var k=t.getPositionByEpoch(O).sub_(f.getPositionByEpoch(O)).mag-y;if(k<0){if(P){do{O+=j,O>C[1]&&(O=C[1]),k=t.getPositionByEpoch(O).sub_(f.getPositionByEpoch(O)).mag-y}while(k<0&&O<C[1]);if(k<0)break;continue}for(;Math.abs(k)>this.maxPatchError;)j*=k/(T-k),O+=j,T=k,k=t.getPositionByEpoch(O).sub_(f.getPositionByEpoch(O)).mag-y;i.push({epoch:O,newSoi:f}),g=!0;break}T=k,P=!1,O+=j}if(g)break}}}catch(e){w=!0,_=e}finally{try{!m&&S.return&&S.return()}finally{if(w)throw _}}}}}}catch(e){c=!0,s=e}finally{try{!a&&l.return&&l.return()}finally{if(c)throw s}}if(!i.length)return!1;var x=i[0],B=!0,A=!1,R=void 0;try{for(var I,M=i[Symbol.iterator]();!(B=(I=M.next()).done);B=!0){var V=I.value;V.epoch<x.epoch&&(x=V)}}catch(e){A=!0,R=e}finally{try{!B&&M.return&&M.return()}finally{if(A)throw R}}return x}},{key:"_getPotentialApproachIntervals",value:function(e,t,r,o,n){var i=this._getRadialTaBounds(e,t,n);if(!1===i)return!1;var a=this._getVerticalTaBounds(e,t,r,n),c=void 0;if(a)c=Object(p.h)(a,i);else{if(!0===i)return!0;c=i}if(!1===c)return!1;var s=t.period,u=void 0,l=void 0,f=t.isElliptic?Math.floor((r-t.epoch)/s)*s:0,h=0,y=[];do{var d=!0,v=!1,b=void 0;try{for(var g,m=c[Symbol.iterator]();!(d=(g=m.next()).done);d=!0){var w=g.value;if(u=t.getEpochByTrueAnomaly(w[0])+f,l=t.getEpochByTrueAnomaly(w[1])+f,l<u&&(u-=s),l>h&&(h=l),!(l<r)){if(y.length>1e4)throw new Error("Infinite loop detected");y.push([u,l])}}}catch(e){v=!0,b=e}finally{try{!d&&m.return&&m.return()}finally{if(v)throw b}}f+=s}while(h<o&&t.isElliptic);return y}},{key:"_getVerticalTaBounds",value:function(e,t,r,o){var n=e.getNormalVector(),i=t.getNormalVector(),a=e.getPeriapsisVector(),c=n.cross(i),s=t.getPeriapsisVector(),u=n.angle(i),f=c.angle(a);a.cross(c).angle(n)>Math.PI/2&&(f=p.b-f);var h=c.angle(s);return c.cross(s).angle(i)>Math.PI/2&&(h=p.b-h),new l.a(t.ecc,t.sma,h,u,f,t.m0,t.epoch,t.mu,!1).getPlaneCrossingTrueAnomaly(o)}},{key:"_getRadialTaBounds",value:function(e,t,r){var o=e.getPeriapsisRadius()-r,n=e.getApoapsisRadius()+r,i=t.getSphereCrossingTrueAnomaly(o),a=t.getSphereCrossingTrueAnomaly(n);return e.isHyperbolic?t.isHyperbolic?!i||[[-1/0,i[1]-p.b],[i[0],1/0]]:i?[i]:t.getApoapsisRadius()>=o:t.isHyperbolic?!!a&&(i?[[a[1]-p.b,i[1]-p.b],[i[0],a[0]]]:[[a[1]-p.b,a[0]]]):i?a?[[i[0],a[0]],[a[1],i[1]]]:[i]:a?[[a[1],a[0]]]:t.getPeriapsisRadius()<n&&t.getApoapsisRadius()>o}},{key:"_createExtensionTrajectory",value:function(e,t,r){var o=h.a.starSystem.getReferenceFrame(s.d.buildId(t.id,s.c.INERTIAL_ECLIPTIC)),n=o.stateVectorFromBaseReferenceFrameByEpoch(r,e.getStateByEpoch(r)),i=new u.a(o.id,l.a.createFromState(n,t.physicalModel.mu,r));return i.minEpoch=r,i.maxEpoch=!1,i.isEditable=!1,i.setVisualModel(new f.a(i,{color:e.visualModel.standardColor,minEpoch:null,maxEpoch:null})),i}}]),t}(a.a);t.default=d},60:function(e,t,r){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=r(193),c=r(6),s=r(20),u=r(52),l=r(1),f=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),t}}(),p=function(e){function t(){return o(this,t),n(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),f(t,[{key:"init",value:function(){l.a.addPropagator("patchedConics",u.default),c.a.addListener(c.a.STAR_SYSTEM_LOADED,this.fillSoiTree),l.a.starSystem&&this.fillSoiTree()}},{key:"fillSoiTree",value:function(){var e=l.a.starSystem;for(var t in e.objects){var r=e.objects[t];if(r instanceof s.a&&void 0!==r.data.patchedConics){var o=e.getObject(r.data.patchedConics.parentSoiId);o instanceof s.a&&(r.data.patchedConics.parentSoi=o,o.data.patchedConics.childSois.push(r))}}}}]),t}(a.a);t.default=p}});
//# sourceMappingURL=1.87aac5a8.chunk.js.map