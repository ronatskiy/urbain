{"version":3,"sources":["core/algebra.js","core/EventHandler.js","ui-legacy/TimeLine.js","core/visual/Raycaster.js","ui-legacy/SelectionHandler.js","ui-legacy/Panel.js","ui-legacy/Panels/Time.js","ui-legacy/Panels/Camera.js","ui-legacy/Panels/Vector.js","ui-legacy/Panels/Metrics.js","core/LambertSolver.js","core/visual/Vector.js","ui-legacy/Panels/Lambert.js","core/visual/Trajectory/Dynamic.js","ui-legacy/Panels/Creation.js","ui-legacy/Panels/Maneuver.js","ui-legacy/UI.js","ui-legacy/Camera.js","interface/StarSystemEntry.js","interface/StarSystemManager.js","core/Simulation.js","core/FunctionOfEpoch/ObjectState.js","core/ReferenceFrame/BodyFixed.js","core/ReferenceFrame/Base.js","core/ReferenceFrame/Topocentric.js","core/ReferenceFrame/Factory.js","core/Events.js","core/StateVector.js","core/visual/ModelAbstract.js","core/EphemerisObject.js","core/FunctionOfEpoch/Custom.js","core/index.js","core/KeplerianObject.js","core/Body.js","core/FunctionOfEpoch/Constant.js","core/Trajectory/KeplerianBasic.js","core/visual/Trajectory/Keplerian.js","core/ReferenceFrame/Abstract.js","core/FunctionOfEpoch/Abstract.js","core/Trajectory/Composite.js","modules/PatchedConics/FlightEvent/SOIChangeAbstract.js","core/visual/FlightEvent/Abstract.js","core/visual/Trajectory/Abstract.js","core/visual/VirtualPlane.js","core/visual/Arrow.js","core/visual/Angle.js","core/visual/PlanePoint.js","core/KeplerianEditor.js","core/Trajectory/Abstract.js","core/ReferenceFrame/InertialDynamic.js","core/StarSystem.js","ui/components/tutorials/wizards/wizard-ids.js","modules/PatchedConics/FlightEvent/SOIDeparture.js","modules/PatchedConics/FlightEvent/SOIArrival.js","core/Trajectory/KeplerianAbstract.js","modules/PatchedConics/visual/FlightEvent/SOIDeparture.js","modules/PatchedConics/visual/FlightEvent/SOIArrival.js","core/Trajectory/Dynamic.js","core/FlightEvent/ImpulsiveBurn.js","core/ReferenceFrame/Inertial.js","core/ReferenceFrame/InertialAbstract.js","core/Trajectory/ExceptionOutOfRange.js","core/visual/LineObject.js","core/FlightEvent/Abstract.js","core/visual/Marker/Pericenter.js","core/visual/Marker/Abstract.js","core/visual/Marker/Apocenter.js","core/visual/FlightEvent/ImpulsiveBurn.js","core/visual/Sprite.js","core/visual/SpriteStatic.js","core/Orientation/Abstract.js","core/Orientation/ConstantAxis.js","core/PhysicalBodyModel.js","core/Trajectory/KeplerianArray.js","core/Trajectory/KeplerianPrecessingArray.js","core/Trajectory/KeplerianPrecessing.js","core/visual/Trajectory/PointArray.js","core/Trajectory/StaticPosition.js","interface/TrajectoryLoader.js","core/visual/StarsModel.js","core/visual/Label.js","core/visual/BodyModel/Abstract.js","core/visual/BodyModel/Basic.js","core/visual/BodyModel/Light.js","core/visual/BodyModel/Rings.js","core/visual/Shape/Sphere.js","interface/StarSystemLoader.js","modules lazy /^/.*$/ groupOptions: {} namespace object","ui/components/tutorials/wizards lazy /^/.*/index$/ groupOptions: {} namespace object","ui/components/tutorials/wizards lazy /^/.*$/ groupOptions: {} namespace object","ui/store/constants.js","ui/store/index.js","ui/store/context.js","ui/components/statistics-badge/index.js","ui/components/tutorials/services/local-storage-watch-status-service.js","ui/components/tutorials/language-selector/index.js","ui/components/tutorials/services/step-handler-service.js","ui/components/tutorials/index.js","ui/components/header/components/logo.js","ui/components/common/select/select.js","ui/components/header/components/star-system-selector/star-system-selector.js","ui/components/header/components/main-menu/components/drop-down-menu-item.js","ui/components/header/components/main-menu/components/drop-down-menu.js","ui/components/header/components/main-menu/components/menu-link.js","ui/components/header/components/main-menu/main-menu.js","ui/components/header/header.js","ui/components/common/side-bar/index.js","ui/components/common/button/index.js","ui/components/common/logos/arrow-logo.js","ui/components/common/logos/maximize-logo.js","ui/components/common/panel/components/collapse-button.js","ui/components/common/panel/components/field.js","ui/components/common/panel/components/field-label.js","ui/components/common/panel/components/field-control.js","ui/components/common/panel/components/button.js","ui/components/common/panel/components/field-set.js","ui/components/common/panel/components/dimension.js","ui/components/common/panel/index.js","ui/components/main-view/components/bottom-panel/components/camera-panel/camera-panel.js","ui/components/main-view/components/bottom-panel/components/time-line/index.js","ui/components/main-view/components/bottom-panel/components/pause-button/index.js","ui/components/main-view/components/bottom-panel/components/time-settings-panel/logo.js","ui/components/main-view/components/bottom-panel/components/time-settings-panel/index.js","ui/components/main-view/components/bottom-panel/index.js","ui/components/main-view/components/creation-panel.js","ui/components/main-view/components/transfer-calculation-panel/index.js","ui/components/main-view/components/metrics-panel/components/keplerian-view.js","ui/components/main-view/components/metrics-panel/components/vector-component-view.js","ui/components/common/expand-button/index.js","ui/components/main-view/components/metrics-panel/components/cartesian-vector-view.js","ui/components/main-view/components/metrics-panel/index.js","ui/components/main-view/components/maneuver-panel/index.js","ui/components/main-view/components/satellite-search-panel/satelite.js","ui/components/main-view/components/satellite-search-panel/transformers/satellite-transformer.js","ui/components/main-view/components/satellite-search-panel/components/satellites-grid.js","ui/components/main-view/components/satellite-search-panel/web-api.js","ui/components/main-view/components/satellite-search-panel/index.js","ui/components/main-view/main-view.js","ui/components/footer/footer.js","ui/app.js","ui/libs/index.js","ui/index.js","api.js","index.js","application.js"],"names":["Vector","_Array","dimOrArray","_this","Object","D_Projects_github_com_urbain_ru_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__","this","D_Projects_github_com_urbain_ru_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__","D_Projects_github_com_urbain_ru_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__","call","undefined","Array","i","length","setPrototypeOf","D_Projects_github_com_urbain_ru_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_5__","prototype","D_Projects_github_com_urbain_ru_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_4__","D_Projects_github_com_urbain_ru_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__","key","value","arrayOrVarargs","vals","arguments","vec","res","cos","dot","mag","Math","PI","acos","scalar","axis","angle","Quaternion","rotate_","div_","v","unit","set","mul_","copy","add_","sub_","unit_","projectOn_","radians","sin","get","sqrt","quadrance","D_Projects_github_com_urbain_ru_node_modules_babel_runtime_helpers_esm_wrapNativeSuper__WEBPACK_IMPORTED_MODULE_6__","vector","t","setAxisAngle","invert_","len","normalize_","cx","cross","cx2","quat","w","x","y","z","ow","ox","oy","oz","order","c1","c2","c3","s1","s2","s3","THREE","q","q1","q2","fromVector","toVector","normal1","normal2","transfer","cosHalfTheta","sinHalfTheta","halfTheta","atan2","ratio1","ratio2","invert","TWO_PI","newtonSolve","func","start","d","maxError","maxSteps","error","step","val","v1","v2","diff","abs","deg2rad","degrees","rad2deg","acosSigned","sinSign","ang","angleIntervalIntersection","int1","int2","getAngleIntervalsIntersection","intervals1","intervals2","result","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","next","done","interval1","int11","int12","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","interval2","int21","int22","r","push","err","return","isInInterval","interval","getEpochIntervalsIntersection","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","epoch1","epoch2","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_step4","_iterator4","epoch21","epoch22","approximateAngle","ang1","ang2","proportion","approximateNumber","n1","n2","presentNumberWithSuffix","number","toFixed","toPrecision","EventHandler","domElement","classCallCheck","listeners","handlers","eventName","listener","priority","event","handleEvent","addEventListener","handler","list","idx","splice","removeEventListener","eventObject","highestPriority","reduce","a","max","TimeLine","epoch","timeScale","isTimeRunning","mouseState","leftButton","rightButton","timeLineCanvasDomElement","document","getElementById","canvasContext","getContext","canvasRect","updateCanvasStyle","initValues","onMouseDown","bind","window","onMouseUp","onMouseMove","onMouseWheel","e","togglePause","oncontextmenu","scales","minute","fiveMinutes","tenMinutes","thirtyMinutes","hour","threeHours","sixHours","day","week","month","threeMonths","year","fiveYears","span","markDistance","scaleType","leftEpoch","updateScaleType","getDateByEpoch","getEpochByDate","roundDateUp","nextRenderingDate","formatDate","formatDateFull","newScale","Events","dispatch","TIME_SCALE_CHANGED","old","new","TIME_UNPAUSED","TIME_PAUSED","timePassed","left","width","EPOCH_CHANGED","date","redraw","newEpoch","tick","forceEpoch","Date","fillStyle","fillRect","height","drawCurrentTimeMark","strokeStyle","font","markDate","markEpoch","drawMark","getCanvasPositionByEpoch","getBoundingClientRect","right","bottom","top","secondsPerPeriod","bestScale","scale","text","beginPath","moveTo","lineTo","stroke","fillText","measureText","button","_this2","keys","b","_this3","mult","deltaY","newSpan","min","getMinScale","getMaxScale","setSeconds","setMinutes","getMinutes","setHours","getHours","setDate","getDate","getDay","setMonth","getMonth","setFullYear","getFullYear","string","getYear","padStart","toString","getSeconds","VisualRaycaster","threeCamera","pixelPrecision","raycaster","mouse","camera","setPixelPrecision","updatePixelAngleSize","clientX","clientY","pixelAngleSize","fov","threeObjects","setFromCamera","intersectObjects","point","pointDirection","subVectors","sim","lastPosition","ray","direction","SelectionHandler","possibleConstructorReturn","getPrototypeOf","selectableObjects","selectedObject","bestIntersection","selectionMouseButton","pointSize","setThreeObj","color","onMouseClick","assertThisInitialized","mouseMoveListener","object","filter","intersections","distance","threeObj","visible","position","scaleKoeff","getPixelAngleSize","hasMouseMoved","mouseClickStart","wasSelected","selectionObject","userData","Function","deselect","select","onClick","SELECT","DESELECT","VisualModelAbstract","UIPanel","panelDom","isCollapsed","jqDom","$","name","data","jqCollapseButton","find","click","toggleCollapse","collapse","expand","show","hide","html","UIPanelTime","maxTimeScale","jqSlider","on","time","setTimeScale","getCurrentTimeScale","getNeededSliderValue","jqScaleText","formatTimeScale","detail","jqDateText","updateTime","useCurrentTime","sign","prefix","UIPanelCamera","jqTarget","changeOrigin","jqFrameType","changeReferenceFrameType","addListener","STAR_SYSTEM_LOADED","starSystem","updateTargetList","updateTarget","orbitingPoint","updateFrameTypeList","updateFrameType","frameType","CAMERA_RF_CHANGED","originId","type","OBJECT_ADDED","each","getObjectNames","objId","objName","append","selected","getAvailableFrameTypes","typeId","frameTypeNames","_UIPanelCamera$frameT","defineProperty","ReferenceFrame","INERTIAL_ECLIPTIC","INERTIAL_BODY_EQUATORIAL","INERTIAL_BODY_FIXED","INERTIAL_PARENT_BODY_EQUATORIAL","UIPanelVector","vectorOfEpoch","jqMag","jqX","jqY","jqZ","update","FunctionOfEpochAbstract","evaluate","UIPanelMetrics","selection","precision","renderListener","render","handleSelect","handleDeselect","getSelectedObject","deleteObject","id","settings","ui","showAnglesOfSelectedOrbit","checked","SHOW_ORBIT_ANGLES_CHANGED","positionPanel","velocityPanel","selectedTrajectory","trajectory","parent","referenceFrame","getReferenceFrameByEpoch","getObject","updateMain","updateCartesian","updateKeplerian","keplerianObject","getKeplerianObjectByEpoch","sma","per","ecc","apo","surfaceAlt","physicalModel","radius","state","getStateInOwnFrameByEpoch","velocity","j2","getNodalPrecessionRate","eqRadius","inc","aop","raan","getTrueAnomalyByEpoch","period","EphemerisObject","TYPE_SPACECRAFT","TYPE_UNKNOWN","RENDER","LambertSolver","orbit1","orbit2","epochMin","epochMax","transferMin","transferMax","points","epochStep","flightTimeStep","startEpoch","flightTime","j","calcDeltaV","getStateByEpoch","mu","plotData","ctx","clearRect","row","col","round","state1","state2","transferOrbit","_velocity","solve","getDeltaV","originObject","targetObject","rPer1","rPer2","departureTime","flightTimeMin","flightTimeMax","bestFlightTime","minDeltaV","solveFullTransfer","deltaV","totalDeltaV","parentObject","getModule","getCommonParent","Body","rfOrigin","rfTarget","originSoi","targetSoi","rfMainId","ReferenceFrameFactory","buildId","TYPE_STAR","rfMain","getReferenceFrame","calcOriginSoi","calcTargetSoi","patchedConics","soiRadius","ejectionVelInf","insertionVelInf","transferKO","ejectionSoiEpoch","insertionSoiEpoch","ejectionTime","insertionTime","ejectionPosShift","insertionPosShift","steps","_position","transformPositionByEpoch","ejectionPosTime","insertionPosTime","ejectionNormal","getSoiEdgePositionAndTime","rotateVectorByEpoch","insertionNormal","sub","ejectionDeltaV","insertionDeltaV","TrajectoryComposite","TrajectoryKeplerianBasic","minEpoch","maxEpoch","addComponent","ejectionKO","KeplerianObject","createFromState","StateVector","getPeriapsisSpeed","getPeriapsisRadius","ejection","insertionKO","insertion","velInf","normal","rPer","rInf","trueAnomaly","flightPathAngle","atan","H","getEccentricAnomalyByTrueAnomaly","sinh","r1vec","r2vec","r1","r2","transferAngle","ta1","signSinTransferAngle","nodeVector","parabolicTime","pow","A","E","B","yParam","getTimeByY","x0","y0","temp","fx","fy","alpha","acosh","beta","f1","rotate","p2","d1","d2","tempAng","rotateZ","f2x","f2y","p","ta2","perVector","rm","cosTa1","sinTa1","n","E1","E2","ta","atanh","tan","VisualVector","referenceFrameId","RF_BASE","quaternion","fromArray","mul","getQuaternionByEpoch","toThreejs","setPosition","getOriginPositionByEpoch","UIPanelLambert","maxTransferTime","changeTransferTime","getCurrentTransferTime","transferTime","jqTransferTimeText","formatTransferTime","jqOrigin","changeTarget","origin","listData","buildListData","updateList","target","solverResult","transferTrajectory","setObject","visualModel","drop","visualModel2","visualModel3","vector1","vector2","VisualTrajectoryModelKeplerian","components","currentEpoch","currentDate","newOrigin","updateSliderScale","newTarget","periods","getRelativePeriod","period1","period2","newTransferTime","root","getRootSoi","buildSoiTreeData","soiObject","level","childSois","child","concat","jqList","entry","repeat","VisualTrajectoryDynamic","VisualTrajectoryAbstract","NO_THREE_OBJ","UIPanelCreation","jqPause","center","created","traj","setVisualModel","propagatorClass","getPropagator","pTraj","TrajectoryDynamic","ephObject","setTrajectory","addObject","forceSelection","propagate","UIPanelManeuver","increment","updateHandler","handleTrajectoryUpdate","setBurnIdx","burnIdx","burn","_arr","_loop","comp","_i","updateBurns","burns","indexOf","init","onUpdate","flightEvents","FlightEventImpulsiveBurn","newIdx","setScale","removeListener","prograde","radial","_increment","UI","timePanel","cameraPanel","metricsPanel","creationPanel","lambertPanel","maneuverPanel","Camera","animationDuration","pixelsToObjectUnderMouse","listenersAdded","initialReferenceFrame","initialPosition","_getQuaternionByPosition","currentMousePos","accountedMousePos","isMouseDown","isShiftDown","rightButtonDown","isLookingAside","zoomingAside","isAnimnating","pole","defaultDirection","defaultUp","directionQuaternion","newUp","neededUp","isBody","newType","changeReferenceFrame","newObjectId","newFrameType","newFrameId","animate","newFrame","startAnimation","transferQuaternion","animationStartingTime","getTime","animationStartingQuaternion","percent","targetQuat","slerp","biggestRadius","biggestObject","getBodies","body","getPixelDistance","getPositionByEpoch","defaultFactor","shiftKey","zoomFactor","factor","objectToZoomTo","findObjectUnderMouse","zoomingTo","currentMag","aspect","updateProjectionMatrix","rfQuaternion","mouseShift","sensitivity","mouseSensitivity","poleAngle","verticalRotationAxis","verticalQuaternion","mainQuaternion","StarSystemEntry","alias","label","moduleName","callback","isModuleLoaded","loadStarSystem","loadModule","module","StarSystemManager","_starSystems","_loadedIdx","add","loadByIdx","defaultStarSystemIdx","_findStarSystemByIdx","load","Simulation","modules","propagators","renderLoopActive","starSystemManager","_initSettings","viewPortDomElement","renderLoopFunction","scene","textureLoader","renderer","antialias","logarithmicDepthBuffer","_setRenderSize","appendChild","onWindowResize","rendererEvents","loadDefault","requestAnimationFrame","VisualFlightEventImpulsiveBurn","preloadTexture","VisualMarkerPericenter","VisualMarkerApocenter","INIT_DONE","jsonFile","onLoadFinish","getJSON","starSystemConfig","unload","StarSystem","StarSystemLoader","loadFromConfig","mainObject","startRendering","showBodyLabels","onResize","timeDelta","simCoords","visualCoords","toArray","className","__webpack_require__","then","default","Error","periodPos","substr","getClass","_this$domElement","clientHeight","clientWidth","console","log","setSize","FunctionOfEpochObjectState","objectId","ReferenceFrameBodyFixed","isInertial","orientation","getOriginStateByEpoch","angularVel","originState","rotation","destPos","destVel","rfVel","getRotationVelocityByEpoch","ReferenceFrameAbstract","ReferenceFrameBase","setId","ReferenceFrameTopocentric","lat","lon","bodyFixedQuaternion","setFromEuler","bodyFixedPosition","rotateY","bodyState","bodyQuaternion","config","ReferenceFrameInertial","ReferenceFrameInertialDynamic","FunctionOfEpochCustom","equinox","parentId","getParentObjectIdByEpoch","INERTIAL_TOPOCENTRIC","BODY_FIXED","TOPOCENTRIC","BASE","floor","getTypeByReferenceFrameId","create","getOriginIdByReferenceFrameId","RF_BASE_OBJ","eventObj","CustomEvent","dispatchEvent","LOADING_BODIES_DONE","LOADING_FRAMES_DONE","LOADING_TRAJECTORIES_DONE","vx","vy","vz","_isHidden","obj","_onRender","getVisualCoords","remove","traverse","geometry","dispose","material","texturePath","bodyId","rf","TYPE_PLANET","TYPE_PLANETOID","TYPE_SATELLITE","TYPE_ASTEROID","TYPE_COMET","TYPE_POINT","__webpack_exports__","_Simulation__WEBPACK_IMPORTED_MODULE_0__","_Events__WEBPACK_IMPORTED_MODULE_1__","statistics","globalTime","viewPortId","curTime","anomaly","isAnomalyTrue","_mu","_sma","_ecc","_inc","_raan","_aop","_epoch","m0","updateMeanMotion","_updateCallback","meanMotion","getMeanAnomalyByEpoch","getNodalPrecessionByEpoch","getEccentricAnomalyByMeanAnomaly","getTrueAnomalyByMeanAnomaly","ea","isElliptic","getMeanAnomalyByEccentricAnomaly","ma","F","M","asinh","cosh","cosE","getTrueAnomalyByEccentricAnomaly","phi","tanh","getApoapsisRadius","getMeanAnomalyByTrueAnomaly","apoR","distanceToPlane","c","taHigh","_planeCrossingHelper","taLow","range1","range2","isHyperbolic","temp1","temp2","isNaN","asymptote","getAsymptoteTa","_validateHyperbolicTa","getEccentricAnomalyByEpoch","koeff","pos","vel","rotateX","orbitalQuat","getOrbitalFrameQuaternion","getOwnCoordsByTrueAnomaly","nodeQuaternion","angMomentum","u","radVel","D_Projects_github_com_urbain_ru_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_6__","D_Projects_github_com_urbain_ru_node_modules_babel_runtime_helpers_esm_get__WEBPACK_IMPORTED_MODULE_4__","Constant","setUpdateCallback","referenceFrameOrId","validateEpoch","_transformKeplerianObject","TrajectoryKeplerianAbstract","VisualTrajectoryKeplerian","showFull","trailPeriod","lastPositionEpoch","lastFrameEpoch","_markers","positionEpoch","getPositionEpoch","renderEllipse","renderHyperbola","framePos","stateVectorFromBaseReferenceFrameByEpoch","getEpochByTrueAnomaly","frameEpoch","maxTa","minTa","orbitQuaternion","pericentricReferenceFrame","curTa","angs","taStep","extraPoints","coords","updateGeometry","disable","enable","relativeCameraPosition","projectedRelativeCameraPosition","projectedCameraPosition","cameraTrueAnomaly","toClosestPoint","toFarthestPoint","cameraAngle","minAnglePart","maxAnglePart","maxMa","curMa","ellipsePoints","getEllipsePoints","curve","pointsNum","densityCenter","nearSegmentSize","segments","otherSegmentsSize","segmentsFar","segmentsMedium","segmentBounds","segmentSteps","curPos","getPoint","VisualTrajectoryModelAbstract","destinationFrameOrId","destinationFrame","stateVectorToBaseReferenceFrameByEpoch","transformStateVectorByEpoch","lastUsedTrajectory","isSelected","selectedVisualModel","map","getComponentByEpoch","isValidAtEpoch","ExceptionOutOfRange","setParent","pop","component","clearAfterEpoch","TrajectoryAbstract","FlightEventSOIChangeAbstract","oldSoi","newSoi","flightEvent","FlightEventAbstract","VisualFlightEventAbstract","D_Projects_github_com_urbain_ru_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_1__","D_Projects_github_com_urbain_ru_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_2__","_flightEvent","_trajectory","setPositionOfEpoch","VisualSpriteStatic","_isSelected","initFlightEvents","_defaultMarkerScale","_selectedMarkerScale","_minEpoch","_maxEpoch","constructor","LineObject","vertexColors","addSelectableObject","intersection","getEpochByPoint","getSimCoords","addFlightEvent","getVisualClass","model","colorMults","endingBrightness","mainColor","setFromPoints","curColor","colors","multiplyScalar","ko","_updateMarkerScales","setColor","selectedColor","_updateScales","multiplier","k","needsUpdate","removeSelectableObject","VirtualPlane","intersects","constant","intersectionPoint","clone","index","face","faceIndex","ArrowObject","dir","headLength","headWidth","line","VisualAngle","size","editingCallback","_referenceFrame","_orientation","_value","arcSize","isEditMode","bounds","customPriority","orientationUpdated","valueUpdated","sizeNeedsUpdate","minValue","maxValue","onWheelListener","mouseDownListener","TYPE_ARC","createArcObject","createSectorObject","threeAngle","children","cone","mouseUpListener","plane","getVirtualPlane","normalize","mainAxis","applyQuaternion","oldAngleValue","newAngleValue","virtualPlane","threeArc","threeMainAxis","vertices","getPoints","ceil","opacity","transparent","side","getPosition","getValue","updateArcObject","updateSectorObject","getOrientation","TYPE_SECTOR","VisualPlanePoint","minBound","maxBound","lastEpoch","updateValue","KeplerianEditor","isEditable","colorRaan","colorAop","colorInc","colorTa","angleRaan","angleInc","setBounds","angleAop","angleTa","pointApoapsis","periapsis","pointPeriapsis","apoapsis","angleTaEditing","cachedEpoch","cachedState","clickHandler","showOrbitAnglesListener","_onShowOrbitAnglesChange","orbitalReferenceFrame","twoAxis","FlightEventSOIDeparture","FlightEventSOIArrival","found","newEvents","removeFlightEvent","keplerianEditor","stateOfEpoch","quaternionOfEpoch","ReferenceFrameInertialAbstract","STAR_SYSTEM_BARYCENTER","stars","referenceFrames","objects","entries","frame","createById","names","values","bodies","_arr2","_i2","GETTING_STARTED_WIZARD","getRus","getEng","VISUAL_CLASS","VisualFlightEventSOIDeparture","VisualFlightEventSOIArrival","setReferenceFrame","_textureName","propagator","updateHandlers","pointEpoch","newEvent","oldEvent","sortManeuvers","h","sort","e1","e2","_vector","_update","isBuffer","isBufferGeometry","verticesCount","attributes","count","applyMatrix4","getInverse","matrixWorld","vertex1","vertex2","i1","i2","positions","array","currentLineDirection","commonPerpendicularDirection","crossVectors","planeNormalVector","distanceCoeff","addVectors","distanceTo","currentDistance","_visualModel","VisualMarkerAbstract","_alignVertical","_alignHorizontal","parentThreeObj","_parent","_isEnabled","VisualSprite","positionOfEpoch","verticalAlign","horizontalAlign","loadTexture","texture","setTexture","textureObj","_dropped","sizeAttenuation","updateCenter","image","vertical","horizontal","setAlign","_texture","OrientationAbstract","OrientationConstantAxis","angularVelocity","axisQuaternion","angularSpeed","initialAngle","initialEpoch","PhysicalBodyModel","TrajectoryKeplerianArray","keplerianObjects","nextIdx","searchDirection","approximateKeplerianObject","object1","object2","TrajectoryKeplerianPrecessingArray","obj1","obj2","TrajectoryKeplerianPrecessing","addPrecession","VisualTrajectoryPointArray","showAhead","showBehind","minCos","maxAngle","minStep","initVertices","originPos","epochs","low","high","curEpoch","curState","curVelocity","lastState","isIncreasing","stepsLeft","nextEpoch","newState","dr","drMag","angleCos","nextNextEpoch","nextDr","TrajectoryStaticPosition","TrajectoryLoader","createKeplerianBasic","createKeplerianPrecessing","createKeplerianArray","createKeplerianPrecessingArray","createComposite","createStatic","periodStart","periodEnd","rendering","visual","regular","createVisualModel","setSelectedVisualModel","keplerianModel","pointArrayModel","VisualTrajectoryModelPointArray","partConfig","elementsArray","addState","createKeplerianObject","elements","VisualStarsModel","threeGeometry","params","VisualLabel","parameters","assign","DEFAULT_SETTINGS","canvas","createElement","renderOrder","setText","context","fontSize","canvasWidth","canvasHeight","margin","ceilPowerOfTwo","textAlign","textBaseline","scaleCoeff","calculateScaleCoeff","scaling","scalingFunctions","range","from","to","alwaysVisible","VisualBodyModelAbstract","shape","getThreeObj","getThreeGeometry","getMaterial","wireframe","getTopDirection","getMaxDimension","VisualBodyModelBasic","isTextureRequested","metalness","roughness","txt","VisualBodyModelLight","light","lightColor","lightIntensity","lightDistance","lightDecay","VisualBodyModelRings","ringsRadius","ringsColorMapPath","ringsAlphaMapPath","container","bodyThreeObj","ringsThreeObj","ringsColorMap","ringsAlphaMap","alphaMap","updateRingsMaterial","VisualShapeSphere","objectConfig","_loadObject","addReferenceFrame","addStars","url","visualShape","visualModelClass","basic","rings","physical","./KSP/ModuleKSP","./KSP/ModuleKSP.js","./PatchedConics/FlightEvent/SOIArrival","./PatchedConics/FlightEvent/SOIArrival.js","./PatchedConics/FlightEvent/SOIChangeAbstract","./PatchedConics/FlightEvent/SOIChangeAbstract.js","./PatchedConics/FlightEvent/SOIDeparture","./PatchedConics/FlightEvent/SOIDeparture.js","./PatchedConics/ModulePatchedConics","./PatchedConics/ModulePatchedConics.js","./PatchedConics/PropagatorPatchedConics","./PatchedConics/PropagatorPatchedConics.js","./PatchedConics/visual/FlightEvent/SOIArrival","./PatchedConics/visual/FlightEvent/SOIArrival.js","./PatchedConics/visual/FlightEvent/SOIDeparture","./PatchedConics/visual/FlightEvent/SOIDeparture.js","./SolarSystem/ModuleSolarSystem","./SolarSystem/ModuleSolarSystem.js","./SolarSystem/Orientation/IAUModel","./SolarSystem/Orientation/IAUModel.js","./SolarSystem/Trajectory/ELP2000","./SolarSystem/Trajectory/ELP2000.js","./SolarSystem/Trajectory/VSOP87","./SolarSystem/Trajectory/VSOP87.js","webpackAsyncContext","req","ids","Promise","all","slice","resolve","code","exports","./getting-started-wizard/index","./getting-started-wizard","./getting-started-wizard/","./getting-started-wizard/getting-started-wizard-eng","./getting-started-wizard/getting-started-wizard-eng.js","./getting-started-wizard/getting-started-wizard-ru","./getting-started-wizard/getting-started-wizard-ru.js","./getting-started-wizard/index.js","./wizard-ids","./wizard-ids.js","TOP_MENU_ITEMS","SIMULATION","EDIT","VIEW","SETTINGS","HELP","HELP_PAGE_URL","MenuItemType","NONE","LINK","DROPDOWN","MenuItem","LinkMenuItem","_ref","_ref$href","href","_ref$target","Boolean","DropDownMenuItem","options","onSelect","selectedLabel","option","newOption","objectSpread","Store","simulation","loadTLE","viewSettings","showStatistics","showOrbitCreationPanel","showTransferCalculationPanel","showSatelliteSearchPanel","topMenu","_ref2","_ref3","_ref4","_simulation","_ref5","_ref6","loadSatellite","noradId","_loadTLE","unloadSatellite","starSystems","defaultValue","defaultStarSystem","item","_React$createContext","React","createContext","Provider","Consumer","StatisticsBadge","elementRef","createRef","current","props","stats","dom","react_default","ref","Component","components_statistics_badge","store_Consumer","store","statistics_badge_StatisticsBadge","LocalStorageWatchStatusService","storage","_storage","wizardId","_getWatchedWizards","some","canWatch","wizards","_saveStatuses","wizardIdsRawString","getItem","KEY","JSON","parse","wizardIds","setItem","stringify","showLangSelectorDialog","langs","rootNode","description","buttonLabel","unmountComponentAtNode","parentNode","removeChild","StepHandlerService","goalPrefix","durationPrefix","_goalPrefix","_durationPrefix","_stepStartTimes","_metrika","yaCounter47040543","nextStepIdx","stepName","durationName","reachGoal","_callee","watchStatusService","stepHandlerService","wizard","selectedId","_args","regenerator_default","wrap","_context","prev","localStorage","abrupt","sent","handleStep","slicedToArray","wizardConfig","createIntroJs","onStep","_currentStep","onComplete","markAsWatched","catch","message","stop","Logo","DEFAULT","customSelectStyles","base","background","minHeight","minWidth","control","borderRadius","borderStyle","menu","marginTop","marginBottom","menuList","backgroundColor","isFocused","singleValue","isDisabled","transition","dropdownIndicator","padding","marginRight","indicatorSeparator","display","IndicatorsContainer","react_select_esm","DropdownIndicator","Select","PropTypes","_ref$onSelect","classNamePrefix","placeholder","styles","isSearchable","onChange","StarSystemSelector","select_select","star_system_selector_star_system_selector","_store$starSystemSele","starSystemSelectorSettings","DropdownMenuItem","handleClick","_this$props","react_fontawesome_index_es","icon","DropDownMenu","selectedItem","updateStore","_this$props2","hasOptionsToShow","drop_down_menu_item","components_drop_down_menu","dropDownMenuData","drop_down_menu_DropDownMenu","MenuLink","_ref$className","MainMenuItem","menuItem","clickable","cn","menu_link","MainMenu","isClickable","Header","logo","main_menu_main_menu","SideBar","Button","_ref$small","small","_ref$disabled","disabled","_ref$onClick","button--disabled","button--small","ArrowLogo","classNames","role","viewBox","fill","xmlns","MaximizeLogo","strokeWidth","CollapseButton","isToRight","_ref$collapseDirectio","collapseDirection","components_common_button","maximize_logo","Field","_ref$leftAligned","leftAligned","_ref$centered","centered","panel__field--left-aligned","panel__field--centered","FieldLabel","_ref$tag","tag","ComponentType","_ref$normal","_ref$middle","middle","panel__field-label--normal","panel__field-label--middle","panel__field-label--small","FieldControl","_ref$fullSize","fullSize","panel__field-control--full-size","PanelButton","FieldSet","Dimension","Panel","collapsedByDefault","handleToggle","setState","prevState","caption","hideCollapseButton","titleIcon","hidden","panel--hidden","panel--collapsed","collapse_button","style","defaultProps","CameraPanel","panel_Panel","field","field_label","field_control","PauseButton","timeLine","pause-button--paused","time_settings_panel_logo","TimeSettingsPanel","components_button","BottomPanel","components_time_settings_panel","components_pause_button","components_time_line","camera_panel_camera_panel","CreationPanel","TransferCalculationPanel","field_set","data-panel-name","components_dimension","KeplerianView","VectorComponentView","_ref$label","_ref$valueClassName","valueClassName","_ref$dimension","dimension","ExpandButton","_ref$expanded","expanded","expand-button--expanded","CartesianVectorView","isExpanded","vectorMagnitudeLabel","components_vector_component_view","common_expand_button","MetricsPanel","defaultChecked","components_cartesian_vector_view","ManeuverPanel","Satellite","satelliteRawData","objectType","intlDes","country","launchDate","decayDate","launchSite","apogee","perigee","launchYear","launchNum","launchPiece","objectName","objectNumber","LoadButton","isLoaded","handleLoad","onLoad","satelliteId","handleUnload","onUnload","SatellitesGrid","satellites","satellite","satellites_grid_LoadButton","onSatelliteLoad","onSatelliteUnload","API_ENDPOINT","findSatellites","_x","_x2","_findSatellites","apply","resp","axios","status","totalRows","alert","t0","SatelliteSearchPanel","satId","handleSatIdChange","handleLaunchDateChange","handleSearch","s","_this$state","isFilterValid","satellites_grid","MainView","common_side_bar","creation_panel","components_maneuver_panel","components_transfer_calculation_panel","components_metrics_panel","components_satellite_search_panel","components_bottom_panel","Footer","App","showWizard","Fragment","header_header","main_view_main_view","footer","library","faExpand","faPlay","faPause","faChevronDown","faCheck","faBars","statsBadge","Stats","classList","createStatsBadge","Root","updatedStore","store_Provider","app","initialState","loadKSP","Application","_store","getInitialState","api","getApi","ReactDOM","ui_Root"],"mappings":"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","file":"static/js/main.549c3ffb.chunk.js","sourcesContent":["import * as THREE from \"three\";\r\n\r\nexport class Vector extends Array\r\n{\r\n    constructor(dimOrArray) {\r\n        super();\r\n        if (dimOrArray === undefined) {\r\n            dimOrArray = 3;\r\n        }\r\n        if (dimOrArray instanceof Array) {\r\n            for (let i = 0; i < dimOrArray.length; ++i) {\r\n                this[i] = dimOrArray[i];\r\n            }\r\n        } else {\r\n            for (let i = 0; i < dimOrArray; ++i) {\r\n                this[i] = 0;\r\n            }\r\n        }\r\n\r\n        Object.setPrototypeOf(this, Vector.prototype);\r\n    }\r\n\r\n    get x() {\r\n        return this[0];\r\n    }\r\n\r\n    set x(value) {\r\n        this[0] = value;\r\n    }\r\n\r\n    get y() {\r\n        return this[1];\r\n    }\r\n\r\n    set y(value) {\r\n        this[1] = value;\r\n    }\r\n\r\n    get z() {\r\n        return this[2];\r\n    }\r\n\r\n    set z(value) {\r\n        this[2] = value;\r\n    }\r\n\r\n    get quadrance() {\r\n        let res = 0;\r\n        for (let i = 0; i < this.length; ++i) {\r\n            res += this[i] * this[i];\r\n        }\r\n        return res;\r\n    }\r\n\r\n    get mag() {\r\n        return Math.sqrt(this.quadrance);\r\n    }\r\n\r\n    copy() {\r\n        return new Vector(this);\r\n    }\r\n\r\n    set(arrayOrVarargs) {\r\n        let vals = (arguments.length === 1) ? arguments[0] : arguments;\r\n        if (vals.length == null) {\r\n            vals = [vals];\r\n        }\r\n        for (let i = 0; i < this.length; ++i) {\r\n            this[i] = vals[i];\r\n        }\r\n        return this;\r\n    }\r\n\r\n    dot(vec) {\r\n        let res = 0;\r\n        for (let i = 0; i < this.length; ++i) {\r\n            res += this[i] * vec[i];\r\n        }\r\n        return res;\r\n    }\r\n\r\n    cross(vec) {\r\n        return new Vector([\r\n            this[1] * vec[2] - this[2] * vec[1],\r\n            this[2] * vec[0] - this[0] * vec[2],\r\n            this[0] * vec[1] - this[1] * vec[0],\r\n        ]);\r\n    }\r\n\r\n    angle(vec) {\r\n        const cos = this.dot(vec) / this.mag / vec.mag;\r\n        if (cos <= -1) {\r\n            return Math.PI;\r\n        }\r\n        if (cos >= 1) {\r\n            return 0;\r\n        }\r\n        return Math.acos(cos);\r\n    }\r\n\r\n    add_(vec) {\r\n        for (let i = 0; i < this.length; ++i) {\r\n            this[i] += vec[i];\r\n        }\r\n        return this;\r\n    }\r\n\r\n    sub_(vec) {\r\n        for (let i = 0; i < this.length; ++i) {\r\n            this[i] -= vec[i];\r\n        }\r\n        return this;\r\n    }\r\n\r\n    mul_(scalar) {\r\n        for (let i = 0; i < this.length; ++i) {\r\n            this[i] *= scalar;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    div_(scalar) {\r\n        for (let i = 0; i < this.length; ++i) {\r\n            this[i] /= scalar;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    rotate_(axis, angle) {\r\n        return (new Quaternion(axis, angle)).rotate_(this);\r\n    }\r\n\r\n    unit_() {\r\n        return this.div_(this.mag);\r\n    }\r\n\r\n    projectOn_(v) {\r\n        let unit = v.unit();\r\n        this.set(unit.mul_(this.dot(unit)));\r\n        return this;\r\n    }\r\n\r\n    add(vec) {\r\n        return this.copy().add_(vec);\r\n    }\r\n\r\n    sub(vec) {\r\n        return this.copy().sub_(vec);\r\n    }\r\n\r\n    mul(scalar) {\r\n        return this.copy().mul_(scalar);\r\n    }\r\n\r\n    div(scalar) {\r\n        return this.copy().div_(scalar);\r\n    }\r\n\r\n    unit() {\r\n        return this.copy().unit_();\r\n    }\r\n\r\n    projectOn(v) {\r\n        return this.copy().projectOn_(v);\r\n    }\r\n\r\n    projectionOn(v) {\r\n        return this.dot(v.unit());\r\n    }\r\n\r\n    rotate(axis, angle) {\r\n        return this.copy().rotate_(axis, angle);\r\n    }\r\n\r\n    rotateX(radians) {\r\n        let sin = Math.sin(radians);\r\n        let cos = Math.cos(radians);\r\n        return new Vector([\r\n            this[0],\r\n            this[1] * cos - this[2] * sin,\r\n            this[1] * sin + this[2] * cos,\r\n        ]);\r\n    }\r\n\r\n    rotateY(radians) {\r\n        let sin = Math.sin(radians);\r\n        let cos = Math.cos(radians);\r\n        return new Vector([\r\n            this[0] * cos + this[2] * sin,\r\n            this[1],\r\n            -this[0] * sin + this[2] * cos,\r\n        ]);\r\n    }\r\n\r\n    rotateZ(radians) {\r\n        let sin = Math.sin(radians);\r\n        let cos = Math.cos(radians);\r\n        return new Vector([\r\n            this[0] * cos - this[1] * sin,\r\n            this[0] * sin + this[1] * cos,\r\n            this[2],\r\n        ]);\r\n    }\r\n}\r\n\r\nexport class Quaternion\r\n{\r\n    constructor(vector, angle) {\r\n        this.t = 1;\r\n        this.v = new Vector(3);\r\n\r\n        if (vector instanceof Array) {\r\n            this.setAxisAngle(vector || [1, 0, 0], angle || 0);\r\n        }\r\n    }\r\n\r\n    static copy(q) {\r\n        return q.copy();\r\n    }\r\n\r\n    static mul(q1, q2) {\r\n        return q1.copy().mul_(q2);\r\n    }\r\n\r\n    static transfer(fromVector, toVector) {\r\n        const angle = fromVector.angle(toVector);\r\n        if (angle) {\r\n            return new Quaternion(fromVector.cross(toVector), angle);\r\n        } else {\r\n            return new Quaternion();\r\n        }\r\n    }\r\n\r\n    static twoAxis(x, y, z) {\r\n        let normal1;\r\n        let normal2;\r\n        let quat;\r\n        if (x && y) {\r\n            normal1 = new Vector([0, 0, 1]);\r\n            normal2 = x.cross(y);\r\n        } else if (x && z) {\r\n            normal1 = new Vector([0, 1, 0]);\r\n            normal2 = z.cross(x);\r\n        } else if (y && z) {\r\n            normal1 = new Vector([1, 0, 0]);\r\n            normal2 = y.cross(z);\r\n        }\r\n        quat = Quaternion.transfer(normal1, normal2);\r\n        return x\r\n            ? Quaternion.transfer(quat.rotate_(new Vector([1,0,0])), x).mul_(quat)\r\n            : Quaternion.transfer(quat.rotate_(new Vector([0,1,0])), y).mul_(quat);\r\n    }\r\n\r\n    static slerp(q1, q2, t) {\r\n        if (t == 0) {\r\n            return q1.copy();\r\n        } else if (t == 1) {\r\n            return q2.copy();\r\n        }\r\n\r\n        let res = q2.copy();\r\n        let cosHalfTheta = q1.t * q2.t + q1.v[0] * q2.v[0] + q1.v[1] * q2.v[1] + q1.v[2] * q2.v[2];\r\n\r\n        if (cosHalfTheta < 0) {\r\n            res.t = -q2.t;\r\n            res.v[0] = -q2.v[0];\r\n            res.v[1] = -q2.v[1];\r\n            res.v[2] = -q2.v[2];\r\n            cosHalfTheta = -cosHalfTheta;\r\n        }\r\n\r\n        if (cosHalfTheta >= 1) {\r\n            return q1.copy();\r\n        }\r\n\r\n        let sinHalfTheta = Math.sqrt(1 - cosHalfTheta * cosHalfTheta);\r\n\r\n        if (sinHalfTheta < 0.001) {\r\n            res.t = (q1.t + res.t) / 2;\r\n            res.v[0] = (q1.v[0] + res.v[0]) / 2;\r\n            res.v[1] = (q1.v[1] + res.v[1]) / 2;\r\n            res.v[2] = (q1.v[2] + res.v[2]) / 2;\r\n            return res;\r\n        }\r\n\r\n        const halfTheta = Math.atan2(sinHalfTheta, cosHalfTheta);\r\n        const ratio1 = Math.sin((1 - t) * halfTheta) / sinHalfTheta;\r\n        const ratio2 = Math.sin(t * halfTheta) / sinHalfTheta;\r\n\r\n        res.t = q1.t * ratio1 + res.t * ratio2;\r\n        res.v[0] = q1.v[0] * ratio1 + res.v[0] * ratio2;\r\n        res.v[1] = q1.v[1] * ratio1 + res.v[1] * ratio2;\r\n        res.v[2] = q1.v[2] * ratio1 + res.v[2] * ratio2;\r\n        return res;\r\n    }\r\n\r\n    static invert(quat) {\r\n        return quat.invert();\r\n    }\r\n\r\n    copy() {\r\n        let res = new Quaternion();\r\n        res.t = this.t;\r\n        res.v = this.v.copy();\r\n        return res;\r\n    }\r\n\r\n    quadrance() {\r\n        return this.t * this.t + this.v[0] * this.v[0] + this.v[1] * this.v[1] + this.v[2] * this.v[2];\r\n    }\r\n\r\n    length() {\r\n        return Math.sqrt(this.quadrance());\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @returns {Quaternion}\r\n     */\r\n    invert_() {\r\n        let quadrance = this.quadrance();\r\n        this.t /= quadrance;\r\n        this.v.div_(-quadrance);\r\n        return this;\r\n    }\r\n\r\n    invert() {\r\n        return this.copy().invert_();\r\n    }\r\n\r\n    normalize_() {\r\n        let len = this.length();\r\n        this.t /= len;\r\n        this.v.div_(len);\r\n        return this;\r\n    }\r\n\r\n    normalize() {\r\n        return this.copy().normalize_();\r\n    }\r\n\r\n    rotate_(vector) {\r\n        let cx = this.v.cross(vector).mul_(2);\r\n        let cx2 = this.v.cross(cx);\r\n        vector[0] += this.t * cx[0] + cx2[0];\r\n        vector[1] += this.t * cx[1] + cx2[1];\r\n        vector[2] += this.t * cx[2] + cx2[2];\r\n        return vector;\r\n    }\r\n\r\n    rotate(vector) {\r\n        return this.rotate_(vector.copy());\r\n    }\r\n\r\n    mul_(quat) {\r\n        const w = this.t;\r\n        const x = this.v[0];\r\n        const y = this.v[1];\r\n        const z = this.v[2];\r\n        const ow = quat.t;\r\n        const ox = quat.v[0];\r\n        const oy = quat.v[1];\r\n        const oz = quat.v[2];\r\n\r\n        this.t = w * ow - x * ox - y * oy - z * oz;\r\n        this.v[0] = w * ox + x * ow + y * oz - z * oy;\r\n        this.v[1] = w * oy - x * oz + y * ow + z * ox;\r\n        this.v[2] = w * oz + x * oy - y * ox + z * ow;\r\n\r\n        return this;\r\n    }\r\n\r\n    mul(quat) {\r\n        return this.copy().mul_(quat);\r\n    }\r\n\r\n    setAxisAngle(axis, angle) {\r\n        this.t = Math.cos(angle / 2);\r\n        this.v.set(axis);\r\n        this.v.mul_(Math.sin(angle / 2) / this.v.mag);\r\n        return this;\r\n    }\r\n\r\n    setFromEuler(x, y, z, order) {\r\n        const c1 = Math.cos(x / 2);\r\n        const c2 = Math.cos(y / 2);\r\n        const c3 = Math.cos(z / 2);\r\n        const s1 = Math.sin(x / 2);\r\n        const s2 = Math.sin(y / 2);\r\n        const s3 = Math.sin(z / 2);\r\n\r\n        order = order || 'ZYX';\r\n\r\n        if (order === 'XYZ') {\r\n            this.v.set([\r\n                s1 * c2 * c3 + c1 * s2 * s3,\r\n                c1 * s2 * c3 - s1 * c2 * s3,\r\n                c1 * c2 * s3 + s1 * s2 * c3\r\n            ]);\r\n            this.t = c1 * c2 * c3 - s1 * s2 * s3;\r\n        } else if (order === 'YXZ') {\r\n            this.v.set([\r\n                s1 * c2 * c3 + c1 * s2 * s3,\r\n                c1 * s2 * c3 - s1 * c2 * s3,\r\n                c1 * c2 * s3 - s1 * s2 * c3\r\n            ]);\r\n            this.t = c1 * c2 * c3 + s1 * s2 * s3;\r\n        } else if (order === 'ZXY') {\r\n            this.v.set([\r\n                s1 * c2 * c3 - c1 * s2 * s3,\r\n                c1 * s2 * c3 + s1 * c2 * s3,\r\n                c1 * c2 * s3 + s1 * s2 * c3\r\n            ]);\r\n            this.t = c1 * c2 * c3 - s1 * s2 * s3;\r\n        } else if (order === 'ZYX') {\r\n            this.v.set([\r\n                s1 * c2 * c3 - c1 * s2 * s3,\r\n                c1 * s2 * c3 + s1 * c2 * s3,\r\n                c1 * c2 * s3 - s1 * s2 * c3\r\n            ]);\r\n            this.t = c1 * c2 * c3 + s1 * s2 * s3;\r\n        } else if (order === 'YZX') {\r\n            this.v.set([\r\n                s1 * c2 * c3 + c1 * s2 * s3,\r\n                c1 * s2 * c3 + s1 * c2 * s3,\r\n                c1 * c2 * s3 - s1 * s2 * c3\r\n            ]);\r\n            this.t = c1 * c2 * c3 - s1 * s2 * s3;\r\n        } else if (order === 'XZY') {\r\n            this.v.set([\r\n                s1 * c2 * c3 - c1 * s2 * s3,\r\n                c1 * s2 * c3 - s1 * c2 * s3,\r\n                c1 * c2 * s3 + s1 * s2 * c3\r\n            ]);\r\n            this.t = c1 * c2 * c3 + s1 * s2 * s3;\r\n        } else if (order === 'ZXZ') {\r\n            this.v.set([\r\n                Math.cos((x - z) / 2) * s2,\r\n                Math.sin((x - z) / 2) * s2,\r\n                Math.sin((x + z) / 2) * c2\r\n            ]);\r\n            this.t = Math.cos((x + z) / 2) * c2\r\n        }\r\n        return this;\r\n    }\r\n\r\n    toThreejs() {\r\n        return new THREE.Quaternion(this.v[0], this.v[1], this.v[2], this.t);\r\n    }\r\n}\r\n\r\nexport const TWO_PI = 2 * Math.PI;\r\n\r\nexport function newtonSolve(func, start, d, maxError, maxSteps) {\r\n    let step = 0;\r\n    let val = start;\r\n    let error;\r\n\r\n    do {\r\n        const v1 = func(val);\r\n        const v2 = func(val + d);\r\n        const diff = (v2 - v1) / d;\r\n\r\n        if (v1 === null || v2 === null) {\r\n            return null;\r\n        }\r\n\r\n        error = Math.abs(v1);\r\n        val -= v1 / diff;\r\n        step += 1;\r\n    } while (error > maxError && step < maxSteps);\r\n\r\n    return (error > maxError) ? null : val;\r\n}\r\n\r\nexport function deg2rad(degrees) {\r\n    return degrees / 180 * Math.PI;\r\n}\r\n\r\nexport function rad2deg(radians) {\r\n    return radians * 180 / Math.PI;\r\n}\r\n\r\nexport function acosSigned(cos, sinSign) {\r\n    const ang = Math.acos(cos);\r\n    return (sinSign > 0)\r\n        ? ang\r\n        : (TWO_PI - ang);\r\n}\r\n\r\nexport function angleIntervalIntersection(int1, int2) {\r\n    if (!int1 || !int2) {\r\n        return false;\r\n    } else if (int1[0] <= int2[0] && int2[1] <= int1[1]) {\r\n        return int2;\r\n    } else if (int2[0] <= int1[0] && int1[1] <= int2[1]) {\r\n        return int1;\r\n    } else if (int1[0] <= int2[0] && int2[0] <= int1[1]) {\r\n        return [int2[0], int1[1]];\r\n    } else if (int1[0] <= int2[1] && int2[1] <= int1[1]) {\r\n        return [int1[0], int2[1]];\r\n    }\r\n    return false;\r\n}\r\n\r\nexport function getAngleIntervalsIntersection(intervals1, intervals2) {\r\n    let result = [];\r\n    if (intervals1 === false || intervals2 === false) {\r\n        return false;\r\n    }\r\n    if (intervals1 === true) {\r\n        return intervals2;\r\n    }\r\n    if (intervals2 === true) {\r\n        return intervals1;\r\n    }\r\n    for (let interval1 of intervals1) {\r\n        const int11 = [interval1[0], interval1[1] > interval1[0] ? interval1[1] : TWO_PI];\r\n        const int12 = interval1[1] > interval1[0] ? false : [0, interval1[1]];\r\n        for (let interval2 of intervals2) {\r\n            const int21 = [interval2[0], interval2[1] > interval2[0] ? interval2[1] : TWO_PI];\r\n            const int22 = interval2[1] > interval2[0] ? false : [0, interval2[1]];\r\n            let r;\r\n            if (r = angleIntervalIntersection(int11, int21))\r\n                result.push(r);\r\n            if (r = angleIntervalIntersection(int11, int22))\r\n                result.push(r);\r\n            if (r = angleIntervalIntersection(int12, int21))\r\n                result.push(r);\r\n            if (r = angleIntervalIntersection(int12, int22))\r\n                result.push(r);\r\n        }\r\n    }\r\n    return result.length ? result : false;\r\n}\r\n\r\nexport function isInInterval(angle, interval) {\r\n    const int1 = (interval[0] + TWO_PI) % TWO_PI;\r\n    const int2 = (interval[1] + TWO_PI) % TWO_PI;\r\n    angle = (angle + TWO_PI) % TWO_PI;\r\n    if (int1 <= int2) {\r\n        return (int1 <= angle) && (angle <= int2);\r\n    } else {\r\n        return (int1 <= angle) || (angle <= int2);\r\n    }\r\n}\r\n\r\nexport function getEpochIntervalsIntersection(intervals1, intervals2) {\r\n    let result = [];\r\n    if (intervals1 === false || intervals2 === false) {\r\n        return false;\r\n    }\r\n    if (intervals1 === true) {\r\n        return intervals2;\r\n    }\r\n    if (intervals2 === true) {\r\n        return intervals1;\r\n    }\r\n    for (let interval1 of intervals1) {\r\n        const epoch1 = interval1[0];\r\n        const epoch2 = interval1[1];\r\n        for (let interval2 of intervals2) {\r\n            const epoch21 = interval2[0];\r\n            const epoch22 = interval2[1];\r\n            if (epoch1 <= epoch21 && epoch21 < epoch2) {\r\n                result.push([\r\n                    epoch21,\r\n                    epoch2 < epoch22 ? epoch2 : epoch22\r\n                ]);\r\n            } else if (epoch1 < epoch22 && epoch22 <= epoch2) {\r\n                result.push([\r\n                    epoch1,\r\n                    epoch22,\r\n                ]);\r\n            } else if (epoch1 < epoch21 && epoch22 < epoch2) {\r\n                result.push([\r\n                    epoch21,\r\n                    epoch22,\r\n                ]);\r\n            } else if (epoch21 < epoch1 && epoch2 < epoch22) {\r\n                result.push([\r\n                    epoch1,\r\n                    epoch2,\r\n                ]);\r\n            }\r\n        }\r\n    }\r\n    return result.length ? result : false;\r\n}\r\n\r\nexport function approximateAngle(ang1, ang2, proportion) {\r\n    ang1 = ((ang1 % TWO_PI) + TWO_PI) % TWO_PI;\r\n    ang2 = ((ang2 % TWO_PI) + TWO_PI) % TWO_PI;\r\n\r\n    let diff = ang2 - ang1;\r\n\r\n    if (Math.abs(diff) > Math.PI) {\r\n        diff = (diff > 0)\r\n            ? (diff - TWO_PI)\r\n            : (diff + TWO_PI);\r\n    }\r\n\r\n    return ((ang1 + diff * proportion) + TWO_PI) % TWO_PI;\r\n}\r\n\r\nexport function approximateNumber(n1, n2, proportion) {\r\n    return n1 + (n2 - n1) * proportion;\r\n}\r\n\r\nexport function presentNumberWithSuffix(number) {\r\n    if (Math.abs(number) >= 1000000000) {\r\n        return (number / 1000000000).toFixed(3) + ' G';\r\n    }\r\n    if (Math.abs(number) >= 1000000) {\r\n        return (number / 1000000).toFixed(3) + ' M';\r\n    }\r\n    if (Math.abs(number) >= 1000) {\r\n        return (number / 1000).toFixed(3) + ' K';\r\n    }\r\n    if (Math.abs(number) <= 0.000000001) {\r\n        return (number / 0.000000001).toFixed(3) + ' n';\r\n    }\r\n    if (Math.abs(number) <= 0.000001) {\r\n        return (number / 0.000001).toFixed(3) + ' µ';\r\n    }\r\n    if (Math.abs(number) <= 0.001) {\r\n        return (number / 0.001).toFixed(3) + ' m';\r\n    }\r\n    return number.toPrecision(6) + ' ';\r\n}\r\n","export default class EventHandler\r\n{\r\n    constructor(domElement) {\r\n        this.domElement = domElement;\r\n        this.listeners = {};\r\n        this.handlers = {};\r\n    }\r\n\r\n    addListener(eventName, listener, priority) {\r\n        if (!this.handlers[eventName]) {\r\n            this.listeners[eventName] = [];\r\n            this.handlers[eventName] = (event) => this.handleEvent(eventName, event);\r\n            this.domElement.addEventListener(eventName, this.handlers[eventName]);\r\n        }\r\n\r\n        this.listeners[eventName].push({\r\n            handler: listener,\r\n            priority: priority\r\n        });\r\n    }\r\n\r\n    removeListener(eventName, listener) {\r\n        const list = this.listeners[eventName];\r\n        for (let idx = 0; idx < list.length; idx++) {\r\n            if (list[idx].handler === listener) {\r\n                list.splice(idx, 1);\r\n                break;\r\n            }\r\n        }\r\n\r\n        if (list.length === 0) {\r\n            this.domElement.removeEventListener(eventName, this.handlers[eventName]);\r\n            delete this.handlers[eventName];\r\n            delete this.listeners[eventName];\r\n        }\r\n    }\r\n\r\n    handleEvent(eventName, eventObject) {\r\n        const list = this.listeners[eventName];\r\n\r\n        if (!list) {\r\n            return;\r\n        }\r\n\r\n        const highestPriority = list.reduce((val, a) => Math.max(val, a.priority), list[0].priority);\r\n\r\n        for (const listener of list) {\r\n            if (listener.priority === highestPriority) {\r\n                listener.handler(eventObject);\r\n            }\r\n        }\r\n    }\r\n}\r\n","import Events from \"../core/Events\";\r\n\r\nexport const J2000_TIMESTAMP = 946728000;\r\n\r\nexport default class TimeLine\r\n{\r\n    constructor(epoch, timeScale, isTimeRunning) {\r\n        this.epoch = epoch;\r\n        this.timeScale = timeScale;\r\n        this.isTimeRunning = isTimeRunning;\r\n\r\n        this.mouseState = {\r\n            x: 0,\r\n            y: 0,\r\n            leftButton: false,\r\n            rightButton: false\r\n        };\r\n\r\n        this.timeLineCanvasDomElement = document.getElementById(\"timeLineCanvas\");\r\n        this.canvasContext = this.timeLineCanvasDomElement.getContext(\"2d\");\r\n        this.canvasRect = {};\r\n        this.updateCanvasStyle();\r\n        this.initValues();\r\n\r\n        this.timeLineCanvasDomElement.addEventListener(\"mousedown\",  this.onMouseDown  .bind(this));\r\n        window                       .addEventListener(\"mouseup\",    this.onMouseUp    .bind(this));\r\n        window                       .addEventListener(\"mousemove\",  this.onMouseMove  .bind(this));\r\n        this.timeLineCanvasDomElement.addEventListener(\"mousewheel\", this.onMouseWheel .bind(this));\r\n\r\n        window.addEventListener('keypress', e => {\r\n            if (e.key === ' ') {\r\n                this.togglePause();\r\n            }\r\n        });\r\n\r\n        window.addEventListener(\"resize\", this.updateCanvasStyle.bind(this));\r\n        window.oncontextmenu = () => false;\r\n    }\r\n\r\n    initValues() {\r\n        this.scales = {\r\n            minute: 60,\r\n            fiveMinutes: 300,\r\n            tenMinutes: 600,\r\n            thirtyMinutes: 1800,\r\n            hour: 3600,\r\n            threeHours: 10800,\r\n            sixHours: 21600,\r\n            day: 86400,\r\n            week: 604800,\r\n            month: 2592000,\r\n            threeMonths: 7776000,\r\n            year: 31557600,\r\n            fiveYears: 157788000,\r\n        };\r\n\r\n        this.span = this.timeScale * 86400 * 5;\r\n        this.markDistance = 300;\r\n        this.scaleType = \"month\";\r\n        this.leftEpoch = this.epoch - this.span / 2;\r\n\r\n        this.updateScaleType();\r\n\r\n        this.getDateByEpoch = TimeLine.getDateByEpoch;\r\n        this.getEpochByDate = TimeLine.getEpochByDate;\r\n\r\n        this.roundDateUp = TimeLine.roundDateUp;\r\n        this.nextRenderingDate = TimeLine.nextRenderingDate;\r\n        this.formatDate = TimeLine.formatDate;\r\n        this.formatDateFull = TimeLine.formatDateFull;\r\n    }\r\n\r\n    setTimeScale(newScale) {\r\n        Events.dispatch(Events.TIME_SCALE_CHANGED, {old: this.timeScale, new: newScale});\r\n        this.timeScale = newScale;\r\n    }\r\n\r\n    togglePause() {\r\n        this.isTimeRunning = !this.isTimeRunning;\r\n        Events.dispatch(this.isTimeRunning ? Events.TIME_UNPAUSED : Events.TIME_PAUSED);\r\n    }\r\n\r\n    tick(timePassed) {\r\n        if (this.mouseState.leftButton) {\r\n            this.epoch = this.leftEpoch + (this.mouseState.x\r\n                - this.canvasRect.left) * this.span / this.timeLineCanvasDomElement.width;\r\n        } else if (this.isTimeRunning) {\r\n            if ((this.leftEpoch < this.epoch)\r\n                && (this.epoch < this.leftEpoch + this.span)\r\n            ) {\r\n                this.leftEpoch += this.timeScale * timePassed;\r\n            }\r\n\r\n            this.epoch += this.timeScale * timePassed;\r\n        }\r\n\r\n        Events.dispatch(Events.EPOCH_CHANGED, {\r\n            epoch: this.epoch,\r\n            date: this.getDateByEpoch(this.epoch)\r\n        });\r\n\r\n        this.redraw();\r\n    }\r\n\r\n    forceEpoch(newEpoch) {\r\n        this.leftEpoch += newEpoch - this.epoch;\r\n        this.epoch = newEpoch;\r\n        this.tick(0);\r\n    }\r\n\r\n    useCurrentTime() {\r\n        this.forceEpoch(this.getEpochByDate(new Date()));\r\n    }\r\n\r\n    redraw() {\r\n        this.canvasContext.fillStyle = \"#222\";\r\n        this.canvasContext.fillRect(0, 0, this.timeLineCanvasDomElement.width, this.timeLineCanvasDomElement.height);\r\n\r\n        this.canvasContext.fillStyle = this.isTimeRunning ? \"#2846ed\" : \"#393b40\";\r\n        this.drawCurrentTimeMark();\r\n\r\n        this.canvasContext.strokeStyle = \"#fdfdfd\";\r\n        this.canvasContext.fillStyle   = \"#fdfdfd\";\r\n        this.canvasContext.font        = \"11px sans-serif\";\r\n\r\n        let markDate = this.roundDateUp(this.getDateByEpoch(this.leftEpoch), this.scaleType);\r\n        let markEpoch = this.getEpochByDate(markDate);\r\n\r\n        while (markEpoch < this.leftEpoch + this.span) {\r\n            this.drawMark(this.getCanvasPositionByEpoch(markEpoch), this.formatDate(markDate, this.scaleType));\r\n            markDate = this.nextRenderingDate(markDate, this.scaleType);\r\n            markEpoch = this.getEpochByDate(markDate);\r\n        }\r\n    }\r\n\r\n    getCanvasPositionByEpoch(epoch) {\r\n        return (epoch - this.leftEpoch) * this.timeLineCanvasDomElement.width / this.span;\r\n    }\r\n\r\n    updateCanvasStyle() {\r\n        this.canvasRect = this.timeLineCanvasDomElement.getBoundingClientRect();\r\n        this.timeLineCanvasDomElement.width  = this.canvasRect.right  - this.canvasRect.left;\r\n        this.timeLineCanvasDomElement.height = this.canvasRect.bottom - this.canvasRect.top;\r\n    }\r\n\r\n    updateScaleType() {\r\n        const secondsPerPeriod = this.markDistance * this.span / this.timeLineCanvasDomElement.width;\r\n        let bestScale = false;\r\n\r\n        for (const scale in this.scales) {\r\n            if (!bestScale) {\r\n                bestScale = scale;\r\n                continue;\r\n            }\r\n\r\n            if (Math.abs(this.scales[bestScale] / secondsPerPeriod - 1)\r\n                > Math.abs(this.scales[scale] / secondsPerPeriod - 1)\r\n            ) {\r\n                bestScale = scale;\r\n            }\r\n        }\r\n\r\n        this.scaleType = bestScale;\r\n    }\r\n\r\n    drawMark(x, text) {\r\n        this.canvasContext.beginPath();\r\n        this.canvasContext.moveTo(x, 0);\r\n        this.canvasContext.lineTo(x, this.timeLineCanvasDomElement.height / 2);\r\n        this.canvasContext.stroke();\r\n        this.canvasContext.fillText(\r\n            text,\r\n            x - this.canvasContext.measureText(text).width / 2,\r\n            this.timeLineCanvasDomElement.height - 2\r\n        );\r\n    }\r\n\r\n    drawCurrentTimeMark() {\r\n        this.canvasContext.fillRect(0, 0, this.getCanvasPositionByEpoch(this.epoch), this.timeLineCanvasDomElement.height);\r\n    }\r\n\r\n    onMouseDown(e) {\r\n        if (e.button === 0) {\r\n            this.mouseState.leftButton = true;\r\n        } else if (e.button === 2) {\r\n            this.mouseState.rightButton = true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    onMouseUp(e) {\r\n        if (e.button === 0) {\r\n            this.mouseState.leftButton = false;\r\n        } else if (e.button === 2) {\r\n            this.mouseState.rightButton = false;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    onMouseMove(e) {\r\n        if (this.mouseState.rightButton) {\r\n            this.leftEpoch += (this.mouseState.x - e.x) * this.span / this.timeLineCanvasDomElement.width;\r\n        }\r\n\r\n        this.mouseState.x = e.x;\r\n        this.mouseState.y = e.y;\r\n        return false;\r\n    }\r\n\r\n    getMinScale() {\r\n        return Object.keys(this.scales).reduce((a, b) => { return this.scales[a] < this.scales[b] ? a : b });\r\n    }\r\n\r\n    getMaxScale() {\r\n        return Object.keys(this.scales).reduce((a, b) => { return this.scales[a] > this.scales[b] ? a : b });\r\n    }\r\n\r\n    onMouseWheel(e) {\r\n        const stepMult = 1.3;\r\n        const mult = (e.deltaY > 0) ? stepMult : (1 / stepMult);\r\n        const newSpan = Math.min(Math.max(this.span * mult,\r\n            (this.canvasRect.right - this.canvasRect.left) / this.markDistance * this.scales[this.getMinScale()]),\r\n            (this.canvasRect.right - this.canvasRect.left) / this.markDistance * this.scales[this.getMaxScale()]);\r\n        this.leftEpoch += (this.mouseState.x - this.canvasRect.left)\r\n            * (this.span - newSpan) / (this.canvasRect.right - this.canvasRect.left);\r\n        this.span = newSpan;\r\n\r\n        this.updateScaleType();\r\n        return false;\r\n    }\r\n\r\n    static getDateByEpoch(epoch) {\r\n        return new Date((J2000_TIMESTAMP + epoch) * 1000);\r\n    }\r\n\r\n    static getEpochByDate(date) {\r\n        return date / 1000 - J2000_TIMESTAMP;\r\n    }\r\n\r\n    static roundDateUp(date, scaleType) {\r\n        const d = new Date(date);\r\n        if (scaleType === \"minute\") {\r\n            d.setSeconds(60, 0);\r\n        } else if (scaleType === \"fiveMinutes\") {\r\n            d.setMinutes(5 + d.getMinutes() - d.getMinutes() % 5, 0, 0);\r\n        } else if (scaleType === \"tenMinutes\") {\r\n            d.setMinutes(10 + d.getMinutes() - d.getMinutes() % 10, 0, 0);\r\n        } else if (scaleType === \"thirtyMinutes\") {\r\n            d.setMinutes(30 + d.getMinutes() - d.getMinutes() % 30, 0, 0);\r\n        } else if (scaleType === \"hour\") {\r\n            d.setMinutes(60, 0, 0);\r\n        } else if (scaleType === \"threeHours\") {\r\n            d.setHours(3 + d.getHours() - d.getHours() % 3, 0, 0, 0);\r\n        } else if (scaleType === \"sixHours\") {\r\n            d.setHours(6 + d.getHours() - d.getHours() % 6, 0, 0, 0);\r\n        } else if (scaleType === \"day\") {\r\n            d.setHours(24, 0, 0, 0);\r\n        } else if (scaleType === \"week\") {\r\n            d.setHours(0, 0, 0, 0);\r\n            d.setDate(7 + d.getDate() - d.getDay());\r\n        } else if (scaleType === \"month\") {\r\n            d.setHours(0, 0, 0, 0);\r\n            d.setDate(1);\r\n            d.setMonth(d.getMonth() + 1);\r\n        } else if (scaleType === \"threeMonths\") {\r\n            d.setHours(0, 0, 0, 0);\r\n            d.setDate(1);\r\n            d.setMonth(3 + d.getMonth() - d.getMonth() % 3);\r\n        } else if (scaleType === \"year\") {\r\n            d.setHours(0, 0, 0, 0);\r\n            d.setMonth(0, 1);\r\n        } else if (scaleType === \"fiveYears\") {\r\n            d.setHours(0, 0, 0, 0);\r\n            d.setFullYear(5 + d.getFullYear() - d.getFullYear() % 5, 0, 1);\r\n        } else {\r\n            return;\r\n        }\r\n        return d;\r\n    }\r\n\r\n    static nextRenderingDate(date, scaleType) {\r\n        const d = new Date(date);\r\n        if (scaleType === \"minute\") {\r\n            d.setMinutes(d.getMinutes() + 1);\r\n        } else if (scaleType === \"fiveMinutes\") {\r\n            d.setMinutes(d.getMinutes() + 5);\r\n        } else if (scaleType === \"tenMinutes\") {\r\n            d.setMinutes(d.getMinutes() + 10);\r\n        } else if (scaleType === \"thirtyMinutes\") {\r\n            d.setMinutes(d.getMinutes() + 30);\r\n        } else if (scaleType === \"hour\") {\r\n            d.setHours(d.getHours() + 1);\r\n        } else if (scaleType === \"threeHours\") {\r\n            d.setHours(d.getHours() + 3);\r\n        } else if (scaleType === \"sixHours\") {\r\n            d.setHours(d.getHours() + 6);\r\n        } else if (scaleType === \"day\") {\r\n            d.setDate(d.getDate() + 1);\r\n        } else if (scaleType === \"week\") {\r\n            d.setDate(d.getDate() + 7);\r\n        } else if (scaleType === \"month\") {\r\n            d.setMonth(d.getMonth() + 1);\r\n        } else if (scaleType === \"threeMonths\") {\r\n            d.setMonth(d.getMonth() + 3);\r\n        } else if (scaleType === \"year\") {\r\n            d.setFullYear(d.getFullYear() + 1, d.getMonth(), d.getDate());\r\n        } else if (scaleType === \"fiveYears\") {\r\n            d.setFullYear(d.getFullYear() + 5, d.getMonth(), d.getDate());\r\n        } else {\r\n            return;\r\n        }\r\n        return d;\r\n    }\r\n\r\n    static formatDate(date, scaleType) {\r\n        if ((scaleType === \"minute\")\r\n            || (scaleType === \"fiveMinutes\")\r\n            || (scaleType === \"tenMinutes\")\r\n            || (scaleType === \"thirtyMinutes\")\r\n            || (scaleType === \"hour\")\r\n            || (scaleType === \"threeHours\")\r\n            || (scaleType === \"sixHours\")\r\n        ) {\r\n            let string = date.getYear() + 1900;\r\n            string += '-' + ((date.getMonth() + 1) + '').padStart(2, '0');\r\n            string += '-' + (date.getDate() + '').padStart(2, '0');\r\n            string += ' ' + (date.getHours() + '').padStart(2, '0');\r\n            string += ':' + (date.getMinutes() + '').padStart(2, '0');\r\n            return string;\r\n        } else if ((scaleType === \"day\")\r\n            || (scaleType === \"week\")\r\n        ) {\r\n            let string = date.getYear() + 1900;\r\n            string += '-' + ((date.getMonth() + 1) + '').padStart(2, '0');\r\n            string += '-' + (date.getDate() + '').padStart(2, '0');\r\n            return string;\r\n        } else if ((scaleType === \"month\")\r\n            || (scaleType === \"threeMonths\")\r\n        ) {\r\n            const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\r\n            return months[date.getMonth()] + ' ' + (date.getYear() + 1900);\r\n        } else if ((scaleType === \"year\")\r\n            || (scaleType === \"fiveYears\")\r\n        ) {\r\n            return (date.getYear() + 1900) + '';\r\n        }\r\n        return date.toString();\r\n    }\r\n\r\n    static formatDateFull(date) {\r\n        let string = date.getYear() + 1900;\r\n        string += '-' + ((date.getMonth() + 1) + '').padStart(2, '0');\r\n        string += '-' + (date.getDate() + '').padStart(2, '0');\r\n        string += ' ' + (date.getHours() + '').padStart(2, '0');\r\n        string += ':' + (date.getMinutes() + '').padStart(2, '0');\r\n        string += ':' + (date.getSeconds() + '').padStart(2, '0');\r\n        return string;\r\n    }\r\n}\r\n","import * as THREE from \"three\";\r\n\r\nimport {deg2rad} from \"../algebra\";\r\nimport { sim } from \"../Simulation\";\r\n\r\nexport default class VisualRaycaster\r\n{\r\n    constructor(domElement, threeCamera, pixelPrecision) {\r\n        this.raycaster = new THREE.Raycaster();\r\n        this.mouse = new THREE.Vector2();\r\n        this.camera = threeCamera;\r\n        this.domElement = domElement;\r\n\r\n        this.setPixelPrecision(pixelPrecision);\r\n        this.updatePixelAngleSize();\r\n\r\n        this.domElement.addEventListener('mousemove', this.onMouseMove.bind(this));\r\n        this.domElement.addEventListener('resize', this.updatePixelAngleSize.bind(this));\r\n    }\r\n\r\n    onMouseMove(event) {\r\n        this.mouse.x = (event.clientX / this.domElement.width) * 2 - 1;\r\n        this.mouse.y = -(event.clientY / this.domElement.height) * 2 + 1;\r\n    }\r\n\r\n    setPixelPrecision(value) {\r\n        this.raycaster.pixelPrecision = value;\r\n    }\r\n\r\n    updatePixelAngleSize() {\r\n        this.raycaster.pixelAngleSize = deg2rad(this.camera.fov) / this.domElement.height;\r\n    }\r\n\r\n    getPixelAngleSize() {\r\n        return this.raycaster.pixelAngleSize;\r\n    }\r\n\r\n    intersectObjects(threeObjects) {\r\n        this.raycaster.setFromCamera(this.mouse, this.camera);\r\n        return this.raycaster.intersectObjects(threeObjects);\r\n    }\r\n\r\n    getPixelDistance(point) {\r\n        this.raycaster.setFromCamera(this.mouse, this.camera);\r\n\r\n        const pointDirection = (new THREE.Vector3()).subVectors(\r\n            point,\r\n            sim.camera.lastPosition\r\n        );\r\n\r\n        const angle = Math.acos(\r\n            this.raycaster.ray.direction.dot(pointDirection) / pointDirection.length()\r\n        );\r\n\r\n        return angle / this.raycaster.pixelAngleSize;\r\n    }\r\n}\r\n","import * as THREE from \"three\";\r\n\r\nimport VisualModelAbstract from \"../core/visual/ModelAbstract\";\r\nimport { sim, Events } from \"../core/index\";\r\n\r\nexport default class SelectionHandler extends VisualModelAbstract\r\n{\r\n    constructor() {\r\n        super();\r\n\r\n        this.selectableObjects = [];\r\n\r\n        this.selectedObject = null;\r\n        this.bestIntersection = null;\r\n\r\n        this.selectionMouseButton = 0;\r\n        this.pointSize = 5;\r\n\r\n        this.setThreeObj(new THREE.Mesh(\r\n            new THREE.SphereGeometry(1, 10, 10),\r\n            new THREE.MeshBasicMaterial({color: 0xFFFF00})\r\n        ));\r\n\r\n        sim.addEventListener('click', this.onMouseClick.bind(this), 1);\r\n        sim.addEventListener('mousedown', this.onMouseDown.bind(this), 1);\r\n\r\n        this.mouseMoveListener = this.onMouseMove.bind(this);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param object - must be a three.js object with its userData.selectionObject\r\n     *                 property set to object (or a function returning that object)\r\n     *                 that will be selected (and its select() method will be called)\r\n     */\r\n    addSelectableObject(object) {\r\n        this.selectableObjects.push(object);\r\n    }\r\n\r\n    removeSelectableObject(object) {\r\n        for (let i in this.selectableObjects) {\r\n            if (this.selectableObjects[i] === object) {\r\n                delete this.selectableObjects[i];\r\n                break;\r\n            }\r\n        }\r\n        this.selectableObjects = this.selectableObjects.filter(val => val);\r\n    }\r\n\r\n    render() {\r\n        const intersections = sim.raycaster.intersectObjects(this.selectableObjects);\r\n\r\n        if (intersections.length > 0) {\r\n            this.bestIntersection = intersections[0];\r\n\r\n            for(var i = 1; i < intersections.length; i++) {\r\n                if (intersections[i].distance < this.bestIntersection.distance) {\r\n                    this.bestIntersection = intersections[i];\r\n                }\r\n            }\r\n\r\n            this.threeObj.visible = true;\r\n            this.threeObj.position.copy(this.bestIntersection.point);\r\n\r\n            const scaleKoeff = this.pointSize * this.bestIntersection.point.length() * sim.raycaster.getPixelAngleSize();\r\n\r\n            this.threeObj.scale.x = scaleKoeff;\r\n            this.threeObj.scale.y = scaleKoeff;\r\n            this.threeObj.scale.z = scaleKoeff;\r\n        }\r\n        else {\r\n            this.threeObj.visible = false;\r\n            this.bestIntersection = null;\r\n        }\r\n    }\r\n\r\n    onMouseDown(event) {\r\n        if (event.button === this.selectionMouseButton) {\r\n            document.addEventListener('mousemove', this.mouseMoveListener);\r\n            this.hasMouseMoved = false;\r\n            this.mouseClickStart = [event.clientX, event.clientY];\r\n        }\r\n    }\r\n\r\n    onMouseMove(event) {\r\n        if (this.mouseClickStart[0] !== event.clientX || this.mouseClickStart[1] !== event.clientY) {\r\n            this.hasMouseMoved = true;\r\n        }\r\n    }\r\n\r\n    onMouseClick(event) {\r\n        const wasSelected = this.selectedObject;\r\n\r\n        if (event.button !== this.selectionMouseButton) {\r\n            return;\r\n        }\r\n\r\n        document.removeEventListener('mousemove', this.mouseMoveListener);\r\n\r\n        if (this.hasMouseMoved) {\r\n            return;\r\n        }\r\n\r\n        if (!this.bestIntersection) {\r\n            this.deselect();\r\n            return;\r\n        }\r\n\r\n        let selectionObject = this.bestIntersection.object.userData.selectionObject;\r\n        if (selectionObject instanceof Function) {\r\n            selectionObject = selectionObject();\r\n        }\r\n        if (selectionObject && selectionObject !== wasSelected) {\r\n            this.deselect();\r\n            this.select(selectionObject);\r\n        } else if (selectionObject && this.bestIntersection.object.userData.onClick) {\r\n            this.bestIntersection.object.userData.onClick(this.bestIntersection);\r\n        }\r\n    }\r\n\r\n    forceSelection(object) {\r\n        this.deselect();\r\n        this.select(object);\r\n    }\r\n\r\n    getSelectedObject() {\r\n        return this.selectedObject;\r\n    }\r\n\r\n    select(object) {\r\n        this.selectedObject = object;\r\n        this.selectedObject.select();\r\n\r\n        Events.dispatch(Events.SELECT, {object: this.selectedObject});\r\n    }\r\n\r\n    deselect() {\r\n        if (!this.selectedObject) {\r\n            return;\r\n        }\r\n\r\n        Events.dispatch(Events.DESELECT, {object: this.selectedObject});\r\n\r\n        this.selectedObject.deselect();\r\n        this.selectedObject = null;\r\n    }\r\n}\r\n","import $ from \"jquery\";\r\n\r\nexport default class UIPanel\r\n{\r\n    constructor(panelDom, isCollapsed) {\r\n        this.jqDom = $(panelDom);\r\n        this.name = this.jqDom.data('panelName');\r\n        this.jqCollapseButton = this.jqDom.find(\".collapseButton[data-panel-name='\" + this.name + \"']\");\r\n        this.jqCollapseButton.click(() => this.toggleCollapse());\r\n        this.isCollapsed = !!isCollapsed;\r\n\r\n        this.isCollapsed ? this.collapse() : this.expand();\r\n    }\r\n\r\n    show() {\r\n        this.jqDom.show();\r\n    }\r\n\r\n    hide() {\r\n        this.jqDom.hide();\r\n    }\r\n\r\n    toggleCollapse() {\r\n        this.isCollapsed ? this.expand() : this.collapse();\r\n    }\r\n\r\n    collapse() {\r\n        this.jqCollapseButton.html('Show');\r\n        this.isCollapsed = true;\r\n        this.jqDom.find(\".panelContent[data-panel-name='\" + this.name + \"']\").hide();\r\n\r\n        // this.jqCollapseButton.attr('disabled', 'true');\r\n        // this.jqDom.find(\".panelContent[data-panel-name='\" + this.name + \"']\").fadeToggle(200, 'swing', () => {\r\n        //     this.jqCollapseButton.removeAttr('disabled');\r\n        // });\r\n    }\r\n\r\n    expand() {\r\n        this.jqCollapseButton.html('Hide');\r\n        this.isCollapsed = false;\r\n        this.jqDom.find(\".panelContent[data-panel-name='\" + this.name + \"']\").show();\r\n\r\n        // this.jqCollapseButton.attr('disabled', 'true');\r\n        // this.jqDom.find(\".panelContent[data-panel-name='\" + this.name + \"']\").fadeToggle(200, 'swing', () => {\r\n        //     this.jqCollapseButton.removeAttr('disabled');\r\n        // });\r\n    }\r\n}\r\n","import Events from \"../../core/Events\";\r\nimport UIPanel from \"../Panel\";\r\nimport { sim } from \"../../core/Simulation\"\r\n\r\nexport default class UIPanelTime extends UIPanel\r\n{\r\n    constructor(panelDom) {\r\n        super(panelDom);\r\n\r\n        this.maxTimeScale = 6 * 30 * 86400;\r\n\r\n        this.jqSlider = this.jqDom.find('#timeScaleSlider');\r\n        this.jqSlider.on('input change', () => sim.time.setTimeScale(this.getCurrentTimeScale()));\r\n        this.jqSlider.val(this.getNeededSliderValue(sim.time.timeScale));\r\n\r\n        this.jqScaleText = this.jqDom.find('#timeScaleValue');\r\n        this.jqScaleText.html(this.formatTimeScale(sim.time.timeScale));\r\n\r\n        document.addEventListener(Events.TIME_SCALE_CHANGED, (event) => {\r\n            this.jqSlider.val(this.getNeededSliderValue(event.detail.new));\r\n            this.jqScaleText.html(this.formatTimeScale(event.detail.new));\r\n        });\r\n\r\n        this.jqDateText = this.jqDom.find('#currentDateValue');\r\n        document.addEventListener(Events.EPOCH_CHANGED, (event) => this.updateTime(event.detail.date));\r\n\r\n        this.jqDom.find('#setRealTimeScale').click(() => sim.time.setTimeScale(1));\r\n        this.jqDom.find('#useCurrentTime').click(() => sim.time.useCurrentTime());\r\n    }\r\n\r\n    updateTime(date) {\r\n        this.jqDateText.html(sim.time.formatDateFull(date));\r\n    }\r\n\r\n    /**\r\n     * @returns {number} — simulation seconds per 1 real life second\r\n     */\r\n    getCurrentTimeScale() {\r\n        const val = this.jqSlider.val();\r\n        return Math.sign(val) * val * val * val * val * this.maxTimeScale;\r\n    }\r\n\r\n    getNeededSliderValue(timeScale) {\r\n        const val = Math.sqrt(Math.sqrt(Math.abs(timeScale) / this.maxTimeScale));\r\n        return Math.sign(timeScale) * Math.min(1, val);\r\n    }\r\n\r\n    formatTimeScale(scale) {\r\n        const precision = 2;\r\n\r\n        const prefix = (scale < 0) ? '-' : '';\r\n        const abs = Math.abs(scale);\r\n        if (abs === 0) {\r\n            return '0';\r\n        }\r\n\r\n        if (abs < 60) {\r\n            return prefix + abs.toPrecision(precision) + ' s/s';\r\n        }\r\n\r\n        if (abs < 3600) {\r\n            return prefix + (abs / 60).toPrecision(precision) + ' min/s';\r\n        }\r\n\r\n        if (abs < 86400) {\r\n            return prefix + (abs / 3600).toPrecision(precision) + ' h/s';\r\n        }\r\n\r\n        if (abs < 2592000) {\r\n            return prefix + (abs / 86400).toPrecision(precision) + ' days/s';\r\n        }\r\n\r\n        if (abs < 31557600) {\r\n            return prefix + (abs / 2592000).toPrecision(precision) + ' months/s';\r\n        }\r\n\r\n        return prefix + (abs / 31557600).toPrecision(precision) + ' years/s';\r\n    }\r\n}\r\n","import $ from \"jquery\";\r\n\r\nimport Events from \"../../core/Events\";\r\nimport UIPanel from \"../Panel\";\r\nimport {ReferenceFrame} from \"../../core/ReferenceFrame/Factory\";\r\n\r\nexport default class UIPanelCamera extends UIPanel\r\n{\r\n    constructor(panelDom, camera) {\r\n        super(panelDom);\r\n\r\n        this.camera = camera;\r\n\r\n        this.jqTarget = this.jqDom.find('#targetSelect');\r\n        this.jqTarget.on('change', () => this.camera.changeOrigin(0|this.jqTarget.val()));\r\n\r\n        this.jqFrameType = this.jqDom.find('#rfTypeSelect');\r\n        this.jqFrameType.on('change', () => this.camera.changeReferenceFrameType(0|this.jqFrameType.val()));\r\n\r\n        Events.addListener(Events.STAR_SYSTEM_LOADED, (event) => {\r\n            this.starSystem = event.detail.starSystem;\r\n\r\n            this.jqTarget.html('');\r\n            this.updateTargetList();\r\n            this.updateTarget(this.camera.orbitingPoint);\r\n\r\n            this.updateFrameTypeList();\r\n            this.updateFrameType(this.camera.frameType);\r\n        });\r\n        Events.addListener(Events.CAMERA_RF_CHANGED, (event) => {\r\n            this.updateTarget(event.detail.new.originId);\r\n            this.updateFrameTypeList();\r\n            this.updateFrameType(event.detail.new.type);\r\n        });\r\n        Events.addListener(Events.OBJECT_ADDED, () => {\r\n            this.updateTargetList();\r\n        });\r\n    }\r\n\r\n    updateTargetList() {\r\n        if (!this.starSystem) {\r\n            return;\r\n        }\r\n        $.each(this.starSystem.getObjectNames(), (objId, objName) => {\r\n            if (this.jqTarget.find(\"option[value='\" + objId + \"']\").length === 0) {\r\n                this.jqTarget.append($('<option>', {value: objId}).text(objName));\r\n            }\r\n        });\r\n    }\r\n\r\n    updateFrameTypeList() {\r\n        const selected = 0|this.jqFrameType.val();\r\n        this.jqFrameType.html('');\r\n        $.each(this.camera.getAvailableFrameTypes(), (idx, typeId) => {\r\n            this.jqFrameType.append($('<option>', {value: typeId, selected: typeId == selected}).text(UIPanelCamera.frameTypeNames[typeId]));\r\n        });\r\n    }\r\n\r\n    updateTarget(value) {\r\n        this.jqTarget.val(value);\r\n    }\r\n\r\n    updateFrameType(value) {\r\n        this.jqFrameType.val(value);\r\n    }\r\n}\r\n\r\nUIPanelCamera.frameTypeNames = {\r\n    [ReferenceFrame.INERTIAL_ECLIPTIC]: 'Ecliptic',\r\n    [ReferenceFrame.INERTIAL_BODY_EQUATORIAL]: 'Equatorial',\r\n    [ReferenceFrame.INERTIAL_BODY_FIXED]: 'Body fixed',\r\n    [ReferenceFrame.INERTIAL_PARENT_BODY_EQUATORIAL]: 'Parent equatorial',\r\n};\r\n","\r\nimport UIPanel from \"../Panel\";\r\nimport {presentNumberWithSuffix, Vector} from \"../../core/algebra\";\r\nimport FunctionOfEpochAbstract from \"../../core/FunctionOfEpoch/Abstract\";\r\n\r\nexport default class UIPanelVector extends UIPanel\r\n{\r\n    constructor(panelDom, vectorOfEpoch) {\r\n        super(panelDom, true);\r\n        this.vectorOfEpoch = vectorOfEpoch;\r\n        this.jqMag = this.jqDom.find('.vec-magnitude');\r\n        this.jqX = this.jqDom.find('.vec-x');\r\n        this.jqY = this.jqDom.find('.vec-y');\r\n        this.jqZ = this.jqDom.find('.vec-z');\r\n    }\r\n\r\n    set(vector, epoch) {\r\n        this.vectorOfEpoch = vector;\r\n        this.update(epoch);\r\n    }\r\n\r\n    update(epoch) {\r\n        let vector = this.vectorOfEpoch;\r\n        if ((epoch || epoch === 0)\r\n            && (vector instanceof FunctionOfEpochAbstract)\r\n        ) {\r\n            vector = vector.evaluate(epoch);\r\n        }\r\n\r\n        if (!vector instanceof Vector) {\r\n            return;\r\n        }\r\n\r\n        this.jqMag.html(presentNumberWithSuffix(vector.mag));\r\n        this.jqX.html  (presentNumberWithSuffix(vector.x));\r\n        this.jqY.html  (presentNumberWithSuffix(vector.y));\r\n        this.jqZ.html  (presentNumberWithSuffix(vector.z));\r\n    }\r\n}\r\n","import $ from \"jquery\";\r\n\r\nimport UIPanel from \"../Panel\";\r\nimport Events from \"../../core/Events\";\r\nimport UIPanelVector from \"./Vector\";\r\nimport {presentNumberWithSuffix, rad2deg} from \"../../core/algebra\";\r\nimport EphemerisObject from \"../../core/EphemerisObject\";\r\nimport { sim } from \"../../core/Simulation\";\r\n\r\nexport default class UIPanelMetrics extends UIPanel\r\n{\r\n    constructor(panelDom, selection) {\r\n        super(panelDom);\r\n\r\n        this.selection = selection;\r\n        this.precision = 5;\r\n\r\n        this.renderListener = this.render.bind(this);\r\n\r\n        document.addEventListener(Events.SELECT, this.handleSelect.bind(this));\r\n        document.addEventListener(Events.DESELECT, this.handleDeselect.bind(this));\r\n\r\n        this.jqDom.find('#unloadObject').on('click', function() {\r\n            let wasSelected = selection.getSelectedObject();\r\n            selection.deselect();\r\n            sim.starSystem.deleteObject(wasSelected.id);\r\n        });\r\n        this.jqDom.find('#showAnglesOfSelectedOrbit').on('change', function() {\r\n            sim.settings.ui.showAnglesOfSelectedOrbit = this.checked;\r\n            Events.dispatch(Events.SHOW_ORBIT_ANGLES_CHANGED, {value: this.checked});\r\n        });\r\n\r\n        this.positionPanel = new UIPanelVector(this.jqDom.find(\".js-metrics-panel-cartesian-position-vector\"), null);\r\n        this.velocityPanel = new UIPanelVector(this.jqDom.find(\".js-metrics-panel-cartesian-velocity-vector\"), null);\r\n\r\n        this.hide();\r\n    }\r\n\r\n    render(event) {\r\n        const selectedTrajectory = this.selection.getSelectedObject().trajectory;\r\n        let parent = null;\r\n        if (!selectedTrajectory) {\r\n            return;\r\n        }\r\n\r\n        try {\r\n            const referenceFrame = selectedTrajectory.getReferenceFrameByEpoch(event.detail.epoch);\r\n            if (referenceFrame) {\r\n                parent = sim.starSystem.getObject(referenceFrame.originId);\r\n                this.jqDom.find('#relativeTo').html(parent.name);\r\n            }\r\n\r\n            this.updateMain(selectedTrajectory, event.detail.epoch, parent);\r\n            this.updateCartesian(selectedTrajectory, event.detail.epoch);\r\n            this.updateKeplerian(selectedTrajectory, event.detail.epoch);\r\n        } catch (e) {\r\n\r\n        }\r\n    }\r\n\r\n    updateMain(selectedObject, epoch, parent) {\r\n        const keplerianObject = selectedObject.getKeplerianObjectByEpoch(epoch);\r\n        const sma = keplerianObject.sma;\r\n        const per = sma * (1 - keplerianObject.ecc);\r\n        const apo = sma * (1 + keplerianObject.ecc);\r\n        const surfaceAlt = parent.physicalModel ? parent.physicalModel.radius : 0;\r\n        const state = selectedObject.getStateInOwnFrameByEpoch(epoch);\r\n\r\n        this.jqDom.find('#elements-orbit-alt' ).html(\r\n            '' + (per - surfaceAlt).toPrecision(this.precision)\r\n            + ' x ' + (apo - surfaceAlt).toPrecision(this.precision)\r\n        );\r\n\r\n        this.jqDom.find('#elements-orbit-avg' ).html(''   + (sma - surfaceAlt).toPrecision(this.precision));\r\n        this.jqDom.find('#elements-alt' ).html(''   + (state.position.mag - surfaceAlt).toPrecision(this.precision));\r\n        this.jqDom.find('#elements-speed' ).html('' + (state.velocity.mag * 1000).toPrecision(this.precision));\r\n\r\n        if (parent.physicalModel && parent.physicalModel.j2 && parent.physicalModel.j2) {\r\n            this.jqDom.find('#elements-precession').html('' + (\r\n                rad2deg(keplerianObject.getNodalPrecessionRate(parent.physicalModel.eqRadius, parent.physicalModel.j2) * 86400)\r\n            ).toPrecision(this.precision));\r\n        }\r\n    }\r\n\r\n    updateCartesian(selectedObject, epoch) {\r\n        const state = selectedObject.getStateInOwnFrameByEpoch(epoch);\r\n        this.positionPanel.set(state.position);\r\n        this.velocityPanel.set(state.velocity);\r\n    }\r\n\r\n    updateKeplerian(selectedObject, epoch) {\r\n        const keplerianObject = selectedObject.getKeplerianObjectByEpoch(epoch);\r\n        this.jqDom.find('#elements-ecc' ).html('' +        ( keplerianObject.ecc ).toPrecision(this.precision));\r\n        this.jqDom.find('#elements-sma' ).html('' + presentNumberWithSuffix(keplerianObject.sma));\r\n        this.jqDom.find('#elements-inc' ).html('' + rad2deg( keplerianObject.inc ).toPrecision(this.precision));\r\n        this.jqDom.find('#elements-aop' ).html('' + rad2deg( keplerianObject.aop ).toPrecision(this.precision));\r\n        this.jqDom.find('#elements-raan').html('' + rad2deg( keplerianObject.raan).toPrecision(this.precision));\r\n        this.jqDom.find('#elements-ta'  ).html('' + rad2deg( keplerianObject.getTrueAnomalyByEpoch(epoch)  ).toPrecision(this.precision));\r\n        this.jqDom.find('#elements-period').html('' + (keplerianObject.period / 86400).toPrecision(this.precision));\r\n    }\r\n\r\n    handleSelect() {\r\n        this.show();\r\n\r\n        const object = this.selection.getSelectedObject();\r\n        if (object) {\r\n            $('#metricsOf').html(object.name);\r\n        } else {\r\n            $('#relativeTo,#metricsOf').html('');\r\n        }\r\n\r\n        if (object.type === EphemerisObject.TYPE_SPACECRAFT || object.type === EphemerisObject.TYPE_UNKNOWN) {\r\n            this.jqDom.find('#unloadObject').show();\r\n        } else {\r\n            this.jqDom.find('#unloadObject').hide();\r\n        }\r\n\r\n        document.addEventListener(Events.RENDER, this.renderListener);\r\n    }\r\n\r\n    handleDeselect() {\r\n        this.hide();\r\n        document.removeEventListener(Events.RENDER, this.renderListener);\r\n    }\r\n}\r\n","import {acosSigned, Vector, Quaternion, newtonSolve} from \"./algebra\";\r\nimport KeplerianObject from \"./KeplerianObject\";\r\nimport EphemerisObject from \"./EphemerisObject\";\r\nimport ReferenceFrameFactory, {ReferenceFrame} from \"./ReferenceFrame/Factory\";\r\nimport Body from \"./Body\";\r\nimport StateVector from \"./StateVector\";\r\nimport TrajectoryComposite from \"./Trajectory/Composite\";\r\nimport TrajectoryKeplerianBasic from \"./Trajectory/KeplerianBasic\";\r\nimport { sim } from \"./Simulation\";\r\n\r\nexport default class LambertSolver\r\n{\r\n    static getPlotData(orbit1, orbit2, epochMin, epochMax, transferMin, transferMax, points) {\r\n        const epochStep = (epochMax - epochMin) / (points - 1);\r\n        const flightTimeStep = (transferMax - transferMin) / (points - 1);\r\n        let result = [];\r\n        let startEpoch = epochMin;\r\n        let i = 0;\r\n\r\n        while (startEpoch <= epochMax) {\r\n            let flightTime = transferMin;\r\n            let j = 0;\r\n\r\n            result[i] = [];\r\n            while (flightTime <= transferMax) {\r\n                let res = this.calcDeltaV(\r\n                    orbit1.getStateByEpoch(startEpoch),\r\n                    orbit2.getStateByEpoch(startEpoch + flightTime),\r\n                    startEpoch,\r\n                    flightTime,\r\n                    orbit1.mu\r\n                );\r\n                result[i][j] = res;\r\n                flightTime += flightTimeStep;\r\n                j++;\r\n\r\n            }\r\n            startEpoch += epochStep;\r\n            i++;\r\n        }\r\n        return result;\r\n    }\r\n\r\n    static plot(plotData) {\r\n        let min = 1e99, max = 0;\r\n        let ctx = document.getElementById('lambertCanvas').getContext('2d');\r\n\r\n        ctx.clearRect(0, 0, 300, 300);\r\n\r\n        for (let row of plotData) {\r\n            for (let res of row) {\r\n                if (res === false) {\r\n                    continue;\r\n                }\r\n                if (res < min) {\r\n                    min = res;\r\n                }\r\n                if (res > max) {\r\n                    max = res;\r\n                }\r\n            }\r\n        }\r\n\r\n        for (let row in plotData) {\r\n            for (let col in plotData[row]) {\r\n                const res = plotData[row][col];\r\n                if (res === false) {\r\n                    ctx.fillStyle = \"rgba(255,0,0,1)\";\r\n                } else {\r\n                    const color = Math.round((1 - (res - min) / (max - min)) * 255);\r\n                    ctx.fillStyle = \"rgba(\" + color + \",\" + color + \",\" + color + \", 1)\";\r\n                }\r\n                ctx.fillRect(0|row, 0|col, 1, 1);\r\n            }\r\n        }\r\n    }\r\n\r\n    static getDeltaV(state1, state2, transferOrbit, epoch1, epoch2) {\r\n        return state1.velocity.sub_(transferOrbit.getStateByEpoch(epoch1)._velocity).mag +\r\n            state2.velocity.sub_(transferOrbit.getStateByEpoch(epoch2)._velocity).mag;\r\n    }\r\n\r\n    static calcDeltaV(state1, state2, startEpoch, flightTime, mu) {\r\n        const transferOrbit = this.solve(state1, state2, startEpoch, flightTime, mu);\r\n\r\n        if (!transferOrbit) {\r\n            return false;\r\n        }\r\n\r\n        return this.getDeltaV(state1, state2, transferOrbit, startEpoch, startEpoch + flightTime);\r\n    }\r\n\r\n    static findBestTransfer(originObject, targetObject, rPer1, rPer2, departureTime, flightTimeMin, flightTimeMax) {\r\n        const d = (flightTimeMax - flightTimeMin) * 1e-6;\r\n        const getDiff = (flightTime) => {\r\n            if (flightTime < flightTimeMin) {\r\n                return null;\r\n            }\r\n            if (flightTime > flightTimeMax) {\r\n                return null;\r\n            }\r\n            const v1 = this.solveFullTransfer(originObject, targetObject, rPer1, rPer2, departureTime, flightTime - d/2);\r\n            const v2 = this.solveFullTransfer(originObject, targetObject, rPer1, rPer2, departureTime, flightTime + d/2);\r\n\r\n            if (v1 === null || v2 === null) {\r\n                return null;\r\n            }\r\n\r\n            return (v2.totalDeltaV - v1.totalDeltaV) / d;\r\n        };\r\n\r\n        const stepCount = 50;\r\n        const step = (flightTimeMax - flightTimeMin) / (stepCount - 1);\r\n\r\n        let minDeltaV = 1e100;\r\n        let bestFlightTime;\r\n\r\n        for (let flightTime = flightTimeMin; flightTime <= flightTimeMax; flightTime += step) {\r\n            const transfer = this.solveFullTransfer(originObject, targetObject, rPer1, rPer2, departureTime, flightTime);\r\n            if (transfer === null) {\r\n                continue;\r\n            }\r\n            const deltaV = transfer.totalDeltaV;\r\n            // console.log(flightTime, deltaV);\r\n            if (deltaV < minDeltaV) {\r\n                bestFlightTime = flightTime;\r\n                minDeltaV = deltaV;\r\n            }\r\n        }\r\n\r\n        bestFlightTime = newtonSolve(getDiff, bestFlightTime, step * 1e-3, 1e-6, 10);\r\n\r\n        if (bestFlightTime === null) {\r\n            return {totalDeltaV: null};\r\n        }\r\n\r\n        return this.solveFullTransfer(originObject, targetObject, rPer1, rPer2, departureTime, bestFlightTime);\r\n    }\r\n\r\n    static solveFullTransfer(originObject, targetObject, rPer1, rPer2, departureTime, flightTime) {\r\n        if (flightTime <= 0) {\r\n            return null;\r\n        }\r\n\r\n        const parentObject = sim.getModule('PatchedConics').getCommonParent(originObject.id, targetObject.id);\r\n\r\n        if (!(parentObject instanceof Body)) {\r\n            return null;\r\n        }\r\n\r\n        const rfMainId = ReferenceFrameFactory.buildId(\r\n            parentObject.id,\r\n            (parentObject.type === EphemerisObject.TYPE_STAR)\r\n                ? ReferenceFrame.INERTIAL_ECLIPTIC\r\n                : ReferenceFrame.INERTIAL_BODY_EQUATORIAL\r\n        );\r\n        const rfMain = sim.starSystem.getReferenceFrame(rfMainId);\r\n\r\n        const mu = parentObject.physicalModel.mu;\r\n\r\n        let state1;\r\n        let state2;\r\n\r\n        let calcOriginSoi = originObject instanceof Body;\r\n        let calcTargetSoi = targetObject instanceof Body;\r\n\r\n        let rfOrigin;\r\n        let rfTarget;\r\n        let originSoi;\r\n        let targetSoi;\r\n\r\n        if (calcOriginSoi) {\r\n            rfOrigin = sim.starSystem.getReferenceFrame(ReferenceFrameFactory.buildId(originObject.id, ReferenceFrame.INERTIAL_BODY_EQUATORIAL));\r\n            originSoi = originObject.data.patchedConics.soiRadius;\r\n        }\r\n        if (calcTargetSoi) {\r\n            targetSoi = targetObject.data.patchedConics.soiRadius;\r\n            rfTarget = sim.starSystem.getReferenceFrame(ReferenceFrameFactory.buildId(targetObject.id, ReferenceFrame.INERTIAL_BODY_EQUATORIAL));\r\n        }\r\n\r\n        let ejectionTime = 0;\r\n        let insertionTime = 0;\r\n        let ejectionPosShift = new Vector(3);\r\n        let insertionPosShift = new Vector(3);\r\n        let ejectionVelInf;\r\n        let insertionVelInf;\r\n        let steps = 0;\r\n        let transferKO;\r\n        let ejectionSoiEpoch;\r\n        let insertionSoiEpoch;\r\n\r\n        while (true) {\r\n            ejectionSoiEpoch = departureTime + ejectionTime;\r\n            insertionSoiEpoch = departureTime + flightTime - insertionTime;\r\n\r\n            state1 = originObject.trajectory.getStateByEpoch(ejectionSoiEpoch, rfMain);\r\n            if (calcOriginSoi) {\r\n                state1._position = rfOrigin.transformPositionByEpoch(ejectionSoiEpoch, ejectionPosShift, rfMain);\r\n            }\r\n\r\n            state2 = targetObject.trajectory.getStateByEpoch(insertionSoiEpoch, rfMain);\r\n            if (calcTargetSoi) {\r\n                state2._position = rfTarget.transformPositionByEpoch(insertionSoiEpoch, insertionPosShift, rfMain);\r\n            }\r\n\r\n            transferKO = this.solve(state1, state2, ejectionSoiEpoch, insertionSoiEpoch - ejectionSoiEpoch, mu);\r\n            if (transferKO === null) {\r\n                return null;\r\n            }\r\n\r\n            steps++;\r\n\r\n            let ejectionPosTime = [new Vector(3), 0];\r\n            let insertionPosTime = [new Vector(3), 0];\r\n\r\n            if (calcOriginSoi) {\r\n                ejectionVelInf = transferKO.getStateByEpoch(ejectionSoiEpoch)._velocity.sub_(state1._velocity);\r\n                const ejectionNormal  = state1._position.cross(ejectionVelInf);\r\n                ejectionPosTime = this.getSoiEdgePositionAndTime(\r\n                    rfMain.rotateVectorByEpoch(ejectionSoiEpoch, ejectionVelInf, rfOrigin),\r\n                    rfMain.rotateVectorByEpoch(ejectionSoiEpoch, ejectionNormal, rfOrigin),\r\n                    rPer1,\r\n                    originSoi,\r\n                    originObject.physicalModel.mu,\r\n                    1\r\n                );\r\n                ejectionTime = ejectionPosTime[1];\r\n            }\r\n\r\n            if (calcTargetSoi) {\r\n                insertionVelInf = transferKO.getStateByEpoch(insertionSoiEpoch)._velocity.sub_(state2._velocity);\r\n                const insertionNormal = state2._position.cross(insertionVelInf);\r\n                insertionPosTime = this.getSoiEdgePositionAndTime(\r\n                    rfMain.rotateVectorByEpoch(insertionSoiEpoch, insertionVelInf, rfTarget),\r\n                    rfMain.rotateVectorByEpoch(insertionSoiEpoch, insertionNormal, rfTarget),\r\n                    rPer2,\r\n                    targetSoi,\r\n                    targetObject.physicalModel.mu,\r\n                    -1\r\n                );\r\n                insertionTime = insertionPosTime[1];\r\n            }\r\n\r\n            if (steps > 10\r\n                || (\r\n                    (!calcOriginSoi || ejectionPosShift.sub(ejectionPosTime[0]).mag < 10)\r\n                    && (!calcTargetSoi || insertionPosShift.sub(insertionPosTime[0]).mag < 10)\r\n                )\r\n            ) {\r\n                ejectionPosShift = ejectionPosTime[0];\r\n                insertionPosShift = insertionPosTime[0];\r\n                break;\r\n            }\r\n\r\n            ejectionPosShift = ejectionPosTime[0];\r\n            insertionPosShift = insertionPosTime[0];\r\n        }\r\n\r\n        let ejectionDeltaV = 0;\r\n        let insertionDeltaV = 0;\r\n        let trajectory = new TrajectoryComposite();\r\n\r\n        const transfer = new TrajectoryKeplerianBasic(rfMainId, transferKO);\r\n        transfer.minEpoch = departureTime + ejectionTime;\r\n        transfer.maxEpoch = departureTime + flightTime - insertionTime;\r\n        trajectory.addComponent(transfer);\r\n\r\n        if (calcOriginSoi) {\r\n            const ejectionKO = KeplerianObject.createFromState(\r\n                new StateVector(ejectionPosShift, rfMain.rotateVectorByEpoch(ejectionSoiEpoch, ejectionVelInf, rfOrigin)),\r\n                originObject.physicalModel.mu,\r\n                departureTime + ejectionTime\r\n            );\r\n            ejectionDeltaV = ejectionKO.getPeriapsisSpeed() - Math.sqrt(originObject.physicalModel.mu / ejectionKO.getPeriapsisRadius());\r\n            const ejection = new TrajectoryKeplerianBasic(rfOrigin.id, ejectionKO);\r\n            ejection.minEpoch = departureTime;\r\n            ejection.maxEpoch = departureTime + ejectionTime;\r\n            trajectory.addComponent(ejection);\r\n        } else {\r\n            ejectionDeltaV = state1.velocity.sub(transferKO.getStateByEpoch(departureTime)._velocity).mag;\r\n        }\r\n\r\n        if (calcTargetSoi) {\r\n            const insertionKO = KeplerianObject.createFromState(\r\n                new StateVector(insertionPosShift, rfMain.rotateVectorByEpoch(insertionSoiEpoch, insertionVelInf, rfTarget)),\r\n                targetObject.physicalModel.mu,\r\n                departureTime + flightTime - insertionTime\r\n            );\r\n            insertionDeltaV = insertionKO.getPeriapsisSpeed() - Math.sqrt(targetObject.physicalModel.mu / insertionKO.getPeriapsisRadius());\r\n            const insertion = new TrajectoryKeplerianBasic(rfTarget.id, insertionKO);\r\n            insertion.minEpoch = departureTime + flightTime - insertionTime;\r\n            insertion.maxEpoch = departureTime + flightTime;\r\n            trajectory.addComponent(insertion);\r\n        } else {\r\n            insertionDeltaV = state2.velocity.sub(transferKO.getStateByEpoch(departureTime + flightTime)._velocity).mag;\r\n        }\r\n\r\n        return {\r\n            trajectory: trajectory,\r\n            ejectionDeltaV: ejectionDeltaV,\r\n            insertionDeltaV: insertionDeltaV,\r\n            totalDeltaV: ejectionDeltaV + insertionDeltaV,\r\n        };\r\n    }\r\n\r\n    static getSoiEdgePositionAndTime(velInf, normal, rPer, rInf, mu, direction) {\r\n        const sma = 1 / (2 / rInf - velInf.quadrance / mu);\r\n        const ecc = 1 - rPer / sma;\r\n        const trueAnomaly = direction * Math.acos((sma * (1 - ecc*ecc) / rInf - 1) / ecc);\r\n        const flightPathAngle = Math.atan(ecc * Math.sin(trueAnomaly) / (sma * (1 - ecc*ecc) / rInf));\r\n        const position = (new Quaternion(normal, flightPathAngle - Math.PI / 2)).rotate_(velInf.unit().mul_(rInf));\r\n\r\n        const H = this.getEccentricAnomalyByTrueAnomaly(trueAnomaly, ecc);\r\n        const time = (ecc > 1)\r\n            ? (ecc * Math.sinh(H) - H) / Math.sqrt(mu / sma / sma / Math.abs(sma))\r\n            : (H - ecc * Math.sin(H)) / Math.sqrt(mu / sma / sma / sma);\r\n\r\n        return [position, Math.abs(time)];\r\n    }\r\n\r\n    static solve(state1, state2, startEpoch, flightTime, mu) {\r\n        const maxError = 1;\r\n        const maxSteps = 30;\r\n\r\n        const r1vec = state1.position;\r\n        const r2vec = state2.position;\r\n        let normal = r1vec.cross(r2vec);\r\n        const r1 = r1vec.mag;\r\n        const r2 = r2vec.mag;\r\n        let transferAngle = r1vec.angle(r2vec);\r\n\r\n        if (normal.angle(state1._position.cross(state1._velocity)) > Math.PI / 2) {\r\n            transferAngle = 2 * Math.PI - transferAngle;\r\n            normal.mul_(-1);\r\n        }\r\n\r\n        const signSinTransferAngle = Math.sign(Math.sin(transferAngle));\r\n        const inc = normal.angle(new Vector([0, 0, 1]));\r\n        const nodeVector = (new Vector([0, 0, 1])).cross(normal);\r\n\r\n        let e, sma, ta1;\r\n        let raan = nodeVector.angle(new Vector([1, 0, 0]));\r\n        if ((new Vector([1, 0, 0])).cross(nodeVector).angle(new Vector([0, 0, 1])) > Math.PI / 2) {\r\n            raan = 2 * Math.PI - raan;\r\n        }\r\n\r\n        const d = Math.sqrt(r1*r1 + r2*r2 - 2 * r1vec.dot(r2vec)) / 2;\r\n\r\n        const parabolicTime = (Math.pow(r1+r2+2*d, 3/2) - signSinTransferAngle*Math.pow(r1+r2-2*d, 3/2)) / (6 * Math.sqrt(mu));\r\n\r\n        if (flightTime > parabolicTime) {\r\n            // ellipse\r\n            const A = (r2 - r1) / 2;\r\n            const E = d / A;\r\n            const B = Math.sqrt(d*d - A*A);\r\n            let y = newtonSolve(\r\n                (yParam) => this.getTimeByY(yParam, A, B, E, r1, r2, d, transferAngle, mu) - flightTime,\r\n                10000, 1, maxError, maxSteps\r\n            );\r\n\r\n            if (y === null) {\r\n                return null;\r\n            }\r\n\r\n            const x0 = -(r2 + r1) / 2 / E;\r\n            const y0 = B * Math.sqrt(x0 * x0 / A / A - 1);\r\n            const x = A * Math.sqrt(1 + y * y / B / B);\r\n            const temp = Math.sqrt((x0 - x) * (x0 - x) + (y0 - y) * (y0 - y));\r\n            const fx = (x0 - x) / temp;\r\n            const fy = (y0 - y) / temp;\r\n            ta1 = acosSigned(\r\n                -((x0 + d) * fx + y0 * fy) / r1,\r\n                signSinTransferAngle * ((x0 + d) * fy - y0 * fx)\r\n            );\r\n            sma = E * (x - x0) / 2;\r\n            e = temp / 2 / sma;\r\n\r\n        } else {\r\n            // hyperbola\r\n            sma = newtonSolve(\r\n                (a) => {\r\n                    const alpha = Math.acosh(1 + (r1 + r2 + 2 * d) / 2 / Math.abs(a));\r\n                    const beta  = Math.acosh(1 + (r1 + r2 - 2 * d) / 2 / Math.abs(a));\r\n                    return Math.sqrt(Math.abs(Math.pow(a, 3)) / mu) *\r\n                        (Math.sinh(alpha) - alpha - signSinTransferAngle * (Math.sinh(beta) - beta)) - flightTime;\r\n                },\r\n                r1, 10, maxError, maxSteps\r\n            );\r\n\r\n            if (sma === null) {\r\n                return null;\r\n            }\r\n\r\n            if (sma > 0) {\r\n                sma = -sma;\r\n            }\r\n\r\n            let f1 = r1vec.rotate(nodeVector, -inc).mul_(-1);\r\n            let p2 = r2vec.rotate(nodeVector, -inc).add_(f1);\r\n            const d1 = r1 - 2 * sma;\r\n            const d2 = r2 - 2 * sma;\r\n            const tempAng = -Math.sign(p2.y) * p2.angle(new Vector([1,0,0]));\r\n            f1 = f1.rotateZ(tempAng);\r\n            p2 = p2.rotateZ(tempAng);\r\n\r\n            const f2x = (p2.x*p2.x - d2*d2 + d1*d1) / 2 / p2.x;\r\n            let f2y = Math.sqrt(d1*d1 - f2x*f2x);\r\n\r\n            if (transferAngle > Math.PI ? (f1.y < 0) : (f1.y > 0)) {\r\n                f2y = -f2y;\r\n            }\r\n\r\n            e = -f1.sub_(new Vector([f2x, f2y, 0])).mag / 2 / sma;\r\n\r\n            const p = sma * (1 - e*e);\r\n            ta1 = Math.acos((p / r1 - 1) / e);\r\n            const ta2 = Math.acos((p / r2 - 1) / e);\r\n\r\n            if (ta1 > ta2 || ta2 - transferAngle < 0) {\r\n                ta1 = -ta1;\r\n            }\r\n        }\r\n\r\n        const perVector = (new Quaternion(normal, -ta1)).rotate(r1vec);\r\n        let aop = nodeVector.angle(perVector);\r\n\r\n        if (nodeVector.cross(perVector).angle(normal) > Math.PI / 2) {\r\n            aop = 2 * Math.PI - aop;\r\n        }\r\n\r\n        return new KeplerianObject(e, sma, aop, inc, raan, ta1, startEpoch, mu, true);\r\n    }\r\n\r\n    static getTimeByY(y, A, B, E, r1, r2, d, alpha, mu) {\r\n        const rm = (r2 + r1) / 2;\r\n        const x0 = - rm / E;\r\n        const y0 = B * Math.sqrt(x0*x0/A/A - 1);\r\n        const x = A * Math.sqrt(1 + y*y/B/B);\r\n        const a = (rm + E * x) / 2;\r\n        const temp = Math.sqrt((x0 - x)*(x0 - x) + (y0 - y)*(y0 - y));\r\n        const e = temp / 2 / a;\r\n        const fx = (x0 - x) / temp;\r\n        const fy = (y0 - y) / temp;\r\n        const cosTa1 = -((x0 + d) * fx + y0 * fy) / r1;\r\n        const sinTa1 = Math.sign(Math.sin(alpha)) * ((x0 + d) * fy - y0 * fx); // TODO optimize\r\n        const ta1 = acosSigned(cosTa1, sinTa1);\r\n        const n = Math.sqrt(mu/a/a/a);\r\n        const E1 = this.getEccentricAnomalyByTrueAnomaly(ta1, e);\r\n        let E2 = this.getEccentricAnomalyByTrueAnomaly(ta1 + alpha, e);\r\n        if (ta1 + alpha > 2 * Math.PI) {\r\n            E2 += 2 * Math.PI;\r\n        }\r\n        return (E2 - E1 - e * (Math.sin(E2) - Math.sin(E1))) / n;\r\n    }\r\n\r\n    static getEccentricAnomalyByTrueAnomaly(ta, ecc) {\r\n        if (ecc < 1) {\r\n            const cos = Math.cos(ta);\r\n            return acosSigned(\r\n                (ecc + cos) / (1 + ecc * cos),\r\n                Math.sin(ta) // TODO optimize\r\n            );\r\n        } else {\r\n            return 2 * Math.atanh(Math.tan(ta / 2) / Math.sqrt((ecc + 1) / (ecc - 1)));\r\n        }\r\n    }\r\n\r\n}\r\n","import * as THREE from \"three\";\r\n\r\nimport VisualModelAbstract from \"./ModelAbstract\";\r\nimport {Quaternion, Vector} from \"../algebra\";\r\nimport {RF_BASE} from \"../ReferenceFrame/Factory\";\r\nimport { sim } from \"../Simulation\";\r\n\r\nexport default class VisualVector extends VisualModelAbstract\r\n{\r\n    constructor(vector, referenceFrameId) {\r\n        super();\r\n        if (referenceFrameId === undefined) {\r\n            referenceFrameId = RF_BASE;\r\n        }\r\n        this.referenceFrame = sim.starSystem.getReferenceFrame(referenceFrameId);\r\n        this.quaternion = Quaternion.transfer(new Vector([0,1,0]), vector);\r\n        this.setThreeObj(new THREE.ArrowHelper(\r\n            (new THREE.Vector3()).fromArray([1,0,0]),\r\n            new THREE.Vector3(),\r\n            vector.mag\r\n        ));\r\n    }\r\n\r\n    render(epoch) {\r\n        this.threeObj.quaternion.copy(this.quaternion.mul(this.referenceFrame.getQuaternionByEpoch(epoch)).toThreejs());\r\n        this.setPosition(this.referenceFrame.getOriginPositionByEpoch(epoch));\r\n    }\r\n}\r\n","import $ from \"jquery\";\r\n\r\nimport UIPanel from \"../Panel\";\r\nimport LambertSolver from \"../../core/LambertSolver\";\r\nimport ReferenceFrameFactory, {ReferenceFrame} from \"../../core/ReferenceFrame/Factory\";\r\nimport VisualTrajectoryModelKeplerian from \"../../core/visual/Trajectory/Keplerian\";\r\nimport VisualVector from \"../../core/visual/Vector\";\r\nimport EphemerisObject from \"../../core/EphemerisObject\";\r\nimport { sim } from \"../../core/Simulation\";\r\nimport Events from \"../../core/Events\";\r\n\r\nexport default class UIPanelLambert extends UIPanel\r\n{\r\n    constructor(panelDom) {\r\n        super(panelDom, true);\r\n\r\n        this.maxTransferTime = 86400 * 365.25 * 40;\r\n\r\n        this.jqSlider = this.jqDom.find('#transferTimeSlider');\r\n        this.jqSlider.on('input change', () => this.changeTransferTime(this.getCurrentTransferTime()));\r\n        this.transferTime = this.getCurrentTransferTime();\r\n\r\n        this.jqTransferTimeText = this.jqDom.find('#transferTimeValue');\r\n        this.jqTransferTimeText.html(this.formatTransferTime(this.transferTime));\r\n\r\n        this.jqDateText = this.jqDom.find('#departureDateValue');\r\n\r\n        this.jqDom.find('#useCurrentTime').click(() => this.useCurrentTime());\r\n\r\n        this.jqOrigin = this.jqDom.find('#originSelect');\r\n        this.jqOrigin.on('change', () => this.changeOrigin(0|this.jqOrigin.val()));\r\n\r\n        this.jqTarget = this.jqDom.find('#targetSelect');\r\n        this.jqTarget.on('change', () => this.changeTarget(0|this.jqTarget.val()));\r\n\r\n        this.useCurrentTime();\r\n\r\n        this.origin = 399;\r\n        this.jqOrigin.val(this.origin);\r\n\r\n        Events.addListener(Events.STAR_SYSTEM_LOADED, () => {\r\n            this.jqOrigin.html('');\r\n            this.jqTarget.html('');\r\n            const listData = this.buildListData();\r\n            if (listData) {\r\n                this.updateList(this.jqTarget, listData);\r\n                this.updateList(this.jqOrigin, listData);\r\n            }\r\n        });\r\n    }\r\n\r\n    solve() {\r\n        if (!this.origin || !this.target || this.origin === this.target) {\r\n            return;\r\n        }\r\n\r\n        const parentObject = sim.getModule('PatchedConics').getCommonParent(this.origin, this.target);\r\n\r\n        if (parentObject === null || parentObject.id == this.origin || parentObject.id == this.target) {\r\n            return;\r\n        }\r\n\r\n        const referenceFrameId = ReferenceFrameFactory.buildId(parentObject.id, ReferenceFrame.INERTIAL_ECLIPTIC);\r\n        const origin = sim.starSystem.getObject(this.origin);\r\n        const target = sim.starSystem.getObject(this.target);\r\n        const state1 = origin.trajectory.getStateByEpoch(this.departureTime, referenceFrameId);\r\n        const state2 = target.trajectory.getStateByEpoch(this.departureTime + this.transferTime, referenceFrameId);\r\n\r\n        const solverResult = LambertSolver.solveFullTransfer(\r\n            origin,\r\n            target,\r\n            origin.physicalModel ? origin.physicalModel.radius + 200 : 0,\r\n            target.physicalModel ? target.physicalModel.radius + 200 : 0,\r\n            this.departureTime,\r\n            this.transferTime\r\n        );\r\n        if (!solverResult) {\r\n            return;\r\n        }\r\n        const transferTrajectory = solverResult.trajectory;\r\n        transferTrajectory.setObject(new EphemerisObject(-1, EphemerisObject.TYPE_UNKNOWN, origin.name + '->' + target.name + ' transfer'));\r\n\r\n        if (this.visualModel) {\r\n            this.visualModel.drop();\r\n            this.visualModel2 && this.visualModel2.drop();\r\n            this.visualModel3 && this.visualModel3.drop();\r\n            this.vector1.drop();\r\n            this.vector2.drop();\r\n        }\r\n\r\n        this.visualModel = new VisualTrajectoryModelKeplerian(transferTrajectory.components[0], 'yellow');\r\n        if (transferTrajectory.components[1]) {\r\n            this.visualModel2 = new VisualTrajectoryModelKeplerian(transferTrajectory.components[1], 'red');\r\n        }\r\n        if (transferTrajectory.components[2]) {\r\n            this.visualModel3 = new VisualTrajectoryModelKeplerian(transferTrajectory.components[2], 'red');\r\n        }\r\n        this.vector1 = new VisualVector(state1.position, referenceFrameId);\r\n        this.vector2 = new VisualVector(state2.position, referenceFrameId);\r\n\r\n        this.jqDom.find('#deltaVEjection').html(solverResult.ejectionDeltaV.toPrecision(4));\r\n        this.jqDom.find('#deltaVInsertion').html(solverResult.insertionDeltaV.toPrecision(4));\r\n        this.jqDom.find('#deltaVTotal').html((solverResult.ejectionDeltaV + solverResult.insertionDeltaV).toPrecision(4));\r\n    }\r\n\r\n    collapse() {\r\n        if (this.visualModel) {\r\n            this.visualModel.drop();\r\n            this.visualModel2.drop();\r\n            this.visualModel3.drop();\r\n            this.vector1.drop();\r\n            this.vector2.drop();\r\n            this.visualModel = null;\r\n        }\r\n        super.collapse();\r\n    }\r\n\r\n    useCurrentTime() {\r\n        this.departureTime = sim.currentEpoch;\r\n        this.updateTime(sim.currentDate);\r\n        this.solve();\r\n    }\r\n\r\n    changeOrigin(newOrigin) {\r\n        this.origin = newOrigin;\r\n        this.updateSliderScale();\r\n        this.solve();\r\n    }\r\n\r\n    changeTarget(newTarget) {\r\n        this.target = newTarget;\r\n        this.updateSliderScale();\r\n        this.solve();\r\n    }\r\n\r\n    updateSliderScale() {\r\n        if (!this.origin || !this.target || this.origin === this.target) {\r\n            return;\r\n        }\r\n\r\n        const periods = sim.getModule('PatchedConics').getRelativePeriod(this.origin, this.target, this.departureTime);\r\n\r\n        if (periods === null) {\r\n            return;\r\n        }\r\n\r\n        this.maxTransferTime = Math.max(periods.period1, periods.period2);\r\n        this.jqSlider.val(this.getNeededSliderValue((periods.period1 + periods.period2) / 4));\r\n        this.changeTransferTime(this.getCurrentTransferTime());\r\n    }\r\n\r\n    changeTransferTime(newTransferTime) {\r\n        this.transferTime = newTransferTime;\r\n        this.jqTransferTimeText.html(this.formatTransferTime(this.transferTime));\r\n        this.solve();\r\n    }\r\n\r\n    getCurrentTransferTime() {\r\n        const val = this.jqSlider.val();\r\n        return val * val * val * val * this.maxTransferTime;\r\n    }\r\n\r\n    getNeededSliderValue(transferTime) {\r\n        const val = Math.sqrt(Math.sqrt(transferTime / this.maxTransferTime));\r\n        return Math.max(0, Math.min(1, val));\r\n    }\r\n\r\n    buildListData() {\r\n        const root = sim.getModule('PatchedConics').getRootSoi();\r\n\r\n        if (!root) {\r\n            return null;\r\n        }\r\n\r\n        return this.buildSoiTreeData(root, 0);\r\n    }\r\n\r\n    buildSoiTreeData(soiObject, level) {\r\n        let result = [{id: soiObject.id, level: level, name: soiObject.name}];\r\n        for (let child of soiObject.data.patchedConics.childSois) {\r\n            result = result.concat(this.buildSoiTreeData(child, level + 1));\r\n        }\r\n        return result;\r\n    }\r\n\r\n    updateList(jqList, data) {\r\n        const indent = '&nbsp;&nbsp;&nbsp;';\r\n        for (let entry of data) {\r\n            jqList.append($('<option>', {value: entry.id}).html(indent.repeat(entry.level) + entry.name));\r\n        }\r\n    }\r\n\r\n    updateTime(date) {\r\n        this.jqDateText.html(sim.time.formatDateFull(date));\r\n    }\r\n\r\n\r\n    formatTransferTime(scale) {\r\n        const precision = 3;\r\n\r\n        const prefix = (scale < 0) ? '-' : '';\r\n        const abs = Math.abs(scale);\r\n        if (abs === 0) {\r\n            return '0';\r\n        }\r\n\r\n        if (abs < 60) {\r\n            return prefix + abs.toPrecision(precision) + ' s';\r\n        }\r\n\r\n        if (abs < 3600) {\r\n            return prefix + (abs / 60).toPrecision(precision) + ' min';\r\n        }\r\n\r\n        if (abs < 86400) {\r\n            return prefix + (abs / 3600).toPrecision(precision) + ' h';\r\n        }\r\n\r\n        if (abs < 2592000) {\r\n            return prefix + (abs / 86400).toPrecision(precision) + ' days';\r\n        }\r\n\r\n        if (abs < 31557600) {\r\n            return prefix + (abs / 2592000).toPrecision(precision) + ' months';\r\n        }\r\n\r\n        return prefix + (abs / 31557600).toPrecision(precision) + ' years';\r\n    }\r\n}\r\n","\r\nimport VisualTrajectoryAbstract from \"./Abstract\";\r\n\r\nexport default class VisualTrajectoryDynamic extends VisualTrajectoryAbstract\r\n{\r\n    static NO_THREE_OBJ = true;\r\n}\r\n","import UIPanel from \"../Panel\";\r\nimport EphemerisObject from \"../../core/EphemerisObject\";\r\nimport TrajectoryKeplerianBasic from \"../../core/Trajectory/KeplerianBasic\";\r\nimport ReferenceFrameFactory, {ReferenceFrame} from \"../../core/ReferenceFrame/Factory\";\r\nimport VisualTrajectoryModelKeplerian from \"../../core/visual/Trajectory/Keplerian\";\r\nimport KeplerianObject from \"../../core/KeplerianObject\";\r\nimport TrajectoryDynamic from \"../../core/Trajectory/Dynamic\";\r\nimport { sim } from \"../../core/Simulation\";\r\nimport VisualTrajectoryDynamic from \"../../core/visual/Trajectory/Dynamic\";\r\n\r\nexport default class UIPanelCreation extends UIPanel {\r\n    constructor(panelDom) {\r\n        super(panelDom);\r\n\r\n        this.jqPause = this.jqDom.find('#createOrbit');\r\n        this.jqPause.click(() => {\r\n            const center = sim.camera.orbitingPoint;\r\n            const object = sim.starSystem.getObject(center);\r\n            if (!object.physicalModel) {\r\n                return;\r\n            }\r\n            const sma = object.physicalModel.radius * 2;\r\n            const id = -11000000 - sim.starSystem.created;\r\n            sim.starSystem.created += 1;\r\n\r\n            let traj = new TrajectoryKeplerianBasic(\r\n                ReferenceFrameFactory.buildId(center, ReferenceFrame.INERTIAL_BODY_EQUATORIAL),\r\n                new KeplerianObject(\r\n                    0.2, sma, Math.PI / 6, Math.PI / 3, Math.PI / 6, 0, sim.currentEpoch, object.physicalModel.mu\r\n                )\r\n            );\r\n            traj.setVisualModel(new VisualTrajectoryModelKeplerian(traj, {color: 'yellow'}));\r\n            traj.minEpoch = false;\r\n            traj.maxEpoch = false;\r\n\r\n            const propagatorClass = sim.getPropagator('patchedConics');\r\n            let pTraj = new TrajectoryDynamic(new propagatorClass());\r\n            pTraj.setVisualModel(new VisualTrajectoryDynamic(pTraj, {color: 'yellow'}));\r\n            pTraj.addComponent(traj);\r\n\r\n            let ephObject = new EphemerisObject(id, EphemerisObject.TYPE_UNKNOWN, \"Created #\" + sim.starSystem.created);\r\n            ephObject.setTrajectory(pTraj);\r\n            sim.starSystem.addObject(id, ephObject);\r\n            sim.selection.forceSelection(ephObject);\r\n\r\n            pTraj.propagate(traj.epoch);\r\n        });\r\n    }\r\n}\r\n","import UIPanel from \"../Panel\";\r\nimport Events from \"../../core/Events\";\r\nimport TrajectoryDynamic from \"../../core/Trajectory/Dynamic\";\r\nimport FlightEventImpulsiveBurn from \"../../core/FlightEvent/ImpulsiveBurn\";\r\nimport { sim } from \"../../core/Simulation\";\r\n\r\nexport default class UIPanelManeuver extends UIPanel {\r\n    constructor(panelDom) {\r\n        super(panelDom);\r\n\r\n        this.increment = 1;\r\n\r\n        document.addEventListener(Events.SELECT, this.handleSelect.bind(this));\r\n        document.addEventListener(Events.DESELECT, this.handleDeselect.bind(this));\r\n\r\n        this.updateHandler = this.handleTrajectoryUpdate.bind(this);\r\n\r\n        this.jqDom.find('#incr001').on('click', () => {this.increment = 0.01});\r\n        this.jqDom.find('#incr01').on('click', () => {this.increment = 0.1});\r\n        this.jqDom.find('#incr1').on('click', () => {this.increment = 1});\r\n        this.jqDom.find('#incr10').on('click', () => {this.increment = 10});\r\n        this.jqDom.find('#incr100').on('click', () => {this.increment = 100});\r\n        this.jqDom.find('#incr1000').on('click', () => {this.increment = 1000});\r\n\r\n        this.jqDom.find('#prev-burn').on('click', () => this.setBurnIdx(this.burnIdx - 1));\r\n        this.jqDom.find('#next-burn').on('click', () => this.setBurnIdx(this.burnIdx + 1));\r\n\r\n        this.jqDom.find('#epoch-minus').on('click', () => {this.burn.epoch -= this.increment;this.update()});\r\n        this.jqDom.find('#epoch-plus').on('click', () => {this.burn.epoch += this.increment;this.update()});\r\n        for (let comp of ['prograde', 'normal', 'radial']) {\r\n            this.jqDom.find('#' + comp +'-minus').on('click', () => {this.burn[comp] -= this.increment / 1000;this.update()});\r\n            this.jqDom.find('#' + comp + '-plus').on('click', () => {this.burn[comp] += this.increment / 1000;this.update()});\r\n            this.jqDom.find('#' + comp + '-zero').on('click', () => {this.burn[comp] = 0;this.update()});\r\n        }\r\n\r\n        this.hide();\r\n    }\r\n\r\n    get increment() {\r\n        return this._increment;\r\n    }\r\n\r\n    set increment(val) {\r\n        this._increment = val;\r\n        this.jqDom.find('#increment').html(val);\r\n    }\r\n\r\n    handleTrajectoryUpdate() {\r\n        this.updateBurns();\r\n        if (this.burns.length > 0) {\r\n            this.show();\r\n        }\r\n        const idx = this.burns.indexOf(this.burn);\r\n        this.setBurnIdx(idx === -1 ? 0 : idx);\r\n    }\r\n\r\n    handleSelect(event) {\r\n        if (event.detail.object.trajectory instanceof TrajectoryDynamic) {\r\n            this.init(event.detail.object.trajectory);\r\n        }\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param trajectory {TrajectoryDynamic}\r\n     */\r\n    init(trajectory) {\r\n        this.trajectory = trajectory;\r\n        this.trajectory.onUpdate(this.updateHandler);\r\n        this.updateBurns();\r\n        if (this.burns.length === 0) {\r\n            this.hide();\r\n            return;\r\n        }\r\n        this.show();\r\n        this.setBurnIdx(0);\r\n    }\r\n\r\n    updateBurns() {\r\n        this.burns = this.trajectory.flightEvents.filter(event => event instanceof FlightEventImpulsiveBurn);\r\n    }\r\n\r\n    setBurnIdx(newIdx) {\r\n        if (newIdx < 0 || newIdx >= this.burns.length) {\r\n            return;\r\n        }\r\n        if (this.burn) {\r\n            this.burn.visualModel.setScale(1);\r\n        }\r\n        this.burnIdx = newIdx;\r\n        this.burn = this.burns[this.burnIdx];\r\n        this.burn.visualModel.setScale(2);\r\n\r\n        this.update();\r\n        this.jqDom.find('#burn-name').html('Burn #' + (this.burnIdx + 1));\r\n    }\r\n\r\n    handleDeselect() {\r\n        if (this.trajectory) {\r\n            this.trajectory.removeListener(this.updateHandler);\r\n            delete this.trajectory;\r\n            delete this.burn;\r\n            this.hide();\r\n        }\r\n    }\r\n\r\n    update() {\r\n        this.jqDom.find('#burn-date')    .html(sim.time.formatDateFull(sim.time.getDateByEpoch(this.burn.epoch)));\r\n        this.jqDom.find('#burn-epoch')   .html(this.burn.epoch.toFixed(2));\r\n        this.jqDom.find('#burn-prograde').html((this.burn.prograde * 1000).toFixed(2));\r\n        this.jqDom.find('#burn-normal')  .html((this.burn.normal * 1000).toFixed(2));\r\n        this.jqDom.find('#burn-radial')  .html((this.burn.radial * 1000).toFixed(2));\r\n        this.jqDom.find('#burn-total')   .html((this.burn.deltaV * 1000).toFixed(2));\r\n    }\r\n}","import $ from \"jquery\";\r\n\r\nimport UIPanelTime from \"./Panels/Time\";\r\nimport UIPanelCamera from \"./Panels/Camera\";\r\nimport UIPanelMetrics from \"./Panels/Metrics\";\r\nimport UIPanelLambert from \"./Panels/Lambert\";\r\nimport UIPanelCreation from \"./Panels/Creation\";\r\nimport UIPanelManeuver from \"./Panels/Maneuver\";\r\nimport { sim } from \"../core/Simulation\";\r\n\r\nexport default class UI\r\n{\r\n    constructor() {\r\n        this.timePanel     = new UIPanelTime    ($('#timePanel'));\r\n        this.cameraPanel   = new UIPanelCamera  ($('#cameraPanel'),  sim.camera);\r\n        this.metricsPanel  = new UIPanelMetrics ($('#metricsPanel'), sim.selection);\r\n        this.creationPanel = new UIPanelCreation($('#creationPanel'));\r\n        this.lambertPanel  = new UIPanelLambert ($('#lambertPanel'));\r\n        this.maneuverPanel = new UIPanelManeuver($('#maneuverPanel'));\r\n    }\r\n}\r\n","import * as THREE from \"three\";\r\n\r\nimport {Quaternion, Vector} from \"../core/algebra\";\r\nimport {ReferenceFrame, RF_BASE} from \"../core/ReferenceFrame/Factory\";\r\nimport Events from \"../core/Events\";\r\nimport ReferenceFrameFactory from \"../core/ReferenceFrame/Factory\";\r\nimport { sim } from \"../core/Simulation\";\r\n\r\nexport default class Camera\r\n{\r\n    constructor(domElement) {\r\n        this.settings = {\r\n            fov: 60,\r\n            animationDuration: 200,\r\n            pixelsToObjectUnderMouse: 20\r\n        };\r\n\r\n        this.domElement = domElement;\r\n        this.threeCamera = new THREE.PerspectiveCamera(this.settings.fov, domElement.width / domElement.height, 1, 1e15);\r\n        this.threeCamera.position.fromArray([0, 0, 0]);\r\n\r\n        this.listenersAdded = false;\r\n    }\r\n\r\n    init(initialReferenceFrame, initialPosition) {\r\n        this.position = initialPosition;\r\n\r\n        this.referenceFrame = sim.starSystem.getReferenceFrame(initialReferenceFrame);\r\n        this.orbitingPoint = this.referenceFrame.originId;\r\n        this.frameType = this.referenceFrame.type;\r\n        this.quaternion = this._getQuaternionByPosition(this.position);\r\n\r\n        this.lastPosition = this.referenceFrame.transformPositionByEpoch(sim.currentEpoch, this.position, RF_BASE);\r\n\r\n        this.currentMousePos = new Vector([0, 0]);\r\n        this.accountedMousePos = new Vector([0, 0]);\r\n\r\n        this.isMouseDown = false;\r\n        this.isShiftDown = false;\r\n        this.rightButtonDown = false;\r\n        this.isLookingAside = false;\r\n        this.zoomingAside = 0;\r\n        this.isAnimnating = false;\r\n\r\n        if (!this.listenersAdded) {\r\n            sim.addEventListener('mousedown', this.onMouseDown.bind(this), 1);\r\n            sim.addEventListener('mousemove', this.onMouseMove.bind(this), 1);\r\n            sim.addEventListener('mouseup', this.onMouseUp.bind(this), 1);\r\n            sim.addEventListener('wheel', this.onMouseWheel.bind(this), 1);\r\n            this.listenersAdded = true;\r\n        }\r\n    }\r\n\r\n    _getQuaternionByPosition(position, pole) {\r\n        const defaultDirection = new Vector([0, 0, 1]); // must be unit length\r\n        const defaultUp = new Vector([0, 1, 0]);        // must be unit length\r\n\r\n        const directionQuaternion = (new Quaternion()).setAxisAngle(\r\n            defaultDirection.cross(position),\r\n            Math.acos(position.dot(defaultDirection) / position.mag)\r\n        );\r\n\r\n        const newUp = directionQuaternion.rotate(defaultUp);\r\n        const neededUp = (new Quaternion()).setAxisAngle(\r\n            position.cross(pole || new Vector([0, 0, 1])),\r\n            Math.PI / 2\r\n        ).rotate(position);\r\n\r\n        let rollQuaternion = (new Quaternion()).setAxisAngle(\r\n            newUp.cross(neededUp),\r\n            Math.acos(newUp.dot(neededUp) / neededUp.mag)\r\n        );\r\n\r\n        return rollQuaternion.mul_(directionQuaternion);\r\n    }\r\n\r\n    getAvailableFrameTypes(orbitingPoint) {\r\n        if (orbitingPoint === undefined) {\r\n            orbitingPoint = this.orbitingPoint;\r\n        }\r\n\r\n        if (orbitingPoint == 0) {\r\n            return [ReferenceFrame.INERTIAL_ECLIPTIC];\r\n        }\r\n\r\n        const isBody = sim.starSystem.isBody(orbitingPoint);\r\n\r\n        if (isBody === null) {\r\n            return [];\r\n        } else if (isBody) {\r\n            return [\r\n                ReferenceFrame.INERTIAL_ECLIPTIC,\r\n                ReferenceFrame.INERTIAL_BODY_EQUATORIAL,\r\n                ReferenceFrame.INERTIAL_BODY_FIXED\r\n            ];\r\n        } else {\r\n            return [\r\n                ReferenceFrame.INERTIAL_ECLIPTIC,\r\n                ReferenceFrame.INERTIAL_PARENT_BODY_EQUATORIAL\r\n            ];\r\n        }\r\n    }\r\n\r\n    changeReferenceFrameType(newType) {\r\n        this.changeReferenceFrame(ReferenceFrameFactory.buildId(this.orbitingPoint, newType), true);\r\n    }\r\n\r\n    changeOrigin(newObjectId) {\r\n        const newFrameTypes = this.getAvailableFrameTypes(newObjectId);\r\n        let newFrameType = (newFrameTypes.indexOf(this.frameType) !== -1)\r\n            ? this.frameType\r\n            : ReferenceFrame.INERTIAL_ECLIPTIC;\r\n        this.changeReferenceFrame(ReferenceFrameFactory.buildId(newObjectId, newFrameType), true);\r\n    }\r\n\r\n    changeReferenceFrame(newFrameId, animate) {\r\n        const newFrame = sim.starSystem.getReferenceFrame(newFrameId);\r\n\r\n        this.position = this.referenceFrame.transformPositionByEpoch(sim.currentEpoch, this.position, newFrame);\r\n        this.isLookingAside = false;\r\n        this.zoomingAside = 0;\r\n        this.orbitingPoint = newFrame.originId;\r\n        this.frameType = newFrame.type;\r\n\r\n        if (animate) {\r\n            this.startAnimation(newFrame);\r\n        } else {\r\n            this.quaternion = this._getQuaternionByPosition(this.position);\r\n        }\r\n\r\n        Events.dispatch(Events.CAMERA_RF_CHANGED, {old: this.referenceFrame, new: newFrame});\r\n\r\n        this.referenceFrame = newFrame;\r\n    }\r\n\r\n    startAnimation(newFrame) {\r\n        if (newFrame) {\r\n            let transferQuaternion = this.referenceFrame.getQuaternionByEpoch(sim.currentEpoch).invert_().mul_(newFrame.getQuaternionByEpoch(sim.currentEpoch));\r\n            this.quaternion = transferQuaternion.invert_().mul_(this.quaternion);\r\n        }\r\n\r\n        this.animationStartingTime = (new Date()).getTime();\r\n        this.animationDuration = this.settings.animationDuration;\r\n        this.animationStartingQuaternion = this.quaternion.copy();\r\n        this.isAnimnating = true;\r\n    }\r\n\r\n    animate() {\r\n        const time = (new Date()).getTime();\r\n        const percent = (time - this.animationStartingTime) / this.animationDuration;\r\n        const targetQuat = this._getQuaternionByPosition(this.position);\r\n\r\n        if (percent >= 1) {\r\n            this.quaternion = targetQuat;\r\n            this.isAnimnating = false;\r\n            this.isLookingAside = false;\r\n            return;\r\n        }\r\n\r\n        this.quaternion = Quaternion.slerp(this.animationStartingQuaternion, targetQuat, percent);\r\n    }\r\n\r\n    findObjectUnderMouse() {\r\n        let biggestRadius = 0;\r\n        let biggestObject = false;\r\n        for (const body of sim.starSystem.getBodies()) {\r\n            const dist = sim.raycaster.getPixelDistance(\r\n                body.getPositionByEpoch(sim.currentEpoch, RF_BASE)\r\n            );\r\n            if (dist < this.settings.pixelsToObjectUnderMouse) {\r\n                if (biggestObject === false) {\r\n                    biggestObject = body.id;\r\n                }\r\n                const r = body.physicalModel.radius;\r\n                if (r && r > biggestRadius) {\r\n                    biggestRadius = r;\r\n                    biggestObject = body.id;\r\n                }\r\n            }\r\n        }\r\n        return biggestObject;\r\n    }\r\n\r\n    onMouseWheel(event) {\r\n        if (!event.deltaY) {\r\n            return;\r\n        }\r\n\r\n        const defaultFactor = event.shiftKey ? (1 + (sim.settings.ui.camera.zoomFactor - 1) / 10) : sim.settings.ui.camera.zoomFactor;\r\n        const factor = event.deltaY < 0\r\n            ? 1 / defaultFactor\r\n            : defaultFactor;\r\n        let objectToZoomTo = this.findObjectUnderMouse();\r\n        let zoomingTo = this.orbitingPoint;\r\n\r\n        if (objectToZoomTo === this.orbitingPoint) {\r\n            objectToZoomTo = false;\r\n        }\r\n\r\n        if (objectToZoomTo !== false) {\r\n            this.position = this.referenceFrame.transformPositionByEpoch(sim.currentEpoch, this.position, objectToZoomTo * 100000 + 1000);\r\n            zoomingTo = objectToZoomTo;\r\n        } else {\r\n            this.zoomingAside = 0;\r\n        }\r\n\r\n        if (sim.starSystem.getObject(zoomingTo).physicalModel && sim.starSystem.getObject(zoomingTo).physicalModel.radius) {\r\n            const currentMag = this.position.mag;\r\n            this.position.mul_((sim.starSystem.getObject(zoomingTo).physicalModel.radius + (currentMag - sim.starSystem.getObject(zoomingTo).physicalModel.radius) * factor) / currentMag);\r\n        } else {\r\n            this.position.mul_(factor);\r\n        }\r\n\r\n        if (objectToZoomTo !== false) {\r\n            this.position = sim.starSystem.getReferenceFrame(objectToZoomTo * 100000 + 1000).transformPositionByEpoch(sim.currentEpoch, this.position, this.referenceFrame);\r\n            this.isLookingAside = true;\r\n            this.zoomingAside++;\r\n\r\n        } else if (this.isLookingAside) {\r\n            this.startAnimation();\r\n        }\r\n\r\n        if (this.zoomingAside === 3) {\r\n            this.changeOrigin(objectToZoomTo, true);\r\n        }\r\n    }\r\n\r\n    onMouseDown(event) {\r\n        this.accountedMousePos = new Vector([event.clientX, event.clientY]);\r\n        this.currentMousePos = this.accountedMousePos.copy();\r\n        this.isMouseDown = true;\r\n        switch (event.button) {\r\n            case 0: //left\r\n                break;\r\n            case 1: // middle\r\n                break;\r\n            case 2:\r\n                this.rightButtonDown = true;\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n\r\n    onMouseMove(event) {\r\n        if (this.isMouseDown) {\r\n            this.isShiftDown = !!event.shiftKey;\r\n            this.currentMousePos.set(event.clientX, event.clientY);\r\n        }\r\n    }\r\n\r\n    onMouseUp(event) {\r\n        this.isMouseDown = false;\r\n        this.rightButtonDown = false;\r\n    }\r\n\r\n    onResize() {\r\n        this.threeCamera.aspect = this.domElement.width / this.domElement.height;\r\n        this.threeCamera.updateProjectionMatrix();\r\n    }\r\n\r\n    getTopDirection(epoch) {\r\n        return this.referenceFrame.getQuaternionByEpoch(epoch).mul_(this.quaternion).rotate_(new Vector([0,1,0]));\r\n    }\r\n\r\n    update(epoch) {\r\n        const rfQuaternion = this.referenceFrame.getQuaternionByEpoch(epoch);\r\n        let mouseShift = this.currentMousePos.sub(this.accountedMousePos);\r\n\r\n        if (this.isAnimnating) {\r\n            this.animate();\r\n        }\r\n\r\n        if (mouseShift[0] || mouseShift[1]) {\r\n            const polarConstraint = 0.00001;\r\n            const sensitivity = (this.isShiftDown ? 0.1 : 1) * sim.settings.ui.camera.mouseSensitivity;\r\n            const pole = new Vector([0, 0, 1]);\r\n            let poleAngle = this.position.angle(pole);\r\n            let verticalRotationAxis = this.rightButtonDown\r\n                ? this.quaternion.rotate(new Vector([0, 0, 1])).cross(pole)\r\n                : this.position.cross(pole);\r\n\r\n            let verticalQuaternion = new Quaternion(verticalRotationAxis, Math.min(Math.max(mouseShift[1] * sensitivity, poleAngle - Math.PI + polarConstraint), poleAngle - polarConstraint));\r\n            let mainQuaternion = (new Quaternion(pole, -mouseShift[0] * sensitivity)).mul_(verticalQuaternion);\r\n\r\n            if (!this.rightButtonDown) {\r\n                mainQuaternion.rotate_(this.position);\r\n            }\r\n            this.quaternion = mainQuaternion.mul_(this.quaternion);\r\n\r\n            this.accountedMousePos = this.currentMousePos.copy();\r\n        }\r\n        this.threeCamera.quaternion.copy(rfQuaternion.mul_(this.quaternion).toThreejs());\r\n        this.lastPosition = this.referenceFrame.transformPositionByEpoch(epoch, this.position, RF_BASE);\r\n    }\r\n}\r\n","import { sim } from \"../core/Simulation\";\r\n\r\nexport default class StarSystemEntry\r\n{\r\n    constructor(idx, alias, label, moduleName) {\r\n        this.idx = idx;\r\n        this.alias = alias;\r\n        this.label = label;\r\n        this.moduleName = moduleName;\r\n    }\r\n\r\n    // used in UI\r\n    get value() {\r\n        return this.alias;\r\n    }\r\n\r\n    load(callback) {\r\n        if (sim.isModuleLoaded(this.moduleName)) {\r\n            sim.getModule(this.moduleName).loadStarSystem(this.alias, callback);\r\n        } else {\r\n            sim.loadModule(this.moduleName, module => module.loadStarSystem(this.alias, callback));\r\n        }\r\n    }\r\n}\r\n","import StarSystemEntry from \"./StarSystemEntry\";\r\n\r\nexport default class StarSystemManager {\r\n    constructor() {\r\n        this._starSystems = [];\r\n        this._loadedIdx = null;\r\n\r\n        // The first one loads by default\r\n        this.add(\"solar_system\", \"SolarSystem\", \"Solar System\");\r\n        this.add(\"ksp\", \"KSP\", \"KSP System\");\r\n    }\r\n\r\n    get starSystems() {\r\n        return this._starSystems;\r\n    }\r\n\r\n    get defaultStarSystemIdx() {\r\n        return 0;\r\n    }\r\n\r\n    get defaultStarSystem() {\r\n        return this._starSystems[this.defaultStarSystemIdx];\r\n    }\r\n\r\n    add(alias, module, label) {\r\n        const idx = this._starSystems.length;\r\n\r\n        this._starSystems.push(new StarSystemEntry(idx, alias, label, module));\r\n    }\r\n\r\n    loadDefault(callback) {\r\n        this.loadByIdx(this.defaultStarSystemIdx, callback);\r\n    }\r\n\r\n    loadByIdx(idx, callback) {\r\n        if (idx === this._loadedIdx) {\r\n            return;\r\n        }\r\n\r\n        const starSystem = this._findStarSystemByIdx(idx);\r\n\r\n        if (!starSystem) {\r\n            return;\r\n        }\r\n\r\n        starSystem.load(callback);\r\n        this._loadedIdx = idx;\r\n    }\r\n\r\n    getCurrentStarSystem() {\r\n        if (this._loadedIdx === null) {\r\n            return undefined;\r\n        }\r\n\r\n        return this._starSystems[this._loadedIdx];\r\n    }\r\n\r\n    _findStarSystemByIdx(idx) {\r\n        // TODO: Add idx validation\r\n\r\n        return this._starSystems[idx];\r\n    }\r\n}\r\n","import * as THREE from \"three\";\nimport $ from \"jquery\";\nimport EventHandler from \"./EventHandler\";\nimport {Vector} from \"./algebra\";\nimport Events from \"./Events\";\nimport {ReferenceFrame} from \"./ReferenceFrame/Factory\";\nimport TimeLine from \"../ui-legacy/TimeLine\";\nimport StarSystemLoader from \"../interface/StarSystemLoader\";\nimport VisualRaycaster from \"./visual/Raycaster\";\nimport SelectionHandler from \"../ui-legacy/SelectionHandler\";\nimport UI from \"../ui-legacy/UI\";\nimport StarSystem from \"./StarSystem\";\nimport Camera from \"../ui-legacy/Camera\";\nimport ReferenceFrameFactory from \"./ReferenceFrame/Factory\";\nimport StarSystemManager from \"../interface/StarSystemManager\";\nimport VisualFlightEventImpulsiveBurn from \"./visual/FlightEvent/ImpulsiveBurn\";\nimport VisualMarkerApocenter from \"./visual/Marker/Apocenter\";\nimport VisualMarkerPericenter from \"./visual/Marker/Pericenter\";\n\nclass Simulation\n{\n    constructor() {\n        this.modules = {};\n        this.propagators = {};\n        this.renderLoopActive = false;\n        this.starSystemManager = new StarSystemManager();\n\n        this._initSettings();\n    }\n\n    init(viewPortDomElement, renderLoopFunction) {\n        this.renderLoopFunction = renderLoopFunction;\n\n        this.scene = new THREE.Scene();\n        this.scene.add(new THREE.AmbientLight(0xFFEFD5, 0.15));\n\n        this.textureLoader = new THREE.TextureLoader();\n\n        this.renderer = new THREE.WebGLRenderer({antialias: true, logarithmicDepthBuffer: true});\n\n        this.domElement = viewPortDomElement;\n        this._setRenderSize();\n        this.domElement.appendChild(this.renderer.domElement);\n        window.addEventListener(\"resize\", this.onWindowResize.bind(this));\n\n        this.rendererEvents = new EventHandler(this.renderer.domElement);\n\n        this.selection = new SelectionHandler();\n\n        this.time = new TimeLine(0, 1, true);\n\n        this.camera = new Camera(this.renderer.domElement);\n\n        this.raycaster = new VisualRaycaster(this.renderer.domElement, this.camera.threeCamera, 7);\n\n        this.ui = new UI();\n\n        this.starSystemManager.loadDefault(() => requestAnimationFrame(renderLoopFunction));\n\n        VisualFlightEventImpulsiveBurn.preloadTexture();\n        VisualMarkerPericenter.preloadTexture();\n        VisualMarkerApocenter.preloadTexture();\n\n        Events.dispatch(Events.INIT_DONE);\n    }\n\n    loadStarSystem(jsonFile, onLoadFinish) {\n        $.getJSON(\"./star_systems/\" + jsonFile, starSystemConfig => {\n            this.selection.deselect();\n            this.starSystem && this.starSystem.unload();\n            this.starSystem = new StarSystem(starSystemConfig.id);\n\n            StarSystemLoader.loadFromConfig(this.starSystem, starSystemConfig);\n\n            this.camera.init(\n                ReferenceFrameFactory.buildId(\n                    this.starSystem.mainObject,\n                    ReferenceFrame.INERTIAL_BODY_EQUATORIAL\n                ),\n                new Vector([30000, 30000, 20000])\n            );\n\n            onLoadFinish && onLoadFinish(this.starSystem);\n            Events.dispatch(Events.STAR_SYSTEM_LOADED, {starSystem: this.starSystem});\n\n            this.startRendering();\n        });\n    }\n\n    startRendering() {\n        this.renderLoopActive = true;\n    }\n\n    stopRendering() {\n        this.renderLoopActive = false;\n    }\n\n    get currentEpoch() {\n        return this.time.epoch;\n    }\n\n    get currentDate() {\n        return this.time.getDateByEpoch(this.time.epoch);\n    }\n\n    forceEpoch(epoch) {\n        return this.time.forceEpoch(epoch);\n    }\n\n    _initSettings() {\n        this.settings = {\n            ui: {\n                showBodyLabels: true,\n                showAnglesOfSelectedOrbit: true,\n                camera: {\n                    mouseSensitivity: 0.007,\n                    zoomFactor: 1.5\n                }\n            }\n        }\n    }\n\n    addEventListener(eventName, listener, priority) {\n        this.rendererEvents.addListener(eventName, listener, priority);\n    }\n\n    removeEventListener(eventName, listener) {\n        this.rendererEvents.removeListener(eventName, listener);\n    }\n\n    onWindowResize() {\n        this._setRenderSize();\n        this.camera.onResize();\n    }\n\n    tick(timeDelta) {\n        this.time.tick(timeDelta);\n\n        this.camera.update(this.time.epoch);\n\n        Events.dispatch(Events.RENDER, {epoch: this.time.epoch});\n\n        if (this.renderLoopActive) {\n            this.renderer.render(this.scene, this.camera.threeCamera);\n        }\n    }\n\n    getVisualCoords(simCoords) {\n        return (new THREE.Vector3()).fromArray(simCoords.sub(this.camera.lastPosition));\n    }\n\n    getSimCoords(visualCoords) {\n        return (new Vector(visualCoords.toArray())).add_(this.camera.lastPosition);\n    }\n\n    loadModule(alias, callback) {\n        const className = 'Module' + alias;\n        import('../modules/' + alias + '/' + className).then((module) => {\n            this.modules[alias] = new module.default();\n            this.modules[alias].init();\n            callback && callback(this.modules[alias]);\n        });\n    }\n\n    getModule(alias) {\n        if (this.modules[alias] === undefined) {\n            throw new Error('Unknown module: ' + alias);\n        }\n        return this.modules[alias];\n    }\n\n    isModuleLoaded(alias) {\n        return this.modules[alias] !== undefined;\n    }\n\n    getClass(alias) {\n        const periodPos = alias.indexOf(\".\");\n        if (periodPos === -1) {\n            throw new Error('Incorrect class alias! Period expected in ' + alias);\n        }\n        return this.getModule(alias.substr(0, periodPos)).getClass(alias.substr(periodPos + 1));\n    }\n\n    addPropagator(alias, propagatorClass) {\n        this.propagators[alias] = propagatorClass;\n    }\n\n    getPropagator(alias) {\n        return this.propagators[alias];\n    }\n\n    _setRenderSize() {\n        const { clientHeight, clientWidth } = this.domElement;\n        console.log(clientHeight, clientWidth);\n        this.renderer.setSize(clientWidth, clientHeight);\n    }\n}\n\nexport const sim = new Simulation();\n","import FunctionOfEpochAbstract from \"./Abstract\";\r\nimport { sim } from \"../Simulation\";\r\n\r\nexport default class FunctionOfEpochObjectState extends FunctionOfEpochAbstract\r\n{\r\n    constructor(objectId, referenceFrame) {\r\n        super();\r\n        this.objectId = objectId;\r\n        this.referenceFrame = referenceFrame;\r\n    }\r\n\r\n    evaluate(epoch) {\r\n        return sim.starSystem.getObject(this.objectId).trajectory.getStateByEpoch(epoch, this.referenceFrame);\r\n    }\r\n}\r\n","import ReferenceFrameAbstract from \"./Abstract\";\r\nimport {RF_BASE} from \"./Factory\";\r\nimport {Vector} from \"../algebra\";\r\nimport StateVector from \"../StateVector\";\r\nimport { sim } from \"../Simulation\";\r\n\r\nexport default class ReferenceFrameBodyFixed extends ReferenceFrameAbstract\r\n{\r\n    constructor(origin, isInertial) {\r\n        super();\r\n        this.origin = origin;\r\n        this.isInertial = isInertial;\r\n        this.body = sim.starSystem.getObject(this.origin);\r\n    }\r\n\r\n    getQuaternionByEpoch(epoch) {\r\n        return this.body.orientation.getQuaternionByEpoch(epoch);\r\n    }\r\n\r\n    getOriginStateByEpoch(epoch) {\r\n        return sim.starSystem.getObject(this.origin).trajectory.getStateByEpoch(epoch, RF_BASE);\r\n    }\r\n\r\n    getOriginPositionByEpoch(epoch) {\r\n        return this.getOriginStateByEpoch(epoch).position;\r\n    }\r\n\r\n    getRotationVelocityByEpoch(epoch) {\r\n        return new Vector([0, 0, this.body.orientation.angularVel]);\r\n    }\r\n\r\n    stateVectorFromBaseReferenceFrameByEpoch(epoch, state) {\r\n        const originState = this.getOriginStateByEpoch(epoch);\r\n        const rotation = this.getQuaternionByEpoch(epoch).invert_();\r\n\r\n        const destPos = rotation.rotate(state.position.sub_(originState.position));\r\n        let destVel = rotation.rotate(state.velocity.sub_(originState.velocity));\r\n\r\n        if (!this.isInertial) {\r\n            const rfVel = destPos.cross(this.getRotationVelocityByEpoch(epoch));\r\n            destVel.add_(rfVel);\r\n        }\r\n\r\n        return new StateVector(\r\n            destPos,\r\n            destVel\r\n        );\r\n    }\r\n\r\n    stateVectorToBaseReferenceFrameByEpoch(epoch, state) {\r\n        const originState = this.getOriginStateByEpoch(epoch);\r\n        const rotation = this.getQuaternionByEpoch(epoch);\r\n\r\n        const destPos = rotation.rotate(state.position).add_(originState.position);\r\n        let destVel;\r\n\r\n        if (!this.isInertial) {\r\n            const rfVel = state.position.cross(this.getRotationVelocityByEpoch(epoch));\r\n            destVel = rotation.rotate(state.velocity.sub_(rfVel)).add_(originState.velocity);\r\n        } else {\r\n            destVel = rotation.rotate(state.velocity).add_(originState.velocity);\r\n        }\r\n\r\n        return new StateVector(\r\n            destPos,\r\n            destVel\r\n        );\r\n    }\r\n}\r\n","import ReferenceFrameAbstract from \"./Abstract\";\r\nimport {RF_BASE} from \"./Factory\";\r\n\r\nexport default class ReferenceFrameBase extends ReferenceFrameAbstract\r\n{\r\n    constructor() {\r\n        super();\r\n        this.setId(RF_BASE);\r\n    }\r\n}","import ReferenceFrameBodyFixed from \"./BodyFixed\";\r\nimport {Quaternion, Vector} from \"../algebra\";\r\nimport {RF_BASE} from \"./Factory\";\r\nimport StateVector from \"../StateVector\";\r\nimport { sim } from \"../Simulation\";\r\n\r\nexport default class ReferenceFrameTopocentric extends ReferenceFrameBodyFixed\r\n{\r\n    constructor(origin, lat, lon, height, isInertial) {\r\n        super(origin, isInertial);\r\n        this.bodyFixedQuaternion = new Quaternion().setFromEuler(0, -lat, lon, 'ZYX');\r\n        this.bodyFixedPosition = (new Vector([this.body.physicalModel.radius + height, 0, 0])).rotateY(-lat).rotateZ(lon);\r\n    }\r\n\r\n    getQuaternionByEpoch(epoch) {\r\n        return this.body.orientation.getQuaternionByEpoch(epoch).mul_(this.bodyFixedQuaternion)\r\n    }\r\n\r\n    getRotationVelocityByEpoch(epoch) {\r\n        return this.bodyFixedQuaternion.invert().rotate(\r\n            new Vector([0, 0, this.body.orientation.angularVel])\r\n        );\r\n    }\r\n\r\n    getOriginStateByEpoch(epoch) {\r\n        const bodyState = sim.starSystem.getObject(this.origin).trajectory.getStateByEpoch(epoch, RF_BASE);\r\n        const bodyQuaternion = this.body.orientation.getQuaternionByEpoch(epoch);\r\n\r\n        let rfVel = this.bodyFixedPosition.cross(\r\n            new Vector([0, 0, this.body.orientation.angularVel])\r\n        );\r\n\r\n        const destPos = bodyQuaternion.rotate(this.bodyFixedPosition).add_(bodyState.position);\r\n        const destVel = bodyQuaternion.rotate_(rfVel.mul_(-1)).add_(bodyState.velocity);\r\n\r\n        return new StateVector(\r\n            destPos,\r\n            destVel\r\n        );\r\n    }\r\n}\r\n","import FunctionOfEpochObjectState from \"../FunctionOfEpoch/ObjectState\";\r\nimport {Quaternion, Vector} from \"../algebra\";\r\nimport FunctionOfEpochCustom from \"../FunctionOfEpoch/Custom\";\r\nimport ReferenceFrameBodyFixed from \"./BodyFixed\";\r\nimport ReferenceFrameBase from \"./Base\";\r\nimport ReferenceFrameInertial from \"./Inertial\";\r\nimport ReferenceFrameInertialDynamic from \"./InertialDynamic\";\r\nimport Body from \"../Body\";\r\nimport ReferenceFrameTopocentric from \"./Topocentric\";\r\nimport { sim } from \"../Simulation\";\r\n\r\nexport default class ReferenceFrameFactory\r\n{\r\n    static create(id, type, config) {\r\n        let res = null;\r\n\r\n        if (type == ReferenceFrame.INERTIAL_ECLIPTIC) {\r\n            res = new ReferenceFrameInertial(\r\n                new FunctionOfEpochObjectState(config.origin, RF_BASE),\r\n                new Quaternion()\r\n            );\r\n        } else if (type == ReferenceFrame.INERTIAL_BODY_EQUATORIAL) {\r\n            if (sim.starSystem.getObject(config.origin) instanceof Body) {\r\n                res = new ReferenceFrameInertialDynamic(\r\n                    new FunctionOfEpochObjectState(config.origin, RF_BASE),\r\n                    new FunctionOfEpochCustom((epoch) => {\r\n                        const z = sim.starSystem.getObject(config.origin).orientation.getQuaternionByEpoch(epoch).rotate_(new Vector([0, 0, 1]));\r\n                        const equinox = z.cross(new Vector([0, 0, 1]));\r\n                        if (equinox.mag === 0) {\r\n                            return new Quaternion();\r\n                        }\r\n                        return Quaternion.transfer(new Vector([0, 0, 1]), z).mul_(\r\n                            Quaternion.transfer(new Vector([1, 0, 0]), equinox)\r\n                        );\r\n                    })\r\n                );\r\n            } else {\r\n                res = null;\r\n            }\r\n        } else if (type == ReferenceFrame.INERTIAL_PARENT_BODY_EQUATORIAL) {\r\n            res = new ReferenceFrameInertialDynamic(\r\n                new FunctionOfEpochObjectState(config.origin, RF_BASE),\r\n                new FunctionOfEpochCustom((epoch) => {\r\n                    const parentId = sim.starSystem.getObject(config.origin).getParentObjectIdByEpoch(epoch);\r\n                    const parent = sim.starSystem.getObject(parentId);\r\n\r\n                    if (parent instanceof Body) {\r\n                        const z = parent.orientation.getQuaternionByEpoch(epoch).rotate_(new Vector([0, 0, 1]));\r\n                        const equinox = z.cross(new Vector([0, 0, 1]));\r\n                        return Quaternion.transfer(new Vector([0, 0, 1]), z).mul_(\r\n                            Quaternion.transfer(new Vector([1, 0, 0]), equinox)\r\n                        );\r\n                    } else {\r\n                        return new Quaternion();\r\n                    }\r\n                })\r\n            );\r\n        } else if (type == ReferenceFrame.INERTIAL_BODY_FIXED) {\r\n            if (sim.starSystem.getObject(config.origin) instanceof Body) {\r\n                res = new ReferenceFrameBodyFixed(\r\n                    config.origin,\r\n                    true\r\n                );\r\n            } else {\r\n                res = null;\r\n            }\r\n        } else if (type == ReferenceFrame.INERTIAL_TOPOCENTRIC) {\r\n            if (sim.starSystem.getObject(config.origin) instanceof Body) {\r\n                res = new ReferenceFrameTopocentric(\r\n                    config.origin,\r\n                    config.lat,\r\n                    config.lon,\r\n                    config.height,\r\n                    true\r\n                );\r\n            } else {\r\n                res = null;\r\n            }\r\n        } else if (type == ReferenceFrame.BODY_FIXED) {\r\n            if (sim.starSystem.getObject(config.origin) instanceof Body) {\r\n                res = new ReferenceFrameBodyFixed(\r\n                    config.origin,\r\n                    false\r\n                );\r\n            } else {\r\n                res = null;\r\n            }\r\n        } else if (type == ReferenceFrame.TOPOCENTRIC) {\r\n            if (sim.starSystem.getObject(config.origin) instanceof Body) {\r\n                res = new ReferenceFrameTopocentric(\r\n                    config.origin,\r\n                    config.lat,\r\n                    config.lon,\r\n                    /* height */ undefined, // TODO: We need to investigate why\r\n                    false\r\n                );\r\n            } else {\r\n                res = null;\r\n            }\r\n        } else if (type == ReferenceFrame.BASE) {\r\n            res = new ReferenceFrameBase();\r\n        }\r\n\r\n        return res ? res.setId(id) : null;\r\n    }\r\n\r\n    static getOriginIdByReferenceFrameId(referenceFrameId) {\r\n        return Math.sign(referenceFrameId) * Math.floor(Math.abs(referenceFrameId) / 100000);\r\n    }\r\n\r\n    static getTypeByReferenceFrameId(referenceFrameId) {\r\n        return Math.floor((Math.abs(referenceFrameId) % 100000) / 1000);\r\n    }\r\n\r\n    static createById(id) {\r\n        const type = this.getTypeByReferenceFrameId(id);\r\n\r\n        if ((type === ReferenceFrame.INERTIAL_ECLIPTIC)\r\n            || (type === ReferenceFrame.INERTIAL_BODY_EQUATORIAL)\r\n            || (type === ReferenceFrame.INERTIAL_BODY_FIXED)\r\n            || (type === ReferenceFrame.BODY_FIXED)\r\n            || (type === ReferenceFrame.INERTIAL_PARENT_BODY_EQUATORIAL)\r\n        ) {\r\n            return this.create(id, type, {origin: this.getOriginIdByReferenceFrameId(id)});\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    static buildId(origin, type) {\r\n        if ((type === ReferenceFrame.INERTIAL_ECLIPTIC)\r\n            || (type === ReferenceFrame.INERTIAL_BODY_EQUATORIAL)\r\n            || (type === ReferenceFrame.INERTIAL_BODY_FIXED)\r\n            || (type === ReferenceFrame.BODY_FIXED)\r\n            || (type === ReferenceFrame.INERTIAL_PARENT_BODY_EQUATORIAL)\r\n        ) {\r\n            return (origin ? Math.sign(origin) : 1) * (Math.abs(origin) * 100000 + type * 1000);\r\n        }\r\n\r\n        return null;\r\n    }\r\n}\r\n\r\nexport const RF_BASE = 1000;\r\n\r\nexport let RF_BASE_OBJ = new ReferenceFrameBase();\r\n\r\nexport const ReferenceFrame = {\r\n    BASE: 0,\r\n    INERTIAL_ECLIPTIC: 1,\r\n    INERTIAL_BODY_EQUATORIAL: 2,\r\n    INERTIAL_BODY_FIXED: 3,\r\n    INERTIAL_TOPOCENTRIC: 4,\r\n    // : 5, vacant\r\n    BODY_FIXED: 6,\r\n    TOPOCENTRIC: 7,\r\n    INERTIAL_PARENT_BODY_EQUATORIAL: 8,\r\n};\r\n","export default class Events\r\n{\r\n    static dispatch(event, detail) {\r\n        let eventObj;\r\n        if (detail) {\r\n            eventObj = new CustomEvent(\r\n                event,\r\n                {detail: detail}\r\n            );\r\n        } else {\r\n            eventObj = new CustomEvent(event);\r\n        }\r\n        document.dispatchEvent(eventObj);\r\n    }\r\n\r\n    static addListener(event, handler) {\r\n        return document.addEventListener(event, handler);\r\n    }\r\n\r\n    static removeListener(event, handler) {\r\n        return document.removeEventListener(event, handler);\r\n    }\r\n\r\n    static LOADING_BODIES_DONE = 'urb_load_bodies_done';\r\n    static LOADING_FRAMES_DONE = 'urb_load_frames_done';\r\n    static LOADING_TRAJECTORIES_DONE = 'urb_load_traj_done';\r\n\r\n    static RENDER = 'urb_render';\r\n    static INIT_DONE = 'urb_init_done';\r\n    static STAR_SYSTEM_LOADED = 'urb_star_system_loading_done';\r\n    static SELECT = 'urb_select';\r\n    static DESELECT = 'urb_deselect';\r\n    static SHOW_ORBIT_ANGLES_CHANGED = 'urb_show_orbit_angles_change';\r\n    static CAMERA_RF_CHANGED = 'urb_camera_rf_change';\r\n    static OBJECT_ADDED = 'urb_object_added';\r\n    static TIME_SCALE_CHANGED = 'urb_time_scale_change';\r\n    static TIME_PAUSED = 'urb_time_paused';\r\n    static TIME_UNPAUSED = 'urb_time_unpaused';\r\n    static EPOCH_CHANGED = 'urb_epoch_change';\r\n}\r\n","import {Vector} from \"./algebra\";\r\n\r\nexport default class StateVector\r\n{\r\n    constructor(position, velocity) {\r\n        this._position = position ? position.copy() : new Vector();\r\n        this._velocity = velocity ? velocity.copy() : new Vector();\r\n    }\r\n\r\n    get position() {\r\n        return this._position.copy();\r\n    }\r\n\r\n    get velocity() {\r\n        return this._velocity.copy();\r\n    }\r\n\r\n    static create(x, y, z, vx, vy, vz) {\r\n        return new this(\r\n            new Vector([ x || 0,  y || 0,  z || 0]),\r\n            new Vector([vx || 0, vy || 0, vz || 0])\r\n        );\r\n    }\r\n\r\n    copy() {\r\n        return new StateVector(this._position, this._velocity);\r\n    }\r\n\r\n    rotate_(quaternion) {\r\n        quaternion.rotate_(this._position);\r\n        quaternion.rotate_(this._velocity);\r\n        return this;\r\n    }\r\n\r\n    rotate(quaternion) {\r\n        return this.copy().rotate_(quaternion);\r\n    }\r\n}\r\n","import Events from \"../Events\";\r\nimport { sim } from \"../Simulation\";\r\n\r\nexport default class VisualModelAbstract\r\n{\r\n    constructor() {\r\n        this.threeObj = null;\r\n        this.scene = sim.scene;\r\n        this._isHidden = false;\r\n    }\r\n\r\n    setThreeObj(obj) {\r\n        this.threeObj = obj;\r\n        this.scene.add(this.threeObj);\r\n        this.renderListener = this._onRender.bind(this);\r\n        if (this._isHidden) {\r\n            this.threeObj.visible = false;\r\n        } else {\r\n            document.addEventListener(Events.RENDER, this.renderListener);\r\n        }\r\n    }\r\n\r\n    setPosition(simCoords) {\r\n        if (simCoords) {\r\n            this.threeObj.visible = true;\r\n            this.threeObj.position.copy(sim.getVisualCoords(simCoords));\r\n        } else {\r\n            this.threeObj.visible = false;\r\n        }\r\n    }\r\n\r\n    get pixelAngleSize() {\r\n        return sim.raycaster.getPixelAngleSize();\r\n    }\r\n\r\n    _onRender(event) {\r\n        try {\r\n            this.render(event.detail.epoch);\r\n        } catch (e) {\r\n            // console.log('Error', e);\r\n            this.threeObj.visible = false;\r\n        }\r\n    }\r\n\r\n    hide() {\r\n        this._isHidden = true;\r\n        this.renderListener && document.removeEventListener(Events.RENDER, this.renderListener);\r\n        if (this.threeObj)\r\n            this.threeObj.visible = false;\r\n    }\r\n\r\n    show() {\r\n        this._isHidden = false;\r\n        this.renderListener && document.addEventListener(Events.RENDER, this.renderListener);\r\n        if (this.threeObj)\r\n            this.threeObj.visible = true;\r\n    }\r\n\r\n    render(epoch) {}\r\n\r\n    drop() {\r\n        if (this.threeObj) {\r\n            this.scene.remove(this.threeObj);\r\n            this.threeObj.traverse(object => {\r\n                if (object.geometry) object.geometry.dispose();\r\n                if (object.material) object.material.dispose();\r\n            });\r\n            delete this.threeObj;\r\n        }\r\n        this.renderListener && document.removeEventListener(Events.RENDER, this.renderListener);\r\n    }\r\n}\r\n\r\nVisualModelAbstract.texturePath = 'texture/';\r\n","import { RF_BASE } from \"./ReferenceFrame/Factory\";\r\n\r\nexport default class EphemerisObject\r\n{\r\n    constructor(bodyId, type, name, data) {\r\n        this.id   = bodyId;\r\n        this.type = type;\r\n        this.name = name;\r\n        this.data = data || {};\r\n    }\r\n\r\n    setTrajectory(trajectory) {\r\n        this.trajectory = trajectory;\r\n        this.trajectory.setObject(this);\r\n    }\r\n\r\n    getParentObjectIdByEpoch(epoch) {\r\n        if (!this.trajectory) {\r\n            return null;\r\n        }\r\n\r\n        const rf = this.trajectory.getReferenceFrameByEpoch(epoch);\r\n        if (!rf) {\r\n            return null;\r\n        }\r\n\r\n        return rf.originId;\r\n    }\r\n\r\n    getStateByEpoch(epoch, referenceFrame) {\r\n        return this.trajectory.getStateByEpoch(epoch, referenceFrame || RF_BASE);\r\n    }\r\n\r\n    getPositionByEpoch(epoch, referenceFrame) {\r\n        return this.trajectory.getPositionByEpoch(epoch, referenceFrame || RF_BASE);\r\n    }\r\n\r\n    select() {\r\n        this.trajectory && this.trajectory.select();\r\n    }\r\n\r\n    deselect() {\r\n        this.trajectory && this.trajectory.deselect();\r\n    }\r\n\r\n    drop() {\r\n        if (this.trajectory) {\r\n            this.trajectory.drop();\r\n            delete this.trajectory;\r\n        }\r\n    }\r\n}\r\n\r\nEphemerisObject.TYPE_UNKNOWN    = 0;\r\nEphemerisObject.TYPE_STAR       = 1;\r\nEphemerisObject.TYPE_PLANET     = 2;\r\nEphemerisObject.TYPE_PLANETOID  = 3;\r\nEphemerisObject.TYPE_SATELLITE  = 4;\r\nEphemerisObject.TYPE_ASTEROID   = 5;\r\nEphemerisObject.TYPE_COMET      = 6;\r\nEphemerisObject.TYPE_SPACECRAFT = 7;\r\nEphemerisObject.TYPE_POINT      = 8;\r\n","import FunctionOfEpochAbstract from \"./Abstract\";\r\n\r\nexport default class FunctionOfEpochCustom extends FunctionOfEpochAbstract\r\n{\r\n    constructor(func) {\r\n        super();\r\n        this.func = func;\r\n    }\r\n\r\n    evaluate(epoch) {\r\n        return this.func(epoch);\r\n    }\r\n}","import { sim } from \"./Simulation\";\r\nimport Events from \"./Events\";\r\n\r\nfunction init(statistics, viewPortId = \"viewport-id\") {\r\n    let globalTime;\r\n\r\n    function render(curTime) {\r\n        if (!sim.renderLoopActive) {\r\n            return;\r\n        }\r\n\r\n        sim.tick((curTime - globalTime) / 1000);\r\n\r\n        globalTime = curTime;\r\n        statistics.update();\r\n        requestAnimationFrame(render);\r\n    }\r\n\r\n    function firstRender(curTime) {\r\n        globalTime = curTime;\r\n        requestAnimationFrame(render);\r\n    }\r\n\r\n    sim.init(document.getElementById(viewPortId), firstRender);\r\n    sim.loadModule('PatchedConics');\r\n}\r\n\r\nexport {\r\n    init,\r\n    sim,\r\n    Events,\r\n}\r\n","import {Quaternion, TWO_PI, Vector} from \"./algebra\";\r\nimport StateVector from \"./StateVector\";\r\n\r\nexport default class KeplerianObject\r\n{\r\n    constructor(ecc, sma, aop, inc, raan, anomaly, epoch, mu, isAnomalyTrue) {\r\n        this._mu    = mu;\r\n        this._sma   = sma;\r\n        this._ecc   = ecc;\r\n        this._inc   = inc;\r\n        this._raan  = raan;\r\n        this._aop   = aop;\r\n        this._epoch = epoch;\r\n\r\n        if ((isAnomalyTrue === undefined) || (isAnomalyTrue === true)) {\r\n            this.ta = anomaly;\r\n        } else {\r\n            this.m0 = anomaly;\r\n        }\r\n\r\n        this.updateMeanMotion();\r\n    }\r\n\r\n    setUpdateCallback(callback) {\r\n        this._updateCallback = callback;\r\n    }\r\n\r\n    copy() {\r\n        return new KeplerianObject(this._ecc, this._sma, this._aop, this._inc, this._raan, this.m0, this._epoch, this._mu, false);\r\n    }\r\n\r\n    updateMeanMotion() {\r\n        this.meanMotion = Math.sqrt(this._mu / Math.abs(this._sma)) / Math.abs(this._sma);\r\n    }\r\n\r\n    get isHyperbolic() {\r\n        return this._ecc > 1;\r\n    }\r\n\r\n    get isElliptic() {\r\n        return this._ecc < 1;\r\n    }\r\n\r\n    get mu() {\r\n        return this._mu;\r\n    }\r\n\r\n    set mu(value) {\r\n        this._mu = value;\r\n        this.updateMeanMotion();\r\n        this._updateCallback && this._updateCallback();\r\n    }\r\n\r\n    get sma() {\r\n        return this._sma;\r\n    }\r\n\r\n    set sma(value) {\r\n        this._sma = value;\r\n        this.updateMeanMotion();\r\n        this._updateCallback && this._updateCallback();\r\n    }\r\n\r\n    get ecc() {\r\n        return this._ecc;\r\n    }\r\n\r\n    set ecc(value) {\r\n        this._ecc = value;\r\n        this._updateCallback && this._updateCallback();\r\n    }\r\n\r\n    get inc() {\r\n        return this._inc;\r\n    }\r\n\r\n    set inc(value) {\r\n        this._inc = value;\r\n        this._updateCallback && this._updateCallback();\r\n    }\r\n\r\n    get raan() {\r\n        return this._raan;\r\n    }\r\n\r\n    set raan(value) {\r\n        this._raan = value;\r\n        this._updateCallback && this._updateCallback();\r\n    }\r\n\r\n    get aop() {\r\n        return this._aop;\r\n    }\r\n\r\n    set aop(value) {\r\n        this._aop = value;\r\n        this._updateCallback && this._updateCallback();\r\n    }\r\n\r\n    get ta() {\r\n        return this.getTrueAnomalyByEpoch(this._epoch);\r\n    }\r\n\r\n    set ta(value) {\r\n        this.m0 = this.getMeanAnomalyByTrueAnomaly(value);\r\n        this._updateCallback && this._updateCallback();\r\n    }\r\n\r\n    get epoch() {\r\n        return this._epoch;\r\n    }\r\n\r\n    set epoch(value) {\r\n        this._epoch = value;\r\n        this._updateCallback && this._updateCallback();\r\n    }\r\n\r\n    get period() {\r\n        if (!this.isElliptic) {\r\n            return 0;\r\n        }\r\n        return TWO_PI * Math.sqrt(this._sma * this._sma * this._sma / this._mu);\r\n    }\r\n\r\n    getNodalPrecessionRate(r, j2) {\r\n        return -3/2 * r * r * j2 * Math.cos(this._inc) * this.meanMotion / Math.pow(this._sma * (1 - this._ecc * this._ecc), 2);\r\n    }\r\n\r\n    getNodalPrecessionByEpoch(r, j2, epoch) {\r\n        return (epoch - this._epoch) * this.getNodalPrecessionRate(r, j2);\r\n    }\r\n\r\n    addPrecession(r, j2, epoch) {\r\n        this.m0 = this.getMeanAnomalyByEpoch(epoch);\r\n        this._raan += this.getNodalPrecessionByEpoch(r, j2, epoch);\r\n        this._epoch = epoch;\r\n        return this;\r\n    }\r\n\r\n    getMeanAnomalyByEpoch(epoch) {\r\n        return this.m0 + this.meanMotion * (epoch - this._epoch);\r\n    }\r\n\r\n    getEccentricAnomalyByEpoch(epoch) {\r\n        return this.getEccentricAnomalyByMeanAnomaly(\r\n            this.getMeanAnomalyByEpoch(epoch)\r\n        );\r\n    }\r\n\r\n    getTrueAnomalyByEpoch(epoch) {\r\n        return this.getTrueAnomalyByMeanAnomaly(\r\n            this.getMeanAnomalyByEpoch(epoch)\r\n        );\r\n    }\r\n\r\n    getMeanAnomalyByEccentricAnomaly(ea) {\r\n        if (this.isElliptic) {\r\n            return ea - this._ecc * Math.sin(ea);\r\n        } else {\r\n            return this._ecc * Math.sinh(ea) - ea;\r\n        }\r\n    }\r\n\r\n    getMeanAnomalyByTrueAnomaly(ta) {\r\n        return this.getMeanAnomalyByEccentricAnomaly(\r\n            this.getEccentricAnomalyByTrueAnomaly(ta)\r\n        );\r\n    }\r\n\r\n    getEccentricAnomalyByMeanAnomaly(ma) {\r\n        const maxIter = 30;\r\n        const delta = 0.00000001;\r\n        let M = ma;\r\n        let E, F, i = 0;\r\n\r\n        if (this.isElliptic) {\r\n            M = M / (2.0 * Math.PI);\r\n            M = 2.0 * Math.PI * (M - Math.floor(M));\r\n\r\n            E = (this._ecc < 0.8) ? M : Math.PI;\r\n\r\n            F = E - this._ecc * Math.sin(E) - M;\r\n\r\n            while ((Math.abs(F) > delta) && (i < maxIter)) {\r\n                E = E - F / (1.0 - this._ecc * Math.cos(E));\r\n                F = E - this._ecc * Math.sin(E) - M;\r\n                i = i + 1;\r\n            }\r\n        } else {\r\n            E = (Math.log(2 * (Math.abs(M) + 1/3)) + 1) / this._ecc + (1 - 1 / this._ecc) * Math.asinh(Math.abs(M) / this._ecc);\r\n            E *= Math.sign(M);\r\n\r\n            F = this._ecc * Math.sinh(E) - E - M;\r\n\r\n            while ((Math.abs(F) > delta) && (i < maxIter)) {\r\n                E = E - F / (this._ecc * Math.cosh(E) - 1);\r\n                F = this._ecc * Math.sinh(E) - E - M;\r\n                i = i + 1;\r\n            }\r\n        }\r\n\r\n        return E;\r\n    }\r\n\r\n    getEccentricAnomalyByTrueAnomaly(ta) {\r\n        if (this.isElliptic) {\r\n            const cos = Math.cos(ta);\r\n            const cosE = (this._ecc + cos) / (1 + this._ecc * cos);\r\n            return ((ta + TWO_PI) % TWO_PI <= Math.PI)\r\n                ? Math.acos(cosE)\r\n                : TWO_PI - Math.acos(cosE);\r\n        } else {\r\n            return 2 * Math.atanh(Math.tan(ta / 2) / Math.sqrt((this._ecc + 1) / (this._ecc - 1)));\r\n        }\r\n    }\r\n\r\n    getTrueAnomalyByMeanAnomaly(ma) {\r\n        return this.getTrueAnomalyByEccentricAnomaly(\r\n            this.getEccentricAnomalyByMeanAnomaly(ma)\r\n        );\r\n    }\r\n\r\n    getTrueAnomalyByEccentricAnomaly(ea) {\r\n        if (this.isElliptic) {\r\n            const phi = Math.atan2(Math.sqrt(1.0 - this._ecc * this._ecc) * Math.sin(ea), Math.cos(ea) - this._ecc);\r\n            return (phi >= 0) ? phi : (phi + 2 * Math.PI);\r\n        } else {\r\n            return 2 * Math.atan(Math.sqrt((this._ecc + 1) / (this._ecc - 1)) * Math.tanh(ea / 2));\r\n        }\r\n    }\r\n\r\n    getOwnCoordsByTrueAnomaly(ta) {\r\n        const r = this._sma * (1.0 - this._ecc * this._ecc) / (1 + this._ecc * Math.cos(ta));\r\n        return new Vector([r * Math.cos(ta), r * Math.sin(ta), 0]);\r\n    }\r\n\r\n    getAsymptoteTa() {\r\n        if (this.isElliptic) {\r\n            return false;\r\n        }\r\n        return Math.acos(-1 / this._ecc);\r\n    }\r\n\r\n    getPeriapsisRadius() {\r\n        return this._sma * (1 - this._ecc);\r\n    }\r\n\r\n    getApoapsisRadius() {\r\n        return this._sma * (1 + this._ecc);\r\n    }\r\n\r\n    getPeriapsisSpeed() {\r\n        return Math.sqrt(this._mu * (2 / this.getPeriapsisRadius() - 1 / this._sma));\r\n    }\r\n\r\n    getApoapsisSpeed() {\r\n        return Math.sqrt(this._mu * (2 / this.getApoapsisRadius() - 1 / this._sma));\r\n    }\r\n\r\n    getEpochByTrueAnomaly(ta) {\r\n        if (ta === null) {\r\n            return null;\r\n        }\r\n        let diff = this.getMeanAnomalyByTrueAnomaly(ta) - this.m0;\r\n        if (diff < 0 && this.isElliptic) {\r\n            diff += TWO_PI;\r\n        }\r\n        return this._epoch + diff / this.meanMotion;\r\n    }\r\n\r\n    getSphereCrossingTrueAnomaly(radius) {\r\n        const apoR = this.getApoapsisRadius();\r\n        if ((apoR > 0 && radius > apoR) || radius < this.getPeriapsisRadius()) {\r\n            return false;\r\n        }\r\n        const ta = Math.acos((this._sma * (1.0 - this._ecc * this._ecc) / radius - 1) / this._ecc);\r\n        return [ta, TWO_PI - ta];\r\n    }\r\n\r\n    getPlaneCrossingTrueAnomaly(distanceToPlane) {\r\n        const a = this._sma * (1 - this._ecc * this._ecc) * Math.sin(this._inc) / distanceToPlane;\r\n        const b = this._ecc;\r\n        const c = Math.cos(this._aop);\r\n        const d = Math.sin(this._aop);\r\n        let taHigh = this._planeCrossingHelper( a * c,  a * d - b);  // top boundary\r\n        let taLow  = this._planeCrossingHelper(-a * c, -a * d - b);  // bottom boundary\r\n        let range1 = null;\r\n        let range2 = null;\r\n\r\n        if (taHigh === false && taLow === false) {\r\n            return false;\r\n        }\r\n\r\n        if (this.isHyperbolic) {\r\n            if (taHigh instanceof Array) {\r\n                if (!taLow instanceof Array) {\r\n                    return [taHigh];\r\n                }\r\n                return [\r\n                    [Math.min(taHigh[0], taLow[0]), Math.max(taHigh[0], taLow[0])],\r\n                    [Math.min(taHigh[1], taLow[1]), Math.max(taHigh[1], taLow[1])]\r\n                ];\r\n            }\r\n            if (taLow instanceof Array) {\r\n                return [taLow];\r\n            }\r\n            if (taHigh !== false && taLow !== false) {\r\n                return [[Math.min(taLow, taHigh), Math.max(taLow, taHigh)]];\r\n            }\r\n            // TODO implement\r\n            // this is a rare case where either taHigh or taLow is a number,\r\n            // which means that hyperbola asymptote is parallel to the horizontal plane\r\n            console.log('Error! getPlaneCrossingTrueAnomaly() not implemented!');\r\n            return false;\r\n        }\r\n\r\n        if (taHigh !== false) {\r\n            if (((this._aop + taHigh[0]) % TWO_PI) < ((this._aop + taHigh[1]) % TWO_PI)) {\r\n                range1 = [taHigh[1], taHigh[0]];\r\n            } else {\r\n                range1 = [taHigh[0], taHigh[1]];\r\n            }\r\n        }\r\n\r\n        if (taLow !== false) {\r\n            if (((this._aop + taLow[0]) % TWO_PI) < ((this._aop + taLow[1]) % TWO_PI)) {\r\n                range2 = [taLow[1], taLow[0]];\r\n            } else {\r\n                range2 = [taLow[0], taLow[1]];\r\n            }\r\n            return range1\r\n                ? [\r\n                    [range1[0], range2[1]],\r\n                    [range2[0], range1[1]]\r\n                ]\r\n                : [range2];\r\n        }\r\n\r\n        return [range1];\r\n    }\r\n\r\n    _planeCrossingHelper(a, b) {\r\n        const temp1 = a*a + b*b;\r\n        const temp2 = Math.sqrt(a*a * (temp1 - 1));\r\n        let ta1 = Math.atan2(\r\n            ((b * temp2 - b*b) / temp1 + 1) / a,\r\n            (b - temp2) / temp1\r\n        );\r\n\r\n        if (isNaN(ta1)) {\r\n            return false;\r\n        }\r\n\r\n        let ta2 = Math.atan2(\r\n            ((-b * temp2 - b*b) / temp1 + 1) / a,\r\n            (b + temp2) / temp1\r\n        );\r\n        if (this.isElliptic) {\r\n            return [\r\n                ta1 < 0 ? ta1 + TWO_PI : ta1,\r\n                ta2 < 0 ? ta2 + TWO_PI : ta2\r\n            ];\r\n        } else {\r\n            const asymptote = this.getAsymptoteTa();\r\n            ta1 = this._validateHyperbolicTa(asymptote, ta1);\r\n            ta2 = this._validateHyperbolicTa(asymptote, ta2);\r\n            if (ta1 !== false && ta2 !== false && ta1 !== ta2) {\r\n                return [Math.min(ta1, ta2), Math.max(ta1, ta2)];\r\n            } else if (ta1 !== false) {\r\n                return ta1;\r\n            } else if (ta2 !== false) {\r\n                return ta2;\r\n            } else {\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n\r\n    _validateHyperbolicTa(asymptote, ta) {\r\n        if (ta > Math.PI) {\r\n            ta -= TWO_PI;\r\n        }\r\n        if (ta > asymptote || ta < -asymptote) {\r\n            return false;\r\n        }\r\n        if (Math.abs(ta - Math.sign(ta) * asymptote) < 1e-14) {\r\n            return false;\r\n        }\r\n        return ta;\r\n    }\r\n\r\n    /**\r\n     *  @see http://microsat.sm.bmstu.ru/e-library/Ballistics/kepler.pdf\r\n     */\r\n    getStateByEpoch(epoch) {\r\n        if (this.isElliptic) {\r\n            const ea = this.getEccentricAnomalyByEpoch(epoch);\r\n            const cos = Math.cos(ea);\r\n            const sin = Math.sin(ea);\r\n            const koeff = Math.sqrt(this._mu / this._sma) / (1 - this._ecc * cos);\r\n\r\n            let pos = new Vector([\r\n                this._sma * (cos - this._ecc),\r\n                this._sma * Math.sqrt(1 - this._ecc * this._ecc) * sin,\r\n                0\r\n            ]);\r\n\r\n            let vel = new Vector([\r\n                -koeff * sin,\r\n                koeff * Math.sqrt(1 - this._ecc * this._ecc) * cos,\r\n                0\r\n            ]);\r\n\r\n            return new StateVector(\r\n                pos.rotateZ(this._aop).rotateX(this._inc).rotateZ(this._raan),\r\n                vel.rotateZ(this._aop).rotateX(this._inc).rotateZ(this._raan)\r\n            );\r\n        } else {\r\n            const ta = this.getTrueAnomalyByEpoch(epoch);\r\n            const orbitalQuat = this.getOrbitalFrameQuaternion();\r\n            const pos = this.getOwnCoordsByTrueAnomaly(ta);\r\n            const flightPathAngle = Math.atan(this._ecc * Math.sin(ta) / (1 + this._ecc * Math.cos(ta)));\r\n            let vel = new Vector([Math.sqrt(this._mu * (2 / pos.mag - 1 / this._sma)), 0, 0]);\r\n\r\n            return new StateVector(\r\n                orbitalQuat.rotate_(pos),\r\n                orbitalQuat.rotate_(vel.rotateZ(ta + Math.PI / 2 - flightPathAngle)),\r\n            );\r\n        }\r\n    }\r\n\r\n    getNormalVector() {\r\n        const nodeQuaternion = new Quaternion(new Vector([0, 0, 1]), this._raan);\r\n        const normalQuaternion = new Quaternion(nodeQuaternion.rotate_(new Vector([1, 0, 0])), this._inc);\r\n\r\n        return normalQuaternion.rotate_(new Vector([0, 0, 1]));\r\n    }\r\n\r\n    getPeriapsisVector() {\r\n        return this.getOrbitalFrameQuaternion().rotate_(new Vector([1, 0, 0]));\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @returns {Quaternion}\r\n     */\r\n    getOrbitalFrameQuaternion() {\r\n        return (new Quaternion(new Vector([0, 0, 1]), this._raan))\r\n            .mul_(new Quaternion(new Vector([1, 0, 0]), this._inc))\r\n            .mul_(new Quaternion(new Vector([0, 0, 1]), this._aop))\r\n        ;\r\n    }\r\n\r\n    /**\r\n     *  @see http://microsat.sm.bmstu.ru/e-library/Ballistics/kepler.pdf\r\n     */\r\n    static createFromState(state, mu, epoch) {\r\n        epoch = epoch || 0;\r\n\r\n        if (!state) {\r\n            return null;\r\n        }\r\n\r\n        const pos = state.position;\r\n        const vel = state.velocity;\r\n\r\n        const angMomentum = pos.cross(vel);\r\n\r\n        const raan = Math.atan2(angMomentum.x, -angMomentum.y);\r\n        const inc = Math.atan2((Math.sqrt(Math.pow(angMomentum.x, 2) + Math.pow(angMomentum.y, 2))) , angMomentum.z);\r\n        const sma = (mu * pos.mag) / (2.0 * mu - pos.mag * Math.pow(vel.mag, 2));\r\n        const e = Math.sqrt(1.0 - Math.min(1, Math.pow(angMomentum.mag, 2) / (mu * sma)));\r\n\r\n        const p = pos.rotateZ(-raan).rotateX(-inc);\r\n        const u = Math.atan2(p.y , p.x);\r\n\r\n        const radVel = pos.dot(vel);\r\n        const ta = Math.acos(Math.min(1, Math.max(-1, (sma*(1 - e*e) / pos.mag - 1) / e))) * Math.sign(radVel);\r\n\r\n        const aop = ((u - ta) > 0) ? (u - ta) : 2 * Math.PI + (u - ta);\r\n\r\n        return new KeplerianObject(e, sma, aop, inc, raan, ta, epoch, mu, true);\r\n    }\r\n\r\n}\r\n","import EphemerisObject from \"./EphemerisObject\";\r\n\r\nexport default class Body extends EphemerisObject\r\n{\r\n    constructor(bodyId, type, name, data, visualModel, physicalModel, orientation) {\r\n        super(bodyId, type, name, data);\r\n\r\n        this.visualModel   = visualModel;    // class VisualBodyModelBasic\r\n        this.physicalModel = physicalModel;  // class PhysicalBodyModel\r\n        this.orientation   = orientation;    // class OrientationAbstract\r\n\r\n        if (this.visualModel) {\r\n            this.visualModel.setObject(this);\r\n        }\r\n    }\r\n\r\n    drop() {\r\n        if (this.visualModel) {\r\n            this.visualModel.drop();\r\n            delete this.visualModel;\r\n        }\r\n        super.drop();\r\n    }\r\n}\r\n","import FunctionOfEpochAbstract from \"./Abstract\";\r\n\r\nexport default class Constant extends FunctionOfEpochAbstract\r\n{\r\n    constructor(value) {\r\n        super();\r\n        this.value = value;\r\n    }\r\n\r\n    evaluate(epoch) {\r\n        return this.value;\r\n    }\r\n}","import TrajectoryKeplerianAbstract from \"./KeplerianAbstract\";\r\n\r\nexport default class TrajectoryKeplerianBasic extends TrajectoryKeplerianAbstract\r\n{\r\n    constructor(referenceFrameId, keplerianObject) {\r\n        super(referenceFrameId);\r\n        this.keplerianObject = keplerianObject;\r\n    }\r\n\r\n    onUpdate(callback) {\r\n        this.keplerianObject.setUpdateCallback(() => callback(this));\r\n        return this;\r\n    }\r\n\r\n    get mu() {\r\n        return this.keplerianObject.mu;\r\n    }\r\n\r\n    set mu(value) {\r\n        this.keplerianObject.mu = value;\r\n    }\r\n\r\n    get sma() {\r\n        return this.keplerianObject.sma;\r\n    }\r\n\r\n    set sma(value) {\r\n        this.keplerianObject.sma = value;\r\n    }\r\n\r\n    get ecc() {\r\n        return this.keplerianObject.ecc;\r\n    }\r\n\r\n    set ecc(value) {\r\n        this.keplerianObject.ecc = value;\r\n    }\r\n\r\n    get inc() {\r\n        return this.keplerianObject.inc;\r\n    }\r\n\r\n    set inc(value) {\r\n        this.keplerianObject.inc = value;\r\n    }\r\n\r\n    get raan() {\r\n        return this.keplerianObject.raan;\r\n    }\r\n\r\n    set raan(value) {\r\n        this.keplerianObject.raan = value;\r\n    }\r\n\r\n    get aop() {\r\n        return this.keplerianObject.aop;\r\n    }\r\n\r\n    set aop(value) {\r\n        this.keplerianObject.aop = value;\r\n    }\r\n\r\n    get ta() {\r\n        return this.keplerianObject.ta;\r\n    }\r\n\r\n    set ta(value) {\r\n        this.keplerianObject.ta = value;\r\n    }\r\n\r\n    get epoch() {\r\n        return this.keplerianObject.epoch;\r\n    }\r\n\r\n    set epoch(value) {\r\n        this.keplerianObject.epoch = value;\r\n    }\r\n\r\n    get period() {\r\n        return this.keplerianObject.period;\r\n    }\r\n\r\n    getKeplerianObjectByEpoch(epoch, referenceFrameOrId) {\r\n        this.validateEpoch(epoch);\r\n        return this._transformKeplerianObject(this.keplerianObject, referenceFrameOrId);\r\n    }\r\n}\r\n","import * as THREE from \"three\";\r\n\r\nimport VisualTrajectoryModelAbstract from \"./Abstract\";\r\nimport {RF_BASE_OBJ} from \"../../ReferenceFrame/Factory\";\r\nimport {acosSigned, isInInterval, TWO_PI, Vector} from \"../../algebra\";\r\nimport ReferenceFrameInertial from \"../../ReferenceFrame/Inertial\";\r\nimport { sim } from \"../../Simulation\";\r\nimport Constant from \"../../FunctionOfEpoch/Constant\";\r\nimport StateVector from \"../../StateVector\";\r\nimport VisualMarkerPericenter from \"../Marker/Pericenter\";\r\nimport VisualMarkerApocenter from \"../Marker/Apocenter\";\r\n\r\nexport default class VisualTrajectoryKeplerian extends VisualTrajectoryModelAbstract\r\n{\r\n    constructor(trajectory, config) {\r\n        super(trajectory, config);\r\n        this.showFull = !!config.showFull;\r\n        this.trailPeriod = config.trailPeriod || false;\r\n        this.lastPositionEpoch = false;\r\n        this.lastFrameEpoch = false;\r\n        this._markers.per = new VisualMarkerPericenter(this.threeObj, this.config.color);\r\n        this._markers.apo = new VisualMarkerApocenter(this.threeObj, this.config.color);\r\n        this._markers.per.setScale(0.5);\r\n        this._markers.apo.setScale(0.5);\r\n    }\r\n\r\n    render(epoch) {\r\n        super.render(epoch);\r\n\r\n        const positionEpoch = this.getPositionEpoch(epoch);\r\n\r\n        if (positionEpoch === false) {\r\n            this.threeObj.visible = false;\r\n            return;\r\n        }\r\n\r\n        this.lastPositionEpoch = positionEpoch;\r\n        this.lastFrameEpoch = epoch;\r\n\r\n        const keplerianObject = this.trajectory.getKeplerianObjectByEpoch(positionEpoch);\r\n\r\n        if (keplerianObject.isElliptic) {\r\n            this.renderEllipse(keplerianObject, positionEpoch, epoch);\r\n        } else {\r\n            this.renderHyperbola(keplerianObject, positionEpoch, epoch);\r\n        }\r\n    }\r\n\r\n    getEpochByPoint(point) {\r\n        const frame = this.trajectory.getReferenceFrameByEpoch(this.lastFrameEpoch);\r\n        let framePos = frame.stateVectorFromBaseReferenceFrameByEpoch(this.lastFrameEpoch, new StateVector(point))._position;\r\n        const keplerianObject = this.trajectory.getKeplerianObjectByEpoch(this.lastPositionEpoch);\r\n        keplerianObject.getOrbitalFrameQuaternion().invert_().rotate_(framePos);\r\n        return keplerianObject.getEpochByTrueAnomaly(Math.atan2(framePos.y, framePos.x));\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param traj {KeplerianObject} - orbit to be rendered\r\n     * @param positionEpoch {float} - moment in time that specifies the position in orbit relative to its reference frame\r\n     * @param frameEpoch {float} - moment in time that specifies the position of the reference frame\r\n     */\r\n    renderHyperbola(traj, positionEpoch, frameEpoch) {\r\n        const endingBrightness = 0.35;\r\n        const pointsNum = 100;\r\n\r\n        let maxTa = traj.getAsymptoteTa() - 0.02;\r\n        let minTa = -maxTa;\r\n\r\n        if (this.trajectory.minEpoch !== false) {\r\n            minTa = traj.getTrueAnomalyByEpoch(this.trajectory.minEpoch);\r\n        }\r\n        if (this.trajectory.maxEpoch !== false) {\r\n            maxTa = traj.getTrueAnomalyByEpoch(this.trajectory.maxEpoch);\r\n        }\r\n\r\n        const orbitQuaternion = this.trajectory.pericentricReferenceFrame.getQuaternionByEpoch(positionEpoch);\r\n        const curTa = traj.getTrueAnomalyByEpoch(positionEpoch);\r\n\r\n        let points = [];\r\n        let angs = [];\r\n        let ta = minTa;\r\n        let i = 0;\r\n\r\n        if (ta > (minTa + curTa) / 2) {\r\n            ta = (minTa + curTa) / 2;\r\n        }\r\n\r\n        const taStep = (Math.max(maxTa, curTa) - ta) / (pointsNum - 1);\r\n        let extraPoints = 0;\r\n\r\n        while (i < pointsNum + extraPoints) {\r\n            let coords = traj.getOwnCoordsByTrueAnomaly(ta);\r\n            points[i] = (new THREE.Vector2()).fromArray([coords[0], coords[1]]);\r\n            angs[i] = (ta > curTa) ? 0 : ((curTa == minTa) ? 1 : (ta - minTa) / (curTa - minTa));\r\n            i  += 1;\r\n            ta += taStep;\r\n\r\n            if (ta - taStep <= curTa && curTa < ta) {\r\n                coords = traj.getOwnCoordsByTrueAnomaly(curTa);\r\n                points[i] = (new THREE.Vector2()).fromArray([coords[0], coords[1]]);\r\n                angs[i] = 1;\r\n                i  += 1;\r\n                points[i] = (new THREE.Vector2()).fromArray([coords[0], coords[1]]);\r\n                angs[i] = 0;\r\n                i  += 1;\r\n                extraPoints += 2;\r\n            }\r\n        }\r\n\r\n        this.updateGeometry(points, angs, endingBrightness);\r\n\r\n        this.threeObj.quaternion.copy(orbitQuaternion.toThreejs());\r\n        this.setPosition(this.trajectory.getReferenceFrameByEpoch(frameEpoch).getOriginPositionByEpoch(frameEpoch));\r\n\r\n        this._markers.apo.disable();\r\n        if (curTa > 0 && curTa < Math.PI) {\r\n            this._markers.per.disable();\r\n        } else {\r\n            this._markers.per.enable();\r\n            this._markers.per.setPosition(new THREE.Vector3(traj.getPeriapsisRadius(), 0, 0));\r\n        }\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param traj {KeplerianObject} - orbit to be rendered\r\n     * @param positionEpoch {float} - moment in time that specifies the position in orbit relative to its reference frame\r\n     * @param frameEpoch {float} - moment in time that specifies the position of the reference frame\r\n     */\r\n    renderEllipse(traj, positionEpoch, frameEpoch) {\r\n        const endingBrightness = 0.35;\r\n        const pointsNum = 100;\r\n\r\n        const orbitQuaternion = this.trajectory.pericentricReferenceFrame.getQuaternionByEpoch(positionEpoch);\r\n\r\n        // Main working RF. We take reference frame of the object\r\n        // at epoch and look at its position at locationEpoch\r\n        const referenceFrame = new ReferenceFrameInertial(\r\n            new Constant(this.trajectory.getReferenceFrameByEpoch(positionEpoch).getOriginStateByEpoch(frameEpoch)),\r\n            orbitQuaternion\r\n        );\r\n\r\n        // Camera position relative to main reference frame\r\n        const relativeCameraPosition = RF_BASE_OBJ.transformPositionByEpoch(frameEpoch, sim.camera.lastPosition, referenceFrame);\r\n\r\n        // Camera position projected onto the plane of the orbit, relative to main reference frame\r\n        const projectedRelativeCameraPosition = new Vector([relativeCameraPosition.x, relativeCameraPosition.y, 0]);\r\n\r\n        // Camera position projected onto the plane of the orbit, in global coordinates\r\n        const projectedCameraPosition = referenceFrame.transformPositionByEpoch(frameEpoch, projectedRelativeCameraPosition, RF_BASE_OBJ);\r\n\r\n        // True anomaly of the camera\r\n        const cameraTrueAnomaly = acosSigned(\r\n            projectedRelativeCameraPosition.x / projectedRelativeCameraPosition.mag,\r\n            projectedRelativeCameraPosition.y\r\n        );\r\n\r\n        const toClosestPoint = traj.getOwnCoordsByTrueAnomaly(cameraTrueAnomaly)                // not really closest\r\n            .sub_(relativeCameraPosition).mag;\r\n        const toFarthestPoint = traj.getOwnCoordsByTrueAnomaly(cameraTrueAnomaly + Math.PI)     // not really farthest\r\n            .sub_(relativeCameraPosition).mag;\r\n\r\n        let cameraAngle = traj.getEccentricAnomalyByTrueAnomaly(cameraTrueAnomaly);\r\n        let ang = traj.getEccentricAnomalyByEpoch(positionEpoch);\r\n        let minAnglePart = 0;\r\n        let maxAnglePart = 1;\r\n\r\n        if (!this.trailPeriod) {\r\n            this._markers.per.enable();\r\n            this._markers.per.setPosition(new THREE.Vector3(traj.getPeriapsisRadius() - projectedRelativeCameraPosition.x, -projectedRelativeCameraPosition.y, 0));\r\n            this._markers.apo.enable();\r\n            this._markers.apo.setPosition(new THREE.Vector3(-traj.getApoapsisRadius() - projectedRelativeCameraPosition.x, -projectedRelativeCameraPosition.y, 0));\r\n        }\r\n\r\n        // if there's less then one orbit left\r\n        if (this.trailPeriod) {\r\n            let minEpoch = positionEpoch - this.trailPeriod;\r\n            if (this.trajectory.minEpoch !== false && this.trajectory.minEpoch > minEpoch) {\r\n                minEpoch = this.trajectory.minEpoch;\r\n            }\r\n            this._markers.per.disable();\r\n            this._markers.apo.disable();\r\n            minAnglePart = 1 - (((ang - traj.getEccentricAnomalyByEpoch(minEpoch)) + TWO_PI) % TWO_PI) / TWO_PI;\r\n            maxAnglePart = 1;\r\n        } else if (!this.showFull\r\n            && this.trajectory.maxEpoch !== false\r\n            && (this.trajectory.maxEpoch - positionEpoch) < traj.period\r\n        ) {\r\n            // rendering a part of ellipse\r\n            const maxAng = traj.getEccentricAnomalyByEpoch(this.trajectory.maxEpoch);\r\n            maxAnglePart = (((maxAng - ang) + TWO_PI) % TWO_PI) / TWO_PI;\r\n\r\n            const maxMa = traj.getMeanAnomalyByEpoch(this.trajectory.maxEpoch);\r\n            const curMa = traj.getMeanAnomalyByEpoch(positionEpoch);\r\n            if (!isInInterval(0, [curMa, maxMa])) {\r\n                this._markers.per.disable();\r\n            }\r\n            if (!isInInterval(Math.PI, [curMa, maxMa])) {\r\n                this._markers.apo.disable();\r\n            }\r\n        }\r\n\r\n        const ellipsePoints = this.getEllipsePoints(\r\n            new THREE.EllipseCurve(\r\n                -traj.sma * traj.ecc - projectedRelativeCameraPosition.x,\r\n                -projectedRelativeCameraPosition.y,\r\n                traj.sma,\r\n                traj.sma * Math.sqrt(1 - traj.ecc * traj.ecc),\r\n                ang,\r\n                TWO_PI + ang - 1e-13,  // protection from rounding errors\r\n                false,\r\n                0\r\n            ),\r\n            pointsNum,\r\n            ((cameraAngle - ang) / TWO_PI + 1) % 1,\r\n            toFarthestPoint / toClosestPoint,\r\n            minAnglePart,\r\n            maxAnglePart\r\n        );\r\n\r\n        this.updateGeometry(ellipsePoints.coords, ellipsePoints.angs, endingBrightness);\r\n\r\n        this.threeObj.quaternion.copy(orbitQuaternion.toThreejs());\r\n        this.setPosition(projectedCameraPosition);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param curve {EllipseCurve} - instance of THREE.EllipseCurve\r\n     * @param pointsNum {int} - number of points to get (or less, if maxAnglePart is less than 1)\r\n     * @param densityCenter {number} - part of the angle (from 0 to 1) closest to the camera,\r\n     *                                which means this area should have more points\r\n     * @param proportion {number} - point density difference between densityCenter and\r\n     *                              the opposite side of the ellipse\r\n     * @param minAnglePart {number} - must be between 0 and 1, where 1 means two pi.\r\n     * @param maxAnglePart {number} - must be between 0 and 1, where 1 means two pi.\r\n     * @returns {{coords: Array, angs: Array}}\r\n     */\r\n    getEllipsePoints(curve, pointsNum, densityCenter, proportion, minAnglePart, maxAnglePart) {\r\n        let nearSegmentSize = 0.25;\r\n        if (proportion > 30) {\r\n            nearSegmentSize = 1 / Math.min(proportion / 60 + 3.5, 12);\r\n            proportion = 30;\r\n        }\r\n\r\n        let coords = [];\r\n        let angs = [];\r\n        const segments = pointsNum - 3;\r\n        const otherSegmentsSize = (1 - nearSegmentSize) / 3;\r\n        const segmentsFar    = Math.floor(segments / (proportion + 2 * Math.sqrt(proportion) + 1));\r\n        const segmentsMedium = Math.floor(Math.sqrt(proportion) * segmentsFar);\r\n        const segmentsNear   = segments - segmentsFar - 2 * segmentsMedium;\r\n        let segmentBounds = [0,0,0,0,0];\r\n        let segmentSteps = [\r\n            nearSegmentSize/segmentsNear,\r\n            otherSegmentsSize/segmentsMedium,\r\n            otherSegmentsSize/segmentsFar,\r\n            otherSegmentsSize/segmentsMedium\r\n        ];\r\n        let curPos = minAnglePart;\r\n\r\n        segmentBounds[0] = densityCenter - nearSegmentSize / 2;\r\n        if (segmentBounds[0] < 0)\r\n            segmentBounds[0] += 1;\r\n        segmentBounds[1] = segmentBounds[0] + nearSegmentSize;\r\n        if (segmentBounds[1] > 1)\r\n            segmentBounds[1] -= 1;\r\n        for (let i = 2; i <= 4; ++i) {\r\n            segmentBounds[i] = segmentBounds[i - 1] + otherSegmentsSize;\r\n            if (segmentBounds[i] > 1)\r\n                segmentBounds[i] -= 1;\r\n        }\r\n\r\n        while (curPos < maxAnglePart) {\r\n            if (curPos >= minAnglePart) {\r\n                coords.push(curve.getPoint(curPos));\r\n                angs.push((curPos - minAnglePart) / (maxAnglePart - minAnglePart));\r\n            }\r\n            let i = 0;\r\n            while (i < 4) {\r\n                if ((segmentBounds[i+1] > segmentBounds[i]\r\n                    && (segmentBounds[i] <= curPos && curPos < segmentBounds[i+1]))\r\n                    || (segmentBounds[i+1] < segmentBounds[i]\r\n                        && (segmentBounds[i] <= curPos || curPos < segmentBounds[i+1]))\r\n                ) {\r\n                    break;\r\n                }\r\n                ++i;\r\n            }\r\n            curPos += segmentSteps[i];\r\n        }\r\n        coords.push(curve.getPoint(maxAnglePart));\r\n        angs.push(maxAnglePart);\r\n\r\n        return {\r\n            coords: coords,\r\n            angs: angs\r\n        }\r\n    }\r\n}\r\n","import {Quaternion, Vector} from \"../algebra\";\r\nimport StateVector from \"../StateVector\";\r\nimport {RF_BASE} from \"./Factory\";\r\nimport ReferenceFrameFactory from \"./Factory\";\r\nimport { sim } from \"../Simulation\";\r\n\r\nexport default class ReferenceFrameAbstract\r\n{\r\n    setId(id) {\r\n        this.id = id;\r\n        this.originId = ReferenceFrameFactory.getOriginIdByReferenceFrameId(id);\r\n        this.type = ReferenceFrameFactory.getTypeByReferenceFrameId(id);\r\n        return this;\r\n    }\r\n\r\n    get mu() {\r\n        if (this._mu === undefined) {\r\n            const obj = sim.starSystem.getObject(this.originId);\r\n            this._mu = obj.physicalModel\r\n                ? obj.physicalModel.mu\r\n                : null;\r\n        }\r\n        return this._mu;\r\n    }\r\n\r\n    getQuaternionByEpoch(epoch) {\r\n        return new Quaternion();\r\n    }\r\n\r\n    getOriginPositionByEpoch(epoch) {\r\n        return new Vector(3);\r\n    }\r\n\r\n    getOriginStateByEpoch(epoch) {\r\n        return new StateVector();\r\n    }\r\n\r\n    transformStateVectorByEpoch(epoch, state, destinationFrameOrId) {\r\n        let destinationFrame = (destinationFrameOrId instanceof ReferenceFrameAbstract)\r\n            ? destinationFrameOrId\r\n            : sim.starSystem.getReferenceFrame(destinationFrameOrId);\r\n\r\n        if (this === destinationFrame) {\r\n            return state;\r\n        }\r\n\r\n        if (this.id === RF_BASE) {\r\n            return destinationFrame.stateVectorFromBaseReferenceFrameByEpoch(\r\n                epoch,\r\n                state\r\n            );\r\n        }\r\n\r\n        if (destinationFrame.id === RF_BASE) {\r\n            return this.stateVectorToBaseReferenceFrameByEpoch(epoch, state);\r\n        }\r\n\r\n        return destinationFrame.stateVectorFromBaseReferenceFrameByEpoch(\r\n            epoch,\r\n            this.stateVectorToBaseReferenceFrameByEpoch(epoch, state)\r\n        );\r\n    }\r\n\r\n    transformPositionByEpoch(epoch, pos, destinationFrameOrId) {\r\n        return this.transformStateVectorByEpoch(\r\n            epoch,\r\n            new StateVector(pos),\r\n            destinationFrameOrId\r\n        ).position;\r\n    }\r\n\r\n    rotateVectorByEpoch(epoch, vec, destinationFrameOrId) {\r\n        let destinationFrame = (destinationFrameOrId instanceof ReferenceFrameAbstract)\r\n            ? destinationFrameOrId\r\n            : sim.starSystem.getReferenceFrame(destinationFrameOrId);\r\n\r\n        if (this === destinationFrame) {\r\n            return vec.copy();\r\n        }\r\n\r\n        return destinationFrame.getQuaternionByEpoch(epoch).invert_().mul_(this.getQuaternionByEpoch(epoch)).rotate(vec);\r\n    }\r\n\r\n    stateVectorFromBaseReferenceFrameByEpoch(epoch, state) {}\r\n    stateVectorToBaseReferenceFrameByEpoch(epoch, state) {}\r\n}\r\n","export default class FunctionOfEpochAbstract\r\n{\r\n    evaluate(epoch) {\r\n        return null;\r\n    }\r\n}\r\n","import TrajectoryAbstract from \"./Abstract\";\r\nimport ExceptionOutOfRange from \"./ExceptionOutOfRange\";\r\n\r\nexport default class TrajectoryComposite extends TrajectoryAbstract\r\n{\r\n    constructor() {\r\n        super();\r\n        this.components = [];\r\n        this.lastUsedTrajectory = null;\r\n    }\r\n\r\n    select() {\r\n        this.isSelected = true;\r\n        if (this.selectedVisualModel) {\r\n            this.visualModel.hide();\r\n            this.selectedVisualModel.show();\r\n            this.selectedVisualModel.select();\r\n        } else {\r\n            this.visualModel && this.visualModel.select();\r\n        }\r\n        this.components.map(traj => traj.select());\r\n    }\r\n\r\n    deselect() {\r\n        super.deselect();\r\n        this.components.map(traj => traj.deselect());\r\n    }\r\n\r\n    drop() {\r\n        super.drop();\r\n        this.components.map(traj => traj.drop());\r\n    }\r\n\r\n    setObject(object) {\r\n        super.setObject(object);\r\n        this.components.map(traj => traj.setObject(object));\r\n    }\r\n\r\n    getReferenceFrameByEpoch(epoch) {\r\n        return this.getComponentByEpoch(epoch).getReferenceFrameByEpoch(epoch);\r\n    }\r\n\r\n    getStateInOwnFrameByEpoch(epoch) {\r\n        return this.getComponentByEpoch(epoch).getStateInOwnFrameByEpoch(epoch);\r\n    }\r\n\r\n    getKeplerianObjectByEpoch(epoch) {\r\n        return this.getComponentByEpoch(epoch).getKeplerianObjectByEpoch(epoch);\r\n    }\r\n\r\n    getStateByEpoch(epoch, referenceFrameOrId, frameEpoch = null) {\r\n        return this.getComponentByEpoch(epoch).getStateByEpoch(epoch, referenceFrameOrId, frameEpoch);\r\n    }\r\n\r\n    getComponentByEpoch(epoch) {\r\n        if (this.lastUsedTrajectory\r\n            && (this.lastUsedTrajectory.minEpoch === false || this.lastUsedTrajectory.minEpoch <= epoch)\r\n            && (this.lastUsedTrajectory.maxEpoch === false || this.lastUsedTrajectory.maxEpoch >= epoch)\r\n        ) {\r\n            return this.lastUsedTrajectory;\r\n        }\r\n\r\n        for (let trajectory of this.components) {\r\n            if (trajectory.isValidAtEpoch(epoch)) {\r\n                this.lastUsedTrajectory = trajectory;\r\n                return trajectory;\r\n            }\r\n        }\r\n\r\n        throw new ExceptionOutOfRange(this.object, this, epoch, this.minEpoch, this.maxEpoch);\r\n    }\r\n\r\n    addComponent(trajectory) {\r\n        this.components.push(trajectory);\r\n        trajectory.setParent(this);\r\n        trajectory.setObject(this.object);\r\n\r\n        if (this.isSelected) {\r\n            trajectory.select();\r\n        }\r\n\r\n        if (this.minEpoch === false\r\n            || (trajectory.minEpoch !== false\r\n                && this.minEpoch > trajectory.minEpoch\r\n            )\r\n        ) {\r\n            this.minEpoch = trajectory.minEpoch;\r\n        }\r\n        if (this.maxEpoch === false\r\n            || (trajectory.maxEpoch !== false\r\n                && this.maxEpoch < trajectory.maxEpoch\r\n            )\r\n        ) {\r\n            this.maxEpoch = trajectory.maxEpoch;\r\n        }\r\n    }\r\n\r\n    clearAfterEpoch(epoch) {\r\n        while (this.components[this.components.length - 1].minEpoch >= epoch) {\r\n            this.components[this.components.length - 1].drop();\r\n            this.components.pop();\r\n        }\r\n        for (let component of this.components) {\r\n            if (component.maxEpoch === false || component.maxEpoch > epoch) {\r\n                component.clearAfterEpoch(epoch);\r\n            }\r\n        }\r\n        this.lastUsedTrajectory = null;\r\n    }\r\n}\r\n","\r\nimport FlightEventAbstract from \"../../../core/FlightEvent/Abstract\";\r\n\r\nexport default class FlightEventSOIChangeAbstract extends FlightEventAbstract\r\n{\r\n    constructor(epoch, oldSoi, newSoi) {\r\n        super(epoch);\r\n        this.oldSoi = oldSoi || false;\r\n        this.newSoi = newSoi || false;\r\n    }\r\n\r\n    set(flightEvent) {\r\n        super.set(flightEvent);\r\n        this.oldSoi = flightEvent.oldSoi;\r\n        this.newSoi = flightEvent.newSoi;\r\n        return this;\r\n    }\r\n}\r\n","\r\nimport VisualSpriteStatic from \"../SpriteStatic\";\r\nimport FunctionOfEpochCustom from \"../../FunctionOfEpoch/Custom\";\r\nimport {RF_BASE_OBJ} from \"../../ReferenceFrame/Factory\";\r\n\r\nexport default class VisualFlightEventAbstract extends VisualSpriteStatic\r\n{\r\n    constructor(trajectory, flightEvent, color) {\r\n        super(color);\r\n\r\n        this._flightEvent = flightEvent;\r\n        this._trajectory = trajectory;\r\n\r\n        this.setPositionOfEpoch(new FunctionOfEpochCustom(epoch => {\r\n            if (epoch > this._flightEvent.epoch) {\r\n                return false;\r\n            }\r\n            return this._trajectory.getPositionByEpoch(this._flightEvent.epoch, RF_BASE_OBJ, epoch)\r\n        }));\r\n    }\r\n}\r\n","import * as THREE from \"three\";\r\n\r\nimport VisualModelAbstract from \"../ModelAbstract\";\r\nimport LineObject from \"../LineObject\";\r\nimport { sim } from \"../../Simulation\";\r\n\r\nexport default class VisualTrajectoryAbstract extends VisualModelAbstract\r\n{\r\n    /**\r\n     * @param trajectory {TrajectoryAbstract}\r\n     * @param config {Object} Fields:\r\n     *      color            - base color of the trajectory\r\n     *      selectedColor    - color when selected\r\n     *      minEpoch/        - (float)   epoch, trajectory is not rendered before/after this moment.\r\n     *      maxEpoch           (false)   there's no limit. for times before/after\r\n     *                                   minEpoch/maxEpoch of the trajectory, minEpoch/maxEpoch\r\n     *                                   of the trajectory is used.\r\n     *                         ('copy')  minEpoch/maxEpoch of the trajectory is used\r\n     */\r\n    constructor(trajectory, config) {\r\n        super();\r\n\r\n        this.trajectory = trajectory;\r\n        this.color = config.color;\r\n        this.config = config;\r\n\r\n        this._isSelected = false;\r\n\r\n        this.initFlightEvents();\r\n\r\n        this._markers = {};\r\n        this._defaultMarkerScale  = 0.5;\r\n        this._selectedMarkerScale = 1;\r\n\r\n        this._minEpoch = (config.minEpoch !== undefined) ? config.minEpoch : (trajectory.minEpoch || false);\r\n        this._maxEpoch = (config.maxEpoch !== undefined) ? config.maxEpoch : (trajectory.maxEpoch || false);\r\n\r\n        if (this.constructor.NO_THREE_OBJ) {\r\n            return;\r\n        }\r\n\r\n        this.setThreeObj(new LineObject(\r\n            new THREE.Geometry(),\r\n            new THREE.LineBasicMaterial({vertexColors: THREE.VertexColors})\r\n        ));\r\n\r\n        this.point = new THREE.Mesh(\r\n            new THREE.SphereGeometry(1, 8, 8),\r\n            new THREE.MeshBasicMaterial({color: this.color})\r\n        );\r\n        this.scene.add(this.point);\r\n        this.pointSize = 4;\r\n\r\n        this.threeObj.userData = {selectionObject: () => this.trajectory.object};\r\n        sim.selection.addSelectableObject(this.threeObj);\r\n    }\r\n\r\n    get minEpoch() {\r\n        return (this._minEpoch === 'copy')\r\n            ? this.trajectory.minEpoch\r\n            : this._minEpoch;\r\n    }\r\n\r\n    get maxEpoch() {\r\n        return (this._maxEpoch === 'copy')\r\n            ? this.trajectory.maxEpoch\r\n            : this._maxEpoch;\r\n    }\r\n\r\n    getEpochByPoint(point) {\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param handler {Function} - this function is called when user clicks on the trajectory.\r\n     *                             Epoch that corresponds to the point under the mouse is passed\r\n     *                             as the only argument.\r\n     */\r\n    onClick(handler) {\r\n        this.threeObj.userData.onClick = (intersection) => handler(\r\n            this.getEpochByPoint(sim.getSimCoords(intersection.point))\r\n        );\r\n    }\r\n\r\n    initFlightEvents() {\r\n        this.flightEvents = [];\r\n        for (let event of this.trajectory.flightEvents) {\r\n            this.addFlightEvent(event);\r\n        }\r\n    }\r\n\r\n    addFlightEvent(flightEvent) {\r\n        const className = flightEvent.getVisualClass();\r\n        if (!className) {\r\n            return;\r\n        }\r\n        \r\n        let model = new className(this.trajectory, flightEvent, this.color);\r\n        if (!this.trajectory.isSelected) {\r\n            model.setScale(0.5);\r\n        }\r\n        flightEvent.visualModel = model;\r\n        this.flightEvents.push({\r\n            event: flightEvent,\r\n            model: model\r\n        });\r\n    }\r\n\r\n    removeFlightEvent(flightEvent) {\r\n        for (let i in this.flightEvents) {\r\n            if (this.flightEvents[i].event === flightEvent) {\r\n                this.flightEvents[i].model.drop();\r\n                this.flightEvents.splice(i, 1);\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    updateGeometry(points, colorMults, endingBrightness) {\r\n        const mainColor = new THREE.Color(this.color);\r\n        this.threeObj.geometry.dispose();\r\n        this.threeObj.geometry = (new THREE.Geometry()).setFromPoints(points);\r\n\r\n        for (let i = 0; i < colorMults.length; i++) {\r\n            let curColor = (new THREE.Color()).copy(mainColor);\r\n            const mult = endingBrightness + (1 - endingBrightness) * colorMults[i];\r\n\r\n            this.threeObj.geometry.colors.push(\r\n                curColor.multiplyScalar(mult)\r\n            );\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Returns moment in time to use to calculate position\r\n     * of the spacecraft relative to its reference frame.\r\n     * false means the trajectory is not rendered.\r\n     * @param epoch\r\n     * @returns {*}\r\n     */\r\n    getPositionEpoch(epoch) {\r\n        if ((this.minEpoch !== false && epoch < this.minEpoch)\r\n            || (this.maxEpoch !== false && epoch > this.maxEpoch)\r\n        ) {\r\n            return false;\r\n        }\r\n\r\n        if (this.trajectory.minEpoch !== false && epoch < this.trajectory.minEpoch) {\r\n            return this.trajectory.minEpoch;\r\n        }\r\n        if (this.trajectory.maxEpoch !== false && epoch > this.trajectory.maxEpoch) {\r\n            return this.trajectory.maxEpoch;\r\n        }\r\n\r\n        return epoch;\r\n    }\r\n\r\n    render(epoch) {\r\n        if (!this.trajectory.isValidAtEpoch(epoch) || this._isHidden) {\r\n            this.point.visible = false;\r\n            return;\r\n        }\r\n\r\n        this.point.position.copy(sim.getVisualCoords(this.trajectory.getPositionByEpoch(epoch)));\r\n        let scaleKoeff = this.pointSize * this.point.position.length() * this.pixelAngleSize;\r\n        const ko = this.trajectory.getKeplerianObjectByEpoch(epoch);\r\n\r\n        if (ko.isElliptic && ko.sma < scaleKoeff) {\r\n            this._updateMarkerScales(0);\r\n            this.point.visible = false;\r\n            return;\r\n        }\r\n\r\n        if (ko.isElliptic && scaleKoeff > ko.sma / 5) {\r\n            this._updateMarkerScales(ko.sma / 5 / scaleKoeff);\r\n            scaleKoeff = ko.sma / 5;\r\n        } else {\r\n            this._updateMarkerScales();\r\n        }\r\n\r\n        this.point.visible = true;\r\n        this.point.scale.x = scaleKoeff;\r\n        this.point.scale.y = scaleKoeff;\r\n        this.point.scale.z = scaleKoeff;\r\n    }\r\n\r\n    select() {\r\n        this._isSelected = true;\r\n        this.setColor(this.config.selectedColor || 0xFFFFFF);\r\n        this._updateScales();\r\n    }\r\n\r\n    deselect() {\r\n        this._isSelected = false;\r\n        this.setColor(this.config.color);\r\n        this._updateScales();\r\n    }\r\n\r\n    hide() {\r\n        super.hide();\r\n        this.point.visible = false;\r\n    }\r\n\r\n    _updateScales() {\r\n        for (let event of this.flightEvents) {\r\n            event.model.setScale(this._isSelected ? 1 : 0.5);\r\n        }\r\n        this._updateMarkerScales();\r\n    }\r\n\r\n    _updateMarkerScales(multiplier) {\r\n        if (multiplier === undefined)\r\n            multiplier = 1;\r\n        for (let k in this._markers) {\r\n            if (multiplier < 0.1) {\r\n                this._markers[k].hide();\r\n            } else {\r\n                this._markers[k].show();\r\n                this._markers[k].setScale(\r\n                    (this._isSelected ? this._selectedMarkerScale : this._defaultMarkerScale)\r\n                    * multiplier\r\n                );\r\n            }\r\n        }\r\n    }\r\n\r\n    setColor(color) {\r\n        this.color = color;\r\n        if (this.point) {\r\n            this.point.material.color.set(this.color);\r\n            this.point.material.needsUpdate = true;\r\n        }\r\n        for (let event of this.flightEvents) {\r\n            event.model.setColor(color);\r\n        }\r\n        for (let k in this._markers) {\r\n            this._markers[k].setColor(color);\r\n        }\r\n    }\r\n\r\n    drop() {\r\n        this.threeObj && sim.selection.removeSelectableObject(this.threeObj);\r\n\r\n        for (let k in this._markers) {\r\n            this._markers[k].drop();\r\n        }\r\n        for (let event of this.flightEvents) {\r\n            event.model.drop();\r\n        }\r\n        delete this.flightEvents;\r\n\r\n        if (this.point) {\r\n            this.scene.remove(this.point);\r\n            if (this.point.geometry) {\r\n                this.point.geometry.dispose();\r\n            }\r\n            if (this.point.material) {\r\n                this.point.material.dispose();\r\n            }\r\n            delete this.point;\r\n        }\r\n\r\n        super.drop();\r\n    }\r\n}\r\n","import * as THREE from \"three\";\r\n\r\nexport default class VirtualPlane extends THREE.Plane\r\n{\r\n    raycast(raycaster, intersects) {\r\n\r\n        this.visible = true; //it's actually not. Visibility is true only to satisfy raycaster.\r\n\r\n        const d = this.constant / raycaster.ray.direction.dot(this.normal);\r\n\r\n        if (d < 0) {\r\n            return;\r\n        }\r\n\r\n        let intersectionPoint = raycaster.ray.direction.clone().multiplyScalar(d);\r\n\r\n        intersects.push({\r\n            distance  : intersectionPoint.length(),\r\n            point     : intersectionPoint,\r\n            index     : 0,\r\n            face      : null,\r\n            faceIndex : null,\r\n            object    : this\r\n        });\r\n    }\r\n}\r\n","import * as THREE from \"three\";\r\n\r\nimport LineObject from \"./LineObject\";\r\n\r\nexport default class ArrowObject extends THREE.ArrowHelper\r\n{\r\n    constructor(dir, origin, length, color, headLength, headWidth) {\r\n        super(dir, origin, length, color, headLength, headWidth);\r\n        this.remove(this.line);\r\n        this.line = new LineObject(this.line.geometry, this.line.material);\r\n        this.add(this.line);\r\n    }\r\n}\r\n","import * as THREE from \"three\";\r\n\r\nimport Constant from \"../FunctionOfEpoch/Constant\";\r\nimport VisualModelAbstract from \"./ModelAbstract\";\r\nimport {RF_BASE} from \"../ReferenceFrame/Factory\";\r\nimport VirtualPlane from \"./VirtualPlane\";\r\nimport {TWO_PI} from \"../algebra\";\r\nimport ArrowObject from \"./Arrow\";\r\nimport { sim } from \"../Simulation\";\r\n\r\nexport default class VisualAngle extends VisualModelAbstract\r\n{\r\n    constructor(referenceFrame, position, orientation, value, color, size, type, editingCallback) {\r\n        super();\r\n\r\n        this._referenceFrame = referenceFrame;\r\n        this._position = position;\r\n        this._orientation = orientation;\r\n        this._value = value;\r\n        this.color = color;\r\n        this.type = type;\r\n        this.arcSize = size;\r\n        this.editingCallback = editingCallback;\r\n        this.isEditMode = !!editingCallback;\r\n        this.bounds = [0, TWO_PI];\r\n        this.customPriority = 0;\r\n\r\n        this.orientationUpdated = false;\r\n        this.valueUpdated = false;\r\n        this.sizeNeedsUpdate = false;\r\n\r\n        this.init();\r\n    }\r\n\r\n    setBounds(minValue, maxValue) {\r\n        this.bounds = [minValue, maxValue];\r\n    }\r\n\r\n    getReferenceFrame(epoch) {\r\n        return this._referenceFrame.evaluate(epoch);\r\n    }\r\n\r\n    getPosition(epoch) {\r\n        return this._position.evaluate(epoch);\r\n    }\r\n\r\n    getOrientation(epoch) {\r\n        return this._orientation.evaluate(epoch);\r\n    }\r\n\r\n    getValue(epoch) {\r\n        return this._value.evaluate(epoch);\r\n    }\r\n\r\n    init() {\r\n        this.onWheelListener = this.onMouseWheel.bind(this);\r\n        document.addEventListener('wheel', this.onWheelListener);\r\n\r\n        if (this.isEditMode) {\r\n            this.mouseDownListener = this.onMouseDown.bind(this);\r\n            document.addEventListener('mousedown', this.mouseDownListener);\r\n        }\r\n\r\n        this.sizeNeedsUpdate = true;\r\n\r\n        if (this.type === VisualAngle.TYPE_ARC) {\r\n            this.createArcObject();\r\n        } else {\r\n            this.createSectorObject();\r\n        }\r\n        this.valueUpdated = true;\r\n        this.orientationUpdated = true;\r\n    }\r\n\r\n    onMouseWheel() {\r\n        this.sizeNeedsUpdate = true;\r\n    }\r\n\r\n    onMouseDown(event) {\r\n        let intersection;\r\n        if (this.type === VisualAngle.TYPE_ARC) {\r\n            intersection = sim.raycaster.intersectObjects([this.threeAngle.line])[0];\r\n        } else {\r\n            intersection = sim.raycaster.intersectObjects(\r\n                [this.threeAngle.children[0].line, this.threeAngle.children[0].cone]\r\n            )[0];\r\n        }\r\n\r\n        if (intersection && (event.button == 0)) { //check if the mouse button pressed is left\r\n            this.mouseUpListener = this.onMouseUp.bind(this);\r\n            document.addEventListener('mouseup', this.mouseUpListener);\r\n            this.mouseMoveListener = this.onMouseMove.bind(this);\r\n            sim.addEventListener('mousemove', this.mouseMoveListener, 2 + this.customPriority / 100);\r\n        }\r\n    }\r\n\r\n    onMouseUp(event) {\r\n        document.removeEventListener('mouseup', this.mouseUpListener);\r\n        sim.removeEventListener('mousemove', this.mouseMoveListener);\r\n    }\r\n\r\n    onMouseMove() {\r\n        const plane = this.getVirtualPlane();\r\n        let intersection = sim.raycaster.intersectObjects([plane])[0];\r\n        if (intersection) {\r\n            const direction = intersection.point\r\n                .clone()\r\n                .sub(this.threeObj.position)\r\n                .normalize();\r\n            let mainAxis = new THREE.Vector3(1, 0, 0);\r\n            mainAxis.applyQuaternion(this.threeObj.quaternion);\r\n\r\n            const oldAngleValue = this._value.value;\r\n            let newAngleValue = Math.acos(mainAxis.dot(direction) / mainAxis.length() / direction.length()); // no division by lengths because direction and mainAxis are normalized (length = 1)\r\n            mainAxis.cross(direction);\r\n\r\n            newAngleValue = (mainAxis.dot(plane.normal) > 0) ? newAngleValue : TWO_PI - newAngleValue;\r\n\r\n            if (newAngleValue < this.bounds[0] || newAngleValue > this.bounds[1]) {\r\n                const lowDiff  = (this.bounds[0] - newAngleValue + TWO_PI) % TWO_PI;\r\n                const highDiff = (newAngleValue - this.bounds[1] + TWO_PI) % TWO_PI;\r\n                if (lowDiff <= highDiff) {\r\n                    newAngleValue = this.bounds[0];\r\n                } else {\r\n                    newAngleValue = this.bounds[1];\r\n                }\r\n            }\r\n\r\n            if (newAngleValue !== oldAngleValue) {\r\n                this._value.value = newAngleValue;\r\n                this.valueUpdated = true;\r\n                if (this.editingCallback) {\r\n                    this.editingCallback(this._value.value);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    getVirtualPlane() {\r\n        let normal = new THREE.Vector3(0, 0, 1);\r\n        normal.applyQuaternion(this.threeObj.quaternion);\r\n        const angle = Math.acos(normal.dot(this.threeObj.position) / this.threeObj.position.length() / normal.length());\r\n        const distance = this.threeObj.position.length() * Math.cos(angle);\r\n\r\n        if (this.virtualPlane) {\r\n            this.virtualPlane.normal.copy(normal);\r\n            this.virtualPlane.constant = distance;\r\n        } else {\r\n            this.virtualPlane = new VirtualPlane(normal, distance);\r\n        }\r\n\r\n        return this.virtualPlane;\r\n    }\r\n\r\n    createArcObject() {\r\n        let material = new THREE.LineBasicMaterial({color: this.color});\r\n        let threeObj = new THREE.Object3D();\r\n\r\n        this.threeArc = new THREE.Line(new THREE.Geometry(), material);\r\n        this.threeMainAxis = new THREE.Line(new THREE.Geometry(), material);\r\n        this.threeAngle = new THREE.Line(new THREE.Geometry(), material);\r\n\r\n        this.threeMainAxis.geometry.vertices.push(\r\n            new THREE.Vector3(0, 0, 0),\r\n            new THREE.Vector3(1, 0, 0),\r\n        );\r\n        this.threeAngle.geometry.vertices.push(\r\n            new THREE.Vector3(0, 0, 0),\r\n            new THREE.Vector3(1, 0, 0),\r\n        );\r\n\r\n        threeObj.add(this.threeArc);\r\n        threeObj.add(this.threeMainAxis);\r\n        threeObj.add(this.threeAngle);\r\n        threeObj.scale.set(this.size, this.size, this.size);\r\n\r\n        this.setThreeObj(threeObj);\r\n    }\r\n\r\n    updateArcObject(value) {\r\n        if (value < 0) {\r\n            value -= 2 * Math.PI * Math.floor(value / 2 / Math.PI);\r\n        }\r\n        // todo: optimize this\r\n        this.threeArc.geometry.dispose();\r\n        this.threeArc.geometry = new THREE.Geometry();\r\n        this.threeArc.geometry.setFromPoints(\r\n            (new THREE.EllipseCurve(\r\n                0, 0,\r\n                1 / 3,\r\n                1 / 3,\r\n                0, value,\r\n                false,\r\n                0\r\n            )).getPoints(Math.ceil(value * 30))\r\n        );\r\n    }\r\n\r\n    createSectorObject() {\r\n        let material = new THREE.MeshBasicMaterial({\r\n            color: this.color,\r\n            opacity: 0.175,\r\n            transparent: true,\r\n            side: THREE.DoubleSide\r\n        });\r\n        let threeObj = new THREE.Object3D();\r\n\r\n        this.threeArc = new THREE.Mesh(new THREE.Geometry(), material);\r\n        this.threeMainAxis = new ArrowObject(\r\n            new THREE.Vector3(1, 0, 0),\r\n            new THREE.Vector3(0, 0, 0),\r\n            1,\r\n            this.color\r\n        );\r\n        this.threeAngle = new THREE.Object3D();\r\n        this.threeAngle.add(new ArrowObject(\r\n            new THREE.Vector3(1, 0, 0),\r\n            new THREE.Vector3(0, 0, 0),\r\n            1,\r\n            this.isEditMode ? 0xc2f442 : this.color\r\n        ));\r\n\r\n        threeObj.add(this.threeArc);\r\n        threeObj.add(this.threeMainAxis);\r\n        threeObj.add(this.threeAngle);\r\n        threeObj.scale.set(this.size, this.size, this.size);\r\n\r\n        this.setThreeObj(threeObj);\r\n    }\r\n\r\n    updateSectorObject(value) {\r\n        if (value < 0) {\r\n            value -= 2 * Math.PI * Math.floor(value / 2 / Math.PI);\r\n        }\r\n        // todo: optimize this\r\n        this.threeArc.geometry.dispose();\r\n        this.threeArc.geometry = new THREE.CircleGeometry(\r\n            1,\r\n            Math.ceil(value * 30),\r\n            0,\r\n            value\r\n        );\r\n    }\r\n\r\n    drop() {\r\n        super.drop();\r\n        delete this.threeMainAxis;\r\n        delete this.threeAngle;\r\n        delete this.threeArc;\r\n        document.removeEventListener('wheel', this.onWheelListener);\r\n        if (this.mouseDownListener) {\r\n            document.removeEventListener('mousedown', this.mouseDownListener);\r\n        }\r\n    }\r\n\r\n    render(epoch) {\r\n        const referenceFrame = this.getReferenceFrame(epoch);\r\n        const pos = referenceFrame.transformPositionByEpoch(\r\n            epoch,\r\n            this.getPosition(epoch),\r\n            RF_BASE\r\n        );\r\n        this.setPosition(pos);\r\n\r\n        if (this.valueUpdated || !(this._value instanceof Constant)) {\r\n            const value = this.getValue(epoch);\r\n            if (this.type === VisualAngle.TYPE_ARC) {\r\n                this.updateArcObject(value);\r\n            } else {\r\n                this.updateSectorObject(value);\r\n            }\r\n            this.threeAngle.rotation.z = value;\r\n            this.valueUpdated = false;\r\n        }\r\n\r\n        if (this.orientationUpdated || !(this._orientation instanceof Constant)) {\r\n            this.threeObj.quaternion.copy(referenceFrame.getQuaternionByEpoch(epoch).mul_(this.getOrientation(epoch)).toThreejs());\r\n            this.orientationUpdated = false;\r\n        }\r\n\r\n        if (this.sizeNeedsUpdate) {\r\n            this.size = this.threeObj.position.length() / 6 * this.arcSize;\r\n            this.threeObj.scale.set(this.size, this.size, this.size);\r\n            this.sizeNeedsUpdate = false;\r\n        }\r\n    }\r\n}\r\n\r\nVisualAngle.TYPE_ARC    = 'arc';\r\nVisualAngle.TYPE_SECTOR = 'sector';\r\n","import * as THREE from \"three\";\r\nimport VisualModelAbstract from \"./ModelAbstract\";\r\nimport {RF_BASE, RF_BASE_OBJ} from \"../ReferenceFrame/Factory\";\r\nimport VirtualPlane from \"./VirtualPlane\";\r\nimport {Vector} from \"../algebra\";\r\nimport { sim } from \"../Simulation\";\r\n\r\nexport default class VisualPlanePoint extends VisualModelAbstract\r\n{\r\n    constructor(referenceFrame, value, color, size, editingCallback, minBound, maxBound) {\r\n        super();\r\n\r\n        this._referenceFrame = referenceFrame;\r\n        this._value = value;\r\n        this.color = color;\r\n        this.size = size;\r\n        this.editingCallback = editingCallback;\r\n        this.minBound = minBound;\r\n        this.maxBound = maxBound;\r\n\r\n        this.isEditMode = !!editingCallback;\r\n\r\n        this.lastEpoch = 0;\r\n\r\n        this.init();\r\n    }\r\n\r\n    getReferenceFrame(epoch) {\r\n        return this._referenceFrame.evaluate(epoch);\r\n    }\r\n\r\n    init() {\r\n        this.setThreeObj(new THREE.Mesh(\r\n            new THREE.SphereGeometry(1, 8, 8),\r\n            new THREE.MeshBasicMaterial({color: this.color})\r\n        ));\r\n\r\n        if (this.isEditMode) {\r\n            this.mouseDownListener = this.onMouseDown.bind(this);\r\n            document.addEventListener('mousedown', this.mouseDownListener);\r\n        }\r\n    }\r\n\r\n    drop() {\r\n        super.drop();\r\n        if (this.mouseDownListener) {\r\n            document.removeEventListener('mousedown', this.mouseDownListener);\r\n        }\r\n    }\r\n\r\n    onMouseDown(event) {\r\n        if (event.button != 0) {\r\n            return;\r\n        }\r\n\r\n        let intersection = sim.raycaster.intersectObjects([this.threeObj])[0];\r\n        if (intersection && (event.button == 0)) { //check if the mouse button pressed is left\r\n            this.mouseUpListener = this.onMouseUp.bind(this);\r\n            document.addEventListener('mouseup', this.mouseUpListener);\r\n            this.mouseMoveListener = this.onMouseMove.bind(this);\r\n            sim.addEventListener('mousemove', this.mouseMoveListener, 3);\r\n        }\r\n    }\r\n\r\n    onMouseUp(event) {\r\n        document.removeEventListener('mouseup', this.mouseUpListener);\r\n        sim.removeEventListener('mousemove', this.mouseMoveListener);\r\n    }\r\n\r\n    onMouseMove() {\r\n        this.updateValue(this.lastEpoch);\r\n    }\r\n\r\n    updateValue(epoch) {\r\n        const plane = this.getVirtualPlane(epoch);\r\n        let intersection = sim.raycaster.intersectObjects([plane])[0];\r\n        if (intersection) {\r\n            const minBound = this.minBound(epoch);\r\n            const maxBound = this.maxBound(epoch);\r\n            this._value = RF_BASE_OBJ.transformPositionByEpoch(epoch, sim.getSimCoords(intersection.point), this.getReferenceFrame(epoch));\r\n\r\n            for (let idx of [0,1,2]) {\r\n                if (minBound[idx] !== false && this._value[idx] < minBound[idx]) {\r\n                    this._value[idx] = minBound[idx];\r\n                } else if (maxBound[idx] !== false && this._value[idx] > maxBound[idx]) {\r\n                    this._value[idx] = maxBound[idx];\r\n                }\r\n            }\r\n\r\n            if (this.editingCallback) {\r\n                this.editingCallback(this._value);\r\n            }\r\n        }\r\n    }\r\n\r\n    getVirtualPlane(epoch) {\r\n        const normal = (new THREE.Vector3()).fromArray(this.getReferenceFrame(epoch).getQuaternionByEpoch(epoch).rotate_(new Vector([0,0,1])));\r\n        const position = sim.getVisualCoords(this.getReferenceFrame(epoch).getOriginPositionByEpoch(epoch));\r\n        const angle = Math.acos(normal.dot(position) / position.length() / normal.length());\r\n        const distance = position.length() * Math.cos(angle);\r\n\r\n        if (this.virtualPlane) {\r\n            this.virtualPlane.normal.copy(normal);\r\n            this.virtualPlane.constant = distance;\r\n        } else {\r\n            this.virtualPlane = new VirtualPlane(normal, distance);\r\n        }\r\n\r\n        return this.virtualPlane;\r\n    }\r\n\r\n    render(epoch) {\r\n        this.lastEpoch = epoch;\r\n\r\n        this.setPosition(this.getReferenceFrame(epoch).transformPositionByEpoch(\r\n            epoch,\r\n            this._value,\r\n            RF_BASE\r\n        ));\r\n\r\n        const scaleKoeff = this.size * this.threeObj.position.length() * this.pixelAngleSize;\r\n        this.threeObj.scale.x = scaleKoeff;\r\n        this.threeObj.scale.y = scaleKoeff;\r\n        this.threeObj.scale.z = scaleKoeff;\r\n    }\r\n}","import FunctionOfEpochCustom from \"./FunctionOfEpoch/Custom\";\r\nimport {Quaternion, Vector} from \"./algebra\";\r\nimport VisualAngle from \"./visual/Angle\";\r\nimport Constant from \"./FunctionOfEpoch/Constant\";\r\nimport VisualPlanePoint from \"./visual/PlanePoint\";\r\nimport { sim } from \"./Simulation\";\r\n\r\nexport default class KeplerianEditor\r\n{\r\n    constructor(trajectory) {\r\n        this.isEditMode = trajectory.isEditable;\r\n        this.trajectory = trajectory;\r\n\r\n        this.colorRaan = 0x7FFFD4; //lightblue\r\n        this.colorAop  = 0x9966CC; //violet\r\n        this.colorInc  = 0xB00000; //red\r\n        this.colorTa   = 0xFC0FC0; //pink\r\n\r\n        if (sim.settings.ui.showAnglesOfSelectedOrbit) {\r\n            this.init();\r\n        }\r\n    }\r\n\r\n    init() {\r\n        let referenceFrame = new FunctionOfEpochCustom(epoch => this.trajectory.getReferenceFrameByEpoch(epoch));\r\n        let position = new Constant(new Vector(3));\r\n\r\n        this.angleRaan = new VisualAngle(\r\n            referenceFrame,\r\n            position,\r\n            new Constant(new Quaternion()),\r\n            new FunctionOfEpochCustom(epoch => this.trajectory.getKeplerianObjectByEpoch(epoch).raan),\r\n            this.colorRaan,\r\n            1.5,\r\n            this.isEditMode ? VisualAngle.TYPE_SECTOR : VisualAngle.TYPE_ARC,\r\n            this.isEditMode ? value => { this.trajectory.raan = value; } : null\r\n        );\r\n        this.angleRaan.customPriority = 4;\r\n\r\n        this.angleInc = new VisualAngle(\r\n            referenceFrame,\r\n            position,\r\n            new FunctionOfEpochCustom(epoch => {\r\n                const ko = this.trajectory.getKeplerianObjectByEpoch(epoch);\r\n                return (new Quaternion(new Vector([0,0,1]), ko.raan + Math.PI / 2))\r\n                    .mul_(new Quaternion(new Vector([1,0,0]), Math.PI / 2));\r\n            }),\r\n            new FunctionOfEpochCustom(epoch => this.trajectory.getKeplerianObjectByEpoch(epoch).inc),\r\n            this.colorInc,\r\n            2,\r\n            this.isEditMode ? VisualAngle.TYPE_SECTOR : VisualAngle.TYPE_ARC,\r\n            this.isEditMode ? value => { this.trajectory.inc = value; } : null\r\n        );\r\n        this.angleInc.setBounds(0, Math.PI);\r\n        this.angleInc.customPriority = 3;\r\n\r\n        this.angleAop = new VisualAngle(\r\n            referenceFrame,\r\n            position,\r\n            new FunctionOfEpochCustom(epoch => {\r\n                const ko = this.trajectory.getKeplerianObjectByEpoch(epoch);\r\n                return (new Quaternion(new Vector([0,0,1]), ko.raan))\r\n                    .mul_(new Quaternion(new Vector([1,0,0]), ko.inc));\r\n            }),\r\n            new FunctionOfEpochCustom(epoch => this.trajectory.getKeplerianObjectByEpoch(epoch).aop),\r\n            this.colorAop,\r\n            2.5,\r\n            this.isEditMode ? VisualAngle.TYPE_SECTOR : VisualAngle.TYPE_ARC,\r\n            this.isEditMode ? value => { this.trajectory.aop = value; } : null\r\n        );\r\n        this.angleAop.customPriority = 2;\r\n\r\n        this.angleTa = new VisualAngle(\r\n            referenceFrame,\r\n            position,\r\n            new FunctionOfEpochCustom(epoch => {\r\n                const ko = this.trajectory.getKeplerianObjectByEpoch(epoch);\r\n                return (new Quaternion(new Vector([0,0,1]), ko.raan))\r\n                    .mul_(new Quaternion(new Vector([1,0,0]), ko.inc))\r\n                    .mul_(new Quaternion(new Vector([0,0,1]), ko.aop));\r\n            }),\r\n            new FunctionOfEpochCustom(epoch => this.trajectory.getKeplerianObjectByEpoch(epoch).getTrueAnomalyByEpoch(epoch)),\r\n            this.colorTa,\r\n            3,\r\n            VisualAngle.TYPE_ARC\r\n        );\r\n\r\n        if (this.isEditMode) {\r\n            this.pointApoapsis = new VisualPlanePoint(\r\n                new Constant(this.trajectory.pericentricReferenceFrame),\r\n                new Vector([-this.trajectory.sma * (1 + this.trajectory.ecc), 0, 0]),\r\n                'red',\r\n                8,\r\n                value => {\r\n                    const periapsis = this.trajectory.sma * (1 - this.trajectory.ecc);\r\n                    const sma = (-value.x + periapsis) / 2;\r\n                    this.trajectory.sma = sma;\r\n                    this.trajectory.ecc = 1 - periapsis / sma;\r\n                },\r\n                () => [false, 0, 0],\r\n                () => [-this.trajectory.sma * (1 - this.trajectory.ecc), 0, 0]\r\n            );\r\n            this.pointPeriapsis = new VisualPlanePoint(\r\n                new Constant(this.trajectory.pericentricReferenceFrame),\r\n                new Vector([this.trajectory.sma * (1 - this.trajectory.ecc), 0, 0]),\r\n                'blue',\r\n                8,\r\n                value => {\r\n                    const apoapsis = this.trajectory.sma * (1 + this.trajectory.ecc);\r\n                    const sma = (value.x + apoapsis) / 2;\r\n                    this.trajectory.sma = sma;\r\n                    this.trajectory.ecc = apoapsis / sma - 1;\r\n                },\r\n                () => [0, 0, 0],\r\n                () => [this.trajectory.sma * (1 + this.trajectory.ecc), 0, 0]\r\n            );\r\n            this.angleTaEditing = new VisualAngle(\r\n                referenceFrame,\r\n                position,\r\n                new FunctionOfEpochCustom((epoch) => (new Quaternion(new Vector([0,0,1]), this.trajectory.raan))\r\n                        .mul_(new Quaternion(new Vector([1,0,0]), this.trajectory.inc))\r\n                        .mul_(new Quaternion(new Vector([0,0,1]), this.trajectory.aop))),\r\n                new Constant(this.trajectory.ta),\r\n                this.colorTa,\r\n                3,\r\n                VisualAngle.TYPE_SECTOR,\r\n                value => { this.trajectory.ta = value; }\r\n            );\r\n            this.angleTaEditing.customPriority = 1;\r\n\r\n        }\r\n    }\r\n\r\n    remove() {\r\n        this.angleRaan && this.angleRaan.drop();\r\n        this.angleAop && this.angleAop.drop();\r\n        this.angleInc && this.angleInc.drop();\r\n        this.angleTa && this.angleTa.drop();\r\n        this.angleTaEditing && this.angleTaEditing.drop();\r\n\r\n        this.pointApoapsis && this.pointApoapsis.drop();\r\n        this.pointPeriapsis && this.pointPeriapsis.drop();\r\n    }\r\n}\r\n","import StateVector from \"../StateVector\";\r\nimport {RF_BASE} from \"../ReferenceFrame/Factory\";\r\nimport KeplerianObject from \"../KeplerianObject\";\r\nimport ExceptionOutOfRange from \"./ExceptionOutOfRange\";\r\nimport FunctionOfEpochCustom from \"../FunctionOfEpoch/Custom\";\r\nimport ReferenceFrameInertialDynamic from \"../ReferenceFrame/InertialDynamic\";\r\nimport KeplerianEditor from \"../KeplerianEditor\";\r\nimport {Quaternion} from \"../algebra\";\r\nimport ReferenceFrameAbstract from \"../ReferenceFrame/Abstract\";\r\nimport { sim } from \"../Simulation\";\r\nimport Events from \"../Events\";\r\nimport FlightEventSOIDeparture from \"../../modules/PatchedConics/FlightEvent/SOIDeparture\";\r\nimport FlightEventSOIArrival from \"../../modules/PatchedConics/FlightEvent/SOIArrival\";\r\n\r\n/**\r\n * Fields:\r\n *  minEpoch/  - (float) time limits where the trajectory is defined\r\n *  maxEpoch     (false) there is no limit\r\n */\r\nexport default class TrajectoryAbstract\r\n{\r\n    constructor() {\r\n        this.minEpoch = false;\r\n        this.maxEpoch = false;\r\n\r\n        this.cachedEpoch = null;\r\n        this.cachedState = null;\r\n\r\n        this.visualModel = null;\r\n        this.selectedVisualModel = null;\r\n        this.object = null;\r\n\r\n        this.parent = null;\r\n\r\n        this.referenceFrame = null;\r\n\r\n        this.isEditable = false;\r\n        this.isSelected = false;\r\n        this.clickHandler = null;\r\n\r\n        this.flightEvents = [];\r\n\r\n        this.showOrbitAnglesListener = this._onShowOrbitAnglesChange.bind(this);\r\n\r\n        this.orbitalReferenceFrame = new ReferenceFrameInertialDynamic(\r\n            new FunctionOfEpochCustom(epoch => this.getStateByEpoch(epoch)),\r\n            new FunctionOfEpochCustom(epoch => {\r\n                const quat = this.getReferenceFrameByEpoch(epoch).getQuaternionByEpoch(epoch);\r\n                const state = this.getStateInOwnFrameByEpoch(epoch);\r\n                return quat.mul_(Quaternion.twoAxis(state._velocity, null, state._position));\r\n            }),\r\n        );\r\n\r\n        this.pericentricReferenceFrame = new ReferenceFrameInertialDynamic(\r\n            new FunctionOfEpochCustom((epoch) => {\r\n                return this.getReferenceFrameByEpoch(epoch).getOriginStateByEpoch(epoch);\r\n            }),\r\n            new FunctionOfEpochCustom((epoch) => {\r\n                const quat = this.getReferenceFrameByEpoch(epoch).getQuaternionByEpoch(epoch);\r\n                const ko = this.getKeplerianObjectByEpoch(epoch);\r\n                return quat.mul_(ko.getOrbitalFrameQuaternion());\r\n            })\r\n        );\r\n    }\r\n\r\n    onClick(handler) {\r\n        this.clickHandler = handler;\r\n        this.visualModel && this.visualModel.onClick(handler);\r\n    }\r\n\r\n    onUpdate(handler) {\r\n        return null;\r\n    }\r\n\r\n    addFlightEvent(flightEvent) {\r\n        if (flightEvent instanceof FlightEventSOIDeparture || flightEvent instanceof FlightEventSOIArrival) {\r\n            for (let event of this.flightEvents) {\r\n                if (event.constructor === flightEvent.constructor) {\r\n                    event.set(flightEvent);\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n        let found = false;\r\n        for (let i in this.flightEvents) {\r\n            if (this.flightEvents[i].epoch > flightEvent.epoch) {\r\n                this.flightEvents.splice(i, 0, flightEvent);\r\n                found = true;\r\n                break;\r\n            }\r\n        }\r\n        if (!found) {\r\n            this.flightEvents.push(flightEvent);\r\n        }\r\n        this.visualModel && this.visualModel.addFlightEvent(flightEvent);\r\n    }\r\n\r\n    clearAfterEpoch(epoch) {\r\n        let newEvents = [];\r\n        for (let event of this.flightEvents) {\r\n            if (event.epoch <= epoch) {\r\n                newEvents.push(event);\r\n            } else {\r\n                this.visualModel && this.visualModel.removeFlightEvent(event);\r\n            }\r\n        }\r\n        this.flightEvents = newEvents;\r\n    }\r\n\r\n    setReferenceFrame(referenceFrameId) {\r\n        this.referenceFrame = sim.starSystem.getReferenceFrame(referenceFrameId);\r\n    }\r\n\r\n    getReferenceFrameByEpoch(epoch) {\r\n        return this.referenceFrame;\r\n    }\r\n\r\n    _transformKeplerianObject(keplerianObject, destinationFrameOrId, epoch) {\r\n        if (destinationFrameOrId === undefined) {\r\n            return keplerianObject;\r\n        }\r\n\r\n        let destinationFrame = (destinationFrameOrId instanceof ReferenceFrameAbstract)\r\n            ? destinationFrameOrId\r\n            : sim.starSystem.getReferenceFrame(destinationFrameOrId);\r\n        if (epoch === undefined) {\r\n            epoch = keplerianObject.epoch;\r\n        }\r\n        return KeplerianObject.createFromState(\r\n            this.referenceFrame.transformStateVectorByEpoch(\r\n                epoch,\r\n                keplerianObject.getStateByEpoch(epoch),\r\n                destinationFrame\r\n            ),\r\n            destinationFrame.mu,\r\n            epoch\r\n        );\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param epoch\r\n     * @param referenceFrameOrId\r\n     * @return {KeplerianObject}\r\n     */\r\n    getKeplerianObjectByEpoch(epoch, referenceFrameOrId) {\r\n        let destinationFrame = (referenceFrameOrId instanceof ReferenceFrameAbstract)\r\n            ? referenceFrameOrId\r\n            : referenceFrameOrId !== undefined\r\n                ? sim.starSystem.getReferenceFrame(referenceFrameOrId)\r\n                : this.getReferenceFrameByEpoch(epoch);\r\n        return KeplerianObject.createFromState(\r\n            this.getStateByEpoch(epoch, destinationFrame),\r\n            destinationFrame.mu,\r\n            epoch\r\n        );\r\n    }\r\n\r\n    setVisualModel(visualModel) {\r\n        this.visualModel = visualModel;\r\n        this.clickHandler && this.visualModel.onClick(this.clickHandler);\r\n        for (let event of this.flightEvents) {\r\n            this.visualModel.addFlightEvent(event);\r\n        }\r\n    }\r\n\r\n    setSelectedVisualModel(visualModel) {\r\n        this.selectedVisualModel = visualModel;\r\n        if (this.isSelected) {\r\n            this.visualModel.hide();\r\n        } else {\r\n            visualModel.hide();\r\n        }\r\n        this.clickHandler && visualModel.onClick(this.clickHandler);\r\n        for (let event of this.flightEvents) {\r\n            visualModel.addFlightEvent(event);\r\n        }\r\n    }\r\n\r\n    setParent(parent) {\r\n        this.parent = parent;\r\n    }\r\n\r\n    setObject(object) {\r\n        this.object = object;\r\n    }\r\n\r\n    drop() {\r\n        if (this.isSelected) {\r\n            this.deselect();\r\n        }\r\n        if (this.visualModel) {\r\n            this.visualModel.drop();\r\n        }\r\n        if (this.selectedVisualModel) {\r\n            this.selectedVisualModel.drop();\r\n        }\r\n    }\r\n\r\n    select() {\r\n        this.isSelected = true;\r\n        if (this.selectedVisualModel) {\r\n            this.visualModel.hide();\r\n            this.selectedVisualModel.show();\r\n            this.selectedVisualModel.select();\r\n        } else {\r\n            this.visualModel && this.visualModel.select();\r\n        }\r\n        this.keplerianEditor = new KeplerianEditor(this);\r\n        Events.addListener(Events.SHOW_ORBIT_ANGLES_CHANGED, this.showOrbitAnglesListener);\r\n    }\r\n\r\n    deselect() {\r\n        this.isSelected = false;\r\n        if (this.selectedVisualModel) {\r\n            this.selectedVisualModel.deselect();\r\n            this.selectedVisualModel.hide();\r\n            this.visualModel.show();\r\n        } else {\r\n            this.visualModel && this.visualModel.deselect();\r\n        }\r\n        if (this.keplerianEditor) {\r\n            this.keplerianEditor.remove();\r\n            delete this.keplerianEditor;\r\n            Events.removeListener(Events.SHOW_ORBIT_ANGLES_CHANGED, this.showOrbitAnglesListener);\r\n        }\r\n    }\r\n\r\n    _onShowOrbitAnglesChange(event) {\r\n        if (event.detail.value) {\r\n            this.keplerianEditor.init();\r\n        } else {\r\n            this.keplerianEditor.remove();\r\n        }\r\n    }\r\n\r\n    isValidAtEpoch(epoch) {\r\n        return (this.minEpoch === false || epoch >= this.minEpoch)\r\n            && (this.maxEpoch === false || epoch <= this.maxEpoch);\r\n    }\r\n\r\n    validateEpoch(epoch) {\r\n        if (!this.isValidAtEpoch(epoch)) {\r\n            throw new ExceptionOutOfRange(this.object, this, epoch, this.minEpoch, this.maxEpoch);\r\n        }\r\n    }\r\n\r\n    getStateInOwnFrameByEpoch(epoch) {\r\n        this.validateEpoch(epoch);\r\n        return new StateVector();\r\n    }\r\n\r\n    getStateByEpoch(epoch, referenceFrameOrId, frameEpoch = null) {\r\n        let state;\r\n\r\n        if (this.referenceFrame === null) {\r\n            return null;\r\n        }\r\n\r\n        if (referenceFrameOrId === undefined) {\r\n            referenceFrameOrId = RF_BASE;\r\n        }\r\n\r\n        if (referenceFrameOrId === RF_BASE && epoch === this.cachedEpoch) {\r\n            state = this.cachedState;\r\n        } else {\r\n            state = this.getStateInOwnFrameByEpoch(epoch);\r\n            if (referenceFrameOrId === RF_BASE && epoch === sim.currentEpoch) {\r\n                this.cachedState = state;\r\n                this.cachedEpoch = epoch;\r\n            }\r\n        }\r\n\r\n        if (state === null) {\r\n            return null;\r\n        }\r\n\r\n        return this.referenceFrame.transformStateVectorByEpoch((frameEpoch === null) ? epoch : frameEpoch, state, referenceFrameOrId);\r\n    }\r\n\r\n    getPositionByEpoch(epoch, referenceFrameOrId, frameEpoch = null) {\r\n        return this.getStateByEpoch(epoch, referenceFrameOrId, frameEpoch).position;\r\n    }\r\n}\r\n","import ReferenceFrameInertialAbstract from \"./InertialAbstract\";\r\n\r\nexport default class ReferenceFrameInertialDynamic extends ReferenceFrameInertialAbstract\r\n{\r\n    constructor(stateOfEpoch, quaternionOfEpoch) {\r\n        super(stateOfEpoch);\r\n\r\n        this.quaternionOfEpoch = quaternionOfEpoch;\r\n    }\r\n\r\n    /**\r\n     * @param epoch\r\n     * @return {Quaternion}\r\n     */\r\n    getQuaternionByEpoch(epoch) {\r\n        return this.quaternionOfEpoch.evaluate(epoch);\r\n    }\r\n}","import ReferenceFrameFactory from \"./ReferenceFrame/Factory\";\r\nimport Body from \"./Body\";\r\nimport Events from \"./Events\";\r\n\r\nexport const STAR_SYSTEM_BARYCENTER = 0;\r\n\r\nexport default class StarSystem\r\n{\r\n    constructor(id) {\r\n        this.id = id;\r\n        this.name = null;\r\n        this.stars = null;\r\n        this.mainObject = null;\r\n        this.referenceFrames = {};\r\n        this.objects = {};\r\n        this.created = 0;\r\n    }\r\n\r\n    unload() {\r\n        Object.entries(this.objects).map(entry => entry[1].drop());\r\n        this.stars && this.stars.drop();\r\n    }\r\n\r\n    addStars(stars) {\r\n        this.stars = stars;\r\n        return this;\r\n    }\r\n\r\n    addReferenceFrame(frame) {\r\n        this.referenceFrames[frame.id] = frame;\r\n    }\r\n\r\n    getReferenceFrame(id) {\r\n        if (this.referenceFrames[id] === undefined) {\r\n            this.referenceFrames[id] = ReferenceFrameFactory.createById(id);\r\n        }\r\n        return this.referenceFrames[id];\r\n    }\r\n\r\n    addObject(id, body) {\r\n        this.objects[id] = body;\r\n        Events.dispatch(Events.OBJECT_ADDED, {object: body});\r\n    }\r\n\r\n    getObject(id) {\r\n        if (this.objects[id] === undefined) {\r\n            return null;\r\n        }\r\n        return this.objects[id];\r\n    }\r\n\r\n    deleteObject(id) {\r\n        this.objects[id].drop();\r\n        delete this.objects[id];\r\n    }\r\n\r\n    isBody(objectId) {\r\n        if (this.objects[objectId] === undefined) {\r\n            return null;\r\n        }\r\n        return this.objects[objectId] instanceof Body;\r\n    }\r\n\r\n    getObjectNames() {\r\n        let names = {};\r\n        for (const object of Object.values(this.objects)) {\r\n            names[object.id] = object.name;\r\n        }\r\n        return names;\r\n    }\r\n\r\n    getBodies() {\r\n        let bodies = [];\r\n        for (const object of Object.values(this.objects)) {\r\n            if (object instanceof Body) {\r\n                bodies.push(object);\r\n            }\r\n        }\r\n        return bodies;\r\n    }\r\n}","export const GETTING_STARTED_WIZARD = \"getting-started-wizard\";\r\n\r\nexport function getRus(id) {\r\n    return `${id}-ru`;\r\n}\r\n\r\nexport function getEng(id) {\r\n    return `${id}-eng`;\r\n}\r\n","\r\nimport VisualFlightEventSOIDeparture from \"../visual/FlightEvent/SOIDeparture\";\r\nimport FlightEventSOIChangeAbstract from \"./SOIChangeAbstract\";\r\n\r\nexport default class FlightEventSOIDeparture extends FlightEventSOIChangeAbstract\r\n{\r\n    static VISUAL_CLASS = VisualFlightEventSOIDeparture;\r\n}\r\n","\r\nimport VisualFlightEventSOIArrival from \"../visual/FlightEvent/SOIArrival\";\r\nimport FlightEventSOIChangeAbstract from \"./SOIChangeAbstract\";\r\n\r\nexport default class FlightEventSOIArrival extends FlightEventSOIChangeAbstract\r\n{\r\n    static VISUAL_CLASS = VisualFlightEventSOIArrival;\r\n}\r\n","import TrajectoryAbstract from \"./Abstract\";\r\n\r\nexport default class TrajectoryKeplerianAbstract extends TrajectoryAbstract\r\n{\r\n    constructor(referenceFrameId) {\r\n        super();\r\n        this.setReferenceFrame(referenceFrameId);\r\n    }\r\n\r\n    getStateInOwnFrameByEpoch(epoch) {\r\n        return this.getKeplerianObjectByEpoch(epoch).getStateByEpoch(epoch);\r\n    }\r\n}\r\n","\r\nimport VisualFlightEventAbstract from \"../../../../core/visual/FlightEvent/Abstract\";\r\n\r\nexport default class VisualFlightEventSOIDeparture extends VisualFlightEventAbstract\r\n{\r\n    static _textureName = 'soi_out.png';\r\n}\r\n","\r\nimport VisualFlightEventAbstract from \"../../../../core/visual/FlightEvent/Abstract\";\r\n\r\nexport default class VisualFlightEventSOIArrival extends VisualFlightEventAbstract\r\n{\r\n    static _textureName = 'soi_in.png';\r\n}\r\n","\r\nimport TrajectoryComposite from \"./Composite\";\r\nimport FlightEventImpulsiveBurn from \"../FlightEvent/ImpulsiveBurn\";\r\nimport {Vector} from \"../algebra\";\r\n\r\nexport default class TrajectoryDynamic extends TrajectoryComposite\r\n{\r\n    /**\r\n     *\r\n     * @param propagator {PropagatorAbstract}\r\n     */\r\n    constructor(propagator) {\r\n        super();\r\n        this.propagator = propagator;\r\n        this.updateHandlers = [];\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param trajectory {TrajectoryAbstract}\r\n     */\r\n    addComponent(trajectory) {\r\n        if (this.components.length === 0) {\r\n            trajectory.isEditable = true;\r\n            trajectory.onUpdate(traj => this.propagate(traj.epoch));\r\n        }\r\n\r\n        super.addComponent(trajectory);\r\n\r\n        trajectory.onClick((pointEpoch) => {\r\n            this.addFlightEvent((new FlightEventImpulsiveBurn(\r\n                pointEpoch,\r\n                new Vector([0, 0, 0])\r\n            )).onUpdate((newEvent, oldEvent) => {\r\n                this.sortManeuvers();\r\n                this.propagate(Math.min(oldEvent.epoch, newEvent.epoch));\r\n            }));\r\n            this.updateHandlers.map(h => h(this));\r\n        });\r\n    }\r\n\r\n    sortManeuvers() {\r\n        this.flightEvents.sort((e1, e2) => (e1.epoch < e2.epoch) ? -1 : (e1.epoch > e2.epoch ? 1 : 0));\r\n    }\r\n\r\n    propagate(startEpoch) {\r\n        this.propagator.propagate(this, startEpoch);\r\n        this.updateHandlers.map(h => h(this));\r\n    }\r\n\r\n    onUpdate(handler) {\r\n        this.updateHandlers.push(handler);\r\n    }\r\n\r\n    removeListener(handler) {\r\n        for (let i in this.updateHandlers) {\r\n            if (this.updateHandlers[i] === handler) {\r\n                this.updateHandlers = this.updateHandlers.splice(i, 1);\r\n                break;\r\n            }\r\n        }\r\n    }\r\n}\r\n","\r\nimport FlightEventAbstract from \"./Abstract\";\r\nimport VisualFlightEventImpulsiveBurn from \"../visual/FlightEvent/ImpulsiveBurn\";\r\n\r\n/**\r\n * Public fields:\r\n *      vector {Vector} - [prograde, normal, radial]\r\n *      prograde {Number}\r\n *      normal {Number}\r\n *      radial {Number}\r\n */\r\nexport default class FlightEventImpulsiveBurn extends FlightEventAbstract\r\n{\r\n    static VISUAL_CLASS = VisualFlightEventImpulsiveBurn;\r\n\r\n    constructor(epoch, vector) {\r\n        super(epoch);\r\n        this._vector = vector || false;\r\n        this.deltaV = vector ? vector.mag : 0;\r\n    }\r\n\r\n    _update(old) {\r\n        this.deltaV = this._vector.mag;\r\n        this._updateCallback && this._updateCallback(this, old);\r\n    }\r\n\r\n    set(flightEvent) {\r\n        super.set(flightEvent);\r\n        this._vector = flightEvent.vector;\r\n        this.deltaV = this._vector.mag;\r\n        return this;\r\n    }\r\n\r\n    set vector(vector) {\r\n        const old = this.copy();\r\n        this._vector = vector;\r\n        this._update(old);\r\n    }\r\n\r\n    get vector() {\r\n        return this._vector.copy();\r\n    }\r\n\r\n    set prograde(value) {\r\n        const old = this.copy();\r\n        this._vector[0] = value;\r\n        this._update(old);\r\n    }\r\n\r\n    get prograde() {\r\n        return this._vector[0];\r\n    }\r\n\r\n    set normal(value) {\r\n        const old = this.copy();\r\n        this._vector[1] = value;\r\n        this._update(old);\r\n    }\r\n\r\n    get normal() {\r\n        return this._vector[1];\r\n    }\r\n\r\n    set radial(value) {\r\n        const old = this.copy();\r\n        this._vector[2] = value;\r\n        this._update(old);\r\n    }\r\n\r\n    get radial() {\r\n        return this._vector[2];\r\n    }\r\n}\r\n","import ReferenceFrameInertialAbstract from \"./InertialAbstract\";\r\nimport {Quaternion} from \"../algebra\";\r\n\r\nexport default class ReferenceFrameInertial extends ReferenceFrameInertialAbstract\r\n{\r\n    constructor(stateOfEpoch, quaternion) {\r\n        super(stateOfEpoch);\r\n\r\n        this.quaternion = quaternion;\r\n    }\r\n\r\n    getQuaternionByEpoch(epoch) {\r\n        return Quaternion.copy(this.quaternion);\r\n    }\r\n}\r\n","import ReferenceFrameAbstract from \"./Abstract\";\r\nimport StateVector from \"../StateVector\";\r\n\r\nexport default class ReferenceFrameInertialAbstract extends ReferenceFrameAbstract\r\n{\r\n    constructor(stateOfEpoch) {\r\n        super();\r\n        this.stateOfEpoch = stateOfEpoch;\r\n    }\r\n\r\n    getOriginPositionByEpoch(epoch) {\r\n        return this.stateOfEpoch.evaluate(epoch).position;\r\n    }\r\n\r\n    getOriginStateByEpoch(epoch) {\r\n        return this.stateOfEpoch.evaluate(epoch);\r\n    }\r\n\r\n    stateVectorFromBaseReferenceFrameByEpoch(epoch, state) {\r\n        const originState = this.stateOfEpoch.evaluate(epoch);\r\n        const rotation = this.getQuaternionByEpoch(epoch).invert_();\r\n\r\n        return new StateVector(\r\n            rotation.rotate(state.position.sub_(originState.position)),\r\n            rotation.rotate(state.velocity.sub_(originState.velocity))\r\n        );\r\n    }\r\n\r\n    stateVectorToBaseReferenceFrameByEpoch(epoch, state) {\r\n        const originState = this.stateOfEpoch.evaluate(epoch);\r\n        const rotation = this.getQuaternionByEpoch(epoch);\r\n\r\n        return new StateVector(\r\n            rotation.rotate(state.position).add_(originState.position),\r\n            rotation.rotate(state.velocity).add_(originState.velocity)\r\n        );\r\n    }\r\n}","export default class ExceptionOutOfRange\r\n{\r\n    constructor(object, trajectory, epoch, minEpoch, maxEpoch) {\r\n        this.object = object;\r\n        this.trajectory = trajectory;\r\n        this.epoch = epoch;\r\n        this.minEpoch = minEpoch;\r\n        this.maxEpoch = maxEpoch;\r\n    }\r\n}","import * as THREE from \"three\";\r\n\r\nexport default class LineObject extends THREE.Line {\r\n    raycast(raycaster, intersects) {\r\n        const isBuffer = this.geometry.isBufferGeometry;\r\n        const verticesCount = isBuffer ? this.geometry.attributes.position.count : this.geometry.vertices.length;\r\n        let bestIntersection;\r\n\r\n        const ray = (new THREE.Ray())\r\n            .copy(raycaster.ray)\r\n            .applyMatrix4(\r\n                (new THREE.Matrix4())\r\n                .getInverse(this.matrixWorld)\r\n            );\r\n\r\n        for (let i = 0; i < verticesCount - 1; i++) {\r\n            let vertex1;\r\n            let vertex2;\r\n            if (isBuffer) {\r\n                const i1 = i * 3;\r\n                const i2 = ((i + 1) % verticesCount) * 3;\r\n                let positions = this.geometry.attributes.position.array;\r\n                vertex1 = new THREE.Vector3(positions[i1], positions[i1+1], positions[i1+2]);\r\n                vertex2 = new THREE.Vector3(positions[i2], positions[i2+1], positions[i2+2]);\r\n            } else {\r\n                vertex1 = (new THREE.Vector3())\r\n                    .copy(this.geometry.vertices[i]);\r\n                vertex2 = (new THREE.Vector3())\r\n                    .copy(this.geometry.vertices[(i + 1) % verticesCount]);\r\n            }\r\n\r\n            const currentLineDirection = (new THREE.Vector3()).subVectors(\r\n                vertex1,\r\n                vertex2\r\n            );\r\n\r\n            if (currentLineDirection.length() === 0) {\r\n                continue;\r\n            }\r\n\r\n            const commonPerpendicularDirection = (new THREE.Vector3()).crossVectors(\r\n                currentLineDirection,\r\n                ray.direction\r\n            );\r\n\r\n            const planeNormalVector = (new THREE.Vector3()).crossVectors(\r\n                ray.direction,\r\n                commonPerpendicularDirection\r\n            );\r\n\r\n            let distanceCoeff = (new THREE.Vector3()).subVectors(\r\n                ray.origin,\r\n                vertex1\r\n            ).dot(planeNormalVector);\r\n\r\n            distanceCoeff /= planeNormalVector.clone().dot(currentLineDirection);\r\n\r\n            let intersectionPoint = (new THREE.Vector3()).addVectors(\r\n                vertex1,\r\n                currentLineDirection.multiplyScalar(distanceCoeff)\r\n            );\r\n\r\n            if ((new THREE.Vector3()).subVectors(\r\n                    vertex1, intersectionPoint\r\n                ).dot(\r\n                    (new THREE.Vector3()).subVectors(\r\n                        intersectionPoint, vertex2\r\n                    )\r\n                ) < 0\r\n            ) {\r\n                // вне отркзка\r\n                intersectionPoint =\r\n                    (intersectionPoint.distanceTo(vertex1) < intersectionPoint.distanceTo(vertex2))\r\n                        ? vertex1\r\n                        : vertex2;\r\n            }\r\n\r\n            const currentDistance = (new THREE.Vector3()).crossVectors(\r\n                (new THREE.Vector3()).subVectors(\r\n                    intersectionPoint,\r\n                    ray.origin\r\n                ),\r\n                ray.direction\r\n            ).length();\r\n\r\n            if (!bestIntersection || (bestIntersection.distance > currentDistance)) {\r\n                bestIntersection = {\r\n                    distance: currentDistance,\r\n                    point: intersectionPoint,\r\n                    index: i,\r\n                    face: null,\r\n                    faceIndex: null,\r\n                    object: this\r\n                }\r\n            }\r\n        }\r\n\r\n        if (bestIntersection\r\n            && (bestIntersection.distance / ray.origin.distanceTo(bestIntersection.point)\r\n                < raycaster.pixelPrecision * raycaster.pixelAngleSize\r\n            )\r\n        ) {\r\n            bestIntersection.point.applyMatrix4(this.matrixWorld);\r\n            intersects.push(bestIntersection);\r\n        }\r\n    }\r\n}\r\n","\r\nexport default class FlightEventAbstract\r\n{\r\n    static VISUAL_CLASS = null;\r\n\r\n    constructor(epoch) {\r\n        this._epoch = epoch || false;\r\n        this._updateCallback = false;\r\n        this._visualModel = null;\r\n    }\r\n\r\n    onUpdate(callback) {\r\n        this._updateCallback = callback;\r\n        return this;\r\n    }\r\n\r\n    set(flightEvent) {\r\n        this._epoch = flightEvent._epoch;\r\n        return this;\r\n    }\r\n\r\n    copy() {\r\n        return (new this.constructor()).set(this);\r\n    }\r\n\r\n    set epoch(epoch) {\r\n        const old = this.copy();\r\n        this._epoch = epoch;\r\n        this._updateCallback && this._updateCallback(this, old);\r\n    }\r\n\r\n    get epoch() {\r\n        return this._epoch;\r\n    }\r\n\r\n    set visualModel(model) {\r\n        this._visualModel = model;\r\n    }\r\n\r\n    get visualModel() {\r\n        return this._visualModel;\r\n    }\r\n\r\n    getVisualClass() {\r\n        return this.constructor.VISUAL_CLASS;\r\n    }\r\n}\r\n","\r\nimport VisualMarkerAbstract from \"./Abstract\";\r\n\r\nexport default class VisualMarkerPericenter extends VisualMarkerAbstract\r\n{\r\n    static _textureName = 'pe.png';\r\n    static _alignVertical = 'top';\r\n    static _alignHorizontal = 'center';\r\n}","\r\nimport VisualSpriteStatic from \"../SpriteStatic\";\r\n\r\nexport default class VisualMarkerAbstract extends VisualSpriteStatic\r\n{\r\n    constructor(parentThreeObj, color) {\r\n        super(color);\r\n        this._parent = parentThreeObj;\r\n        this.threeObj && this._parent.add(this.threeObj);\r\n        this._isEnabled = false;\r\n        this.hide();\r\n    }\r\n\r\n    /**\r\n     * Redefining base method and not subscribing to RENDER event\r\n     * because this object is intended to be controlled by parent\r\n     * @param threeObj\r\n     */\r\n    setThreeObj(threeObj) {\r\n        this.threeObj = threeObj;\r\n        this._parent && this._parent.add(this.threeObj);\r\n        if (this._isHidden || !this._isEnabled)\r\n            this.threeObj.visible = false;\r\n    }\r\n\r\n    setPosition(pos) {\r\n        this.threeObj && this.threeObj.position.copy(pos);\r\n    }\r\n\r\n    enable() {\r\n        this._isEnabled = true;\r\n        if (!this._isHidden) {\r\n            this.threeObj.visible = true;\r\n        }\r\n    }\r\n\r\n    disable() {\r\n        this._isEnabled = false;\r\n        this.threeObj.visible = false;\r\n    }\r\n\r\n    show() {\r\n        super.show();\r\n        if (!this._isEnabled) {\r\n            this.threeObj.visible = false;\r\n        }\r\n    }\r\n}","\r\nimport VisualMarkerAbstract from \"./Abstract\";\r\n\r\nexport default class VisualMarkerApocenter extends VisualMarkerAbstract\r\n{\r\n    static _textureName = 'ap.png';\r\n    static _alignVertical = 'bottom';\r\n    static _alignHorizontal = 'center';\r\n}","\r\nimport VisualFlightEventAbstract from \"./Abstract\";\r\n\r\nexport default class VisualFlightEventImpulsiveBurn extends VisualFlightEventAbstract\r\n{\r\n    static _textureName = 'burn.png';\r\n}\r\n","import * as THREE from \"three\";\r\n\r\nimport VisualModelAbstract from \"./ModelAbstract\";\r\nimport { sim } from '../Simulation';\r\n\r\nexport default class VisualSprite extends VisualModelAbstract\r\n{\r\n    constructor(positionOfEpoch, texturePath, color, verticalAlign, horizontalAlign, scale) {\r\n        super();\r\n        this.positionOfEpoch = positionOfEpoch;\r\n        this.verticalAlign = verticalAlign || 'center';\r\n        this.horizontalAlign = horizontalAlign || 'center';\r\n        this.scale = scale || 1;\r\n        this.color = color || 0xFFFFFF;\r\n        this.loadTexture(texturePath);\r\n    }\r\n\r\n    loadTexture(texturePath) {\r\n        texturePath && sim.textureLoader.load(texturePath, texture => {\r\n            this.setTexture(texture);\r\n        });\r\n    }\r\n\r\n    setTexture(textureObj) {\r\n        if (this._dropped)\r\n            return;\r\n\r\n        this.setThreeObj(new THREE.Sprite(new THREE.SpriteMaterial(\r\n            {map: textureObj, sizeAttenuation: false, color: this.color}\r\n        )));\r\n        this.setScale(this.scale);\r\n        this.updateCenter();\r\n    }\r\n\r\n    updateCenter() {\r\n        this.threeObj && this.threeObj.center.set(\r\n            this.horizontalAlign === 'right'\r\n                ? 0\r\n                : this.horizontalAlign === 'left'\r\n                ? 1\r\n                : 0.5,\r\n            this.verticalAlign === 'top'\r\n                ? 0\r\n                : this.verticalAlign === 'bottom'\r\n                ? 1\r\n                : 0.5\r\n        );\r\n    }\r\n\r\n    setScale(scale) {\r\n        this.scale = scale;\r\n        this.threeObj.scale.set(\r\n            this.threeObj.material.map.image.width / 800 * this.scale, // god knows why 800, but it works...\r\n            this.threeObj.material.map.image.height / 800 * this.scale,\r\n            1\r\n        );\r\n    }\r\n\r\n    setColor(color) {\r\n        this.color = color;\r\n        this.threeObj.material.color.set(this.color);\r\n        this.threeObj.material.needsUpdate = true;\r\n    }\r\n\r\n    setAlign(vertical, horizontal) {\r\n        this.verticalAlign = vertical;\r\n        this.horizontalAlign = horizontal;\r\n        this.updateCenter();\r\n    }\r\n\r\n    setPositionOfEpoch(positionOfEpoch) {\r\n        this.positionOfEpoch = positionOfEpoch;\r\n    }\r\n\r\n    render(epoch) {\r\n        this.positionOfEpoch && this.setPosition(this.positionOfEpoch.evaluate(epoch));\r\n    }\r\n\r\n    drop() {\r\n        super.drop();\r\n        this._dropped = true;\r\n    }\r\n}\r\n","\r\nimport VisualSprite from \"./Sprite\";\r\nimport { sim } from '../Simulation';\r\n\r\nexport default class VisualSpriteStatic extends VisualSprite\r\n{\r\n    static _texture = null;\r\n    static _textureName = null;\r\n    static _alignVertical = 'center';\r\n    static _alignHorizontal = 'center';\r\n\r\n    static preloadTexture() {\r\n        sim.textureLoader.load('images/' + this._textureName, texture => {this._texture = texture});\r\n    }\r\n\r\n    constructor(color) {\r\n        super(null, null, color);\r\n\r\n        this.setAlign(this.constructor._alignVertical, this.constructor._alignHorizontal);\r\n\r\n        if (this.constructor._texture) {\r\n            this.setTexture(this.constructor._texture);\r\n        } else {\r\n            this.loadTexture('images/' + this.constructor._textureName);\r\n        }\r\n    }\r\n}","export default class OrientationAbstract\r\n{\r\n    getQuaternionByEpoch(epoch) {}\r\n}\r\n","import OrientationAbstract from \"./Abstract\";\r\nimport {Quaternion, Vector} from \"../algebra\";\r\n\r\nexport default class OrientationConstantAxis extends OrientationAbstract\r\n{\r\n    constructor(config) {\r\n        super();\r\n        const angularVelocity = new Vector(config.vector);\r\n        this.axisQuaternion = Quaternion.transfer(new Vector([0, 0, 1]), angularVelocity);\r\n        this.angularSpeed = angularVelocity.mag;\r\n        this.initialAngle = config.angle || 0;\r\n        this.initialEpoch = config.epoch || 0;\r\n    }\r\n\r\n    getQuaternionByEpoch(epoch) {\r\n        return this.axisQuaternion.mul(\r\n            new Quaternion(\r\n                [0, 0, 1],\r\n                this.initialAngle + (epoch - this.initialEpoch) * this.angularSpeed\r\n            )\r\n        );\r\n    }\r\n}\r\n","export default class PhysicalBodyModel\r\n{\r\n    constructor(config) {\r\n        this.mu       = config.mu;     // gravitational parameter\r\n        this.radius   = config.radius;\r\n        this.eqRadius = config.eqRadius;\r\n        this.j2       = config.j2 || 0;\r\n    }\r\n}","import TrajectoryKeplerianAbstract from \"./KeplerianAbstract\";\r\nimport {approximateAngle, approximateNumber} from \"../algebra\";\r\nimport KeplerianObject from \"../KeplerianObject\";\r\nimport StateVector from \"../StateVector\";\r\n\r\nexport default class TrajectoryKeplerianArray extends TrajectoryKeplerianAbstract\r\n{\r\n    constructor(referenceFrameId) {\r\n        super(referenceFrameId);\r\n        this.keplerianObjects = []; // array of class KeplerianObject\r\n    }\r\n\r\n    addState(keplerianObject) {\r\n        this.keplerianObjects.push(keplerianObject);\r\n    }\r\n\r\n    getKeplerianObjectByEpoch(epoch, referenceFrameOrId) {\r\n        this.validateEpoch(epoch);\r\n\r\n        let nextIdx = Math.ceil(\r\n            (epoch - this.keplerianObjects[0].epoch)\r\n            / (this.keplerianObjects[this.keplerianObjects.length - 1].epoch\r\n                - this.keplerianObjects[0].epoch\r\n            )\r\n            * (this.keplerianObjects.length - 1)\r\n        );\r\n        if (nextIdx < 0)\r\n            nextIdx = 0;\r\n        if (nextIdx > this.keplerianObjects.length - 1)\r\n            nextIdx = this.keplerianObjects.length - 1;\r\n        let searchDirection = this.keplerianObjects[nextIdx].epoch > epoch ? -1 : 1;\r\n\r\n        while ((nextIdx < this.keplerianObjects.length) && (nextIdx >= 0)) {\r\n            if (this.keplerianObjects[nextIdx].epoch == epoch) {\r\n                return this.keplerianObjects[nextIdx];\r\n            }\r\n            if ((this.keplerianObjects[nextIdx].epoch > epoch)\r\n                && (nextIdx === 0 || this.keplerianObjects[nextIdx - 1].epoch < epoch)\r\n            ) {\r\n                break;\r\n            }\r\n            nextIdx += searchDirection;\r\n        }\r\n\r\n        if ((nextIdx === this.keplerianObjects.length) || (nextIdx === 0)) {\r\n            nextIdx -= searchDirection;\r\n        }\r\n\r\n        return this._transformKeplerianObject(this.approximateKeplerianObject(\r\n            this.keplerianObjects[nextIdx - 1],\r\n            this.keplerianObjects[nextIdx],\r\n            epoch\r\n        ), referenceFrameOrId);\r\n    }\r\n\r\n    approximateKeplerianObject(object1, object2, epoch) {\r\n        const proportion = (epoch - object1.epoch) / (object2.epoch - object1.epoch);\r\n\r\n        if ((0.95 < object1.ecc && object1.ecc < 1.05)\r\n            || (0.95 < object2.ecc && object2.ecc < 1.05)\r\n            || (object1.isElliptic !== object2.isElliptic)\r\n        ) {\r\n            const state1 = object1.getStateByEpoch(epoch);\r\n            const state2 = object2.getStateByEpoch(epoch);\r\n            return KeplerianObject.createFromState(\r\n                new StateVector(\r\n                    state1.position.mul_(1 - proportion).add_(state2.position.mul_(proportion)),\r\n                    state1.velocity.mul_(1 - proportion).add_(state2.velocity.mul_(proportion)),\r\n                ),\r\n                approximateNumber(object1.mu, object2.mu, proportion),\r\n                epoch\r\n            );\r\n        }\r\n\r\n        const ma = object1.isElliptic\r\n            ? approximateAngle(object1.getMeanAnomalyByEpoch(epoch), object2.getMeanAnomalyByEpoch(epoch), proportion)\r\n            : approximateNumber(object1.getMeanAnomalyByEpoch(epoch), object2.getMeanAnomalyByEpoch(epoch), proportion);\r\n\r\n        return new KeplerianObject(\r\n            approximateNumber(object1.ecc, object2.ecc, proportion),\r\n            approximateNumber(object1.sma, object2.sma, proportion),\r\n            approximateAngle(object1.aop, object2.aop, proportion),\r\n            approximateAngle(object1.inc, object2.inc, proportion),\r\n            approximateAngle(object1.raan, object2.raan, proportion),\r\n            ma,\r\n            epoch,\r\n            approximateNumber(object1.mu, object2.mu, proportion),\r\n            false\r\n        );\r\n    }\r\n}\r\n","import TrajectoryKeplerianArray from \"./KeplerianArray\";\r\n\r\nexport default class TrajectoryKeplerianPrecessingArray extends TrajectoryKeplerianArray\r\n{\r\n    constructor(referenceFrameId, r, j2) {\r\n        super(referenceFrameId);\r\n        this.r = r;\r\n        this.j2 = j2;\r\n    }\r\n\r\n    approximateKeplerianObject(object1, object2, epoch) {\r\n        let obj1 = object1.copy();\r\n        let obj2 = object2.copy();\r\n        obj1.raan += obj1.getNodalPrecessionByEpoch(this.r, this.j2, epoch);\r\n        obj2.raan += obj2.getNodalPrecessionByEpoch(this.r, this.j2, epoch);\r\n        return super.approximateKeplerianObject(\r\n            obj1,\r\n            obj2,\r\n            epoch\r\n        );\r\n    }\r\n}","import TrajectoryKeplerianBasic from \"./KeplerianBasic\";\r\nimport KeplerianObject from \"../KeplerianObject\";\r\n\r\nexport default class TrajectoryKeplerianPrecessing extends TrajectoryKeplerianBasic\r\n{\r\n    constructor(referenceFrameId, keplerianObject, r, j2) {\r\n        super(referenceFrameId, keplerianObject);\r\n\r\n        this.r = r;\r\n        this.j2 = j2;\r\n    }\r\n\r\n    getKeplerianObjectByEpoch(epoch, referenceFrameOrId) {\r\n        this.validateEpoch(epoch);\r\n        return this._transformKeplerianObject(\r\n            this.keplerianObject.addPrecession(this.r, this.j2, epoch),\r\n            referenceFrameOrId\r\n        );\r\n    }\r\n\r\n    static createFromState(referenceFrame, state, mu, r, j2, epoch, color) {\r\n        return new TrajectoryKeplerianPrecessing(\r\n            referenceFrame,\r\n            KeplerianObject.createFromState(state, mu, epoch),\r\n            r,\r\n            j2,\r\n            color\r\n        );\r\n    }\r\n}\r\n","import VisualTrajectoryModelAbstract from \"./Abstract\";\r\nimport {deg2rad} from \"../../algebra\";\r\nimport { sim } from \"../../Simulation\";\r\n\r\nexport default class VisualTrajectoryPointArray extends VisualTrajectoryModelAbstract\r\n{\r\n    constructor(trajectory, config) {\r\n        super(trajectory, config);\r\n\r\n        this.referenceFrame = sim.starSystem.getReferenceFrame(config.referenceFrame);\r\n        this.showAhead = config.showAhead;\r\n        this.showBehind = config.showBehind;\r\n        this.trailPeriod = config.trailPeriod;\r\n\r\n        this.minCos = Math.cos(deg2rad(config.maxAngle || 2));\r\n        this.minStep = config.minStep || 180;\r\n        this.threeObj.position.set(0, 0, 0);\r\n\r\n        this.initVertices();\r\n    }\r\n\r\n    select() {\r\n        super.select();\r\n        this.showAhead = true;\r\n        this.showBehind = true;\r\n    }\r\n\r\n    deselect() {\r\n        super.deselect();\r\n        this.showAhead = this.config.showAhead;\r\n        this.showBehind = this.config.showBehind;\r\n    }\r\n\r\n    render(epoch) {\r\n        super.render(epoch);\r\n\r\n        const positionEpoch = this.getPositionEpoch(epoch);\r\n\r\n        if (positionEpoch === false) {\r\n            this.threeObj.visible = false;\r\n            return;\r\n        }\r\n\r\n        const endingBrightness = this.showBehind ? 0.4 : 0;\r\n        const originPos = this.referenceFrame.getOriginPositionByEpoch(epoch);\r\n        let points = [];\r\n        let colors = [];\r\n\r\n        for (let i = 0; i < this.positions.length; ++i) {\r\n            if (this.epochs[i] < positionEpoch - this.trailPeriod) {\r\n                if (this.showBehind) {\r\n                    points.push(this.positions[i]);\r\n                    colors.push(0);\r\n                }\r\n                if (this.epochs[i+1] > positionEpoch - this.trailPeriod) {\r\n                    points.push(\r\n                        this.trajectory.getPositionByEpoch(positionEpoch - this.trailPeriod, this.referenceFrame)\r\n                    );\r\n                    colors.push(0);\r\n                }\r\n            } else if (this.epochs[i] < positionEpoch) {\r\n                points.push(this.positions[i]);\r\n                colors.push(1 - (positionEpoch - this.epochs[i]) / this.trailPeriod);\r\n            } else if (this.epochs[i] > positionEpoch && this.showAhead) {\r\n                points.push(this.positions[i]);\r\n                colors.push(0);\r\n            }\r\n\r\n            if ((this.epochs[i] < positionEpoch)\r\n                && (this.epochs[i+1] >= positionEpoch)\r\n            ) {\r\n                const pos = this.trajectory.getPositionByEpoch(positionEpoch, this.referenceFrame);\r\n                points.push(pos);\r\n                points.push(pos);\r\n                colors.push(1);\r\n                colors.push(0);\r\n            }\r\n        }\r\n\r\n        this.updateGeometry(points, colors, endingBrightness);\r\n\r\n        this.threeObj.quaternion.copy(this.referenceFrame.getQuaternionByEpoch(epoch).toThreejs());\r\n        this.setPosition(originPos);\r\n    }\r\n\r\n    findPointByEpoch(epoch) {\r\n        let low  = 0;\r\n        let high = this.epochs.length - 1;\r\n        let idx = Math.floor((low + high) / 2);\r\n\r\n        do {\r\n            if (this.epochs[idx] < epoch) {\r\n                low = idx;\r\n            } else if (this.epochs[idx] > epoch) {\r\n                high = idx;\r\n            } else {\r\n                return idx;\r\n            }\r\n            idx = Math.floor((low + high) / 2)\r\n        } while (idx != low);\r\n\r\n        return (epoch - this.epochs[idx] > this.epochs[idx + 1] - epoch)\r\n            ? idx + 1\r\n            : idx;\r\n    }\r\n\r\n    initVertices() {\r\n        const traj = this.trajectory;\r\n        let step = this.minStep;\r\n        let curEpoch = traj.minEpoch;\r\n        let curState = traj.getStateByEpoch(curEpoch, this.referenceFrame);\r\n        let curVelocity = curState.velocity.unit_();\r\n\r\n        this.positions = [curState.position];\r\n        this.epochs = [curEpoch];\r\n        let i = 1;\r\n\r\n        while (curEpoch < traj.maxEpoch) {\r\n            let lastState;\r\n            let lastEpoch;\r\n            let lastDrMag;\r\n            let isIncreasing = null;\r\n            let stepsLeft = 20;\r\n            while (true) {\r\n                const nextEpoch = (curEpoch + step > traj.maxEpoch)\r\n                    ? traj.maxEpoch\r\n                    : curEpoch + step;\r\n                step = nextEpoch - curEpoch;\r\n                const newState = traj.getStateByEpoch(nextEpoch, this.referenceFrame);\r\n                const dr = newState._position.sub(curState._position);\r\n                const drMag = dr.mag;\r\n                let angleCos = dr.dot(curVelocity) / drMag;\r\n\r\n                if (nextEpoch != traj.maxEpoch) {\r\n                    const nextNextEpoch = (nextEpoch + step > traj.maxEpoch)\r\n                        ? traj.maxEpoch\r\n                        : nextEpoch + step;\r\n                    const nextNewState = traj.getStateByEpoch(nextNextEpoch, this.referenceFrame);\r\n                    const nextDr = nextNewState._position.sub(newState._position);\r\n                    angleCos = Math.min(angleCos, dr.dot(nextDr) / drMag / nextDr.mag);\r\n                }\r\n\r\n                // angle is too big\r\n                if (angleCos < this.minCos) {\r\n                    if (isIncreasing === true) {\r\n                        break;\r\n                    }\r\n                    step /= 2;\r\n                    isIncreasing = false;\r\n                // angle is acceptable\r\n                } else {\r\n                    lastState = newState;\r\n                    lastEpoch = nextEpoch;\r\n                    lastDrMag = drMag;\r\n                    if (isIncreasing === false || nextEpoch === traj.maxEpoch) {\r\n                        break;\r\n                    }\r\n                    step *= 2;\r\n                    isIncreasing = true;\r\n                }\r\n\r\n                --stepsLeft;\r\n                if (stepsLeft === 0 || Math.abs(step) < this.minStep) {\r\n                    step = this.minStep * Math.sign(step);\r\n                    if (lastState === undefined) {\r\n                        lastState = newState;\r\n                        lastEpoch = nextEpoch;\r\n                        lastDrMag = drMag;\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n\r\n            this.epochs[i] = lastEpoch;\r\n            this.positions[i] = lastState.position;\r\n\r\n            curState = lastState;\r\n            curVelocity = curState.velocity.unit_();\r\n            curEpoch = lastEpoch;\r\n            i++;\r\n        }\r\n    }\r\n}\r\n","import TrajectoryAbstract from \"./Abstract\";\r\nimport StateVector from \"../StateVector\";\r\n\r\nexport default class TrajectoryStaticPosition extends TrajectoryAbstract\r\n{\r\n    constructor(referenceFrameId, pos) {\r\n        super();\r\n        this.setReferenceFrame(referenceFrameId);\r\n        this.pos = pos;\r\n    }\r\n\r\n    getStateInOwnFrameByEpoch(epoch) {\r\n        this.validateEpoch(epoch);\r\n        return new StateVector(this.pos);\r\n    }\r\n}\r\n","import TrajectoryKeplerianArray from \"../core/Trajectory/KeplerianArray\";\r\nimport TrajectoryKeplerianPrecessingArray from \"../core/Trajectory/KeplerianPrecessingArray\";\r\nimport TrajectoryKeplerianBasic from \"../core/Trajectory/KeplerianBasic\";\r\nimport TrajectoryKeplerianPrecessing from \"../core/Trajectory/KeplerianPrecessing\";\r\nimport KeplerianObject from \"../core/KeplerianObject\";\r\nimport TrajectoryComposite from \"../core/Trajectory/Composite\";\r\nimport VisualTrajectoryModelPointArray from \"../core/visual/Trajectory/PointArray\";\r\nimport VisualTrajectoryModelKeplerian from \"../core/visual/Trajectory/Keplerian\";\r\nimport TrajectoryStaticPosition from \"../core/Trajectory/StaticPosition\";\r\nimport {Vector} from \"../core/algebra\";\r\nimport { sim } from \"../core/Simulation\";\r\n\r\nexport default class TrajectoryLoader\r\n{\r\n    static create(config) {\r\n        let type = config.type;\r\n        let trajectory;\r\n        let visualModel;\r\n        let selectedVisualModel;\r\n\r\n        if (type === 'keplerian') {\r\n            trajectory = this.createKeplerianBasic(config);\r\n        } else if (type === 'keplerian_precessing') {\r\n            trajectory = this.createKeplerianPrecessing(config);\r\n        } else if (type === 'keplerian_array') {\r\n            trajectory = this.createKeplerianArray(config);\r\n        } else if (type === 'keplerian_precessing_array') {\r\n            trajectory = this.createKeplerianPrecessingArray(config);\r\n        } else if (type === 'composite') {\r\n            trajectory = this.createComposite(config);\r\n        } else if (type === 'static') {\r\n            trajectory = this.createStatic(config);\r\n        } else {\r\n            const className = sim.getClass(type);\r\n            trajectory = new className(config.data);\r\n        }\r\n\r\n        if (config.periodStart !== undefined) {\r\n            trajectory.minEpoch = config.periodStart;\r\n        }\r\n        if (config.periodEnd !== undefined) {\r\n            trajectory.maxEpoch = config.periodEnd;\r\n        }\r\n\r\n        // temporary\r\n        if (config.rendering) {\r\n            config.visual = config.rendering;\r\n        }\r\n\r\n        if (config.visual !== undefined) {\r\n            if (config.visual.regular !== undefined) {\r\n                visualModel = this.createVisualModel(trajectory, config.visual.regular);\r\n                selectedVisualModel = this.createVisualModel(trajectory, config.visual.selected);\r\n            } else {\r\n                visualModel = this.createVisualModel(trajectory, config.visual);\r\n            }\r\n        }\r\n\r\n        if (visualModel) {\r\n            trajectory.setVisualModel(visualModel);\r\n        }\r\n        if (selectedVisualModel) {\r\n            trajectory.setSelectedVisualModel(selectedVisualModel);\r\n        }\r\n\r\n        return trajectory;\r\n    }\r\n\r\n    static createVisualModel(trajectory, config) {\r\n        // legacy format, will be removed\r\n        if (config.keplerianModel) {\r\n            return new VisualTrajectoryModelKeplerian(trajectory, config);\r\n        } else if (config.pointArrayModel) {\r\n            return new VisualTrajectoryModelPointArray(trajectory, config);\r\n        }\r\n\r\n        let className;\r\n        if (config.model === 'keplerian') {\r\n            className = VisualTrajectoryModelKeplerian;\r\n        } else if (config.model === 'pointArray') {\r\n            className = VisualTrajectoryModelPointArray;\r\n        } else {\r\n            className = sim.getClass(config.model);\r\n        }\r\n        return new className(trajectory, config.config);\r\n    }\r\n\r\n    static createComposite(config) {\r\n        let traj = new TrajectoryComposite();\r\n        for (const partConfig of config.data) {\r\n            traj.addComponent(this.create(partConfig));\r\n        }\r\n        return traj;\r\n    }\r\n\r\n    static createKeplerianArray(config) {\r\n        let traj = new TrajectoryKeplerianArray(\r\n            config.data.referenceFrame\r\n        );\r\n\r\n        for (const entry of config.data.elementsArray) {\r\n            traj.addState(this.createKeplerianObject(entry, config.data.mu));\r\n        }\r\n        return traj;\r\n    }\r\n\r\n    static createKeplerianPrecessingArray(config) {\r\n        let traj = new TrajectoryKeplerianPrecessingArray(\r\n            config.data.referenceFrame,\r\n            config.data.radius,\r\n            config.data.j2\r\n        );\r\n\r\n        for (const entry of config.data.elementsArray) {\r\n            traj.addState(this.createKeplerianObject(entry, config.data.mu));\r\n        }\r\n        return traj;\r\n    }\r\n\r\n    static createKeplerianBasic(config) {\r\n        return new TrajectoryKeplerianBasic(\r\n            config.data.referenceFrame,\r\n            this.createKeplerianObject(config.data.elements)\r\n        );\r\n    }\r\n\r\n    static createKeplerianPrecessing(config) {\r\n        return new TrajectoryKeplerianPrecessing(\r\n            config.data.referenceFrame,\r\n            this.createKeplerianObject(config.data.elements),\r\n            config.data.radius,\r\n            config.data.j2\r\n        );\r\n    }\r\n\r\n    static createStatic(config) {\r\n        return new TrajectoryStaticPosition(\r\n            config.data.referenceFrame,\r\n            new Vector(config.data.position)\r\n        );\r\n    }\r\n\r\n    static createKeplerianObject(elements, mu) {\r\n        return new KeplerianObject(\r\n            elements[0], // ecc\r\n            elements[1] / (1 - elements[0]), // sma = Rper / (1 - ecc)\r\n            elements[2], // aop\r\n            elements[3], // inc\r\n            elements[4], // raan\r\n            elements[5], // mean anomaly\r\n            elements[6], // epoch\r\n            mu ? mu : elements[7], // mu\r\n            false\r\n        );\r\n    }\r\n}\r\n","import * as THREE from \"three\";\r\n\r\nimport { deg2rad, Quaternion } from \"../algebra\";\r\nimport VisualModelAbstract from \"./ModelAbstract\";\r\n\r\nexport default class VisualStarsModel extends VisualModelAbstract\r\n{\r\n    constructor(data) {\r\n        super();\r\n\r\n        let threeGeometry = new THREE.Geometry();\r\n\r\n        const starDist = 1e12;\r\n\r\n        for(let params of data) {\r\n\r\n            threeGeometry.vertices.push(new THREE.Vector3(\r\n                starDist * Math.cos(deg2rad(params[0])) * Math.cos(deg2rad(params[1])),\r\n                starDist * Math.sin(deg2rad(params[0])) * Math.cos(deg2rad(params[1])),\r\n                starDist * Math.sin(deg2rad(params[1]))\r\n            ));\r\n\r\n            threeGeometry.colors.push(new THREE.Color(\r\n                params[2] / 50,\r\n                params[2] / 50,\r\n                params[2] / 50\r\n            ));\r\n        }\r\n\r\n        this.setThreeObj(new THREE.Points(\r\n            threeGeometry,\r\n            new THREE.PointsMaterial({\r\n                vertexColors: THREE.VertexColors,\r\n                size: 2,\r\n                sizeAttenuation: false\r\n            })\r\n        ));\r\n\r\n        this.threeObj.quaternion.copy(new Quaternion([-1, 0, 0], deg2rad(23.4)).toThreejs());\r\n    }\r\n}\r\n","import * as THREE from \"three\";\r\n\r\nimport VisualModelAbstract from \"./ModelAbstract\";\r\nimport { sim } from \"../Simulation\";\r\n\r\nexport default class VisualLabel extends VisualModelAbstract {\r\n    constructor(positionOfEpoch, parameters) {\r\n        super();\r\n\r\n        this.visible = true;\r\n\r\n        this.parameters = Object.assign({}, VisualLabel.DEFAULT_SETTINGS, parameters);\r\n        this.positionOfEpoch = positionOfEpoch;\r\n\r\n        this.canvas = document.createElement('canvas');\r\n\r\n        this.setThreeObj(new THREE.Sprite(new THREE.SpriteMaterial(\r\n            {map: new THREE.CanvasTexture(this.canvas)}\r\n        )));\r\n\r\n        this.threeObj.renderOrder = 1;\r\n\r\n        this.setText(this.parameters.text);\r\n    }\r\n\r\n    setText(text) {\r\n        let context = this.canvas.getContext('2d');\r\n        context.font = this.parameters.fontSize + 'px ' + this.parameters.font;\r\n\r\n        let canvasWidth = context.measureText(text).width;\r\n        let canvasHeight = this.parameters.fontSize * (1 + this.parameters.margin) * 2;\r\n        this.canvas.width = THREE.Math.ceilPowerOfTwo(canvasWidth);\r\n        this.canvas.height = THREE.Math.ceilPowerOfTwo(canvasHeight);\r\n\r\n        context.font = this.parameters.fontSize + 'px ' + this.parameters.font;\r\n        context.fillStyle = this.parameters.color;\r\n        context.textAlign = 'center';\r\n        context.textBaseline = 'bottom';\r\n        context.fillText(\r\n            text,\r\n            this.canvas.width / 2,\r\n            this.parameters.fontSize + (this.canvas.height - canvasHeight) / 2\r\n        );\r\n\r\n        this.threeObj.material.map.needsUpdate = true;\r\n    }\r\n\r\n    render(epoch) {\r\n        if (!this.visible) {\r\n            this.threeObj.visible = false;\r\n            return;\r\n        }\r\n\r\n        this.setPosition(this.positionOfEpoch.evaluate(epoch));\r\n\r\n        const distance = this.threeObj.position.length();\r\n\r\n        const scaleCoeff = this.calculateScaleCoeff(distance, this.parameters.scaling) / 2;\r\n        this.threeObj.scale.x = this.canvas.width  * scaleCoeff;\r\n        this.threeObj.scale.y = this.canvas.height * scaleCoeff;\r\n\r\n        this.threeObj.visible = 1 < Math.max(this.threeObj.scale.x, this.threeObj.scale.y) /\r\n            (distance * this.pixelAngleSize) / 2;\r\n    }\r\n\r\n    calculateScaleCoeff(distance, scaling) {\r\n        if (typeof scaling.callback === 'string') {\r\n            return VisualLabel.scalingFunctions[scaling.callback](distance, scaling.range);\r\n        }\r\n        return scaling.callback(distance, scaling.range);\r\n    }\r\n}\r\n\r\nVisualLabel.DEFAULT_SETTINGS = {\r\n    text: '',\r\n    font: 'Arial',\r\n    color: 'white',\r\n    fontSize: 32,\r\n    margin: 0,\r\n    scaling: {\r\n        range: {\r\n            from: 30000,\r\n            to: 700000,\r\n        },\r\n        callback: 'range'\r\n    }\r\n};\r\n\r\nVisualLabel.scalingFunctions = {\r\n    alwaysVisible: (distance) => distance * sim.raycaster.getPixelAngleSize(),\r\n    range: (distance, range) => {\r\n        if (distance < range.from) {\r\n            return range.from * sim.raycaster.getPixelAngleSize();\r\n        }\r\n        if (distance > range.to) {\r\n            return range.to * sim.raycaster.getPixelAngleSize();\r\n        }\r\n        return distance * sim.raycaster.getPixelAngleSize();\r\n    }\r\n};\r\n","import * as THREE from \"three\";\r\n\r\nimport VisualModelAbstract from \"../ModelAbstract\";\r\nimport VisualLabel from \"../Label\";\r\nimport EphemerisObject from \"../../EphemerisObject\";\r\nimport FunctionOfEpochCustom from \"../../FunctionOfEpoch/Custom\";\r\nimport { sim } from \"../../Simulation\";\r\n\r\nexport default class VisualBodyModelAbstract extends VisualModelAbstract\r\n{\r\n    constructor(shape, config) {\r\n        super();\r\n\r\n        this.shape = shape;   // class VisualShapeAbstract\r\n        this.color = config.color;\r\n        this.body = null; // class Body\r\n\r\n        this.setThreeObj(this.getThreeObj());\r\n        this.threeObj.add(new THREE.AxesHelper(shape.radius * 2));\r\n    }\r\n\r\n    getThreeObj() {\r\n        return new THREE.Mesh(\r\n            this.shape.getThreeGeometry(),\r\n            this.getMaterial({color: this.color, wireframe: true})\r\n        );\r\n    }\r\n\r\n    setObject(obj) {\r\n        this.body = obj;\r\n        this.label = new VisualLabel(\r\n            new FunctionOfEpochCustom((epoch) => {\r\n                return obj.getPositionByEpoch(epoch).add_(sim.camera.getTopDirection(epoch).mul_(this.shape.getMaxDimension() / 2));\r\n            }),\r\n            {\r\n                text: this.body.name,\r\n                margin: 0.3,\r\n                scaling: (this.body.type === EphemerisObject.TYPE_STAR\r\n                        || this.body.type === EphemerisObject.TYPE_PLANET)\r\n                    ? {callback: 'alwaysVisible'}\r\n                    : (this.body.type === EphemerisObject.TYPE_PLANETOID\r\n                        || this.body.type === EphemerisObject.TYPE_SATELLITE)\r\n                        ? {\r\n                            callback: 'range',\r\n                            range: {\r\n                                from: 5 * this.shape.getMaxDimension(),\r\n                                to: 1000 * this.shape.getMaxDimension()\r\n                            }\r\n                        }\r\n                        : VisualLabel.DEFAULT_SETTINGS.scaling\r\n            }\r\n        );\r\n        this.threeObj.userData = {selectionObject: obj};\r\n        sim.selection.addSelectableObject(this.threeObj);\r\n    }\r\n\r\n    getMaterial(parameters) {\r\n        return new THREE.MeshStandardMaterial(parameters);\r\n    }\r\n\r\n    drop() {\r\n        if (this.label) {\r\n            this.label.drop();\r\n        }\r\n\r\n        sim.selection.removeSelectableObject(this.threeObj);\r\n\r\n        super.drop();\r\n    }\r\n\r\n    render(epoch) {\r\n        if (this.label) {\r\n            this.label.visible = sim.settings.ui.showBodyLabels;\r\n        }\r\n        this.setPosition(this.body.getPositionByEpoch(epoch));\r\n        this.threeObj.quaternion.copy(\r\n            this.body.orientation.getQuaternionByEpoch(epoch).toThreejs()\r\n        );\r\n    }\r\n}\r\n","import * as THREE from \"three\";\r\n\r\nimport VisualBodyModelAbstract from \"./Abstract\";\r\nimport VisualModelAbstract from \"../ModelAbstract\"\r\nimport { sim } from \"../../Simulation\";\r\n\r\nexport default class VisualBodyModelBasic extends VisualBodyModelAbstract\r\n{\r\n    constructor(shape, config) {\r\n        super(shape, config);\r\n\r\n        this.texturePath = config.texturePath;\r\n        this.isTextureRequested = false;\r\n    }\r\n\r\n    getMaterial(parameters) {\r\n        parameters.metalness = 0;\r\n        parameters.roughness = 1;\r\n        return new THREE.MeshStandardMaterial(parameters);\r\n    }\r\n\r\n    render(epoch) {\r\n        super.render(epoch);\r\n        if (!this.isTextureRequested\r\n            && this.texturePath\r\n            && this.shape.getMaxDimension() / this.threeObj.position.length() > this.pixelAngleSize\r\n        ) {\r\n            this.isTextureRequested = true;\r\n            sim.textureLoader.load(\r\n                VisualModelAbstract.texturePath + this.texturePath,\r\n                (txt) => {\r\n                    if (this.threeObj) {\r\n                        this.threeObj.material.dispose();\r\n                        this.threeObj.material = this.getMaterial({map: txt});\r\n                    }\r\n                },\r\n                undefined,\r\n                function(err) {\r\n                    console.log(err);\r\n                }\r\n            );\r\n        }\r\n    }\r\n}\r\n","import * as THREE from \"three\";\r\n\r\nimport VisualBodyModelBasic from \"./Basic\";\r\nimport { sim } from \"../../Simulation\";\r\n\r\nexport default class VisualBodyModelLight extends VisualBodyModelBasic\r\n{\r\n    constructor(shape, config) {\r\n        super(shape, config);\r\n        this.light = new THREE.PointLight(\r\n            config.lightColor,\r\n            config.lightIntensity,\r\n            config.lightDistance || null,\r\n            config.lightDecay || null\r\n        );\r\n        this.scene.add(this.light);\r\n    }\r\n\r\n    render(epoch) {\r\n        super.render(epoch);\r\n        this.light.position.copy(sim.getVisualCoords(this.body.getPositionByEpoch(epoch)));\r\n    }\r\n\r\n    getMaterial(parameters) {\r\n        return new THREE.MeshBasicMaterial(parameters);\r\n    }\r\n\r\n    drop() {\r\n        this.scene.remove(this.light);\r\n        super.drop();\r\n    }\r\n}\r\n","import * as THREE from \"three\";\r\n\r\nimport VisualBodyModelAbstract from \"./Abstract\";\r\nimport VisualModelAbstract from \"../ModelAbstract\"\r\nimport { sim } from \"../../Simulation\";\r\n\r\nexport default class VisualBodyModelRings extends VisualBodyModelAbstract\r\n{\r\n    constructor(shape, config) {\r\n        super(shape, config);\r\n\r\n        this.texturePath = config.texturePath;\r\n        this.ringsRadius = config.ringsRadius;\r\n        this.ringsColorMapPath = config.ringsColorMapPath;\r\n        this.ringsAlphaMapPath = config.ringsAlphaMapPath;\r\n        this.isTextureRequested = false;\r\n    }\r\n\r\n    getThreeObj() {\r\n        let container = new THREE.Object3D();\r\n\r\n        this.bodyThreeObj = new THREE.Mesh(\r\n            this.shape.getThreeGeometry(),\r\n            this.getMaterial({color: this.color, wireframe: true})\r\n        );\r\n\r\n        this.ringsThreeObj = new THREE.Mesh(\r\n            new THREE.CircleGeometry(140220, 64),\r\n            this.getMaterial({color: this.color, wireframe: true})\r\n        );\r\n\r\n        container.add(this.bodyThreeObj);\r\n        container.add(this.ringsThreeObj);\r\n\r\n        return container;\r\n    }\r\n\r\n    updateRingsMaterial() {\r\n        if (this.ringsColorMap && this.ringsAlphaMap) {\r\n            this.ringsThreeObj.material.dispose();\r\n            this.ringsThreeObj.material = this.getMaterial({\r\n                map: this.ringsColorMap,\r\n                alphaMap: this.ringsAlphaMap,\r\n                side: THREE.DoubleSide,\r\n                transparent: true\r\n            });\r\n        }\r\n    }\r\n\r\n    getMaterial(parameters) {\r\n        parameters.metalness = 0;\r\n        parameters.roughness = 1;\r\n        return new THREE.MeshStandardMaterial(parameters);\r\n    }\r\n\r\n    render(epoch) {\r\n        super.render(epoch);\r\n        if (!this.isTextureRequested\r\n            && this.texturePath\r\n            && this.shape.getMaxDimension() / this.threeObj.position.length() > this.pixelAngleSize\r\n        ) {\r\n            this.isTextureRequested = true;\r\n            sim.textureLoader.load(\r\n                VisualModelAbstract.texturePath + this.texturePath,\r\n                (txt) => {\r\n                    this.bodyThreeObj.material.dispose();\r\n                    this.bodyThreeObj.material = this.getMaterial({map: txt});\r\n                },\r\n                undefined,\r\n                function(err) {\r\n                    console.log(err);\r\n                }\r\n            );\r\n            sim.textureLoader.load(\r\n                VisualModelAbstract.texturePath + this.ringsColorMapPath,\r\n                (txt) => {\r\n                    this.ringsColorMap = txt;\r\n                    this.updateRingsMaterial();\r\n                },\r\n                undefined,\r\n                function(err) {\r\n                    console.log(err);\r\n                }\r\n            );\r\n            sim.textureLoader.load(\r\n                VisualModelAbstract.texturePath + this.ringsAlphaMapPath,\r\n                (txt) => {\r\n                    this.ringsAlphaMap = txt;\r\n                    this.updateRingsMaterial();\r\n                },\r\n                undefined,\r\n                function(err) {\r\n                    console.log(err);\r\n                }\r\n            );\r\n        }\r\n    }\r\n}\r\n","import * as THREE from \"three\";\r\n\r\nimport VisualShapeAbstract from \"./Abstract\";\r\n\r\nexport default class VisualShapeSphere extends VisualShapeAbstract\r\n{\r\n    constructor(radius, segments) {\r\n        super();\r\n        this.radius = radius;\r\n        this.segments = segments;\r\n    }\r\n\r\n    getThreeGeometry() {\r\n        if (!this.threeGeometry) {\r\n            this.threeGeometry = new THREE.SphereGeometry(this.radius, this.segments * 2, this.segments);\r\n            this.threeGeometry.rotateX(Math.PI / 2);\r\n        }\r\n\r\n        return this.threeGeometry;\r\n    }\r\n\r\n    getMaxDimension() {\r\n        return this.radius * 2;\r\n    }\r\n}\r\n","import $ from \"jquery\";\r\n\r\nimport ReferenceFrameFactory, {RF_BASE_OBJ} from \"../core/ReferenceFrame/Factory\";\r\nimport Body from \"../core/Body\";\r\nimport OrientationConstantAxis from \"../core/Orientation/ConstantAxis\";\r\nimport PhysicalBodyModel from \"../core/PhysicalBodyModel\";\r\nimport EphemerisObject from \"../core/EphemerisObject\";\r\nimport TrajectoryLoader from \"./TrajectoryLoader\";\r\nimport VisualStarsModel from \"../core/visual/StarsModel\";\r\nimport VisualBodyModelLight from \"../core/visual/BodyModel/Light\";\r\nimport VisualBodyModelRings from \"../core/visual/BodyModel/Rings\";\r\nimport VisualBodyModelBasic from \"../core/visual/BodyModel/Basic\";\r\nimport VisualShapeSphere from \"../core/visual/Shape/Sphere\";\r\nimport Events from \"../core/Events\";\r\nimport { sim } from \"../core/Simulation\";\r\nimport {STAR_SYSTEM_BARYCENTER} from \"../core/StarSystem\";\r\n\r\nexport default class StarSystemLoader\r\n{\r\n    static loadFromConfig(starSystem, config) {\r\n        // Loading name\r\n        starSystem.name = config.name;\r\n\r\n        // Loading main object\r\n        starSystem.mainObject = config.mainObject;\r\n\r\n        starSystem.addObject(\r\n            STAR_SYSTEM_BARYCENTER,\r\n            new EphemerisObject(STAR_SYSTEM_BARYCENTER, EphemerisObject.TYPE_POINT, 'Star system barycenter')\r\n        );\r\n\r\n        // Loading objects\r\n        for (const objectConfig of config.objects) {\r\n            this._loadObject(starSystem, objectConfig);\r\n        }\r\n\r\n        Events.dispatch(Events.LOADING_BODIES_DONE);\r\n\r\n        // Loading reference frames\r\n        starSystem.addReferenceFrame(RF_BASE_OBJ);\r\n\r\n        for (const frame of config.referenceFrames) {\r\n            starSystem.addReferenceFrame(\r\n                ReferenceFrameFactory.create(frame.id, frame.type, frame.config)\r\n            );\r\n        }\r\n\r\n        Events.dispatch(Events.LOADING_FRAMES_DONE);\r\n\r\n        // Loading trajectories\r\n        for (const objectConfig of config.objects) {\r\n            starSystem.getObject(objectConfig.id).setTrajectory(TrajectoryLoader.create(objectConfig.trajectory));\r\n        }\r\n\r\n        Events.dispatch(Events.LOADING_TRAJECTORIES_DONE);\r\n\r\n        // Loading stars\r\n        starSystem.addStars(new VisualStarsModel(config.stars));\r\n    }\r\n\r\n    static loadObjectByUrl(starSystem, url) {\r\n        $.getJSON(url, (objectConfig) => {\r\n            this._loadObject(starSystem, objectConfig);\r\n            starSystem.getObject(objectConfig.id).setTrajectory(TrajectoryLoader.create(objectConfig.trajectory));\r\n        });\r\n    }\r\n\r\n    static _loadObject(starSystem, config) {\r\n        let object;\r\n        let visualModel = null;\r\n        let physicalModel = null;\r\n        let orientation = null;\r\n\r\n        if (config.visual) {\r\n            const visualShape = new VisualShapeSphere(\r\n                config.visual.config.radius,\r\n                config.visual.config.texturePath ? 32 : 12\r\n            );\r\n            const visualModelClass = {\r\n                'basic': VisualBodyModelBasic,\r\n                'light': VisualBodyModelLight,\r\n                'rings': VisualBodyModelRings,\r\n            }[config.visual.model];\r\n\r\n            if (visualModelClass !== undefined) {\r\n                visualModel = new visualModelClass(visualShape, config.visual.config);\r\n            }\r\n        }\r\n\r\n        if (config.physical || config.orientation) {\r\n            if (!config.orientation) {\r\n                config.orientation = {\r\n                    type: 'constantAxis',\r\n                    config: {\r\n                        vector: [0, 0, 1e-11]\r\n                    }\r\n                };\r\n            }\r\n            let className;\r\n            if (config.orientation.type === 'constantAxis') {\r\n                className = OrientationConstantAxis;\r\n            } else {\r\n                className = sim.getClass(config.orientation.type);\r\n            }\r\n            orientation = new className(config.orientation.config);\r\n        }\r\n\r\n        if (config.physical) {\r\n            physicalModel = new PhysicalBodyModel(\r\n                config.physical\r\n            );\r\n        }\r\n\r\n        if (visualModel || physicalModel || orientation) {\r\n            object = new Body(\r\n                config.id,\r\n                config.type || EphemerisObject.TYPE_UNKNOWN,\r\n                config.name,\r\n                config.data,\r\n                visualModel,\r\n                physicalModel,\r\n                orientation\r\n            );\r\n        } else {\r\n            object = new EphemerisObject(\r\n                config.id,\r\n                config.type || EphemerisObject.TYPE_UNKNOWN,\r\n                config.name,\r\n                config.data\r\n            );\r\n        }\r\n\r\n        starSystem.addObject(\r\n            config.id,\r\n            object\r\n        );\r\n    }\r\n}\r\n","var map = {\n\t\"./KSP/ModuleKSP\": [\n\t\t95,\n\t\t2\n\t],\n\t\"./KSP/ModuleKSP.js\": [\n\t\t95,\n\t\t2\n\t],\n\t\"./PatchedConics/FlightEvent/SOIArrival\": [\n\t\t49\n\t],\n\t\"./PatchedConics/FlightEvent/SOIArrival.js\": [\n\t\t49\n\t],\n\t\"./PatchedConics/FlightEvent/SOIChangeAbstract\": [\n\t\t38\n\t],\n\t\"./PatchedConics/FlightEvent/SOIChangeAbstract.js\": [\n\t\t38\n\t],\n\t\"./PatchedConics/FlightEvent/SOIDeparture\": [\n\t\t48\n\t],\n\t\"./PatchedConics/FlightEvent/SOIDeparture.js\": [\n\t\t48\n\t],\n\t\"./PatchedConics/ModulePatchedConics\": [\n\t\t96,\n\t\t3\n\t],\n\t\"./PatchedConics/ModulePatchedConics.js\": [\n\t\t96,\n\t\t3\n\t],\n\t\"./PatchedConics/PropagatorPatchedConics\": [\n\t\t92,\n\t\t4\n\t],\n\t\"./PatchedConics/PropagatorPatchedConics.js\": [\n\t\t92,\n\t\t4\n\t],\n\t\"./PatchedConics/visual/FlightEvent/SOIArrival\": [\n\t\t53\n\t],\n\t\"./PatchedConics/visual/FlightEvent/SOIArrival.js\": [\n\t\t53\n\t],\n\t\"./PatchedConics/visual/FlightEvent/SOIDeparture\": [\n\t\t52\n\t],\n\t\"./PatchedConics/visual/FlightEvent/SOIDeparture.js\": [\n\t\t52\n\t],\n\t\"./SolarSystem/ModuleSolarSystem\": [\n\t\t90,\n\t\t0\n\t],\n\t\"./SolarSystem/ModuleSolarSystem.js\": [\n\t\t90,\n\t\t0\n\t],\n\t\"./SolarSystem/Orientation/IAUModel\": [\n\t\t91,\n\t\t5\n\t],\n\t\"./SolarSystem/Orientation/IAUModel.js\": [\n\t\t91,\n\t\t5\n\t],\n\t\"./SolarSystem/Trajectory/ELP2000\": [\n\t\t93,\n\t\t0\n\t],\n\t\"./SolarSystem/Trajectory/ELP2000.js\": [\n\t\t93,\n\t\t0\n\t],\n\t\"./SolarSystem/Trajectory/VSOP87\": [\n\t\t94,\n\t\t0\n\t],\n\t\"./SolarSystem/Trajectory/VSOP87.js\": [\n\t\t94,\n\t\t0\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tvar ids = map[req];\n\tif(!ids) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\treturn Promise.all(ids.slice(1).map(__webpack_require__.e)).then(function() {\n\t\tvar id = ids[0];\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 100;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./getting-started-wizard/index\": [\n\t\t50,\n\t\t1\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tvar ids = map[req];\n\tif(!ids) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\tvar id = ids[0];\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 111;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./getting-started-wizard\": [\n\t\t50,\n\t\t1\n\t],\n\t\"./getting-started-wizard/\": [\n\t\t50,\n\t\t1\n\t],\n\t\"./getting-started-wizard/getting-started-wizard-eng\": [\n\t\t97,\n\t\t6\n\t],\n\t\"./getting-started-wizard/getting-started-wizard-eng.js\": [\n\t\t97,\n\t\t6\n\t],\n\t\"./getting-started-wizard/getting-started-wizard-ru\": [\n\t\t98,\n\t\t7\n\t],\n\t\"./getting-started-wizard/getting-started-wizard-ru.js\": [\n\t\t98,\n\t\t7\n\t],\n\t\"./getting-started-wizard/index\": [\n\t\t50,\n\t\t1\n\t],\n\t\"./getting-started-wizard/index.js\": [\n\t\t50,\n\t\t1\n\t],\n\t\"./wizard-ids\": [\n\t\t47\n\t],\n\t\"./wizard-ids.js\": [\n\t\t47\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tvar ids = map[req];\n\tif(!ids) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\treturn Promise.all(ids.slice(1).map(__webpack_require__.e)).then(function() {\n\t\tvar id = ids[0];\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 112;\nmodule.exports = webpackAsyncContext;","export const TOP_MENU_ITEMS = {\r\n    SIMULATION: \"Simulation\",\r\n    EDIT: \"Edit\",\r\n    VIEW: \"View\",\r\n    SETTINGS: \"Settings\",\r\n    HELP: \"Help\",\r\n};\r\n\r\nexport const HELP_PAGE_URL =\r\n    \"https://github.com/tossha/urbain/wiki/%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5-Urbain\";\r\n","import { HELP_PAGE_URL, TOP_MENU_ITEMS } from \"./constants\";\r\nimport { createContext } from \"./context\";\r\n\r\nexport const MenuItemType = {\r\n    NONE: 0,\r\n    LINK: 1,\r\n    DROPDOWN: 2,\r\n};\r\n\r\nclass MenuItem {\r\n    constructor(label, type = MenuItemType.NONE) {\r\n        this.label = label;\r\n        this.type = type;\r\n    }\r\n\r\n    get isClickable() {\r\n        return true;\r\n    }\r\n}\r\n\r\nclass LinkMenuItem extends MenuItem {\r\n    constructor(label, { href = \"\", target = \"_self\" } = {}) {\r\n        super(label, MenuItemType.LINK);\r\n\r\n        this.href = href;\r\n        this.target = target;\r\n    }\r\n\r\n    get isClickable() {\r\n        return Boolean(this.href);\r\n    }\r\n}\r\n\r\nclass DropDownMenuItem extends MenuItem {\r\n    constructor(label, options = []) {\r\n        super(label, MenuItemType.DROPDOWN);\r\n\r\n        this.options = options;\r\n    }\r\n\r\n    onSelect = selectedLabel => {\r\n        this.options = this.options.map(option => {\r\n            const newOption = {\r\n                ...option,\r\n                selected: selectedLabel === option.label ? !option.selected : option.selected,\r\n            };\r\n\r\n            if (selectedLabel === option.label && option.onUpdate) {\r\n                option.onUpdate(newOption);\r\n            }\r\n\r\n            return newOption;\r\n        });\r\n    };\r\n}\r\n\r\nclass Store {\r\n    constructor(simulation, loadTLE) {\r\n        this._simulation = simulation;\r\n        this._loadTLE = loadTLE;\r\n    }\r\n\r\n    viewSettings = {\r\n        showStatistics: false,\r\n        showBodyLabels: true,\r\n        showOrbitCreationPanel: false,\r\n        showTransferCalculationPanel: false,\r\n        showSatelliteSearchPanel: false,\r\n    };\r\n\r\n    topMenu = [\r\n        new DropDownMenuItem(TOP_MENU_ITEMS.SIMULATION, [\r\n            {\r\n                label: \"Orbit creation panel\",\r\n                selected: this.viewSettings.showOrbitCreationPanel,\r\n                onUpdate: ({ selected }) => {\r\n                    this.viewSettings.showOrbitCreationPanel = selected;\r\n                },\r\n            },\r\n            {\r\n                label: \"Transfer calculation panel\",\r\n                selected: this.viewSettings.showTransferCalculationPanel,\r\n                onUpdate: ({ selected }) => {\r\n                    this.viewSettings.showTransferCalculationPanel = selected;\r\n                },\r\n            },\r\n        ]),\r\n        new LinkMenuItem(TOP_MENU_ITEMS.EDIT),\r\n        new DropDownMenuItem(TOP_MENU_ITEMS.VIEW, [\r\n            {\r\n                label: \"Body Labels\",\r\n                selected: this.viewSettings.showBodyLabels,\r\n                onUpdate: ({ selected }) => {\r\n                    this._simulation.settings.ui.showBodyLabels = selected;\r\n                    this.viewSettings.showBodyLabels = selected;\r\n                },\r\n            },\r\n            {\r\n                label: \"Statistics badge\",\r\n                selected: false,\r\n                onUpdate: ({ selected }) => {\r\n                    this.viewSettings.showStatistics = selected;\r\n                },\r\n            },\r\n            {\r\n                label: \"Satellite search panel\",\r\n                selected: this.viewSettings.showSatelliteSearchPanel,\r\n                onUpdate: ({ selected }) => {\r\n                    this.viewSettings.showSatelliteSearchPanel = selected;\r\n                },\r\n            },\r\n        ]),\r\n        new LinkMenuItem(TOP_MENU_ITEMS.HELP, {\r\n            href: HELP_PAGE_URL,\r\n            target: \"_blank\",\r\n        }),\r\n    ];\r\n\r\n    get starSystemSelectorSettings() {\r\n        const { starSystemManager } = this._simulation;\r\n\r\n        return {\r\n            options: starSystemManager.starSystems,\r\n            defaultValue: starSystemManager.defaultStarSystem,\r\n            onSelect: item => starSystemManager.loadByIdx(item.idx),\r\n        };\r\n    }\r\n\r\n    loadSatellite = noradId => {\r\n        this._loadTLE(noradId);\r\n    };\r\n\r\n    unloadSatellite = noradId => {\r\n        this._simulation.starSystem.deleteObject(-(100000 + (0 | noradId)));\r\n    };\r\n}\r\n\r\nconst { Provider, Consumer } = createContext();\r\n\r\nexport { Store, TOP_MENU_ITEMS, Provider, Consumer };\r\n","import React from \"react\";\r\n\r\nexport function createContext(defaultValue) {\r\n    const { Provider, Consumer } = React.createContext(defaultValue);\r\n\r\n    return {\r\n        Provider,\r\n        Consumer,\r\n    };\r\n}\r\n","import React, { Component } from \"react\";\r\nimport Stats from \"stats.js\";\r\n\r\nimport { Consumer } from \"../../store/index\";\r\nimport \"./index.scss\";\r\n\r\nclass StatisticsBadge extends Component {\r\n    elementRef = React.createRef();\r\n\r\n    componentDidMount() {\r\n        this.elementRef.current.appendChild(this.props.stats.dom);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        this.elementRef = null;\r\n    }\r\n\r\n    render() {\r\n        return <div ref={this.elementRef} className=\"statistics-badge\" />;\r\n    }\r\n}\r\n\r\nexport default () => (\r\n    <Consumer>\r\n        {({ store, stats }) => (store.viewSettings.showStatistics ? <StatisticsBadge stats={stats} /> : null)}\r\n    </Consumer>\r\n);\r\n\r\nexport function createStatsBadge() {\r\n    const statsBadge = new Stats();\r\n    statsBadge.dom.classList.add(\"stats-badge\");\r\n\r\n    return statsBadge;\r\n}\r\n","class LocalStorageWatchStatusService {\r\n    static KEY = \"urbain-watched-wizards\";\r\n\r\n    constructor(storage) {\r\n        this._storage = storage;\r\n    }\r\n\r\n    canWatch(wizardId) {\r\n        return !this._getWatchedWizards().some(id => id === wizardId);\r\n    }\r\n\r\n    markAsWatched(wizardId) {\r\n        if (!this.canWatch(wizardId)) {\r\n            return;\r\n        }\r\n        const wizards = this._getWatchedWizards();\r\n\r\n        wizards.push(wizardId);\r\n\r\n        this._saveStatuses(wizards);\r\n    }\r\n\r\n    _getWatchedWizards() {\r\n        const wizardIdsRawString = this._storage.getItem(LocalStorageWatchStatusService.KEY);\r\n\r\n        if (!wizardIdsRawString) {\r\n            return [];\r\n        }\r\n\r\n        return JSON.parse(wizardIdsRawString);\r\n    }\r\n\r\n    _saveStatuses(wizardIds) {\r\n        this._storage.setItem(LocalStorageWatchStatusService.KEY, JSON.stringify(wizardIds));\r\n    }\r\n}\r\n\r\nexport default LocalStorageWatchStatusService;\r\n","import React from \"react\";\r\nimport { render, unmountComponentAtNode } from \"react-dom\";\r\n\r\nimport \"./index.scss\";\r\n\r\nexport function showLangSelectorDialog(langs) {\r\n    let rootNode = document.createElement(\"div\");\r\n    document.body.appendChild(rootNode);\r\n\r\n    const removeDialog = () => {\r\n        if (rootNode) {\r\n            unmountComponentAtNode(rootNode);\r\n            rootNode.parentNode.removeChild(rootNode);\r\n            rootNode = null;\r\n        }\r\n    };\r\n\r\n    return new Promise(resolve => {\r\n        render(\r\n            <div className=\"language-selector-wrapper\">\r\n                <div className=\"language-selector\">\r\n                    {langs.map(({ id, description, buttonLabel }) => {\r\n                        const handleNext = () => {\r\n                            removeDialog();\r\n                            resolve(id);\r\n                        };\r\n\r\n                        return (\r\n                            <div key={id} className=\"language-selector__row\">\r\n                                <span className=\"language-selector__content\">{description}</span>\r\n\r\n                                <button className=\"language-selector__button\" onClick={handleNext}>\r\n                                    {buttonLabel}\r\n                                </button>\r\n                            </div>\r\n                        );\r\n                    })}\r\n                </div>\r\n            </div>,\r\n            rootNode,\r\n        );\r\n    });\r\n}\r\n","class StepHandlerService {\r\n    constructor(goalPrefix, durationPrefix) {\r\n        this._goalPrefix = goalPrefix;\r\n        this._durationPrefix = durationPrefix;\r\n\r\n        this._stepStartTimes = {};\r\n        this._metrika = window.yaCounter47040543;\r\n    }\r\n\r\n    handleStep(nextStepIdx) {\r\n        if (!this._metrika || this._stepStartTimes[nextStepIdx] !== undefined) {\r\n            return;\r\n        }\r\n\r\n        const stepName = this._goalPrefix + nextStepIdx;\r\n\r\n        this._stepStartTimes[nextStepIdx] = +new Date();\r\n\r\n        if (nextStepIdx === 0) {\r\n            this._metrika.reachGoal(stepName);\r\n            return;\r\n        }\r\n\r\n        const durationName = this._durationPrefix + (nextStepIdx - 1);\r\n        this._metrika.reachGoal(stepName, {\r\n            [durationName]: this._stepStartTimes[nextStepIdx] - this._stepStartTimes[nextStepIdx - 1],\r\n        });\r\n    }\r\n}\r\n\r\nexport default StepHandlerService;\r\n","import * as wizardIds from \"./wizards/wizard-ids\";\r\nimport LocalStorageWatchStatusService from \"./services/local-storage-watch-status-service\";\r\nimport { showLangSelectorDialog } from \"./language-selector\";\r\nimport StepHandlerService from \"./services/step-handler-service\";\r\n\r\nasync function showWizard(\r\n    wizardId,\r\n    watchStatusService = new LocalStorageWatchStatusService(window.localStorage),\r\n    stepHandlerService = new StepHandlerService(\"tutorial_\", \"duration_tut_\"),\r\n) {\r\n    if (!watchStatusService.canWatch(wizardId)) {\r\n        return;\r\n    }\r\n\r\n    const { default: wizard } = await import(/* webpackChunkName: \"[request]\" */ `./wizards/${wizardId}/index`);\r\n\r\n    stepHandlerService.handleStep(0);\r\n\r\n    const selectedId = await showLangSelectorDialog(wizard.langs);\r\n\r\n    Promise.all([\r\n        import(/* webpackChunkName: \"[request]\" */ `./wizards/${wizardId}/${selectedId}`),\r\n        import(/* webpackChunkName: \"createIntroJs\" */ `./create-intro-js`),\r\n        import(/* webpackChunkName: \"introjsStyles\" */ \"./introjs.scss\"),\r\n    ])\r\n        .then(([{ default: wizardConfig }, { createIntroJs }]) => {\r\n            const intro = createIntroJs(wizardConfig, {\r\n                onStep() {\r\n                    stepHandlerService.handleStep(this._currentStep + 1);\r\n                },\r\n                onComplete() {\r\n                    stepHandlerService.handleStep(this._currentStep + 2);\r\n                    watchStatusService.markAsWatched(wizardId);\r\n                },\r\n            });\r\n            intro.start();\r\n        })\r\n        .catch(error => {\r\n            console.error(error.message);\r\n        });\r\n}\r\n\r\nexport { showWizard, wizardIds };\r\n","import React from \"react\";\r\n\r\nconst Logo = ({ className }) => <div className={className} />;\r\n\r\nexport default Logo;\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport ReactSelect, { components } from \"react-select\";\r\n\r\nconst DEFAULT = {\r\n    background: \"var(--black)\",\r\n    color: \"var(--white-text)\",\r\n    containerHeight: 24,\r\n};\r\n\r\nconst customSelectStyles = {\r\n    container: base => ({\r\n        ...base,\r\n        background: DEFAULT.background,\r\n        color: DEFAULT.color,\r\n        minHeight: DEFAULT.containerHeight,\r\n        height: DEFAULT.containerHeight,\r\n        minWidth: 50,\r\n    }),\r\n\r\n    control: base => ({\r\n        ...base,\r\n        background: DEFAULT.background,\r\n        borderRadius: 0,\r\n        borderStyle: \"none\",\r\n        minHeight: DEFAULT.containerHeight,\r\n        height: DEFAULT.containerHeight,\r\n    }),\r\n\r\n    menu: base => ({\r\n        ...base,\r\n        borderRadius: 0,\r\n        marginTop: 0,\r\n        marginBottom: 0,\r\n    }),\r\n\r\n    menuList: base => ({\r\n        ...base,\r\n        background: \"var(--dark-gray)\",\r\n    }),\r\n\r\n    option: (base, state) => ({\r\n        ...base,\r\n        backgroundColor: state.isFocused ? \"var(--gray)\" : \"transparent\",\r\n    }),\r\n\r\n    singleValue: (base, state) => {\r\n        const opacity = state.isDisabled ? 0.5 : 1;\r\n        const transition = \"opacity 300ms\";\r\n\r\n        return {\r\n            ...base,\r\n            color: DEFAULT.color,\r\n            opacity,\r\n            transition,\r\n        };\r\n    },\r\n\r\n    dropdownIndicator: () => ({\r\n        padding: 0,\r\n        background: `url(\"/images/chevron-down-solid.svg\") 0 0 no-repeat`,\r\n        marginRight: 5,\r\n        height: 10,\r\n        width: 10,\r\n    }),\r\n\r\n    indicatorSeparator: () => ({\r\n        display: \"none\",\r\n    }),\r\n};\r\n\r\nconst IndicatorsContainer = props => {\r\n    return components.IndicatorsContainer && <components.IndicatorsContainer {...props} />;\r\n};\r\n\r\nconst DropdownIndicator = props => {\r\n    return (\r\n        components.DropdownIndicator && (\r\n            <components.DropdownIndicator {...props}>\r\n                <span />\r\n            </components.DropdownIndicator>\r\n        )\r\n    );\r\n};\r\n\r\nconst Select = ({ id, className, options, value, onSelect = () => {} }) => {\r\n    return (\r\n        <ReactSelect\r\n            id={id}\r\n            className={className}\r\n            classNamePrefix=\"select\"\r\n            placeholder=\"\"\r\n            styles={customSelectStyles}\r\n            isSearchable={false}\r\n            options={options}\r\n            defaultValue={value}\r\n            components={{ IndicatorsContainer, DropdownIndicator }}\r\n            onChange={onSelect}\r\n        />\r\n    );\r\n};\r\n\r\nexport const optionPropTypes = PropTypes.shape({\r\n    label: PropTypes.string,\r\n    value: PropTypes.string,\r\n});\r\n\r\nSelect.propTypes = {\r\n    id: PropTypes.string,\r\n    className: PropTypes.string,\r\n    options: PropTypes.arrayOf(optionPropTypes).isRequired,\r\n    value: optionPropTypes,\r\n    onSelect: PropTypes.func,\r\n};\r\n\r\nexport default Select;\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\n\r\nimport { Consumer } from \"../../../../store\";\r\nimport Select, { optionPropTypes } from \"../../../common/select/select\";\r\nimport \"./star-system-selector.scss\";\r\n\r\nfunction StarSystemSelector({ options, defaultValue, onSelect }) {\r\n    return (\r\n        <div className=\"star-system-selector\">\r\n            <div className=\"star-system-selector__label\">Star system</div>\r\n            <Select\r\n                className=\"star-system-selector__selector\"\r\n                options={options}\r\n                value={defaultValue || options[0]}\r\n                onSelect={onSelect}\r\n            />\r\n        </div>\r\n    );\r\n}\r\n\r\nStarSystemSelector.propTypes = {\r\n    options: PropTypes.arrayOf(optionPropTypes).isRequired,\r\n    defaultValue: optionPropTypes,\r\n    onSelect: PropTypes.func,\r\n};\r\n\r\nexport default () => (\r\n    <Consumer>\r\n        {({ store }) => {\r\n            const { options, defaultValue, onSelect } = store.starSystemSelectorSettings;\r\n\r\n            return <StarSystemSelector options={options} defaultValue={defaultValue} onSelect={onSelect} />;\r\n        }}\r\n    </Consumer>\r\n);\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\n\r\nclass DropdownMenuItem extends Component {\r\n    static propTypes = {\r\n        text: PropTypes.string.isRequired,\r\n        selected: PropTypes.bool,\r\n        onClick: PropTypes.func,\r\n    };\r\n\r\n    handleClick = () => {\r\n        this.props.onClick(this.props.text);\r\n    };\r\n\r\n    render() {\r\n        const { text, selected } = this.props;\r\n\r\n        return (\r\n            <li className=\"drop-down-menu__menu-item\" onClick={this.handleClick}>\r\n                <span className=\"drop-down-menu__menu-item-icon\">{selected && <FontAwesomeIcon icon=\"check\" />}</span>\r\n                {text}\r\n            </li>\r\n        );\r\n    }\r\n}\r\n\r\nexport default DropdownMenuItem;\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\n\r\nimport { Consumer } from \"../../../../../store/index\";\r\nimport DropDownMenuItem from \"./drop-down-menu-item\";\r\nimport \"./drop-down-menu.scss\";\r\n\r\nclass DropDownMenu extends Component {\r\n    static propTypes = {\r\n        text: PropTypes.string.isRequired,\r\n        options: PropTypes.arrayOf(\r\n            PropTypes.shape({\r\n                label: PropTypes.string.isRequired,\r\n                selected: PropTypes.bool,\r\n                onUpdate: PropTypes.func,\r\n                onClick: PropTypes.func,\r\n            }),\r\n        ).isRequired,\r\n        onSelect: PropTypes.func,\r\n    };\r\n\r\n    handleSelect = selectedItem => {\r\n        const { store, updateStore, text } = this.props;\r\n        const dropDownMenuData = store.topMenu.find(item => item.label === text);\r\n\r\n        dropDownMenuData.onSelect(selectedItem);\r\n        updateStore(store);\r\n    };\r\n\r\n    render() {\r\n        const { text, options } = this.props;\r\n        const hasOptionsToShow = options.length > 0;\r\n\r\n        return (\r\n            <ul className=\"drop-down-menu\">\r\n                <li>\r\n                    <span className=\"drop-down-menu__toggler\">\r\n                        {text}\r\n                        {hasOptionsToShow && <FontAwesomeIcon className=\"drop-down-menu__caret\" icon=\"chevron-down\" />}\r\n                    </span>\r\n                    {hasOptionsToShow && (\r\n                        <ul className=\"drop-down-menu__menu\">\r\n                            {options.map(({ label, selected, onClick }) => {\r\n                                return (\r\n                                    <DropDownMenuItem\r\n                                        key={label}\r\n                                        selected={selected}\r\n                                        text={label}\r\n                                        onClick={onClick || this.handleSelect}\r\n                                    />\r\n                                );\r\n                            })}\r\n                        </ul>\r\n                    )}\r\n                </li>\r\n            </ul>\r\n        );\r\n    }\r\n}\r\n\r\nexport default props => (\r\n    <Consumer>\r\n        {({ store, updateStore }) => {\r\n            const dropDownMenuData = store.topMenu.find(item => item.label === props.text);\r\n            const options = dropDownMenuData ? dropDownMenuData.options : [];\r\n\r\n            return <DropDownMenu {...props} store={store} updateStore={updateStore} options={options} />;\r\n        }}\r\n    </Consumer>\r\n);\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\n\r\nconst MenuLink = ({ text, href, className = \"\", target = \"_self\" }) => (\r\n    <a className={`main-menu__link ${className}`} href={href} target={target}>\r\n        {text}\r\n    </a>\r\n);\r\n\r\nMenuLink.propTypes = {\r\n    text: PropTypes.string.isRequired,\r\n    href: PropTypes.string.isRequired,\r\n    className: PropTypes.string,\r\n    target: PropTypes.string,\r\n};\r\n\r\nexport default MenuLink;\r\n","import React from \"react\";\r\nimport cn from \"classnames\";\r\n\r\nimport \"./main-menu.scss\";\r\nimport DropDownMenu from \"./components/drop-down-menu\";\r\nimport MenuLink from \"./components/menu-link\";\r\nimport { Consumer, MenuItemType } from \"../../../../store\";\r\n\r\nfunction MainMenuItem({ menuItem, clickable }) {\r\n    return (\r\n        <div className=\"main-menu__item\">\r\n            <div className={cn(clickable && \"main-menu__clickable-zone\")}>\r\n                {menuItem.type === MenuItemType.LINK && <MenuLink text={menuItem.label} {...menuItem} />}\r\n                {menuItem.type === MenuItemType.DROPDOWN && <DropDownMenu text={menuItem.label} {...menuItem} />}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction MainMenu() {\r\n    return (\r\n        <nav className=\"main-menu\">\r\n            <Consumer>\r\n                {({ store }) =>\r\n                    store.topMenu.map(menuItem => (\r\n                        <MainMenuItem key={menuItem.label} menuItem={menuItem} clickable={menuItem.isClickable} />\r\n                    ))\r\n                }\r\n            </Consumer>\r\n        </nav>\r\n    );\r\n}\r\n\r\nexport default MainMenu;\r\n","import React from \"react\";\r\nimport cn from \"classnames\";\r\n\r\nimport Logo from \"./components/logo\";\r\nimport StarSystemSelector from \"./components/star-system-selector/star-system-selector\";\r\nimport MainMenu from \"./components/main-menu/main-menu\";\r\nimport \"./header.scss\";\r\n\r\nconst Header = ({ className }) => (\r\n    <header className={cn(className, \"header\", \"noselect\")}>\r\n        <div className=\"header__logo-wrapper\">\r\n            <Logo className=\"header__logo\" />\r\n        </div>\r\n        <div className=\"header__top-menu\">\r\n            <MainMenu />\r\n        </div>\r\n        <div className=\"header__star-system-selector\">\r\n            <StarSystemSelector />\r\n        </div>\r\n    </header>\r\n);\r\n\r\nexport default Header;\r\n","import React from \"react\";\r\nimport cn from \"classnames\";\r\nimport \"./index.scss\";\r\n\r\nconst SideBar = ({ className, right, children }) => {\r\n    return <aside className={cn(className, \"side-bar\")}>{children}</aside>;\r\n};\r\n\r\nexport default SideBar;\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport cn from \"classnames\";\r\n\r\nimport \"./index.scss\";\r\n\r\nconst Button = ({ id, className, children, small = false, disabled = false, onClick = () => {} }) => (\r\n    <button\r\n        id={id}\r\n        type=\"button\"\r\n        className={cn(\r\n            \"button\",\r\n            {\r\n                \"button--disabled\": disabled,\r\n                \"button--small\": small,\r\n            },\r\n            className,\r\n        )}\r\n        onClick={onClick}\r\n        disabled={disabled}\r\n    >\r\n        {children}\r\n    </button>\r\n);\r\n\r\nButton.propTypes = {\r\n    id: PropTypes.string,\r\n    className: PropTypes.string,\r\n    disabled: PropTypes.bool,\r\n    small: PropTypes.bool,\r\n    onClick: PropTypes.func,\r\n    children: PropTypes.node,\r\n};\r\n\r\nexport default Button;\r\n","import React from \"react\";\r\nimport cn from \"classnames\";\r\n\r\nimport \"./arrow-logo.scss\";\r\n\r\nexport default function ArrowLogo({ direction }) {\r\n    const classNames = cn(\"arrow-logo\", `arrow-logo--to-${direction}`);\r\n\r\n    return (\r\n        <svg\r\n            className={classNames}\r\n            role=\"img\"\r\n            width=\"10\"\r\n            height=\"8\"\r\n            viewBox=\"0 0 10 8\"\r\n            fill=\"none\"\r\n            xmlns=\"http://www.w3.org/2000/svg\"\r\n        >\r\n            <path\r\n                d=\"M1.50359 3.64645C1.30833 3.84171 1.30833 4.15829 1.50359 4.35355L4.68557 7.53553C4.88083 7.7308 5.19741 7.7308 5.39268 7.53553C5.58794 7.34027 5.58794 7.02369 5.39268 6.82843L2.56425 4L5.39268 1.17157C5.58794 0.97631 5.58794 0.659728 5.39268 0.464466C5.19741 0.269204 4.88083 0.269203 4.68557 0.464466L1.50359 3.64645ZM1.5 8V0H0.5V8H1.5ZM10 3.5L1.85714 3.5L1.85714 4.5L10 4.5L10 3.5Z\"\r\n                fill=\"#8F9193\"\r\n            />\r\n        </svg>\r\n    );\r\n}\r\n","import React from \"react\";\r\n\r\nconst MaximizeLogo = () => {\r\n    return (\r\n        <svg role=\"img\" width=\"10\" height=\"8\" viewBox=\"0 0 10 8\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n            <path d=\"M3 3V1H9V5H7M7 5V7H1V3H7V5Z\" stroke=\"#8F9193\" strokeWidth=\"0.5\" />\r\n        </svg>\r\n    );\r\n};\r\n\r\nexport default MaximizeLogo;\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\n\r\nimport Button from \"../../button\";\r\nimport ArrowLogo from \"../../logos/arrow-logo\";\r\nimport MaximizeLogo from \"../../logos/maximize-logo\";\r\n\r\nconst CollapseButton = ({ isCollapsed, onClick, isToRight = false, className = \"\", collapseDirection = \"left\" }) => (\r\n    <Button className={className} onClick={onClick} small>\r\n        {isCollapsed ? <MaximizeLogo /> : <ArrowLogo direction={collapseDirection} />}\r\n    </Button>\r\n);\r\n\r\nCollapseButton.propTypes = {\r\n    className: PropTypes.string,\r\n    isCollapsed: PropTypes.bool.isRequired,\r\n    onClick: PropTypes.func.isRequired,\r\n    collapseDirection: PropTypes.oneOf([\"right\", \"left\"]),\r\n};\r\n\r\nexport default CollapseButton;\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport cn from \"classnames\";\r\n\r\nconst Field = ({ className, leftAligned = false, centered = false, children }) => {\r\n    return (\r\n        <div\r\n            className={cn(\r\n                \"panel__field\",\r\n                {\r\n                    \"panel__field--left-aligned\": leftAligned,\r\n                    \"panel__field--centered\": centered,\r\n                },\r\n                className,\r\n            )}\r\n        >\r\n            {children}\r\n        </div>\r\n    );\r\n};\r\n\r\nField.propTypes = {\r\n    className: PropTypes.string,\r\n    leftAligned: PropTypes.bool,\r\n    centered: PropTypes.bool,\r\n    children: PropTypes.node,\r\n};\r\n\r\nexport default Field;\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport cn from \"classnames\";\r\n\r\nconst FieldLabel = ({\r\n    id,\r\n    className,\r\n    tag: ComponentType = \"span\",\r\n    normal = true,\r\n    middle = false,\r\n    small = false,\r\n    children,\r\n}) => {\r\n    return (\r\n        <ComponentType\r\n            id={id}\r\n            className={cn(\r\n                \"panel__field-label\",\r\n                {\r\n                    \"panel__field-label--normal\": normal,\r\n                    \"panel__field-label--middle\": middle,\r\n                    \"panel__field-label--small\": small,\r\n                },\r\n                className,\r\n            )}\r\n        >\r\n            {children}\r\n        </ComponentType>\r\n    );\r\n};\r\n\r\nFieldLabel.propTypes = {\r\n    id: PropTypes.string,\r\n    className: PropTypes.string,\r\n    tag: PropTypes.string,\r\n    normal: PropTypes.bool,\r\n    middle: PropTypes.bool,\r\n    small: PropTypes.bool,\r\n    children: PropTypes.node,\r\n};\r\n\r\nexport default FieldLabel;\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport cn from \"classnames\";\r\n\r\nconst FieldControl = ({ id, className, fullSize = false, children }) => {\r\n    return (\r\n        <span\r\n            id={id}\r\n            className={cn(\"panel__field-control\", { \"panel__field-control--full-size\": fullSize }, className)}\r\n        >\r\n            {children}\r\n        </span>\r\n    );\r\n};\r\n\r\nFieldControl.propTypes = {\r\n    id: PropTypes.string,\r\n    className: PropTypes.string,\r\n    fullSize: PropTypes.bool,\r\n    children: PropTypes.node,\r\n};\r\n\r\nexport default FieldControl;\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport cn from \"classnames\";\r\n\r\nimport Button from \"../../button\";\r\n\r\nconst PanelButton = ({ id, className, children }) => (\r\n    <Button className={cn(\"panel__button\", className)} id={id}>\r\n        {children}\r\n    </Button>\r\n);\r\n\r\nPanelButton.propTypes = {\r\n    id: PropTypes.string,\r\n    className: PropTypes.string,\r\n    children: PropTypes.string,\r\n};\r\n\r\nexport default PanelButton;\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport cn from \"classnames\";\r\n\r\nconst FieldSet = ({ className, children }) => {\r\n    return <span className={cn(\"panel__field-set\", className)}>{children}</span>;\r\n};\r\n\r\nFieldSet.propTypes = {\r\n    className: PropTypes.string,\r\n    children: PropTypes.node,\r\n};\r\n\r\nexport default FieldSet;\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport cn from \"classnames\";\r\n\r\nconst Dimension = ({ id, className, children }) => {\r\n    return (\r\n        <span id={id} className={cn(\"panel__dimension\", className)}>\r\n            {children}\r\n        </span>\r\n    );\r\n};\r\n\r\nDimension.propTypes = {\r\n    id: PropTypes.string,\r\n    className: PropTypes.string,\r\n    children: PropTypes.node,\r\n};\r\n\r\nexport default Dimension;\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport cn from \"classnames\";\r\n\r\nimport CollapseButton from \"./components/collapse-button\";\r\nimport Field from \"./components/field\";\r\nimport FieldLabel from \"./components/field-label\";\r\nimport FieldControl from \"./components/field-control\";\r\nimport PanelButton from \"./components/button\";\r\nimport FieldSet from \"./components/field-set\";\r\nimport Dimension from \"./components/dimension\";\r\nimport \"./index.scss\";\r\n\r\nclass Panel extends Component {\r\n    static propTypes = {\r\n        id: PropTypes.string,\r\n        className: PropTypes.string,\r\n        children: PropTypes.node,\r\n        caption: PropTypes.string,\r\n        hideCollapseButton: PropTypes.bool,\r\n        titleIcon: PropTypes.node,\r\n        collapsedByDefault: PropTypes.bool,\r\n        hidden: PropTypes.bool,\r\n        collapseDirection: PropTypes.oneOf([\"right\", \"left\"]),\r\n    };\r\n\r\n    static defaultProps = {\r\n        caption: \"\",\r\n        hideCollapseButton: false,\r\n        className: \"\",\r\n        id: \"\",\r\n        collapsedByDefault: false,\r\n        hidden: false,\r\n        collapseDirection: \"left\",\r\n    };\r\n\r\n    state = {\r\n        isCollapsed: this.props.collapsedByDefault,\r\n    };\r\n\r\n    handleToggle = () => {\r\n        this.setState(prevState => ({\r\n            isCollapsed: !prevState.isCollapsed,\r\n        }));\r\n    };\r\n\r\n    render() {\r\n        const {\r\n            id,\r\n            className,\r\n            caption,\r\n            hideCollapseButton,\r\n            children,\r\n            titleIcon,\r\n            hidden,\r\n            collapseDirection,\r\n        } = this.props;\r\n        const { isCollapsed } = this.state;\r\n        const classNames = cn(\r\n            \"panel\",\r\n            \"noselect\",\r\n            {\r\n                \"panel--hidden\": hidden,\r\n                \"panel--collapsed\": isCollapsed,\r\n            },\r\n            className,\r\n        );\r\n\r\n        return (\r\n            <div id={id} className={classNames}>\r\n                <div className=\"panel__header\">\r\n                    <div className=\"panel__caption\">\r\n                        {titleIcon && <span className=\"panel__caption-icon\">{titleIcon}</span>}\r\n                        <span className=\"panel__caption-text\">{caption}</span>\r\n                    </div>\r\n                    {!hideCollapseButton && (\r\n                        <CollapseButton\r\n                            className=\"panel__collapse-button\"\r\n                            onClick={this.handleToggle}\r\n                            isCollapsed={isCollapsed}\r\n                            collapseDirection={collapseDirection}\r\n                        />\r\n                    )}\r\n                </div>\r\n                <div style={{ display: isCollapsed ? \"none\" : \"block\" }} className=\"panel__content\">\r\n                    {children}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport { Panel as default, Field, FieldSet, FieldLabel, FieldControl, PanelButton, Dimension };\r\n","import React from \"react\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\n\r\nimport Panel, { Field, FieldLabel, FieldControl } from \"../../../../../common/panel\";\r\nimport \"./camera-panel.scss\";\r\n\r\nconst CameraPanel = ({ className }) => (\r\n    <Panel\r\n        id=\"cameraPanel\"\r\n        className={`camera-panel ${className}`}\r\n        caption=\"Camera\"\r\n        titleIcon={<FontAwesomeIcon icon=\"expand\" />}\r\n        collapseDirection=\"right\"\r\n    >\r\n        <Field className=\"camera-panel__field\">\r\n            <FieldLabel>Target</FieldLabel>\r\n            <FieldControl>\r\n                <select className=\"camera-panel__field-control\" id=\"targetSelect\" />\r\n            </FieldControl>\r\n        </Field>\r\n        <Field className=\"camera-panel__field\">\r\n            <FieldLabel>Frame type</FieldLabel>\r\n            <FieldControl>\r\n                <select className=\"camera-panel__field-control\" id=\"rfTypeSelect\" />\r\n            </FieldControl>\r\n        </Field>\r\n    </Panel>\r\n);\r\n\r\nexport default CameraPanel;\r\n","import React from \"react\";\r\nimport \"./index.scss\";\r\n\r\nfunction TimeLine({ className }) {\r\n    return <canvas className={`time-line ${className}`} id=\"timeLineCanvas\" />;\r\n}\r\n\r\nexport default TimeLine;\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport cn from \"classnames\";\r\n\r\nimport { sim, Events } from \"../../../../../../../core/index\";\r\nimport \"./index.scss\";\r\n\r\nclass PauseButton extends Component {\r\n    static propTypes = {\r\n        className: PropTypes.string,\r\n    };\r\n\r\n    state = {\r\n        isTimeRunning: true,\r\n    };\r\n\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        document.addEventListener(Events.TIME_PAUSED, () => {\r\n            this.setState({ isTimeRunning: false });\r\n        });\r\n        document.addEventListener(Events.TIME_UNPAUSED, () => {\r\n            this.setState({ isTimeRunning: true });\r\n        });\r\n    }\r\n\r\n    handleClick = () => {\r\n        const timeLine = sim.time;\r\n\r\n        if (timeLine) {\r\n            timeLine.togglePause();\r\n        }\r\n    };\r\n\r\n    render() {\r\n        const { isTimeRunning } = this.state;\r\n\r\n        return (\r\n            <div\r\n                role=\"button\"\r\n                className={cn(\r\n                    \"pause-button\",\r\n                    \"noselect\",\r\n                    {\r\n                        \"pause-button--paused\": !isTimeRunning,\r\n                    },\r\n                    this.props.className,\r\n                )}\r\n                onClick={this.handleClick}\r\n            >\r\n                <div>\r\n                    <FontAwesomeIcon className=\"pause-button__icon\" icon={isTimeRunning ? \"pause\" : \"play\"} />\r\n                </div>\r\n                <div>{isTimeRunning ? \"Pause\" : \"Resume\"}</div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default PauseButton;\r\n","import React from \"react\";\r\n\r\nexport default function({ className }) {\r\n    return (\r\n        <svg\r\n            className={className}\r\n            role=\"img\"\r\n            width=\"4\"\r\n            height=\"9\"\r\n            viewBox=\"0 0 4 9\"\r\n            fill=\"none\"\r\n            xmlns=\"http://www.w3.org/2000/svg\"\r\n        >\r\n            <path\r\n                d=\"M3.71197 2.33602L3.58397 3.42402H2.35197L1.96797 6.14402C1.92531 6.38936 1.92531 6.57069 1.96797 6.68802C2.01064 6.80536 2.11731 6.86402 2.28797 6.86402C2.46931 6.86402 2.62397 6.84269 2.75197 6.80002C2.87997 6.74669 2.96531 6.71469 3.00797 6.70402V7.76002C2.96531 7.77069 2.90131 7.79736 2.81597 7.84002C2.73064 7.88269 2.63464 7.92536 2.52797 7.96802C2.26131 8.08536 1.96264 8.14402 1.63197 8.14402C1.11997 8.14402 0.773306 8.01069 0.591973 7.74402C0.410639 7.46669 0.362639 7.00269 0.447973 6.35202L0.879973 3.42402H0.271973L0.415973 2.33602H1.02397L1.21597 0.976023L2.73597 0.736023L2.49597 2.33602H3.71197Z\"\r\n                fill=\"#A1A1A3\"\r\n            />\r\n        </svg>\r\n    );\r\n}\r\n","import React from \"react\";\r\n\r\nimport Panel, { Field, FieldLabel, FieldControl, PanelButton } from \"../../../../../common/panel\";\r\nimport Logo from \"./logo\";\r\nimport \"./index.scss\";\r\n\r\nfunction TimeSettingsPanel({ className }) {\r\n    return (\r\n        <Panel\r\n            className={`time-settings-panel ${className}`}\r\n            id=\"timePanel\"\r\n            caption=\"Time\"\r\n            titleIcon={<Logo className=\"time-settings-panel__logo\" />}\r\n        >\r\n            <Field>\r\n                <FieldLabel middle>Current</FieldLabel>\r\n                <FieldControl>\r\n                    <time id=\"currentDateValue\">01.01.2000 12:00:00</time>\r\n                </FieldControl>\r\n                <PanelButton id=\"useCurrentTime\">Now</PanelButton>\r\n            </Field>\r\n            <Field>\r\n                <FieldLabel middle>Rate</FieldLabel>\r\n                <FieldControl id=\"timeScaleValue\" />\r\n                <PanelButton id=\"setRealTimeScale\">Real</PanelButton>\r\n            </Field>\r\n            <Field centered>\r\n                <FieldControl fullSize>\r\n                    <input\r\n                        id=\"timeScaleSlider\"\r\n                        type=\"range\"\r\n                        className=\"time-settings-panel__scale-slider\"\r\n                        min=\"-1\"\r\n                        max=\"1\"\r\n                        step=\"0.001\"\r\n                        defaultValue=\"0.001\"\r\n                        style={{ width: \"100%\" }}\r\n                    />\r\n                </FieldControl>\r\n            </Field>\r\n        </Panel>\r\n    );\r\n}\r\n\r\nexport default TimeSettingsPanel;\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport cn from \"classnames\";\r\n\r\nimport CameraPanel from \"./components/camera-panel/camera-panel\";\r\nimport TimeLine from \"./components/time-line\";\r\nimport PauseButton from \"./components/pause-button\";\r\nimport TimeSettingsPanel from \"./components/time-settings-panel\";\r\nimport StatisticsBadge from \"../../../statistics-badge\";\r\n\r\nimport \"./index.scss\";\r\n\r\nfunction BottomPanel({ className }) {\r\n    return (\r\n        <div className={cn(className, \"bottom-panel\")}>\r\n            <TimeSettingsPanel className=\"bottom-panel__time-settings-panel\" />\r\n            <PauseButton className=\"bottom-panel__pause-button\" />\r\n            <div className=\"bottom-panel__time-line-container\">\r\n                <TimeLine className=\"bottom-panel__time-line\" />\r\n            </div>\r\n            <CameraPanel className=\"bottom-panel__camera-panel\" />\r\n            <StatisticsBadge />\r\n        </div>\r\n    );\r\n}\r\n\r\nBottomPanel.propTypes = {\r\n    className: PropTypes.string,\r\n};\r\n\r\nexport default BottomPanel;\r\n","import React from \"react\";\r\n\r\nimport Panel, { Field, FieldLabel, PanelButton } from \"../../common/panel\";\r\nimport { Consumer } from \"../../../store\";\r\n\r\nconst CreationPanel = ({ className }) => (\r\n    <Consumer>\r\n        {({ store }) => (\r\n            <Panel\r\n                className={className}\r\n                id=\"creationPanel\"\r\n                caption=\"Orbit creation\"\r\n                hidden={!store.viewSettings.showOrbitCreationPanel}\r\n            >\r\n                <Field>\r\n                    <FieldLabel>Create Orbit</FieldLabel>\r\n                    <PanelButton id=\"createOrbit\">Create</PanelButton>\r\n                </Field>\r\n            </Panel>\r\n        )}\r\n    </Consumer>\r\n);\r\n\r\nexport default CreationPanel;\r\n","import React from \"react\";\r\nimport cn from \"classnames\";\r\n\r\nimport { Consumer } from \"../../../../store\";\r\nimport Panel, { Field, FieldSet, FieldLabel, FieldControl, PanelButton, Dimension } from \"../../../common/panel\";\r\nimport \"./index.scss\";\r\n\r\nconst TransferCalculationPanel = ({ className }) => (\r\n    <Consumer>\r\n        {({ store }) => (\r\n            <Panel\r\n                className={cn(className, \"transfer-calculation-panel\")}\r\n                id=\"lambertPanel\"\r\n                caption=\"Transfer calculation\"\r\n                hidden={!store.viewSettings.showTransferCalculationPanel}\r\n            >\r\n                <FieldSet>\r\n                    <Field>\r\n                        <FieldLabel>Origin</FieldLabel>\r\n                        <FieldControl>\r\n                            <select className=\"transfer-calculation-panel__select\" id=\"originSelect\" />\r\n                        </FieldControl>\r\n                    </Field>\r\n                    <Field>\r\n                        <FieldLabel>Target</FieldLabel>\r\n                        <FieldControl>\r\n                            <select className=\"transfer-calculation-panel__select\" id=\"targetSelect\" />\r\n                        </FieldControl>\r\n                    </Field>\r\n                    <Field>\r\n                        <FieldLabel>Transfer type</FieldLabel>\r\n                        <FieldControl>Ballistic</FieldControl>\r\n                    </Field>\r\n                    <Field>\r\n                        <FieldLabel>Departure</FieldLabel>\r\n                        <FieldControl>\r\n                            <time id=\"departureDateValue\">01.01.2000 12:00:00</time>\r\n                        </FieldControl>\r\n                        <PanelButton id=\"useCurrentTime\">Now</PanelButton>\r\n                    </Field>\r\n                    <Field>\r\n                        <FieldLabel>Transfer time</FieldLabel>\r\n                        <FieldControl id=\"transferTimeValue\" />\r\n                        {/*<PanelButton id=\"optimalTransferTime\">*/}\r\n                        {/*Optimal*/}\r\n                        {/*</PanelButton>*/}\r\n                    </Field>\r\n                    <Field>\r\n                        <FieldControl fullSize>\r\n                            <input\r\n                                id=\"transferTimeSlider\"\r\n                                type=\"range\"\r\n                                min=\"0\"\r\n                                max=\"1\"\r\n                                step=\"0.001\"\r\n                                defaultValue={\"0.5\"}\r\n                                style={{ width: \"100%\" }}\r\n                            />\r\n                        </FieldControl>\r\n                    </Field>\r\n                </FieldSet>\r\n                <FieldSet className=\"transfer-calculation-panel__delta-v-calc \" data-panel-name=\"lambert\">\r\n                    <Field className=\"panel__field-header\">Delta-V</Field>\r\n                    <Field>\r\n                        <FieldLabel>Ejection</FieldLabel>\r\n                        <FieldControl id=\"deltaVEjection\">0</FieldControl>\r\n                        <Dimension>km/s</Dimension>\r\n                    </Field>\r\n                    <Field>\r\n                        <FieldLabel>Insertion</FieldLabel>\r\n                        <FieldControl id=\"deltaVInsertion\">0</FieldControl>\r\n                        <Dimension>km/s</Dimension>\r\n                    </Field>\r\n                    <Field>\r\n                        <FieldLabel>Total</FieldLabel>\r\n                        <FieldControl id=\"deltaVTotal\">0</FieldControl>\r\n                        <Dimension>km/s</Dimension>\r\n                    </Field>\r\n                </FieldSet>\r\n            </Panel>\r\n        )}\r\n    </Consumer>\r\n);\r\n\r\nexport default TransferCalculationPanel;\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport cn from \"classnames\";\r\n\r\nimport { FieldLabel, FieldControl, Dimension } from \"../../../../common/panel\";\r\nimport \"./keplerian-view.scss\";\r\n\r\nexport default function KeplerianView({ className = \"\" }) {\r\n    return (\r\n        <div className={cn(className, \"keplerian-view\")}>\r\n            <div className=\"keplerian-view__column\">\r\n                <div className=\"keplerian-view__field\">\r\n                    <FieldLabel className=\"keplerian-view__field-label\">Ecc</FieldLabel>\r\n                    <FieldControl id=\"elements-ecc\" />\r\n                    <Dimension />\r\n                </div>\r\n                <div className=\"keplerian-view__field\">\r\n                    <FieldLabel className=\"keplerian-view__field-label\">SMA</FieldLabel>\r\n                    <FieldControl id=\"elements-sma\" />\r\n                    <Dimension>km</Dimension>\r\n                </div>\r\n                <div className=\"keplerian-view__field\">\r\n                    <FieldLabel className=\"keplerian-view__field-label\">Inc</FieldLabel>\r\n                    <FieldControl id=\"elements-inc\" />\r\n                    <Dimension>deg.</Dimension>\r\n                </div>\r\n                <div className=\"keplerian-view__field\">\r\n                    <FieldLabel className=\"keplerian-view__field-label\">AoP</FieldLabel>\r\n                    <FieldControl id=\"elements-aop\" />\r\n                    <Dimension>deg.</Dimension>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"keplerian-view__column\">\r\n                <div className=\"keplerian-view__field\">\r\n                    <FieldLabel className=\"keplerian-view__field-label\">RAAN</FieldLabel>\r\n                    <FieldControl id=\"elements-raan\" />\r\n                    <Dimension>deg.</Dimension>\r\n                </div>\r\n                <div className=\"keplerian-view__field\">\r\n                    <FieldLabel className=\"keplerian-view__field-label\">TA</FieldLabel>\r\n                    <FieldControl id=\"elements-ta\" />\r\n                    <Dimension>deg.</Dimension>\r\n                </div>\r\n                <div className=\"keplerian-view__field\">\r\n                    <FieldLabel className=\"keplerian-view__field-label\">Period</FieldLabel>\r\n                    <FieldControl id=\"elements-period\" />\r\n                    <Dimension>days</Dimension>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nKeplerianView.propTypes = { className: PropTypes.string };\r\n","import React from \"react\";\r\nimport cn from \"classnames\";\r\n\r\nimport { FieldLabel, FieldControl, Dimension } from \"../../../../common/panel\";\r\nimport \"./vector-component-view.scss\";\r\n\r\nfunction VectorComponentView({ className, label = \"x\", valueClassName = \"vec-x\", dimension = \"km\" }) {\r\n    return (\r\n        <div className={cn(className, \"vector-component\")}>\r\n            <FieldLabel className=\"vector-component__label\">{label}</FieldLabel>\r\n            <FieldControl className={valueClassName} />\r\n            <Dimension>{dimension}</Dimension>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default VectorComponentView;\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport cn from \"classnames\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\n\r\nimport Button from \"../button\";\r\nimport \"./index.scss\";\r\n\r\nfunction ExpandButton({ className, onClick, expanded = false }) {\r\n    return (\r\n        <Button\r\n            className={cn(className, \"expand-button\", {\r\n                \"expand-button--expanded\": expanded,\r\n            })}\r\n            onClick={onClick}\r\n        >\r\n            <FontAwesomeIcon className=\"expand-button__icon\" icon=\"chevron-down\" />\r\n        </Button>\r\n    );\r\n}\r\n\r\nExpandButton.propTypes = {\r\n    className: PropTypes.string,\r\n    expanded: PropTypes.bool,\r\n    onClick: PropTypes.func,\r\n};\r\n\r\nexport default ExpandButton;\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport cn from \"classnames\";\r\n\r\nimport VectorComponentView from \"./vector-component-view\";\r\nimport ExpandButton from \"../../../../common/expand-button/index\";\r\nimport { Field } from \"../../../../common/panel\";\r\nimport \"./cartesian-vector-view.scss\";\r\n\r\nclass CartesianVectorView extends Component {\r\n    static propTypes = {\r\n        className: PropTypes.string,\r\n        isExpanded: PropTypes.bool,\r\n        vectorMagnitudeLabel: PropTypes.string.isRequired,\r\n        dimension: PropTypes.string.isRequired,\r\n    };\r\n\r\n    static defaultProps = {\r\n        isExpanded: false,\r\n    };\r\n\r\n    state = {\r\n        isExpanded: this.props.isExpanded,\r\n    };\r\n\r\n    handleToggle = () => {\r\n        this.setState(({ isExpanded }) => ({ isExpanded: !isExpanded }));\r\n    };\r\n\r\n    render() {\r\n        const { isExpanded } = this.state;\r\n        const { className, vectorMagnitudeLabel, dimension } = this.props;\r\n\r\n        return (\r\n            <Field className={cn(className, \"cartesian-vector-view\")}>\r\n                <div className=\"cartesian-vector-view__header\">\r\n                    <VectorComponentView\r\n                        label={vectorMagnitudeLabel}\r\n                        valueClassName=\"vec-magnitude\"\r\n                        dimension={dimension}\r\n                    />\r\n                    <ExpandButton\r\n                        className=\"cartesian-vector-view__expand-button\"\r\n                        expanded={isExpanded}\r\n                        onClick={this.handleToggle}\r\n                    />\r\n                </div>\r\n                <div className={cn(\"cartesian-vector-view__vector-components\", { hidden: !isExpanded })}>\r\n                    <VectorComponentView label=\"x\" valueClassName=\"vec-x\" dimension={dimension} />\r\n                    <VectorComponentView label=\"y\" valueClassName=\"vec-y\" dimension={dimension} />\r\n                    <VectorComponentView label=\"z\" valueClassName=\"vec-z\" dimension={dimension} />\r\n                </div>\r\n            </Field>\r\n        );\r\n    }\r\n}\r\n\r\nexport default CartesianVectorView;\r\n","import React from \"react\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\n\r\nimport Panel, { FieldSet, Field, FieldLabel, FieldControl, Dimension } from \"../../../common/panel\";\r\nimport KeplerianView from \"./components/keplerian-view\";\r\nimport CartesianVectorView from \"./components/cartesian-vector-view\";\r\nimport \"./index.scss\";\r\n\r\nconst MetricsPanel = () => (\r\n    <Panel\r\n        id=\"metricsPanel\"\r\n        className=\"metrics-panel\"\r\n        caption=\"Metrics\"\r\n        titleIcon={<FontAwesomeIcon icon=\"bars\" />}\r\n        collapseDirection=\"right\"\r\n    >\r\n        <div className=\"metrics-panel__content\">\r\n            <FieldSet>\r\n                <Field>\r\n                    <FieldLabel>Object</FieldLabel>\r\n                    <FieldControl id=\"metricsOf\" />\r\n                </Field>\r\n                <Field>\r\n                    <FieldLabel>Relative to</FieldLabel>\r\n                    <FieldControl id=\"relativeTo\" />\r\n                </Field>\r\n            </FieldSet>\r\n            <FieldSet>\r\n                <Field leftAligned>\r\n                    <FieldLabel tag=\"label\">\r\n                        <input\r\n                            className=\"metrics-panel__angles-checker\"\r\n                            type=\"checkbox\"\r\n                            id=\"showAnglesOfSelectedOrbit\"\r\n                            defaultChecked\r\n                        />\r\n                        Show angles\r\n                    </FieldLabel>\r\n                    <button className=\"metrics-panel__unload-object-button\" type=\"button\" id=\"unloadObject\">\r\n                        Unload object\r\n                    </button>\r\n                </Field>\r\n            </FieldSet>\r\n            <FieldSet>\r\n                <Field className=\"panel__field-header\">Main</Field>\r\n                <Field>\r\n                    <FieldLabel>Orbit</FieldLabel>\r\n                    <FieldControl id=\"elements-orbit-alt\" />\r\n                    <Dimension>km</Dimension>\r\n                </Field>\r\n                <Field>\r\n                    <FieldLabel>Avg height</FieldLabel>\r\n                    <FieldControl id=\"elements-orbit-avg\" />\r\n                    <Dimension>km</Dimension>\r\n                </Field>\r\n                <Field>\r\n                    <FieldLabel>Altitude</FieldLabel>\r\n                    <FieldControl id=\"elements-alt\" />\r\n                    <Dimension>km</Dimension>\r\n                </Field>\r\n                <Field>\r\n                    <FieldLabel>Speed</FieldLabel>\r\n                    <FieldControl id=\"elements-speed\" />\r\n                    <Dimension>m/s</Dimension>\r\n                </Field>\r\n                <Field>\r\n                    <FieldLabel>Precession</FieldLabel>\r\n                    <FieldControl id=\"elements-precession\" />\r\n                    <Dimension>deg/day</Dimension>\r\n                </Field>\r\n\r\n                <Field id=\"row-node-time\" style={{ display: \"none\" }}>\r\n                    <FieldLabel>Node local time</FieldLabel>\r\n                    <FieldControl id=\"elements-node-time\" />\r\n                    <Dimension />\r\n                </Field>\r\n            </FieldSet>\r\n\r\n            <FieldSet>\r\n                <Field className=\"panel__field-header\">Keplerian</Field>\r\n                <KeplerianView className=\"panel__field\" />\r\n            </FieldSet>\r\n\r\n            <FieldSet>\r\n                <Field className=\"panel__field-header\">Cartesian</Field>\r\n                <CartesianVectorView\r\n                    className=\"metrics-panel__cartesian-position-vector js-metrics-panel-cartesian-position-vector\"\r\n                    vectorMagnitudeLabel=\"Position\"\r\n                    dimension=\"km\"\r\n                />\r\n                <CartesianVectorView\r\n                    className=\"metrics-panel__cartesian-velocity-vector js-metrics-panel-cartesian-velocity-vector\"\r\n                    vectorMagnitudeLabel=\"Velocity\"\r\n                    dimension=\"km/s\"\r\n                />\r\n            </FieldSet>\r\n        </div>\r\n    </Panel>\r\n);\r\n\r\nexport default MetricsPanel;\r\n","import React from \"react\";\r\n\r\nimport Panel, { Field, FieldSet, FieldLabel, FieldControl, Dimension } from \"../../../common/panel\";\r\nimport Button from \"../../../common/button\";\r\nimport \"./index.scss\";\r\n\r\nconst ManeuverPanel = ({ className }) => (\r\n    <Panel id=\"maneuverPanel\" className={`maneuver-panel ${className}`} caption=\"Maneuver\" collapseDirection=\"left\">\r\n        <div className=\"maneuver-panel__content\">\r\n            <FieldSet>\r\n                <Field centered>\r\n                    <Button className=\"maneuver-panel__button\" id=\"prev-burn\">\r\n                        Prev burn\r\n                    </Button>\r\n                    <FieldLabel id=\"burn-name\" />\r\n                    <Button className=\"maneuver-panel__button\" id=\"next-burn\">\r\n                        Next burn\r\n                    </Button>\r\n                </Field>\r\n            </FieldSet>\r\n            <FieldSet>\r\n                <Field className=\"panel__field-header\">Increment</Field>\r\n                <Field centered>\r\n                    <FieldLabel small id=\"increment\" />\r\n                    <FieldControl className=\"maneuver-panel__buttons\">\r\n                        <Button className=\"maneuver-panel__button\" id=\"incr001\">\r\n                            0.01\r\n                        </Button>\r\n                        <Button className=\"maneuver-panel__button\" id=\"incr01\">\r\n                            0.1\r\n                        </Button>\r\n                        <Button className=\"maneuver-panel__button\" id=\"incr1\">\r\n                            1\r\n                        </Button>\r\n                        <Button className=\"maneuver-panel__button\" id=\"incr10\">\r\n                            10\r\n                        </Button>\r\n                        <Button className=\"maneuver-panel__button\" id=\"incr100\">\r\n                            100\r\n                        </Button>\r\n                        <Button className=\"maneuver-panel__button\" id=\"incr1000\">\r\n                            1000\r\n                        </Button>\r\n                    </FieldControl>\r\n                </Field>\r\n            </FieldSet>\r\n\r\n            <FieldSet>\r\n                <Field className=\"panel__field-header\">Time</Field>\r\n                <Field>\r\n                    <FieldLabel>Date</FieldLabel>\r\n                    <FieldControl id=\"burn-date\" />\r\n                </Field>\r\n                <Field centered>\r\n                    <FieldLabel>Epoch</FieldLabel>\r\n                    <FieldControl id=\"burn-epoch\" />\r\n                    <span className=\"maneuver-panel__buttons\">\r\n                        <Button className=\"maneuver-panel__button\" id=\"epoch-minus\">\r\n                            -\r\n                        </Button>\r\n                        <Button className=\"maneuver-panel__button\" id=\"epoch-plus\">\r\n                            +\r\n                        </Button>\r\n                    </span>\r\n                </Field>\r\n            </FieldSet>\r\n\r\n            <FieldSet>\r\n                <Field className=\"panel__field-header\">Impulse</Field>\r\n                <Field centered>\r\n                    <FieldLabel>Prograde</FieldLabel>\r\n                    <FieldControl id=\"burn-prograde\" />\r\n                    <Dimension>m/s</Dimension>\r\n                    <span className=\"maneuver-panel__buttons\">\r\n                        <Button className=\"maneuver-panel__button\" id=\"prograde-zero\">\r\n                            0\r\n                        </Button>\r\n                        <Button className=\"maneuver-panel__button\" id=\"prograde-minus\">\r\n                            -\r\n                        </Button>\r\n                        <Button className=\"maneuver-panel__button\" id=\"prograde-plus\">\r\n                            +\r\n                        </Button>\r\n                    </span>\r\n                </Field>\r\n                <Field centered>\r\n                    <FieldLabel>Normal</FieldLabel>\r\n                    <FieldControl id=\"burn-normal\" />\r\n                    <Dimension>m/s</Dimension>\r\n                    <span className=\"maneuver-panel__buttons\">\r\n                        <Button className=\"maneuver-panel__button\" id=\"normal-zero\">\r\n                            0\r\n                        </Button>\r\n                        <Button className=\"maneuver-panel__button\" id=\"normal-minus\">\r\n                            -\r\n                        </Button>\r\n                        <Button className=\"maneuver-panel__button\" id=\"normal-plus\">\r\n                            +\r\n                        </Button>\r\n                    </span>\r\n                </Field>\r\n                <Field centered>\r\n                    <FieldLabel>Radial</FieldLabel>\r\n                    <FieldControl id=\"burn-radial\" />\r\n                    <Dimension>m/s</Dimension>\r\n                    <span className=\"maneuver-panel__buttons\">\r\n                        <Button className=\"maneuver-panel__button\" id=\"radial-zero\">\r\n                            0\r\n                        </Button>\r\n                        <Button className=\"maneuver-panel__button\" id=\"radial-minus\">\r\n                            -\r\n                        </Button>\r\n                        <Button className=\"maneuver-panel__button\" id=\"radial-plus\">\r\n                            +\r\n                        </Button>\r\n                    </span>\r\n                </Field>\r\n                <Field>\r\n                    <FieldLabel>Total</FieldLabel>\r\n                    <FieldControl id=\"burn-total\" />\r\n                    <Dimension>m/s</Dimension>\r\n                </Field>\r\n            </FieldSet>\r\n        </div>\r\n    </Panel>\r\n);\r\n\r\nexport default ManeuverPanel;\r\n","import { satelliteTransformer } from \"./transformers/satellite-transformer\";\r\n\r\nclass Satellite {\r\n    constructor(satelliteRawData) {\r\n        Object.assign(this, satelliteTransformer(satelliteRawData), {});\r\n    }\r\n}\r\n\r\nexport default Satellite;\r\n","export function satelliteTransformer(data) {\r\n    return {\r\n        noradId: data[\"norad_id\"],\r\n        objectType: data[\"object_type\"],\r\n        intlDes: data[\"intl_des\"],\r\n        name: data[\"name\"],\r\n        country: data[\"country\"],\r\n        launchDate: data[\"launch_date\"],\r\n        decayDate: data[\"decay_date\"],\r\n        launchSite: data[\"launch_site\"],\r\n        period: data[\"period\"],\r\n        inc: data[\"inc\"],\r\n        apogee: data[\"apogee\"],\r\n        perigee: data[\"perigee\"],\r\n        launchYear: data[\"launch_year\"],\r\n        launchNum: data[\"launch_num\"],\r\n        launchPiece: data[\"launch_piece\"],\r\n        objectName: data[\"object_name\"],\r\n        objectId: data[\"object_id\"],\r\n        objectNumber: data[\"object_number\"],\r\n    };\r\n}\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\n\r\nimport Button from \"../../../../common/button\";\r\nimport Satellite from \"../satelite\";\r\n\r\nclass LoadButton extends Component {\r\n    static propTypes = {\r\n        onLoad: PropTypes.func.isRequired,\r\n        onUnload: PropTypes.func.isRequired,\r\n        satelliteId: PropTypes.string.isRequired,\r\n    };\r\n\r\n    state = {\r\n        isLoaded: false,\r\n    };\r\n\r\n    handleLoad = () => {\r\n        this.props.onLoad(this.props.satelliteId);\r\n        this.setState({ isLoaded: true });\r\n    };\r\n\r\n    handleUnload = () => {\r\n        this.props.onUnload(this.props.satelliteId);\r\n        this.setState({ isLoaded: false });\r\n    };\r\n\r\n    render() {\r\n        return this.state.isLoaded ? (\r\n            <Button text=\"Unload\" onClick={this.handleUnload} />\r\n        ) : (\r\n            <Button text=\"Load\" onClick={this.handleLoad} />\r\n        );\r\n    }\r\n}\r\n\r\nclass SatellitesGrid extends React.Component {\r\n    static propTypes = {\r\n        satellites: PropTypes.arrayOf(PropTypes.instanceOf(Satellite)).isRequired,\r\n        onSatelliteLoad: PropTypes.func.isRequired,\r\n        onSatelliteUnload: PropTypes.func.isRequired,\r\n    };\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"satellites-grid-container\">\r\n                <table className=\"satellites-grid\">\r\n                    <thead className=\"satellites-grid__head\">\r\n                        <tr>\r\n                            <th className=\"satellites-grid__pos-column\">#</th>\r\n                            <th className=\"satellites-grid__id-column\">ID</th>\r\n                            <th className=\"satellites-grid__name-column\">Name</th>\r\n                            <th className=\"satellites-grid__designator-column\">Designator</th>\r\n                            <th className=\"satellites-grid__launch-date-column\">Launch date</th>\r\n                            <th className=\"satellites-grid__command-column\" />\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        {this.props.satellites.map((satellite, index) => {\r\n                            const { noradId, name, launchDate, intlDes } = satellite;\r\n\r\n                            return (\r\n                                <tr key={noradId}>\r\n                                    <td>{index}</td>\r\n                                    <td>{noradId}</td>\r\n                                    <td>{name}</td>\r\n                                    <td>{intlDes}</td>\r\n                                    <td>{launchDate}</td>\r\n                                    <td>\r\n                                        <LoadButton\r\n                                            satelliteId={noradId}\r\n                                            onLoad={this.props.onSatelliteLoad}\r\n                                            onUnload={this.props.onSatelliteUnload}\r\n                                        />\r\n                                    </td>\r\n                                </tr>\r\n                            );\r\n                        })}\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default SatellitesGrid;\r\n","import axios from \"axios\";\r\n\r\nconst API_ENDPOINT = \"/api/\";\r\n\r\nexport async function findSatellites(noradId, launchDate) {\r\n    try {\r\n        const params = {};\r\n        if (noradId) {\r\n            params[\"fields[norad_id][value]\"] = noradId;\r\n            params[\"fields[norad_id][relation]\"] = \"=\";\r\n        }\r\n\r\n        if (launchDate) {\r\n            params[\"fields[launch_date][value]\"] = launchDate;\r\n            params[\"fields[launch_date][relation]\"] = \"=\";\r\n        }\r\n\r\n        const resp = await axios.get(API_ENDPOINT, {\r\n            params,\r\n        });\r\n\r\n        if (resp.data.status === \"ok\") {\r\n            const { result } = resp.data;\r\n\r\n            return {\r\n                totalRows: result[\"total_rows\"],\r\n                satellites: result.satellites,\r\n            };\r\n        } else if (resp.data.status === \"error\") {\r\n            alert(resp.data.message);\r\n\r\n            return {\r\n                totalRows: 1,\r\n                satellites: [],\r\n            };\r\n        }\r\n\r\n        throw new Error(\"Unknown status code\");\r\n    } catch (error) {\r\n        console.error(error);\r\n    }\r\n}\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport cn from \"classnames\";\r\n\r\nimport { Consumer } from \"../../../../store\";\r\nimport Panel from \"../../../common/panel\";\r\nimport Button from \"../../../common/button\";\r\nimport SatellitesGrid from \"./components/satellites-grid\";\r\nimport { findSatellites } from \"./web-api\";\r\nimport Satellite from \"./satelite\";\r\nimport \"./index.scss\";\r\n\r\nclass SatelliteSearchPanel extends React.Component {\r\n    static propTypes = {\r\n        className: PropTypes.string,\r\n    };\r\n\r\n    state = {\r\n        satId: \"\",\r\n        launchDate: \"\",\r\n        satellites: [],\r\n    };\r\n\r\n    get isFilterValid() {\r\n        return Boolean(this.state.satId) || Boolean(this.state.launchDate); // TODO: Add a few more validation rules\r\n    }\r\n\r\n    handleSatIdChange = ({ target: { value } }) => {\r\n        this.setState({\r\n            satId: value,\r\n        });\r\n    };\r\n\r\n    handleLaunchDateChange = ({ target: { value } }) => {\r\n        this.setState({\r\n            launchDate: value,\r\n        });\r\n    };\r\n\r\n    handleSearch = async () => {\r\n        try {\r\n            const { satellites } = await findSatellites(this.state.satId, this.state.launchDate);\r\n\r\n            this.setState({\r\n                satellites: satellites.map(s => new Satellite(s)),\r\n            });\r\n        } catch (e) {\r\n            console.error(e);\r\n        }\r\n    };\r\n\r\n    render() {\r\n        const { className } = this.props;\r\n        const { satellites, satId, launchDate } = this.state;\r\n\r\n        return (\r\n            <Consumer>\r\n                {({ store }) => (\r\n                    <Panel\r\n                        className={cn(\"satellite-search-panel\", className)}\r\n                        caption=\"Satellite search panel\"\r\n                        hidden={!store.viewSettings.showSatelliteSearchPanel}\r\n                        collapseDirection=\"right\"\r\n                    >\r\n                        <div>\r\n                            <div className=\"panel__field-set\">\r\n                                <div className=\"panel__field panel__field--left-aligned\">\r\n                                    <div className=\"satellite-search-panel__searcher searcher\">\r\n                                        <div className=\"searcher__filter\">\r\n                                            <div className=\"searcher__column\">\r\n                                                <label>\r\n                                                    Satellite Catalog Number\r\n                                                    <input\r\n                                                        className=\"searcher__input\"\r\n                                                        type=\"number\"\r\n                                                        value={satId}\r\n                                                        step={1}\r\n                                                        placeholder=\"NORAD ID\"\r\n                                                        min=\"1\"\r\n                                                        onChange={this.handleSatIdChange}\r\n                                                    />\r\n                                                </label>\r\n                                            </div>\r\n                                            <div className=\"searcher__column\">\r\n                                                <label>\r\n                                                    Launch date\r\n                                                    <input\r\n                                                        className=\"searcher__input\"\r\n                                                        type=\"text\"\r\n                                                        placeholder={\"YYYY-MM-DD\"}\r\n                                                        value={launchDate}\r\n                                                        onChange={this.handleLaunchDateChange}\r\n                                                    />\r\n                                                </label>\r\n                                            </div>\r\n                                        </div>\r\n                                        <div className=\"searcher__search-button-wrapper\">\r\n                                            <Button\r\n                                                className=\"searcher__search-button\"\r\n                                                disabled={!this.isFilterValid}\r\n                                                onClick={this.handleSearch}\r\n                                            >\r\n                                                search\r\n                                            </Button>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                            {satellites.length > 0 && (\r\n                                <div className=\"panel__field-set\">\r\n                                    <div className=\"panel__field panel__field-header\">Satellites</div>\r\n                                    <div className=\"panel__field\">\r\n                                        <SatellitesGrid\r\n                                            satellites={satellites}\r\n                                            onSatelliteLoad={store.loadSatellite}\r\n                                            onSatelliteUnload={store.unloadSatellite}\r\n                                        />\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    </Panel>\r\n                )}\r\n            </Consumer>\r\n        );\r\n    }\r\n}\r\n\r\nexport default SatelliteSearchPanel;\r\n","import React from \"react\";\nimport cn from \"classnames\";\n\nimport SideBar from \"../common/side-bar\";\nimport BottomPanel from \"./components/bottom-panel\";\nimport CreationPanel from \"./components/creation-panel\";\nimport TransferCalculationPanel from \"./components/transfer-calculation-panel\";\nimport MetricsPanel from \"./components/metrics-panel\";\nimport ManeuverPanel from \"./components/maneuver-panel\";\nimport SatelliteSearchPanel from \"./components/satellite-search-panel\";\nimport \"./main-view.scss\";\n\nconst MainView = ({ className, children }) => {\n    return (\n        <main className={cn(className, \"main-view\")}>\n            <SideBar className=\"main-view__left-side-bar\">\n                <CreationPanel className=\"main-view__creation-panel\" />\n                <ManeuverPanel className=\"main-view__maneuver-panel\" />\n                <TransferCalculationPanel className=\"main-view__transfer-calculation-panel\" />\n            </SideBar>\n            <SideBar className=\"main-view__right-side-bar\" right>\n                <MetricsPanel />\n            </SideBar>\n            <SatelliteSearchPanel className=\"main-view__satellite-search-panel\" />\n            <BottomPanel className=\"main-view__bottom-panel\" />\n            <div id=\"viewport-id\" className=\"main-view__viewport-container\" />\n        </main>\n    );\n};\n\nexport default MainView;\n","import React from \"react\";\r\n\r\nconst Footer = ({ className }) => <footer className={`${className} footer`} />;\r\n\r\nexport default Footer;\r\n","import React from \"react\";\n\nimport { showWizard, wizardIds } from \"./components/tutorials/index\";\nimport Header from \"./components/header/header\";\nimport MainView from \"./components/main-view/main-view\";\nimport Footer from \"./components/footer/footer\";\nimport \"./components/common/app-layout.scss\";\n\nclass App extends React.Component {\n    componentDidMount() {\n        showWizard(wizardIds.GETTING_STARTED_WIZARD);\n    }\n\n    render() {\n        return (\n            <>\n                <Header className=\"app-layout__header\" />\n                <MainView className=\"app-layout__main\" />\n                <Footer className=\"app-layout__footer\" />\n            </>\n        );\n    }\n}\n\nexport default App;\n","import { library } from \"@fortawesome/fontawesome-svg-core\";\r\nimport { faExpand, faPlay, faPause, faChevronDown, faCheck, faBars } from \"@fortawesome/free-solid-svg-icons\";\r\n\r\nexport function configureLibs() {\r\n    library.add(faExpand);\r\n    library.add(faPlay);\r\n    library.add(faPause);\r\n    library.add(faChevronDown);\r\n    library.add(faCheck);\r\n    library.add(faBars);\r\n}\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\n\r\nimport { configureLibs } from \"./libs\";\r\nimport { Provider, Store } from \"./store\";\r\nimport { createStatsBadge } from \"./components/statistics-badge\";\r\nimport AppComponent from \"./app\";\r\n\r\nconfigureLibs();\r\nconst statsBadge = createStatsBadge();\r\n\r\nclass Root extends React.Component {\r\n    state = {\r\n        stats: statsBadge,\r\n        store: this.props.store,\r\n        updateStore: updatedStore => {\r\n            this.setState({\r\n                store: updatedStore,\r\n            });\r\n        },\r\n    };\r\n\r\n    render() {\r\n        return (\r\n            <Provider value={this.state}>\r\n                <AppComponent />\r\n            </Provider>\r\n        );\r\n    }\r\n}\r\n\r\nfunction renderUi(initialState) {\r\n    ReactDOM.render(<Root store={initialState} />, document.getElementById(\"root\"));\r\n}\r\n\r\nexport { renderUi, statsBadge, Store };\r\n","import { sim } from \"./core/index\";\r\n\r\nexport const loadTLE = function(noradId) {\r\n    sim.getModule(\"SolarSystem\").loadTLE(sim.starSystem, noradId);\r\n};\r\n\r\nexport const loadKSP = function() {\r\n    sim.loadModule(\"KSP\");\r\n};\r\n","import { sim } from \"./core/index\";\r\nimport { renderUi, statsBadge } from \"./ui/index\";\r\nimport Application from \"./application\";\r\n\r\nconst app = new Application(sim);\r\nconst initialState = app.getInitialState();\r\nwindow.api = app.getApi();\r\n\r\nrenderUi(initialState);\r\n\r\napp.init(statsBadge);\r\n","import { init } from \"./core/index\";\r\nimport { loadTLE, loadKSP } from \"./api\";\r\nimport { Store } from \"./ui/index\";\r\n\r\nclass Application {\r\n    constructor(sim) {\r\n        this._store = new Store(sim, loadTLE);\r\n    }\r\n\r\n    init(statsBadge) {\r\n        init(statsBadge);\r\n    }\r\n\r\n    getInitialState() {\r\n        return this._store;\r\n    }\r\n\r\n    getApi() {\r\n        return {\r\n            loadTLE,\r\n            loadKSP,\r\n        };\r\n    }\r\n}\r\n\r\nexport default Application;\r\n"],"sourceRoot":""}