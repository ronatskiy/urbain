{"version":3,"sources":["core/algebra.js","core/EventHandler.js","ui-legacy/TimeLine.js","core/visual/Raycaster.js","ui-legacy/SelectionHandler.js","ui-legacy/Panel.js","ui-legacy/Panels/Time.js","ui-legacy/Panels/Camera.js","ui-legacy/Panels/Vector.js","ui-legacy/Panels/Metrics.js","core/LambertSolver.js","core/visual/Vector.js","ui-legacy/Panels/Lambert.js","ui-legacy/Panels/Creation.js","ui-legacy/UI.js","core/StarSystem.js","ui-legacy/Camera.js","interface/StarSystemEntry.js","interface/StarSystemManager.js","core/Simulation.js","core/FunctionOfEpoch/ObjectState.js","core/ReferenceFrame/BodyFixed.js","core/ReferenceFrame/Base.js","core/ReferenceFrame/Topocentric.js","core/ReferenceFrame/Factory.js","core/Events.js","core/EphemerisObject.js","core/StateVector.js","core/visual/ModelAbstract.js","core/index.js","core/FunctionOfEpoch/Custom.js","core/KeplerianObject.js","core/Body.js","core/Trajectory/KeplerianBasic.js","core/ReferenceFrame/Abstract.js","core/visual/TrajectoryModel/Keplerian.js","core/FunctionOfEpoch/Abstract.js","core/Trajectory/Composite.js","core/FunctionOfEpoch/Constant.js","core/visual/VirtualPlane.js","core/visual/Arrow.js","core/visual/Angle.js","core/visual/PlanePoint.js","core/KeplerianEditor.js","core/Trajectory/Abstract.js","core/ReferenceFrame/InertialDynamic.js","components/tutorials/wizards/wizard-ids.js","core/Trajectory/KeplerianAbstract.js","core/ReferenceFrame/Inertial.js","core/ReferenceFrame/InertialAbstract.js","core/Trajectory/ExceptionOutOfRange.js","core/visual/LineObject.js","core/visual/TrajectoryModel/Abstract.js","core/Orientation/Abstract.js","core/Orientation/ConstantAxis.js","core/PhysicalBodyModel.js","core/Trajectory/KeplerianArray.js","core/Trajectory/KeplerianPrecessingArray.js","core/Trajectory/KeplerianPrecessing.js","core/visual/TrajectoryModel/PointArray.js","core/Trajectory/StaticPosition.js","interface/TrajectoryLoader.js","core/visual/StarsModel.js","core/visual/VisualLabel.js","core/visual/BodyModel/Abstract.js","core/visual/BodyModel/Basic.js","core/visual/BodyModel/Light.js","core/visual/BodyModel/Rings.js","core/visual/Shape/Sphere.js","interface/StarSystemLoader.js","modules lazy /^/.*$/ groupOptions: {} namespace object","components/tutorials/wizards lazy /^/.*$/ groupOptions: {} namespace object","store/constants.js","store/index.js","store/context.js","components/main-view/components/statistics-badge/index.js","components/tutorials/services/local-storage-watch-status-service.js","components/header/components/logo.js","components/common/select/select.js","components/header/components/star-system-selector/star-system-selector.js","components/header/components/main-menu/components/drop-down-menu-item.js","components/header/components/main-menu/components/drop-down-menu.js","components/header/components/main-menu/components/menu-link.js","components/header/components/main-menu/main-menu.js","components/header/header.js","components/common/logos/arrow-logo.js","components/common/logos/maximize-logo.js","components/common/panel/components/collapse-button.js","components/common/panel/index.js","components/main-view/components/bottom-panel/components/camera-panel/camera-panel.js","components/main-view/components/bottom-panel/components/time-line/index.js","components/main-view/components/bottom-panel/components/pause-button/index.js","components/main-view/components/bottom-panel/components/time-settings-panel/logo.js","components/main-view/components/bottom-panel/components/time-settings-panel/index.js","components/main-view/components/bottom-panel/index.js","components/main-view/components/creation-panel.js","components/main-view/components/transfer-calculation-panel/index.js","components/main-view/components/metrics-panel/components/keplerian-view.js","components/main-view/components/metrics-panel/components/vector-component-view.js","components/common/expand-button/index.js","components/main-view/components/metrics-panel/components/cartesian-vector-view.js","components/main-view/components/metrics-panel/index.js","components/common/side-bar/index.js","components/main-view/main-view.js","components/footer/footer.js","components/app.js","components/tutorials/index.js","api.js","application.js","libs/index.js","index.js"],"names":["Vector","_Array","dimOrArray","_this","Object","D_Projects_github_com_urbain_ru_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__","this","D_Projects_github_com_urbain_ru_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__","D_Projects_github_com_urbain_ru_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__","call","undefined","Array","i","length","setPrototypeOf","D_Projects_github_com_urbain_ru_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_5__","prototype","D_Projects_github_com_urbain_ru_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_4__","D_Projects_github_com_urbain_ru_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__","key","value","arrayOrVarargs","vals","arguments","vec","res","cos","dot","mag","Math","PI","acos","scalar","axis","angle","Quaternion","rotate_","div_","copy","add_","sub_","mul_","unit_","radians","sin","get","set","sqrt","quadrance","D_Projects_github_com_urbain_ru_node_modules_babel_runtime_helpers_esm_wrapNativeSuper__WEBPACK_IMPORTED_MODULE_6__","vector","t","v","setAxisAngle","invert_","len","normalize_","cx","cross","cx2","quat","w","x","y","z","ow","ox","oy","oz","order","c1","c2","c3","s1","s2","s3","THREE","q","q1","q2","fromVector","toVector","normal1","normal2","transfer","cosHalfTheta","sinHalfTheta","halfTheta","atan2","ratio1","ratio2","invert","TWO_PI","newtonSolve","func","start","d","maxError","maxSteps","error","step","val","v1","v2","diff","abs","deg2rad","degrees","rad2deg","getAngleBySinCos","ang","angleIntervalIntersection","int1","int2","getAngleIntervalsIntersection","intervals1","intervals2","result","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","next","done","interval1","int11","int12","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","interval2","int21","int22","r","push","err","return","getEpochIntervalsIntersection","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","epoch1","epoch2","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_step4","_iterator4","epoch21","epoch22","approximateAngle","ang1","ang2","proportion","approximateNumber","n1","n2","presentNumberWithSuffix","number","toFixed","toPrecision","EventHandler","domElement","classCallCheck","listeners","handlers","eventName","listener","priority","event","handleEvent","addEventListener","handler","list","idx","splice","removeEventListener","eventObject","highestPriority","reduce","a","max","TimeLine","epoch","timeScale","isTimeRunning","mouseState","leftButton","rightButton","timeLineCanvasDomElement","document","getElementById","canvasContext","getContext","canvasRect","updateCanvasStyle","initValues","onMouseDown","bind","window","onMouseUp","onMouseMove","onMouseWheel","e","togglePause","oncontextmenu","scales","minute","fiveMinutes","tenMinutes","thirtyMinutes","hour","threeHours","sixHours","day","week","month","threeMonths","year","fiveYears","span","markDistance","scaleType","leftEpoch","updateScaleType","getDateByEpoch","getEpochByDate","roundDateUp","nextRenderingDate","formatDate","formatDateFull","newScale","Events","dispatch","TIME_SCALE_CHANGED","old","new","TIME_UNPAUSED","TIME_PAUSED","timePassed","left","width","EPOCH_CHANGED","date","redraw","newEpoch","tick","forceEpoch","Date","fillStyle","fillRect","height","drawCurrentTimeMark","strokeStyle","font","markDate","markEpoch","drawMark","getCanvasPositionByEpoch","getBoundingClientRect","right","bottom","top","secondsPerPeriod","bestScale","scale","text","beginPath","moveTo","lineTo","stroke","fillText","measureText","button","_this2","keys","b","_this3","mult","deltaY","newSpan","min","getMinScale","getMaxScale","setSeconds","setMinutes","getMinutes","setHours","getHours","setDate","getDate","getDay","setMonth","getMonth","setFullYear","getFullYear","string","getYear","padStart","toString","getSeconds","VisualRaycaster","threeCamera","pixelPrecision","raycaster","mouse","camera","setPixelPrecision","updatePixelAngleSize","clientX","clientY","pixelAngleSize","fov","threeObjects","setFromCamera","intersectObjects","point","pointDirection","subVectors","sim","lastPosition","ray","direction","SelectionHandler","possibleConstructorReturn","getPrototypeOf","selectableObjects","selectedObject","bestIntersection","selectionMouseButton","pointSize","setThreeObj","color","onMouseClick","assertThisInitialized","mouseMoveListener","object","filter","intersections","distance","threeObj","visible","position","scaleKoeff","getPixelAngleSize","hasMouseMoved","mouseClickStart","wasSelected","deselect","currentTraj","userData","trajectory","parent","select","SELECT","DESELECT","VisualModelAbstract","UIPanel","panelDom","isCollapsed","jqDom","$","name","data","jqCollapseButton","find","click","toggleCollapse","collapse","expand","show","hide","html","UIPanelTime","maxTimeScale","jqSlider","on","time","setTimeScale","getCurrentTimeScale","getNeededSliderValue","jqScaleText","formatTimeScale","detail","jqDateText","updateTime","useCurrentTime","sign","prefix","UIPanelCamera","jqTarget","changeOrigin","jqFrameType","changeReferenceFrameType","addListener","STAR_SYSTEM_LOADED","starSystem","updateTargetList","updateTarget","orbitingPoint","updateFrameTypeList","updateFrameType","frameType","CAMERA_RF_CHANGED","originId","type","OBJECT_ADDED","each","getObjectNames","objId","objName","append","selected","getAvailableFrameTypes","typeId","frameTypeNames","_UIPanelCamera$frameT","defineProperty","ReferenceFrame","INERTIAL_ECLIPTIC","INERTIAL_BODY_EQUATORIAL","INERTIAL_BODY_FIXED","INERTIAL_PARENT_BODY_EQUATORIAL","UIPanelVector","vectorOfEpoch","jqMag","jqX","jqY","jqZ","update","FunctionOfEpochAbstract","evaluate","UIPanelMetrics","selection","precision","renderListener","render","handleSelect","handleDeselect","getSelectedObject","deleteObject","id","settings","ui","showAnglesOfSelectedOrbit","checked","SHOW_ORBIT_ANGLES_CHANGED","positionPanel","velocityPanel","referenceFrame","getReferenceFrameByEpoch","getObject","updateMain","updateCartesian","updateKeplerian","keplerianObject","getKeplerianObjectByEpoch","sma","per","apo","surfaceAlt","physicalModel","radius","state","getStateInOwnFrameByEpoch","velocity","j2","getNodalPrecessionRate","eqRadius","inc","aop","raan","getTrueAnomalyByEpoch","period","EphemerisObject","TYPE_SPACECRAFT","TYPE_UNKNOWN","RENDER","LambertSolver","orbit1","orbit2","epochMin","epochMax","transferMin","transferMax","points","epochStep","flightTimeStep","startEpoch","flightTime","j","calcDeltaV","getStateByEpoch","mu","plotData","ctx","clearRect","row","col","round","state1","state2","transferOrbit","_velocity","solve","getDeltaV","originObject","targetObject","rPer1","rPer2","departureTime","flightTimeMin","flightTimeMax","bestFlightTime","minDeltaV","solveFullTransfer","deltaV","totalDeltaV","parentObject","getCommonParentObject","Body","rfOrigin","rfTarget","originSoi","targetSoi","rfMainId","ReferenceFrameFactory","buildId","TYPE_STAR","rfMain","getReferenceFrame","calcOriginSoi","calcTargetSoi","patchedConics","soiRadius","ejectionVelInf","insertionVelInf","transferKO","ejectionSoiEpoch","insertionSoiEpoch","ejectionTime","insertionTime","ejectionPosShift","insertionPosShift","steps","_position","transformPositionByEpoch","ejectionPosTime","insertionPosTime","ejectionNormal","getSoiEdgePositionAndTime","rotateVectorByEpoch","insertionNormal","sub","ejectionDeltaV","insertionDeltaV","TrajectoryComposite","TrajectoryKeplerianBasic","minEpoch","maxEpoch","addComponent","ejectionKO","KeplerianObject","createFromState","StateVector","getPeriapsisSpeed","getPeriapsisRadius","ejection","insertionKO","insertion","velInf","normal","rPer","rInf","ecc","trueAnomaly","flightPathAngle","atan","unit","H","getEccentricAnomalyByTrueAnomaly","sinh","r1vec","r2vec","r1","r2","transferAngle","ta1","signSinTransferAngle","nodeVector","parabolicTime","pow","A","E","B","yParam","getTimeByY","x0","y0","temp","fx","fy","alpha","acosh","beta","f1","rotate","p2","d1","d2","tempAng","rotateZ","f2x","f2y","p","ta2","perVector","rm","cosTa1","sinTa1","n","E1","E2","ta","atanh","tan","VisualVector","referenceFrameId","RF_BASE","quaternion","fromArray","mul","getQuaternionByEpoch","toThreejs","getVisualCoords","getOriginPositionByEpoch","UIPanelLambert","maxTransferTime","changeTransferTime","getCurrentTransferTime","transferTime","jqTransferTimeText","formatTransferTime","jqOrigin","changeTarget","origin","updateOriginList","target","solverResult","transferTrajectory","setObject","visualModel","drop","visualModel2","visualModel3","vector1","vector2","VisualTrajectoryModelKeplerian","components","currentEpoch","currentDate","newOrigin","newTarget","newTransferTime","UIPanelCreation","jqPause","center","created","ephObject","traj","setVisualModel","isEditable","pTraj","propagatorClass","getPropagator","propagator","setUpdateCallback","propagate","setTrajectory","addObject","forceSelection","UI","timePanel","cameraPanel","metricsPanel","creationPanel","lambertPanel","StarSystem","stars","mainObject","referenceFrames","objects","entries","map","entry","frame","createById","body","object1","object2","chain1","getParentObjectIdByEpoch","indexOf","objectId","names","_arr","values","_i","bodies","_arr2","_i2","Camera","animationDuration","pixelsToObjectUnderMouse","listenersAdded","initialReferenceFrame","initialPosition","_getQuaternionByPosition","currentMousePos","accountedMousePos","isMouseDown","isShiftDown","rightButtonDown","isLookingAside","zoomingAside","isAnimnating","pole","defaultDirection","defaultUp","directionQuaternion","newUp","neededUp","isBody","newType","changeReferenceFrame","newObjectId","newFrameType","newFrameId","animate","newFrame","startAnimation","transferQuaternion","animationStartingTime","getTime","animationStartingQuaternion","percent","targetQuat","slerp","biggestRadius","biggestObject","getBodies","getPixelDistance","getPositionByEpoch","defaultFactor","shiftKey","zoomFactor","factor","objectToZoomTo","findObjectUnderMouse","zoomingTo","currentMag","aspect","updateProjectionMatrix","rfQuaternion","mouseShift","sensitivity","mouseSensitivity","poleAngle","verticalRotationAxis","verticalQuaternion","mainQuaternion","StarSystemEntry","alias","label","moduleName","isModuleLoaded","getModule","loadStarSystem","loadModule","module","StarSystemManager","_starSystems","_loadedIdx","add","loadByIdx","defaultStarSystemIdx","_findStarSystemByIdx","load","Simulation","modules","propagators","renderLoopActive","starSystemManager","_initSettings","viewPortDomElement","renderLoopFunction","scene","textureLoader","renderer","antialias","logarithmicDepthBuffer","setSize","innerWidth","innerHeight","appendChild","onWindowResize","rendererEvents","loadDefault","INIT_DONE","jsonFile","onLoadFinish","getJSON","starSystemConfig","unload","StarSystemLoader","loadFromConfig","init","startRendering","requestAnimationFrame","showBodyLabels","removeListener","onResize","timeDelta","simCoords","visualCoords","toArray","callback","className","__webpack_require__","then","default","Error","periodPos","substr","getClass","FunctionOfEpochObjectState","ReferenceFrameBodyFixed","isInertial","orientation","getOriginStateByEpoch","angularVel","originState","rotation","destPos","destVel","rfVel","getRotationVelocityByEpoch","ReferenceFrameAbstract","ReferenceFrameBase","setId","ReferenceFrameTopocentric","lat","lon","bodyFixedQuaternion","setFromEuler","bodyFixedPosition","rotateY","bodyState","bodyQuaternion","config","ReferenceFrameInertial","ReferenceFrameInertialDynamic","FunctionOfEpochCustom","equinox","parentId","INERTIAL_TOPOCENTRIC","BODY_FIXED","TOPOCENTRIC","BASE","floor","getTypeByReferenceFrameId","create","getOriginIdByReferenceFrameId","RF_BASE_OBJ","eventObj","CustomEvent","dispatchEvent","LOADING_BODIES_DONE","LOADING_FRAMES_DONE","LOADING_TRAJECTORIES_DONE","bodyId","rf","TYPE_PLANET","TYPE_PLANETOID","TYPE_SATELLITE","TYPE_ASTEROID","TYPE_COMET","TYPE_POINT","vx","vy","vz","obj","_onRender","remove","traverse","geometry","dispose","material","texturePath","__webpack_exports__","_Simulation__WEBPACK_IMPORTED_MODULE_0__","_Events__WEBPACK_IMPORTED_MODULE_1__","statistics","globalTime","viewPortId","curTime","anomaly","isAnomalyTrue","_mu","_sma","_e","_inc","_raan","_aop","_epoch","m0","updateMeanMotion","updateCallback","meanMotion","getMeanAnomalyByEpoch","getNodalPrecessionByEpoch","getEccentricAnomalyByMeanAnomaly","getTrueAnomalyByMeanAnomaly","ea","isElliptic","getMeanAnomalyByEccentricAnomaly","ma","F","M","log","asinh","cosh","cosE","getTrueAnomalyByEccentricAnomaly","phi","tanh","getApoapsisRadius","getMeanAnomalyByTrueAnomaly","apoR","distanceToPlane","c","taHigh","_planeCrossingHelper","taLow","range1","range2","isHyperbolic","console","temp1","temp2","isNaN","asymptote","getAsymptoteTa","_validateHyperbolicTa","getEccentricAnomalyByEpoch","koeff","pos","vel","rotateX","orbitalQuat","getOrbitalFrameQuaternion","getOwnCoordsByTrueAnomaly","nodeQuaternion","angMomentum","u","radVel","D_Projects_github_com_urbain_ru_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_6__","D_Projects_github_com_urbain_ru_node_modules_babel_runtime_helpers_esm_get__WEBPACK_IMPORTED_MODULE_4__","referenceFrameOrId","validateEpoch","_transformKeplerianObject","TrajectoryKeplerianAbstract","destinationFrameOrId","destinationFrame","stateVectorFromBaseReferenceFrameByEpoch","stateVectorToBaseReferenceFrameByEpoch","transformStateVectorByEpoch","renderingEpoch","getRenderingEpoch","renderEllipse","renderHyperbola","locationEpoch","maxTa","minTa","orbitQuaternion","pericentricReferenceFrame","curTa","taCut","angs","taStep","extraPoints","coords","updateGeometry","cameraPosition","visualOrigin","actualVisualOrigin","sinE","cameraTrueAnomaly","toClosestPoint","toFarthestPoint","cameraAngle","ellipsePoints","getEllipsePoints","curve","pointsNum","densityCenter","nearSegmentSize","segments","otherSegmentsSize","segmentsFar","segmentsMedium","segmentsNear","curPos","getPoint","partSize","VisualTrajectoryModelAbstract","lastUsedTrajectory","isSelected","getComponentByEpoch","isEditableAtEpoch","ExceptionOutOfRange","setParent","pop","TrajectoryAbstract","Constant","VirtualPlane","intersects","C","constant","intersectionPoint","clone","multiplyScalar","index","face","faceIndex","ArrowObject","dir","headLength","headWidth","line","LineObject","VisualAngle","size","editingCallback","_referenceFrame","_orientation","_value","arcSize","isEditMode","orientationUpdated","valueUpdated","isHidden","sizeNeedsUpdate","onWheelListener","mouseDownListener","TYPE_ARC","createArcObject","createSectorObject","threeAngle","children","cone","mouseUpListener","plane","getVirtualPlane","intersection","normalize","mainAxis","applyQuaternion","newAngleValue","virtualPlane","threeArc","threeMainAxis","vertices","setFromPoints","getPoints","ceil","opacity","transparent","side","getPosition","getValue","updateArcObject","updateSectorObject","getOrientation","TYPE_SECTOR","VisualPlanePoint","minBound","maxBound","mouseMoved","getSimCoords","updateValue","KeplerianEditor","colorRaan","colorAop","colorInc","colorTa","angleRaan","angleInc","ko","angleAop","angleTa","pointApoapsis","periapsis","cachedEpoch","cachedState","showOrbitAnglesListener","_onShowOrbitAnglesChange","orbitalReferenceFrame","twoAxis","keplerianEditor","isValidAtEpoch","stateOfEpoch","quaternionOfEpoch","ReferenceFrameInertialAbstract","GETTING_STARTED_WIZARD","setReferenceFrame","isBuffer","isBufferGeometry","verticesCount","attributes","count","applyMatrix4","getInverse","matrixWorld","vertex1","vertex2","i1","i2","positions","array","currentLineDirection","commonPerpendicularDirection","crossVectors","planeNormalVector","distanceCoeff","addVectors","distanceTo","currentDistance","standardColor","vertexColors","addSelectableObject","colorMults","endingBrightness","mainColor","curColor","colors","setColor","needsUpdate","removeSelectableObject","OrientationAbstract","OrientationConstantAxis","angularVelocity","axisQuaternion","angularSpeed","initialAngle","initialEpoch","PhysicalBodyModel","TrajectoryKeplerianArray","keplerianObjects","nextIdx","searchDirection","approximateKeplerianObject","TrajectoryKeplerianPrecessingArray","obj1","obj2","TrajectoryKeplerianPrecessing","addPrecession","VisualTrajectoryModelPointArray","pointArrayModel","showAhead","showBehind","trailPeriod","minCos","maxAngle","minStep","initVertices","originPos","epochs","low","high","curEpoch","curState","curVelocity","lastState","lastEpoch","isIncreasing","stepsLeft","nextEpoch","newState","dr","drMag","angleCos","nextNextEpoch","nextDr","TrajectoryStaticPosition","TrajectoryLoader","createKeplerianBasic","createKeplerianPrecessing","createKeplerianArray","createKeplerianPrecessingArray","createComposite","createStatic","periodStart","periodEnd","rendering","visual","keplerianModel","partConfig","elementsArray","addState","createKeplerianObject","elements","VisualStarsModel","threeGeometry","params","sizeAttenuation","VisualLabel","functionOfEpoch","parameters","assign","DEFAULT_SETTINGS","canvas","createElement","setText","context","fontSize","canvasWidth","canvasHeight","margin","ceilPowerOfTwo","textAlign","textBaseline","scaleCoeff","calculateScaleCoeff","scaling","scalingFunctions","range","from","to","alwaysVisible","VisualBodyModelAbstract","shape","getThreeObj","getThreeGeometry","getMaterial","wireframe","getTopDirection","getMaxDimension","VisualBodyModelBasic","isTextureRequested","metalness","roughness","txt","VisualBodyModelLight","light","lightColor","lightIntensity","lightDistance","lightDecay","VisualBodyModelRings","ringsRadius","ringsColorMapPath","ringsAlphaMapPath","container","bodyThreeObj","ringsThreeObj","ringsColorMap","ringsAlphaMap","alphaMap","updateRingsMaterial","VisualShapeSphere","objectConfig","_loadObject","addReferenceFrame","addStars","url","visualShape","visualModelClass","basic","rings","model","physical","./KSP/ModuleKSP","./KSP/ModuleKSP.js","./PatchedConics/ModulePatchedConics","./PatchedConics/ModulePatchedConics.js","./PatchedConics/PropagatorPatchedConics","./PatchedConics/PropagatorPatchedConics.js","./SolarSystem/ModuleSolarSystem","./SolarSystem/ModuleSolarSystem.js","./SolarSystem/Orientation/IAUModel","./SolarSystem/Orientation/IAUModel.js","./SolarSystem/Trajectory/ELP2000","./SolarSystem/Trajectory/ELP2000.js","./SolarSystem/Trajectory/VSOP87","./SolarSystem/Trajectory/VSOP87.js","webpackAsyncContext","req","ids","Promise","resolve","code","exports","./getting-started-wizard","./getting-started-wizard.js","./wizard-ids","./wizard-ids.js","all","slice","TOP_MENU_ITEMS","SIMULATION","EDIT","VIEW","SETTINGS","HELP","HELP_PAGE_URL","MenuItemType","NONE","LINK","DROPDOWN","MenuItem","LinkMenuItem","_ref","_ref$href","href","_ref$target","Boolean","DropDownMenuItem","options","onSelect","selectedLabel","option","newOption","objectSpread","onUpdate","Store","simulation","viewSettings","showStatistics","showOrbitCreationPanel","showTransferCalculationPanel","topMenu","_ref2","_ref3","_ref4","_simulation","_ref5","starSystems","defaultValue","defaultStarSystem","item","_React$createContext","React","createContext","Provider","Consumer","StatisticsBadge","elementRef","createRef","current","props","stats","dom","react_default","ref","Component","components_statistics_badge","store_Consumer","store","statistics_badge_StatisticsBadge","LocalStorageWatchStatusService","storage","_storage","wizardId","_getWatchedWizards","some","wizardIdsRawString","getItem","KEY","JSON","parse","wizardIds","setItem","stringify","Logo","DEFAULT","customSelectStyles","base","background","minHeight","minWidth","control","borderRadius","borderStyle","menu","marginTop","marginBottom","menuList","backgroundColor","isFocused","singleValue","isDisabled","transition","dropdownIndicator","padding","marginRight","indicatorSeparator","display","IndicatorsContainer","react_select_esm","DropdownIndicator","Select","PropTypes","_ref$onSelect","classNamePrefix","placeholder","styles","isSearchable","onChange","StarSystemSelector","select_select","star_system_selector_star_system_selector","_store$starSystemSele","starSystemSelectorSettings","DropdownMenuItem","handleClick","onClick","_this$props","react_fontawesome_index_es","icon","DropDownMenu","selectedItem","updateStore","_this$props2","hasOptionsToShow","drop_down_menu_item","components_drop_down_menu","dropDownMenuData","drop_down_menu_DropDownMenu","MenuLink","_ref$className","concat","MainMenuItem","menuItem","clickable","cn","menu_link","MainMenu","isClickable","Header","logo","main_menu_main_menu","ArrowLogo","classNames","role","viewBox","fill","xmlns","MaximizeLogo","strokeWidth","CollapseButton","isToRight","_ref$collapseDirectio","collapseDirection","maximize_logo","Panel","collapsedByDefault","handleToggle","setState","prevState","caption","hideCollapseButton","titleIcon","hidden","panel--hidden","panel--collapsed","collapse_button","style","defaultProps","CameraPanel","common_panel","PauseButton","timeLine","pause-button--paused","time_settings_panel_logo","TimeSettingsPanel","data-panel-name","BottomPanel","components_time_settings_panel","components_pause_button","components_time_line","camera_panel_camera_panel","CreationPanel","TransferCalculationPanel","KeplerianView","VectorComponentView","_ref$label","_ref$valueClassName","valueClassName","_ref$dimension","dimension","ExpandButton","_ref$expanded","expanded","expand-button--expanded","CartesianVectorView","isExpanded","vectorMagnitudeLabel","components_vector_component_view","common_expand_button","MetricsPanel","defaultChecked","components_cartesian_vector_view","SideBar","MainView","common_side_bar","creation_panel","components_transfer_calculation_panel","components_metrics_panel","components_bottom_panel","Footer","App","localStorage","canWatch","slicedToArray","wizardConfig","createIntroJs","showWizard","main_view_main_view","header_header","footer","loadTLE","noradId","loadKSP","Application","_store","statsBadge","library","faExpand","faPlay","faPause","faChevronDown","faCheck","faBars","Stats","classList","createStatsBadge","app","initialState","getInitialState","api","getApi","updatedStore","store_Provider","ReactDOM","src_App"],"mappings":"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","file":"static/js/main.02338d4f.chunk.js","sourcesContent":["import * as THREE from \"three\";\r\n\r\nexport class Vector extends Array\r\n{\r\n    constructor(dimOrArray) {\r\n        super();\r\n        if (dimOrArray === undefined) {\r\n            dimOrArray = 3;\r\n        }\r\n        if (dimOrArray instanceof Array) {\r\n            for (let i = 0; i < dimOrArray.length; ++i) {\r\n                this[i] = dimOrArray[i];\r\n            }\r\n        } else {\r\n            for (let i = 0; i < dimOrArray; ++i) {\r\n                this[i] = 0;\r\n            }\r\n        }\r\n\r\n        Object.setPrototypeOf(this, Vector.prototype);\r\n    }\r\n\r\n    get x() {\r\n        return this[0];\r\n    }\r\n\r\n    set x(value) {\r\n        this[0] = value;\r\n    }\r\n\r\n    get y() {\r\n        return this[1];\r\n    }\r\n\r\n    set y(value) {\r\n        this[1] = value;\r\n    }\r\n\r\n    get z() {\r\n        return this[2];\r\n    }\r\n\r\n    set z(value) {\r\n        this[2] = value;\r\n    }\r\n\r\n    get quadrance() {\r\n        let res = 0;\r\n        for (let i = 0; i < this.length; ++i) {\r\n            res += this[i] * this[i];\r\n        }\r\n        return res;\r\n    }\r\n\r\n    get mag() {\r\n        return Math.sqrt(this.quadrance);\r\n    }\r\n\r\n    copy() {\r\n        return new Vector(this);\r\n    }\r\n\r\n    set(arrayOrVarargs) {\r\n        let vals = (arguments.length === 1) ? arguments[0] : arguments;\r\n        if (vals.length == null) {\r\n            vals = [vals];\r\n        }\r\n        for (let i = 0; i < this.length; ++i) {\r\n            this[i] = vals[i];\r\n        }\r\n        return this;\r\n    }\r\n\r\n    dot(vec) {\r\n        let res = 0;\r\n        for (let i = 0; i < this.length; ++i) {\r\n            res += this[i] * vec[i];\r\n        }\r\n        return res;\r\n    }\r\n\r\n    cross(vec) {\r\n        return new Vector([\r\n            this[1] * vec[2] - this[2] * vec[1],\r\n            this[2] * vec[0] - this[0] * vec[2],\r\n            this[0] * vec[1] - this[1] * vec[0],\r\n        ]);\r\n    }\r\n\r\n    angle(vec) {\r\n        const cos = this.dot(vec) / this.mag / vec.mag;\r\n        if (cos <= -1) {\r\n            return Math.PI;\r\n        }\r\n        if (cos >= 1) {\r\n            return 0;\r\n        }\r\n        return Math.acos(cos);\r\n    }\r\n\r\n    add_(vec) {\r\n        for (let i = 0; i < this.length; ++i) {\r\n            this[i] += vec[i];\r\n        }\r\n        return this;\r\n    }\r\n\r\n    sub_(vec) {\r\n        for (let i = 0; i < this.length; ++i) {\r\n            this[i] -= vec[i];\r\n        }\r\n        return this;\r\n    }\r\n\r\n    mul_(scalar) {\r\n        for (let i = 0; i < this.length; ++i) {\r\n            this[i] *= scalar;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    div_(scalar) {\r\n        for (let i = 0; i < this.length; ++i) {\r\n            this[i] /= scalar;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    rotate_(axis, angle) {\r\n        return (new Quaternion(axis, angle)).rotate_(this);\r\n    }\r\n\r\n    unit_() {\r\n        return this.div_(this.mag);\r\n    }\r\n\r\n    add(vec) {\r\n        return this.copy().add_(vec);\r\n    }\r\n\r\n    sub(vec) {\r\n        return this.copy().sub_(vec);\r\n    }\r\n\r\n    mul(scalar) {\r\n        return this.copy().mul_(scalar);\r\n    }\r\n\r\n    div(scalar) {\r\n        return this.copy().div_(scalar);\r\n    }\r\n\r\n    unit() {\r\n        return this.copy().unit_();\r\n    }\r\n\r\n    rotate(axis, angle) {\r\n        return this.copy().rotate_(axis, angle);\r\n    }\r\n\r\n    rotateX(radians) {\r\n        let sin = Math.sin(radians);\r\n        let cos = Math.cos(radians);\r\n        return new Vector([\r\n            this[0],\r\n            this[1] * cos - this[2] * sin,\r\n            this[1] * sin + this[2] * cos,\r\n        ]);\r\n    }\r\n\r\n    rotateY(radians) {\r\n        let sin = Math.sin(radians);\r\n        let cos = Math.cos(radians);\r\n        return new Vector([\r\n            this[0] * cos + this[2] * sin,\r\n            this[1],\r\n            -this[0] * sin + this[2] * cos,\r\n        ]);\r\n    }\r\n\r\n    rotateZ(radians) {\r\n        let sin = Math.sin(radians);\r\n        let cos = Math.cos(radians);\r\n        return new Vector([\r\n            this[0] * cos - this[1] * sin,\r\n            this[0] * sin + this[1] * cos,\r\n            this[2],\r\n        ]);\r\n    }\r\n}\r\n\r\nexport class Quaternion\r\n{\r\n    constructor(vector, angle) {\r\n        this.t = 1;\r\n        this.v = new Vector(3);\r\n\r\n        if (vector instanceof Array) {\r\n            this.setAxisAngle(vector || [1, 0, 0], angle || 0);\r\n        }\r\n    }\r\n\r\n    static copy(q) {\r\n        return q.copy();\r\n    }\r\n\r\n    static mul(q1, q2) {\r\n        return q1.copy().mul_(q2);\r\n    }\r\n\r\n    static transfer(fromVector, toVector) {\r\n        const angle = fromVector.angle(toVector);\r\n        if (angle) {\r\n            return new Quaternion(fromVector.cross(toVector), angle);\r\n        } else {\r\n            return new Quaternion();\r\n        }\r\n    }\r\n\r\n    static twoAxis(x, y ,z) {\r\n        let normal1;\r\n        let normal2;\r\n        let quat;\r\n        if (x && y) {\r\n            normal1 = new Vector([0, 0, 1]);\r\n            normal2 = x.cross(y);\r\n        } else if (x && z) {\r\n            normal1 = new Vector([0, 1, 0]);\r\n            normal2 = z.cross(x);\r\n        } else if (y && z) {\r\n            normal1 = new Vector([1, 0, 0]);\r\n            normal2 = y.cross(z);\r\n        }\r\n        quat = Quaternion.transfer(normal1, normal2);\r\n        return x\r\n            ? Quaternion.transfer(quat.rotate_(new Vector([1,0,0])), x).mul_(quat)\r\n            : Quaternion.transfer(quat.rotate_(new Vector([0,1,0])), y).mul_(quat);\r\n    }\r\n\r\n    static slerp(q1, q2, t) {\r\n        if (t == 0) {\r\n            return q1.copy();\r\n        } else if (t == 1) {\r\n            return q2.copy();\r\n        }\r\n\r\n        let res = q2.copy();\r\n        let cosHalfTheta = q1.t * q2.t + q1.v[0] * q2.v[0] + q1.v[1] * q2.v[1] + q1.v[2] * q2.v[2];\r\n\r\n        if (cosHalfTheta < 0) {\r\n            res.t = -q2.t;\r\n            res.v[0] = -q2.v[0];\r\n            res.v[1] = -q2.v[1];\r\n            res.v[2] = -q2.v[2];\r\n            cosHalfTheta = -cosHalfTheta;\r\n        }\r\n\r\n        if (cosHalfTheta >= 1) {\r\n            return q1.copy();\r\n        }\r\n\r\n        let sinHalfTheta = Math.sqrt(1 - cosHalfTheta * cosHalfTheta);\r\n\r\n        if (sinHalfTheta < 0.001) {\r\n            res.t = (q1.t + res.t) / 2;\r\n            res.v[0] = (q1.v[0] + res.v[0]) / 2;\r\n            res.v[1] = (q1.v[1] + res.v[1]) / 2;\r\n            res.v[2] = (q1.v[2] + res.v[2]) / 2;\r\n            return res;\r\n        }\r\n\r\n        const halfTheta = Math.atan2(sinHalfTheta, cosHalfTheta);\r\n        const ratio1 = Math.sin((1 - t) * halfTheta) / sinHalfTheta;\r\n        const ratio2 = Math.sin(t * halfTheta) / sinHalfTheta;\r\n\r\n        res.t = q1.t * ratio1 + res.t * ratio2;\r\n        res.v[0] = q1.v[0] * ratio1 + res.v[0] * ratio2;\r\n        res.v[1] = q1.v[1] * ratio1 + res.v[1] * ratio2;\r\n        res.v[2] = q1.v[2] * ratio1 + res.v[2] * ratio2;\r\n        return res;\r\n    }\r\n\r\n    static invert(quat) {\r\n        return quat.invert();\r\n    }\r\n\r\n    copy() {\r\n        let res = new Quaternion();\r\n        res.t = this.t;\r\n        res.v = this.v.copy();\r\n        return res;\r\n    }\r\n\r\n    quadrance() {\r\n        return this.t * this.t + this.v[0] * this.v[0] + this.v[1] * this.v[1] + this.v[2] * this.v[2];\r\n    }\r\n\r\n    length() {\r\n        return Math.sqrt(this.quadrance());\r\n    }\r\n\r\n    invert_() {\r\n        let quadrance = this.quadrance();\r\n        this.t /= quadrance;\r\n        this.v.div_(-quadrance);\r\n        return this;\r\n    }\r\n\r\n    invert() {\r\n        return this.copy().invert_();\r\n    }\r\n\r\n    normalize_() {\r\n        let len = this.length();\r\n        this.t /= len;\r\n        this.v.div_(len);\r\n        return this;\r\n    }\r\n\r\n    normalize() {\r\n        return this.copy().normalize_();\r\n    }\r\n\r\n    rotate_(vector) {\r\n        let cx = this.v.cross(vector).mul_(2);\r\n        let cx2 = this.v.cross(cx);\r\n        vector[0] += this.t * cx[0] + cx2[0];\r\n        vector[1] += this.t * cx[1] + cx2[1];\r\n        vector[2] += this.t * cx[2] + cx2[2];\r\n        return vector;\r\n    }\r\n\r\n    rotate(vector) {\r\n        return this.rotate_(vector.copy());\r\n    }\r\n\r\n    mul_(quat) {\r\n        const w = this.t;\r\n        const x = this.v[0];\r\n        const y = this.v[1];\r\n        const z = this.v[2];\r\n        const ow = quat.t;\r\n        const ox = quat.v[0];\r\n        const oy = quat.v[1];\r\n        const oz = quat.v[2];\r\n\r\n        this.t = w * ow - x * ox - y * oy - z * oz;\r\n        this.v[0] = w * ox + x * ow + y * oz - z * oy;\r\n        this.v[1] = w * oy - x * oz + y * ow + z * ox;\r\n        this.v[2] = w * oz + x * oy - y * ox + z * ow;\r\n\r\n        return this;\r\n    }\r\n\r\n    mul(quat) {\r\n        return this.copy().mul_(quat);\r\n    }\r\n\r\n    setAxisAngle(axis, angle) {\r\n        this.t = Math.cos(angle / 2);\r\n        this.v.set(axis);\r\n        this.v.mul_(Math.sin(angle / 2) / this.v.mag);\r\n        return this;\r\n    }\r\n\r\n    setFromEuler(x, y, z, order) {\r\n        const c1 = Math.cos(x / 2);\r\n        const c2 = Math.cos(y / 2);\r\n        const c3 = Math.cos(z / 2);\r\n        const s1 = Math.sin(x / 2);\r\n        const s2 = Math.sin(y / 2);\r\n        const s3 = Math.sin(z / 2);\r\n\r\n        order = order || 'ZYX';\r\n\r\n        if (order === 'XYZ') {\r\n            this.v.set([\r\n                s1 * c2 * c3 + c1 * s2 * s3,\r\n                c1 * s2 * c3 - s1 * c2 * s3,\r\n                c1 * c2 * s3 + s1 * s2 * c3\r\n            ]);\r\n            this.t = c1 * c2 * c3 - s1 * s2 * s3;\r\n        } else if (order === 'YXZ') {\r\n            this.v.set([\r\n                s1 * c2 * c3 + c1 * s2 * s3,\r\n                c1 * s2 * c3 - s1 * c2 * s3,\r\n                c1 * c2 * s3 - s1 * s2 * c3\r\n            ]);\r\n            this.t = c1 * c2 * c3 + s1 * s2 * s3;\r\n        } else if (order === 'ZXY') {\r\n            this.v.set([\r\n                s1 * c2 * c3 - c1 * s2 * s3,\r\n                c1 * s2 * c3 + s1 * c2 * s3,\r\n                c1 * c2 * s3 + s1 * s2 * c3\r\n            ]);\r\n            this.t = c1 * c2 * c3 - s1 * s2 * s3;\r\n        } else if (order === 'ZYX') {\r\n            this.v.set([\r\n                s1 * c2 * c3 - c1 * s2 * s3,\r\n                c1 * s2 * c3 + s1 * c2 * s3,\r\n                c1 * c2 * s3 - s1 * s2 * c3\r\n            ]);\r\n            this.t = c1 * c2 * c3 + s1 * s2 * s3;\r\n        } else if (order === 'YZX') {\r\n            this.v.set([\r\n                s1 * c2 * c3 + c1 * s2 * s3,\r\n                c1 * s2 * c3 + s1 * c2 * s3,\r\n                c1 * c2 * s3 - s1 * s2 * c3\r\n            ]);\r\n            this.t = c1 * c2 * c3 - s1 * s2 * s3;\r\n        } else if (order === 'XZY') {\r\n            this.v.set([\r\n                s1 * c2 * c3 - c1 * s2 * s3,\r\n                c1 * s2 * c3 - s1 * c2 * s3,\r\n                c1 * c2 * s3 + s1 * s2 * c3\r\n            ]);\r\n            this.t = c1 * c2 * c3 + s1 * s2 * s3;\r\n        } else if (order === 'ZXZ') {\r\n            this.v.set([\r\n                Math.cos((x - z) / 2) * s2,\r\n                Math.sin((x - z) / 2) * s2,\r\n                Math.sin((x + z) / 2) * c2\r\n            ]);\r\n            this.t = Math.cos((x + z) / 2) * c2\r\n        }\r\n        return this;\r\n    }\r\n\r\n    toThreejs() {\r\n        return new THREE.Quaternion(this.v[0], this.v[1], this.v[2], this.t);\r\n    }\r\n}\r\n\r\nexport const TWO_PI = 2 * Math.PI;\r\n\r\nexport function newtonSolve(func, start, d, maxError, maxSteps) {\r\n    let step = 0;\r\n    let val = start;\r\n    let error;\r\n\r\n    do {\r\n        const v1 = func(val);\r\n        const v2 = func(val + d);\r\n        const diff = (v2 - v1) / d;\r\n\r\n        if (v1 === null || v2 === null) {\r\n            return null;\r\n        }\r\n\r\n        error = Math.abs(v1);\r\n        val -= v1 / diff;\r\n        step += 1;\r\n    } while (error > maxError && step < maxSteps);\r\n\r\n    return (error > maxError) ? null : val;\r\n}\r\n\r\nexport function deg2rad(degrees) {\r\n    return degrees / 180 * Math.PI;\r\n}\r\n\r\nexport function rad2deg(radians) {\r\n    return radians * 180 / Math.PI;\r\n}\r\n\r\nexport function getAngleBySinCos(sin, cos) {\r\n    const ang = Math.acos(cos);\r\n    return (sin > 0)\r\n        ? ang\r\n        : (TWO_PI - ang);\r\n}\r\n\r\nexport function angleIntervalIntersection(int1, int2) {\r\n    if (!int1 || !int2) {\r\n        return false;\r\n    } else if (int1[0] <= int2[0] && int2[1] <= int1[1]) {\r\n        return int2;\r\n    } else if (int2[0] <= int1[0] && int1[1] <= int2[1]) {\r\n        return int1;\r\n    } else if (int1[0] <= int2[0] && int2[0] <= int1[1]) {\r\n        return [int2[0], int1[1]];\r\n    } else if (int1[0] <= int2[1] && int2[1] <= int1[1]) {\r\n        return [int1[0], int2[1]];\r\n    }\r\n    return false;\r\n}\r\n\r\nexport function getAngleIntervalsIntersection(intervals1, intervals2) {\r\n    let result = [];\r\n    if (intervals1 === false || intervals2 === false) {\r\n        return false;\r\n    }\r\n    if (intervals1 === true) {\r\n        return intervals2;\r\n    }\r\n    if (intervals2 === true) {\r\n        return intervals1;\r\n    }\r\n    for (let interval1 of intervals1) {\r\n        const int11 = [interval1[0], interval1[1] > interval1[0] ? interval1[1] : TWO_PI];\r\n        const int12 = interval1[1] > interval1[0] ? false : [0, interval1[1]];\r\n        for (let interval2 of intervals2) {\r\n            const int21 = [interval2[0], interval2[1] > interval2[0] ? interval2[1] : TWO_PI];\r\n            const int22 = interval2[1] > interval2[0] ? false : [0, interval2[1]];\r\n            let r;\r\n            if (r = angleIntervalIntersection(int11, int21))\r\n                result.push(r);\r\n            if (r = angleIntervalIntersection(int11, int22))\r\n                result.push(r);\r\n            if (r = angleIntervalIntersection(int12, int21))\r\n                result.push(r);\r\n            if (r = angleIntervalIntersection(int12, int22))\r\n                result.push(r);\r\n        }\r\n    }\r\n    return result.length ? result : false;\r\n}\r\n\r\nexport function isInInterval(angle, interval) {\r\n    angle = (angle + TWO_PI) % TWO_PI;\r\n    if (interval[0] <= interval[1]) {\r\n        return (interval[0] <= angle) && (angle <= interval[1]);\r\n    } else {\r\n        return (interval[0] <= angle) || (angle <= interval[1]);\r\n    }\r\n}\r\n\r\nexport function getEpochIntervalsIntersection(intervals1, intervals2) {\r\n    let result = [];\r\n    if (intervals1 === false || intervals2 === false) {\r\n        return false;\r\n    }\r\n    if (intervals1 === true) {\r\n        return intervals2;\r\n    }\r\n    if (intervals2 === true) {\r\n        return intervals1;\r\n    }\r\n    for (let interval1 of intervals1) {\r\n        const epoch1 = interval1[0];\r\n        const epoch2 = interval1[1];\r\n        for (let interval2 of intervals2) {\r\n            const epoch21 = interval2[0];\r\n            const epoch22 = interval2[1];\r\n            if (epoch1 <= epoch21 && epoch21 < epoch2) {\r\n                result.push([\r\n                    epoch21,\r\n                    epoch2 < epoch22 ? epoch2 : epoch22\r\n                ]);\r\n            } else if (epoch1 < epoch22 && epoch22 <= epoch2) {\r\n                result.push([\r\n                    epoch1,\r\n                    epoch22,\r\n                ]);\r\n            } else if (epoch1 < epoch21 && epoch22 < epoch2) {\r\n                result.push([\r\n                    epoch21,\r\n                    epoch22,\r\n                ]);\r\n            } else if (epoch21 < epoch1 && epoch2 < epoch22) {\r\n                result.push([\r\n                    epoch1,\r\n                    epoch2,\r\n                ]);\r\n            }\r\n        }\r\n    }\r\n    return result.length ? result : false;\r\n}\r\n\r\nexport function approximateAngle(ang1, ang2, proportion) {\r\n    ang1 = ((ang1 % TWO_PI) + TWO_PI) % TWO_PI;\r\n    ang2 = ((ang2 % TWO_PI) + TWO_PI) % TWO_PI;\r\n\r\n    let diff = ang2 - ang1;\r\n\r\n    if (Math.abs(diff) > Math.PI) {\r\n        diff = (diff > 0)\r\n            ? (diff - TWO_PI)\r\n            : (diff + TWO_PI);\r\n    }\r\n\r\n    return ((ang1 + diff * proportion) + TWO_PI) % TWO_PI;\r\n}\r\n\r\nexport function approximateNumber(n1, n2, proportion) {\r\n    return n1 + (n2 - n1) * proportion;\r\n}\r\n\r\nexport function presentNumberWithSuffix(number) {\r\n    if (Math.abs(number) >= 1000000000) {\r\n        return (number / 1000000000).toFixed(3) + ' G';\r\n    }\r\n    if (Math.abs(number) >= 1000000) {\r\n        return (number / 1000000).toFixed(3) + ' M';\r\n    }\r\n    if (Math.abs(number) >= 1000) {\r\n        return (number / 1000).toFixed(3) + ' K';\r\n    }\r\n    if (Math.abs(number) <= 0.000000001) {\r\n        return (number / 0.000000001).toFixed(3) + ' n';\r\n    }\r\n    if (Math.abs(number) <= 0.000001) {\r\n        return (number / 0.000001).toFixed(3) + ' µ';\r\n    }\r\n    if (Math.abs(number) <= 0.001) {\r\n        return (number / 0.001).toFixed(3) + ' m';\r\n    }\r\n    return number.toPrecision(6) + ' ';\r\n}\r\n","export default class EventHandler\r\n{\r\n    constructor(domElement) {\r\n        this.domElement = domElement;\r\n        this.listeners = {};\r\n        this.handlers = {};\r\n    }\r\n\r\n    addListener(eventName, listener, priority) {\r\n        if (!this.handlers[eventName]) {\r\n            this.listeners[eventName] = [];\r\n            this.handlers[eventName] = (event) => this.handleEvent(eventName, event);\r\n            this.domElement.addEventListener(eventName, this.handlers[eventName]);\r\n        }\r\n\r\n        this.listeners[eventName].push({\r\n            handler: listener,\r\n            priority: priority\r\n        });\r\n    }\r\n\r\n    removeListener(eventName, listener) {\r\n        const list = this.listeners[eventName];\r\n        for (let idx = 0; idx < list.length; idx++) {\r\n            if (list[idx].handler === listener) {\r\n                list.splice(idx, 1);\r\n                break;\r\n            }\r\n        }\r\n\r\n        if (list.length === 0) {\r\n            this.domElement.removeEventListener(eventName, this.handlers[eventName]);\r\n            delete this.handlers[eventName];\r\n            delete this.listeners[eventName];\r\n        }\r\n    }\r\n\r\n    handleEvent(eventName, eventObject) {\r\n        const list = this.listeners[eventName];\r\n\r\n        if (!list) {\r\n            return;\r\n        }\r\n\r\n        const highestPriority = list.reduce((val, a) => Math.max(val, a.priority), list[0].priority);\r\n\r\n        for (const listener of list) {\r\n            if (listener.priority === highestPriority) {\r\n                listener.handler(eventObject);\r\n            }\r\n        }\r\n    }\r\n}\r\n","import Events from \"../core/Events\";\r\n\r\nexport const J2000_TIMESTAMP = 946728000;\r\n\r\nexport default class TimeLine\r\n{\r\n    constructor(epoch, timeScale, isTimeRunning) {\r\n        this.epoch = epoch;\r\n        this.timeScale = timeScale;\r\n        this.isTimeRunning = isTimeRunning;\r\n\r\n        this.mouseState = {\r\n            x: 0,\r\n            y: 0,\r\n            leftButton: false,\r\n            rightButton: false\r\n        };\r\n\r\n        this.timeLineCanvasDomElement = document.getElementById(\"timeLineCanvas\");\r\n        this.canvasContext = this.timeLineCanvasDomElement.getContext(\"2d\");\r\n        this.canvasRect = {};\r\n        this.updateCanvasStyle();\r\n        this.initValues();\r\n\r\n        this.timeLineCanvasDomElement.addEventListener(\"mousedown\",  this.onMouseDown  .bind(this));\r\n        window                       .addEventListener(\"mouseup\",    this.onMouseUp    .bind(this));\r\n        window                       .addEventListener(\"mousemove\",  this.onMouseMove  .bind(this));\r\n        this.timeLineCanvasDomElement.addEventListener(\"mousewheel\", this.onMouseWheel .bind(this));\r\n\r\n        window.addEventListener('keypress', e => {\r\n            if (e.key === ' ') {\r\n                this.togglePause();\r\n            }\r\n        });\r\n\r\n        window.addEventListener(\"resize\", this.updateCanvasStyle.bind(this));\r\n        window.oncontextmenu = () => false;\r\n    }\r\n\r\n    initValues() {\r\n        this.scales = {\r\n            minute: 60,\r\n            fiveMinutes: 300,\r\n            tenMinutes: 600,\r\n            thirtyMinutes: 1800,\r\n            hour: 3600,\r\n            threeHours: 10800,\r\n            sixHours: 21600,\r\n            day: 86400,\r\n            week: 604800,\r\n            month: 2592000,\r\n            threeMonths: 7776000,\r\n            year: 31557600,\r\n            fiveYears: 157788000,\r\n        };\r\n\r\n        this.span = this.timeScale * 86400 * 5;\r\n        this.markDistance = 300;\r\n        this.scaleType = \"month\";\r\n        this.leftEpoch = this.epoch - this.span / 2;\r\n\r\n        this.updateScaleType();\r\n\r\n        this.getDateByEpoch = TimeLine.getDateByEpoch;\r\n        this.getEpochByDate = TimeLine.getEpochByDate;\r\n\r\n        this.roundDateUp = TimeLine.roundDateUp;\r\n        this.nextRenderingDate = TimeLine.nextRenderingDate;\r\n        this.formatDate = TimeLine.formatDate;\r\n        this.formatDateFull = TimeLine.formatDateFull;\r\n    }\r\n\r\n    setTimeScale(newScale) {\r\n        Events.dispatch(Events.TIME_SCALE_CHANGED, {old: this.timeScale, new: newScale});\r\n        this.timeScale = newScale;\r\n    }\r\n\r\n    togglePause() {\r\n        this.isTimeRunning = !this.isTimeRunning;\r\n        Events.dispatch(this.isTimeRunning ? Events.TIME_UNPAUSED : Events.TIME_PAUSED);\r\n    }\r\n\r\n    tick(timePassed) {\r\n        if (this.mouseState.leftButton) {\r\n            this.epoch = this.leftEpoch + (this.mouseState.x\r\n                - this.canvasRect.left) * this.span / this.timeLineCanvasDomElement.width;\r\n        } else if (this.isTimeRunning) {\r\n            if ((this.leftEpoch < this.epoch)\r\n                && (this.epoch < this.leftEpoch + this.span)\r\n            ) {\r\n                this.leftEpoch += this.timeScale * timePassed;\r\n            }\r\n\r\n            this.epoch += this.timeScale * timePassed;\r\n        }\r\n\r\n        Events.dispatch(Events.EPOCH_CHANGED, {\r\n            epoch: this.epoch,\r\n            date: this.getDateByEpoch(this.epoch)\r\n        });\r\n\r\n        this.redraw();\r\n    }\r\n\r\n    forceEpoch(newEpoch) {\r\n        this.leftEpoch += newEpoch - this.epoch;\r\n        this.epoch = newEpoch;\r\n        this.tick(0);\r\n    }\r\n\r\n    useCurrentTime() {\r\n        this.forceEpoch(this.getEpochByDate(new Date()));\r\n    }\r\n\r\n    redraw() {\r\n        this.canvasContext.fillStyle = \"#222\";\r\n        this.canvasContext.fillRect(0, 0, this.timeLineCanvasDomElement.width, this.timeLineCanvasDomElement.height);\r\n\r\n        this.canvasContext.fillStyle = this.isTimeRunning ? \"#2846ed\" : \"#393b40\";\r\n        this.drawCurrentTimeMark();\r\n\r\n        this.canvasContext.strokeStyle = \"#fdfdfd\";\r\n        this.canvasContext.fillStyle   = \"#fdfdfd\";\r\n        this.canvasContext.font        = \"11px sans-serif\";\r\n\r\n        let markDate = this.roundDateUp(this.getDateByEpoch(this.leftEpoch), this.scaleType);\r\n        let markEpoch = this.getEpochByDate(markDate);\r\n\r\n        while (markEpoch < this.leftEpoch + this.span) {\r\n            this.drawMark(this.getCanvasPositionByEpoch(markEpoch), this.formatDate(markDate, this.scaleType));\r\n            markDate = this.nextRenderingDate(markDate, this.scaleType);\r\n            markEpoch = this.getEpochByDate(markDate);\r\n        }\r\n    }\r\n\r\n    getCanvasPositionByEpoch(epoch) {\r\n        return (epoch - this.leftEpoch) * this.timeLineCanvasDomElement.width / this.span;\r\n    }\r\n\r\n    updateCanvasStyle() {\r\n        this.canvasRect = this.timeLineCanvasDomElement.getBoundingClientRect();\r\n        this.timeLineCanvasDomElement.width  = this.canvasRect.right  - this.canvasRect.left;\r\n        this.timeLineCanvasDomElement.height = this.canvasRect.bottom - this.canvasRect.top;\r\n    }\r\n\r\n    updateScaleType() {\r\n        const secondsPerPeriod = this.markDistance * this.span / this.timeLineCanvasDomElement.width;\r\n        let bestScale = false;\r\n\r\n        for (const scale in this.scales) {\r\n            if (!bestScale) {\r\n                bestScale = scale;\r\n                continue;\r\n            }\r\n\r\n            if (Math.abs(this.scales[bestScale] / secondsPerPeriod - 1)\r\n                > Math.abs(this.scales[scale] / secondsPerPeriod - 1)\r\n            ) {\r\n                bestScale = scale;\r\n            }\r\n        }\r\n\r\n        this.scaleType = bestScale;\r\n    }\r\n\r\n    drawMark(x, text) {\r\n        this.canvasContext.beginPath();\r\n        this.canvasContext.moveTo(x, 0);\r\n        this.canvasContext.lineTo(x, this.timeLineCanvasDomElement.height / 2);\r\n        this.canvasContext.stroke();\r\n        this.canvasContext.fillText(\r\n            text,\r\n            x - this.canvasContext.measureText(text).width / 2,\r\n            this.timeLineCanvasDomElement.height - 2\r\n        );\r\n    }\r\n\r\n    drawCurrentTimeMark() {\r\n        this.canvasContext.fillRect(0, 0, this.getCanvasPositionByEpoch(this.epoch), this.timeLineCanvasDomElement.height);\r\n    }\r\n\r\n    onMouseDown(e) {\r\n        if (e.button === 0) {\r\n            this.mouseState.leftButton = true;\r\n        } else if (e.button === 2) {\r\n            this.mouseState.rightButton = true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    onMouseUp(e) {\r\n        if (e.button === 0) {\r\n            this.mouseState.leftButton = false;\r\n        } else if (e.button === 2) {\r\n            this.mouseState.rightButton = false;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    onMouseMove(e) {\r\n        if (this.mouseState.rightButton) {\r\n            this.leftEpoch += (this.mouseState.x - e.x) * this.span / this.timeLineCanvasDomElement.width;\r\n        }\r\n\r\n        this.mouseState.x = e.x;\r\n        this.mouseState.y = e.y;\r\n        return false;\r\n    }\r\n\r\n    getMinScale() {\r\n        return Object.keys(this.scales).reduce((a, b) => { return this.scales[a] < this.scales[b] ? a : b });\r\n    }\r\n\r\n    getMaxScale() {\r\n        return Object.keys(this.scales).reduce((a, b) => { return this.scales[a] > this.scales[b] ? a : b });\r\n    }\r\n\r\n    onMouseWheel(e) {\r\n        const stepMult = 1.3;\r\n        const mult = (e.deltaY > 0) ? stepMult : (1 / stepMult);\r\n        const newSpan = Math.min(Math.max(this.span * mult,\r\n            (this.canvasRect.right - this.canvasRect.left) / this.markDistance * this.scales[this.getMinScale()]),\r\n            (this.canvasRect.right - this.canvasRect.left) / this.markDistance * this.scales[this.getMaxScale()]);\r\n        this.leftEpoch += (this.mouseState.x - this.canvasRect.left)\r\n            * (this.span - newSpan) / (this.canvasRect.right - this.canvasRect.left);\r\n        this.span = newSpan;\r\n\r\n        this.updateScaleType();\r\n        return false;\r\n    }\r\n\r\n    static getDateByEpoch(epoch) {\r\n        return new Date((J2000_TIMESTAMP + epoch) * 1000);\r\n    }\r\n\r\n    static getEpochByDate(date) {\r\n        return date / 1000 - J2000_TIMESTAMP;\r\n    }\r\n\r\n    static roundDateUp(date, scaleType) {\r\n        const d = new Date(date);\r\n        if (scaleType === \"minute\") {\r\n            d.setSeconds(60, 0);\r\n        } else if (scaleType === \"fiveMinutes\") {\r\n            d.setMinutes(5 + d.getMinutes() - d.getMinutes() % 5, 0, 0);\r\n        } else if (scaleType === \"tenMinutes\") {\r\n            d.setMinutes(10 + d.getMinutes() - d.getMinutes() % 10, 0, 0);\r\n        } else if (scaleType === \"thirtyMinutes\") {\r\n            d.setMinutes(30 + d.getMinutes() - d.getMinutes() % 30, 0, 0);\r\n        } else if (scaleType === \"hour\") {\r\n            d.setMinutes(60, 0, 0);\r\n        } else if (scaleType === \"threeHours\") {\r\n            d.setHours(3 + d.getHours() - d.getHours() % 3, 0, 0, 0);\r\n        } else if (scaleType === \"sixHours\") {\r\n            d.setHours(6 + d.getHours() - d.getHours() % 6, 0, 0, 0);\r\n        } else if (scaleType === \"day\") {\r\n            d.setHours(24, 0, 0, 0);\r\n        } else if (scaleType === \"week\") {\r\n            d.setHours(0, 0, 0, 0);\r\n            d.setDate(7 + d.getDate() - d.getDay());\r\n        } else if (scaleType === \"month\") {\r\n            d.setHours(0, 0, 0, 0);\r\n            d.setDate(1);\r\n            d.setMonth(d.getMonth() + 1);\r\n        } else if (scaleType === \"threeMonths\") {\r\n            d.setHours(0, 0, 0, 0);\r\n            d.setDate(1);\r\n            d.setMonth(3 + d.getMonth() - d.getMonth() % 3);\r\n        } else if (scaleType === \"year\") {\r\n            d.setHours(0, 0, 0, 0);\r\n            d.setMonth(0, 1);\r\n        } else if (scaleType === \"fiveYears\") {\r\n            d.setHours(0, 0, 0, 0);\r\n            d.setFullYear(5 + d.getFullYear() - d.getFullYear() % 5, 0, 1);\r\n        } else {\r\n            return;\r\n        }\r\n        return d;\r\n    }\r\n\r\n    static nextRenderingDate(date, scaleType) {\r\n        const d = new Date(date);\r\n        if (scaleType === \"minute\") {\r\n            d.setMinutes(d.getMinutes() + 1);\r\n        } else if (scaleType === \"fiveMinutes\") {\r\n            d.setMinutes(d.getMinutes() + 5);\r\n        } else if (scaleType === \"tenMinutes\") {\r\n            d.setMinutes(d.getMinutes() + 10);\r\n        } else if (scaleType === \"thirtyMinutes\") {\r\n            d.setMinutes(d.getMinutes() + 30);\r\n        } else if (scaleType === \"hour\") {\r\n            d.setHours(d.getHours() + 1);\r\n        } else if (scaleType === \"threeHours\") {\r\n            d.setHours(d.getHours() + 3);\r\n        } else if (scaleType === \"sixHours\") {\r\n            d.setHours(d.getHours() + 6);\r\n        } else if (scaleType === \"day\") {\r\n            d.setDate(d.getDate() + 1);\r\n        } else if (scaleType === \"week\") {\r\n            d.setDate(d.getDate() + 7);\r\n        } else if (scaleType === \"month\") {\r\n            d.setMonth(d.getMonth() + 1);\r\n        } else if (scaleType === \"threeMonths\") {\r\n            d.setMonth(d.getMonth() + 3);\r\n        } else if (scaleType === \"year\") {\r\n            d.setFullYear(d.getFullYear() + 1, d.getMonth(), d.getDate());\r\n        } else if (scaleType === \"fiveYears\") {\r\n            d.setFullYear(d.getFullYear() + 5, d.getMonth(), d.getDate());\r\n        } else {\r\n            return;\r\n        }\r\n        return d;\r\n    }\r\n\r\n    static formatDate(date, scaleType) {\r\n        if ((scaleType === \"minute\")\r\n            || (scaleType === \"fiveMinutes\")\r\n            || (scaleType === \"tenMinutes\")\r\n            || (scaleType === \"thirtyMinutes\")\r\n            || (scaleType === \"hour\")\r\n            || (scaleType === \"threeHours\")\r\n            || (scaleType === \"sixHours\")\r\n        ) {\r\n            let string = date.getYear() + 1900;\r\n            string += '-' + ((date.getMonth() + 1) + '').padStart(2, '0');\r\n            string += '-' + (date.getDate() + '').padStart(2, '0');\r\n            string += ' ' + (date.getHours() + '').padStart(2, '0');\r\n            string += ':' + (date.getMinutes() + '').padStart(2, '0');\r\n            return string;\r\n        } else if ((scaleType === \"day\")\r\n            || (scaleType === \"week\")\r\n        ) {\r\n            let string = date.getYear() + 1900;\r\n            string += '-' + ((date.getMonth() + 1) + '').padStart(2, '0');\r\n            string += '-' + (date.getDate() + '').padStart(2, '0');\r\n            return string;\r\n        } else if ((scaleType === \"month\")\r\n            || (scaleType === \"threeMonths\")\r\n        ) {\r\n            const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\r\n            return months[date.getMonth()] + ' ' + (date.getYear() + 1900);\r\n        } else if ((scaleType === \"year\")\r\n            || (scaleType === \"fiveYears\")\r\n        ) {\r\n            return (date.getYear() + 1900) + '';\r\n        }\r\n        return date.toString();\r\n    }\r\n\r\n    static formatDateFull(date) {\r\n        let string = date.getYear() + 1900;\r\n        string += '-' + ((date.getMonth() + 1) + '').padStart(2, '0');\r\n        string += '-' + (date.getDate() + '').padStart(2, '0');\r\n        string += ' ' + (date.getHours() + '').padStart(2, '0');\r\n        string += ':' + (date.getMinutes() + '').padStart(2, '0');\r\n        string += ':' + (date.getSeconds() + '').padStart(2, '0');\r\n        return string;\r\n    }\r\n}\r\n","import * as THREE from \"three\";\r\n\r\nimport {deg2rad} from \"../algebra\";\r\nimport { sim } from \"../Simulation\";\r\n\r\nexport default class VisualRaycaster\r\n{\r\n    constructor(domElement, threeCamera, pixelPrecision) {\r\n        this.raycaster = new THREE.Raycaster();\r\n        this.mouse = new THREE.Vector2();\r\n        this.camera = threeCamera;\r\n        this.domElement = domElement;\r\n\r\n        this.setPixelPrecision(pixelPrecision);\r\n        this.updatePixelAngleSize();\r\n\r\n        this.domElement.addEventListener('mousemove', this.onMouseMove.bind(this));\r\n        this.domElement.addEventListener('resize', this.updatePixelAngleSize.bind(this));\r\n    }\r\n\r\n    onMouseMove(event) {\r\n        this.mouse.x = (event.clientX / this.domElement.width) * 2 - 1;\r\n        this.mouse.y = -(event.clientY / this.domElement.height) * 2 + 1;\r\n    }\r\n\r\n    setPixelPrecision(value) {\r\n        this.raycaster.pixelPrecision = value;\r\n    }\r\n\r\n    updatePixelAngleSize() {\r\n        this.raycaster.pixelAngleSize = deg2rad(this.camera.fov) / this.domElement.height;\r\n    }\r\n\r\n    getPixelAngleSize() {\r\n        return this.raycaster.pixelAngleSize;\r\n    }\r\n\r\n    intersectObjects(threeObjects) {\r\n        this.raycaster.setFromCamera(this.mouse, this.camera);\r\n        return this.raycaster.intersectObjects(threeObjects);\r\n    }\r\n\r\n    getPixelDistance(point) {\r\n        this.raycaster.setFromCamera(this.mouse, this.camera);\r\n\r\n        const pointDirection = (new THREE.Vector3()).subVectors(\r\n            point,\r\n            sim.camera.lastPosition\r\n        );\r\n\r\n        const angle = Math.acos(\r\n            this.raycaster.ray.direction.dot(pointDirection) / pointDirection.length()\r\n        );\r\n\r\n        return angle / this.raycaster.pixelAngleSize;\r\n    }\r\n}\r\n","import * as THREE from \"three\";\r\n\r\nimport VisualModelAbstract from \"../core/visual/ModelAbstract\";\r\nimport { sim, Events } from \"../core/index\";\r\n\r\nexport default class SelectionHandler extends VisualModelAbstract\r\n{\r\n    constructor() {\r\n        super();\r\n\r\n        this.selectableObjects = [];\r\n\r\n        this.selectedObject = null;\r\n        this.bestIntersection = null;\r\n\r\n        this.selectionMouseButton = 0;\r\n        this.pointSize = 5;\r\n\r\n        this.setThreeObj(new THREE.Mesh(\r\n            new THREE.SphereGeometry(1, 10, 10),\r\n            new THREE.MeshBasicMaterial({color: 0xFFFF00})\r\n        ));\r\n\r\n        sim.addEventListener('click', this.onMouseClick.bind(this), 1);\r\n        sim.addEventListener('mousedown', this.onMouseDown.bind(this), 1);\r\n\r\n        this.mouseMoveListener = this.onMouseMove.bind(this);\r\n    }\r\n\r\n    addSelectableObject(object) {\r\n        this.selectableObjects.push(object);\r\n    }\r\n\r\n    removeSelectableObject(object) {\r\n        for (let i in this.selectableObjects) {\r\n            if (this.selectableObjects[i] === object) {\r\n                delete this.selectableObjects[i];\r\n                break;\r\n            }\r\n        }\r\n        this.selectableObjects = this.selectableObjects.filter(val => val);\r\n    }\r\n\r\n    render() {\r\n        const intersections = sim.raycaster.intersectObjects(this.selectableObjects);\r\n\r\n        if (intersections.length > 0) {\r\n            this.bestIntersection = intersections[0];\r\n\r\n            for(var i = 1; i < intersections.length; i++) {\r\n                if (intersections[i].distance < this.bestIntersection.distance) {\r\n                    this.bestIntersection = intersections[i];\r\n                }\r\n            }\r\n\r\n            this.threeObj.visible = true;\r\n            this.threeObj.position.copy(this.bestIntersection.point);\r\n\r\n            const scaleKoeff = this.pointSize * this.bestIntersection.point.length() * sim.raycaster.getPixelAngleSize();\r\n\r\n            this.threeObj.scale.x = scaleKoeff;\r\n            this.threeObj.scale.y = scaleKoeff;\r\n            this.threeObj.scale.z = scaleKoeff;\r\n        }\r\n        else {\r\n            this.threeObj.visible = false;\r\n            this.bestIntersection = null;\r\n        }\r\n    }\r\n\r\n    onMouseDown(event) {\r\n        if (event.button === this.selectionMouseButton) {\r\n            document.addEventListener('mousemove', this.mouseMoveListener);\r\n            this.hasMouseMoved = false;\r\n            this.mouseClickStart = [event.clientX, event.clientY];\r\n        }\r\n    }\r\n\r\n    onMouseMove(event) {\r\n        if (this.mouseClickStart[0] !== event.clientX || this.mouseClickStart[1] !== event.clientY) {\r\n            this.hasMouseMoved = true;\r\n        }\r\n    }\r\n\r\n    onMouseClick(event) {\r\n        const wasSelected = this.selectedObject;\r\n\r\n        if (event.button !== this.selectionMouseButton) {\r\n            return;\r\n        }\r\n\r\n        document.removeEventListener('mousemove', this.mouseMoveListener);\r\n\r\n        if (this.hasMouseMoved) {\r\n            return;\r\n        }\r\n\r\n        this.deselect();\r\n\r\n        if (this.bestIntersection) {\r\n            let currentTraj = this.bestIntersection.object.userData.trajectory;\r\n            while (currentTraj.parent) {\r\n                currentTraj = currentTraj.parent;\r\n            }\r\n            if (currentTraj !== wasSelected) {\r\n                this.select(currentTraj);\r\n            }\r\n        }\r\n    }\r\n\r\n    forceSelection(object) {\r\n        this.deselect();\r\n        this.select(object);\r\n    }\r\n\r\n    getSelectedObject() {\r\n        return this.selectedObject;\r\n    }\r\n\r\n    select(object) {\r\n        this.selectedObject = object;\r\n        this.selectedObject.select();\r\n\r\n        Events.dispatch(Events.SELECT, {trajectory: this.selectedObject});\r\n    }\r\n\r\n    deselect() {\r\n        if (!this.selectedObject) {\r\n            return;\r\n        }\r\n\r\n        Events.dispatch(Events.DESELECT, {trajectory: this.selectedObject});\r\n\r\n        this.selectedObject.deselect();\r\n        this.selectedObject = null;\r\n    }\r\n}\r\n","import $ from \"jquery\";\r\n\r\nexport default class UIPanel\r\n{\r\n    constructor(panelDom, isCollapsed) {\r\n        this.jqDom = $(panelDom);\r\n        this.name = this.jqDom.data('panelName');\r\n        this.jqCollapseButton = this.jqDom.find(\".collapseButton[data-panel-name='\" + this.name + \"']\");\r\n        this.jqCollapseButton.click(() => this.toggleCollapse());\r\n        this.isCollapsed = !!isCollapsed;\r\n\r\n        this.isCollapsed ? this.collapse() : this.expand();\r\n    }\r\n\r\n    show() {\r\n        this.jqDom.show();\r\n    }\r\n\r\n    hide() {\r\n        this.jqDom.hide();\r\n    }\r\n\r\n    toggleCollapse() {\r\n        this.isCollapsed ? this.expand() : this.collapse();\r\n    }\r\n\r\n    collapse() {\r\n        this.jqCollapseButton.html('Show');\r\n        this.isCollapsed = true;\r\n        this.jqDom.find(\".panelContent[data-panel-name='\" + this.name + \"']\").hide();\r\n\r\n        // this.jqCollapseButton.attr('disabled', 'true');\r\n        // this.jqDom.find(\".panelContent[data-panel-name='\" + this.name + \"']\").fadeToggle(200, 'swing', () => {\r\n        //     this.jqCollapseButton.removeAttr('disabled');\r\n        // });\r\n    }\r\n\r\n    expand() {\r\n        this.jqCollapseButton.html('Hide');\r\n        this.isCollapsed = false;\r\n        this.jqDom.find(\".panelContent[data-panel-name='\" + this.name + \"']\").show();\r\n\r\n        // this.jqCollapseButton.attr('disabled', 'true');\r\n        // this.jqDom.find(\".panelContent[data-panel-name='\" + this.name + \"']\").fadeToggle(200, 'swing', () => {\r\n        //     this.jqCollapseButton.removeAttr('disabled');\r\n        // });\r\n    }\r\n}\r\n","import Events from \"../../core/Events\";\r\nimport UIPanel from \"../Panel\";\r\nimport { sim } from \"../../core/Simulation\"\r\n\r\nexport default class UIPanelTime extends UIPanel\r\n{\r\n    constructor(panelDom) {\r\n        super(panelDom);\r\n\r\n        this.maxTimeScale = 6 * 30 * 86400;\r\n\r\n        this.jqSlider = this.jqDom.find('#timeScaleSlider');\r\n        this.jqSlider.on('input change', () => sim.time.setTimeScale(this.getCurrentTimeScale()));\r\n        this.jqSlider.val(this.getNeededSliderValue(sim.time.timeScale));\r\n\r\n        this.jqScaleText = this.jqDom.find('#timeScaleValue');\r\n        this.jqScaleText.html(this.formatTimeScale(sim.time.timeScale));\r\n\r\n        document.addEventListener(Events.TIME_SCALE_CHANGED, (event) => {\r\n            this.jqSlider.val(this.getNeededSliderValue(event.detail.new));\r\n            this.jqScaleText.html(this.formatTimeScale(event.detail.new));\r\n        });\r\n\r\n        this.jqDateText = this.jqDom.find('#currentDateValue');\r\n        document.addEventListener(Events.EPOCH_CHANGED, (event) => this.updateTime(event.detail.date));\r\n\r\n        this.jqDom.find('#setRealTimeScale').click(() => sim.time.setTimeScale(1));\r\n        this.jqDom.find('#useCurrentTime').click(() => sim.time.useCurrentTime());\r\n    }\r\n\r\n    updateTime(date) {\r\n        this.jqDateText.html(sim.time.formatDateFull(date));\r\n    }\r\n\r\n    /**\r\n     * @returns {number} — simulation seconds per 1 real life second\r\n     */\r\n    getCurrentTimeScale() {\r\n        const val = this.jqSlider.val();\r\n        return Math.sign(val) * val * val * val * val * this.maxTimeScale;\r\n    }\r\n\r\n    getNeededSliderValue(timeScale) {\r\n        const val = Math.sqrt(Math.sqrt(Math.abs(timeScale) / this.maxTimeScale));\r\n        return Math.sign(timeScale) * Math.min(1, val);\r\n    }\r\n\r\n    formatTimeScale(scale) {\r\n        const precision = 2;\r\n\r\n        const prefix = (scale < 0) ? '-' : '';\r\n        const abs = Math.abs(scale);\r\n        if (abs === 0) {\r\n            return '0';\r\n        }\r\n\r\n        if (abs < 60) {\r\n            return prefix + abs.toPrecision(precision) + ' s/s';\r\n        }\r\n\r\n        if (abs < 3600) {\r\n            return prefix + (abs / 60).toPrecision(precision) + ' min/s';\r\n        }\r\n\r\n        if (abs < 86400) {\r\n            return prefix + (abs / 3600).toPrecision(precision) + ' h/s';\r\n        }\r\n\r\n        if (abs < 2592000) {\r\n            return prefix + (abs / 86400).toPrecision(precision) + ' days/s';\r\n        }\r\n\r\n        if (abs < 31557600) {\r\n            return prefix + (abs / 2592000).toPrecision(precision) + ' months/s';\r\n        }\r\n\r\n        return prefix + (abs / 31557600).toPrecision(precision) + ' years/s';\r\n    }\r\n}\r\n","import $ from \"jquery\";\r\n\r\nimport Events from \"../../core/Events\";\r\nimport UIPanel from \"../Panel\";\r\nimport {ReferenceFrame} from \"../../core/ReferenceFrame/Factory\";\r\n\r\nexport default class UIPanelCamera extends UIPanel\r\n{\r\n    constructor(panelDom, camera) {\r\n        super(panelDom);\r\n\r\n        this.camera = camera;\r\n\r\n        this.jqTarget = this.jqDom.find('#targetSelect');\r\n        this.jqTarget.on('change', () => this.camera.changeOrigin(0|this.jqTarget.val()));\r\n\r\n        this.jqFrameType = this.jqDom.find('#rfTypeSelect');\r\n        this.jqFrameType.on('change', () => this.camera.changeReferenceFrameType(0|this.jqFrameType.val()));\r\n\r\n        Events.addListener(Events.STAR_SYSTEM_LOADED, (event) => {\r\n            this.starSystem = event.detail.starSystem;\r\n\r\n            this.jqTarget.html('');\r\n            this.updateTargetList();\r\n            this.updateTarget(this.camera.orbitingPoint);\r\n\r\n            this.updateFrameTypeList();\r\n            this.updateFrameType(this.camera.frameType);\r\n        });\r\n        Events.addListener(Events.CAMERA_RF_CHANGED, (event) => {\r\n            this.updateTarget(event.detail.new.originId);\r\n            this.updateFrameTypeList();\r\n            this.updateFrameType(event.detail.new.type);\r\n        });\r\n        Events.addListener(Events.OBJECT_ADDED, () => {\r\n            this.updateTargetList();\r\n        });\r\n    }\r\n\r\n    updateTargetList() {\r\n        if (!this.starSystem) {\r\n            return;\r\n        }\r\n        $.each(this.starSystem.getObjectNames(), (objId, objName) => {\r\n            if (this.jqTarget.find(\"option[value='\" + objId + \"']\").length === 0) {\r\n                this.jqTarget.append($('<option>', {value: objId}).text(objName));\r\n            }\r\n        });\r\n    }\r\n\r\n    updateFrameTypeList() {\r\n        const selected = 0|this.jqFrameType.val();\r\n        this.jqFrameType.html('');\r\n        $.each(this.camera.getAvailableFrameTypes(), (idx, typeId) => {\r\n            this.jqFrameType.append($('<option>', {value: typeId, selected: typeId == selected}).text(UIPanelCamera.frameTypeNames[typeId]));\r\n        });\r\n    }\r\n\r\n    updateTarget(value) {\r\n        this.jqTarget.val(value);\r\n    }\r\n\r\n    updateFrameType(value) {\r\n        this.jqFrameType.val(value);\r\n    }\r\n}\r\n\r\nUIPanelCamera.frameTypeNames = {\r\n    [ReferenceFrame.INERTIAL_ECLIPTIC]: 'Ecliptic',\r\n    [ReferenceFrame.INERTIAL_BODY_EQUATORIAL]: 'Equatorial',\r\n    [ReferenceFrame.INERTIAL_BODY_FIXED]: 'Body fixed',\r\n    [ReferenceFrame.INERTIAL_PARENT_BODY_EQUATORIAL]: 'Parent equatorial',\r\n};\r\n","\r\nimport UIPanel from \"../Panel\";\r\nimport {presentNumberWithSuffix, Vector} from \"../../core/algebra\";\r\nimport FunctionOfEpochAbstract from \"../../core/FunctionOfEpoch/Abstract\";\r\n\r\nexport default class UIPanelVector extends UIPanel\r\n{\r\n    constructor(panelDom, vectorOfEpoch) {\r\n        super(panelDom, true);\r\n        this.vectorOfEpoch = vectorOfEpoch;\r\n        this.jqMag = this.jqDom.find('.vec-magnitude');\r\n        this.jqX = this.jqDom.find('.vec-x');\r\n        this.jqY = this.jqDom.find('.vec-y');\r\n        this.jqZ = this.jqDom.find('.vec-z');\r\n    }\r\n\r\n    set(vector, epoch) {\r\n        this.vectorOfEpoch = vector;\r\n        this.update(epoch);\r\n    }\r\n\r\n    update(epoch) {\r\n        let vector = this.vectorOfEpoch;\r\n        if ((epoch || epoch === 0)\r\n            && (vector instanceof FunctionOfEpochAbstract)\r\n        ) {\r\n            vector = vector.evaluate(epoch);\r\n        }\r\n\r\n        if (!vector instanceof Vector) {\r\n            return;\r\n        }\r\n\r\n        this.jqMag.html(presentNumberWithSuffix(vector.mag));\r\n        this.jqX.html  (presentNumberWithSuffix(vector.x));\r\n        this.jqY.html  (presentNumberWithSuffix(vector.y));\r\n        this.jqZ.html  (presentNumberWithSuffix(vector.z));\r\n    }\r\n}\r\n","import $ from \"jquery\";\r\n\r\nimport UIPanel from \"../Panel\";\r\nimport Events from \"../../core/Events\";\r\nimport UIPanelVector from \"./Vector\";\r\nimport {presentNumberWithSuffix, rad2deg} from \"../../core/algebra\";\r\nimport EphemerisObject from \"../../core/EphemerisObject\";\r\nimport { sim } from \"../../core/Simulation\";\r\n\r\nexport default class UIPanelMetrics extends UIPanel\r\n{\r\n    constructor(panelDom, selection) {\r\n        super(panelDom);\r\n\r\n        this.selection = selection;\r\n        this.precision = 5;\r\n\r\n        this.renderListener = this.render.bind(this);\r\n\r\n        document.addEventListener(Events.SELECT, this.handleSelect.bind(this));\r\n        document.addEventListener(Events.DESELECT, this.handleDeselect.bind(this));\r\n\r\n        this.jqDom.find('#unloadObject').on('click', function() {\r\n            let wasSelected = selection.getSelectedObject().object;\r\n            selection.deselect();\r\n            sim.starSystem.deleteObject(wasSelected.id);\r\n        });\r\n        this.jqDom.find('#showAnglesOfSelectedOrbit').on('change', function() {\r\n            sim.settings.ui.showAnglesOfSelectedOrbit = this.checked;\r\n            Events.dispatch(Events.SHOW_ORBIT_ANGLES_CHANGED, {value: this.checked});\r\n        });\r\n\r\n        this.positionPanel = new UIPanelVector(this.jqDom.find(\".js-metrics-panel-cartesian-position-vector\"), null);\r\n        this.velocityPanel = new UIPanelVector(this.jqDom.find(\".js-metrics-panel-cartesian-velocity-vector\"), null);\r\n\r\n        this.hide();\r\n    }\r\n\r\n    render(event) {\r\n        const selectedObject = this.selection.getSelectedObject();\r\n        let parent = null;\r\n        if (!selectedObject) {\r\n            return;\r\n        }\r\n\r\n        try {\r\n            const referenceFrame = selectedObject.getReferenceFrameByEpoch(event.detail.epoch);\r\n            if (referenceFrame) {\r\n                parent = sim.starSystem.getObject(referenceFrame.originId);\r\n                this.jqDom.find('#relativeTo').html(parent.name);\r\n            }\r\n\r\n            this.updateMain(selectedObject, event.detail.epoch, parent);\r\n            this.updateCartesian(selectedObject, event.detail.epoch);\r\n            this.updateKeplerian(selectedObject, event.detail.epoch);\r\n        } catch (e) {\r\n\r\n        }\r\n    }\r\n\r\n    updateMain(selectedObject, epoch, parent) {\r\n        const keplerianObject = selectedObject.getKeplerianObjectByEpoch(epoch);\r\n        const sma = keplerianObject.sma;\r\n        const per = sma * (1 - keplerianObject.e);\r\n        const apo = sma * (1 + keplerianObject.e);\r\n        const surfaceAlt = parent.physicalModel ? parent.physicalModel.radius : 0;\r\n        const state = selectedObject.getStateInOwnFrameByEpoch(epoch);\r\n\r\n        this.jqDom.find('#elements-orbit-alt' ).html(\r\n            '' + (per - surfaceAlt).toPrecision(this.precision)\r\n            + ' x ' + (apo - surfaceAlt).toPrecision(this.precision)\r\n        );\r\n\r\n        this.jqDom.find('#elements-orbit-avg' ).html(''   + (sma - surfaceAlt).toPrecision(this.precision));\r\n        this.jqDom.find('#elements-alt' ).html(''   + (state.position.mag - surfaceAlt).toPrecision(this.precision));\r\n        this.jqDom.find('#elements-speed' ).html('' + (state.velocity.mag * 1000).toPrecision(this.precision));\r\n\r\n        if (parent.physicalModel && parent.physicalModel.j2 && parent.physicalModel.j2) {\r\n            this.jqDom.find('#elements-precession').html('' + (\r\n                rad2deg(keplerianObject.getNodalPrecessionRate(parent.physicalModel.eqRadius, parent.physicalModel.j2) * 86400)\r\n            ).toPrecision(this.precision));\r\n        }\r\n    }\r\n\r\n    updateCartesian(selectedObject, epoch) {\r\n        const state = selectedObject.getStateInOwnFrameByEpoch(epoch);\r\n        this.positionPanel.set(state.position);\r\n        this.velocityPanel.set(state.velocity);\r\n    }\r\n\r\n    updateKeplerian(selectedObject, epoch) {\r\n        const keplerianObject = selectedObject.getKeplerianObjectByEpoch(epoch);\r\n        this.jqDom.find('#elements-ecc' ).html('' +        ( keplerianObject.e   ).toPrecision(this.precision));\r\n        this.jqDom.find('#elements-sma' ).html('' + presentNumberWithSuffix(keplerianObject.sma));\r\n        this.jqDom.find('#elements-inc' ).html('' + rad2deg( keplerianObject.inc ).toPrecision(this.precision));\r\n        this.jqDom.find('#elements-aop' ).html('' + rad2deg( keplerianObject.aop ).toPrecision(this.precision));\r\n        this.jqDom.find('#elements-raan').html('' + rad2deg( keplerianObject.raan).toPrecision(this.precision));\r\n        this.jqDom.find('#elements-ta'  ).html('' + rad2deg( keplerianObject.getTrueAnomalyByEpoch(epoch)  ).toPrecision(this.precision));\r\n        this.jqDom.find('#elements-period').html('' + (keplerianObject.period / 86400).toPrecision(this.precision));\r\n    }\r\n\r\n    handleSelect() {\r\n        this.show();\r\n\r\n        const object = this.selection.getSelectedObject().object;\r\n        if (object) {\r\n            $('#metricsOf').html(object.name);\r\n        } else {\r\n            $('#relativeTo,#metricsOf').html('');\r\n        }\r\n\r\n        if (object.type === EphemerisObject.TYPE_SPACECRAFT || object.type === EphemerisObject.TYPE_UNKNOWN) {\r\n            this.jqDom.find('#unloadObject').show();\r\n        } else {\r\n            this.jqDom.find('#unloadObject').hide();\r\n        }\r\n\r\n        document.addEventListener(Events.RENDER, this.renderListener);\r\n    }\r\n\r\n    handleDeselect() {\r\n        this.hide();\r\n        document.removeEventListener(Events.RENDER, this.renderListener);\r\n    }\r\n}\r\n","import {getAngleBySinCos, Vector, Quaternion, newtonSolve} from \"./algebra\";\r\nimport KeplerianObject from \"./KeplerianObject\";\r\nimport EphemerisObject from \"./EphemerisObject\";\r\nimport ReferenceFrameFactory, {ReferenceFrame} from \"./ReferenceFrame/Factory\";\r\nimport Body from \"./Body\";\r\nimport StateVector from \"./StateVector\";\r\nimport TrajectoryComposite from \"./Trajectory/Composite\";\r\nimport TrajectoryKeplerianBasic from \"./Trajectory/KeplerianBasic\";\r\nimport { sim } from \"./Simulation\";\r\n\r\nexport default class LambertSolver\r\n{\r\n    static getPlotData(orbit1, orbit2, epochMin, epochMax, transferMin, transferMax, points) {\r\n        const epochStep = (epochMax - epochMin) / (points - 1);\r\n        const flightTimeStep = (transferMax - transferMin) / (points - 1);\r\n        let result = [];\r\n        let startEpoch = epochMin;\r\n        let i = 0;\r\n\r\n        while (startEpoch <= epochMax) {\r\n            let flightTime = transferMin;\r\n            let j = 0;\r\n\r\n            result[i] = [];\r\n            while (flightTime <= transferMax) {\r\n                let res = this.calcDeltaV(\r\n                    orbit1.getStateByEpoch(startEpoch),\r\n                    orbit2.getStateByEpoch(startEpoch + flightTime),\r\n                    startEpoch,\r\n                    flightTime,\r\n                    orbit1.mu\r\n                );\r\n                result[i][j] = res;\r\n                flightTime += flightTimeStep;\r\n                j++;\r\n\r\n            }\r\n            startEpoch += epochStep;\r\n            i++;\r\n        }\r\n        return result;\r\n    }\r\n\r\n    static plot(plotData) {\r\n        let min = 1e99, max = 0;\r\n        let ctx = document.getElementById('lambertCanvas').getContext('2d');\r\n\r\n        ctx.clearRect(0, 0, 300, 300);\r\n\r\n        for (let row of plotData) {\r\n            for (let res of row) {\r\n                if (res === false) {\r\n                    continue;\r\n                }\r\n                if (res < min) {\r\n                    min = res;\r\n                }\r\n                if (res > max) {\r\n                    max = res;\r\n                }\r\n            }\r\n        }\r\n\r\n        for (let row in plotData) {\r\n            for (let col in plotData[row]) {\r\n                const res = plotData[row][col];\r\n                if (res === false) {\r\n                    ctx.fillStyle = \"rgba(255,0,0,1)\";\r\n                } else {\r\n                    const color = Math.round((1 - (res - min) / (max - min)) * 255);\r\n                    ctx.fillStyle = \"rgba(\" + color + \",\" + color + \",\" + color + \", 1)\";\r\n                }\r\n                ctx.fillRect(0|row, 0|col, 1, 1);\r\n            }\r\n        }\r\n    }\r\n\r\n    static getDeltaV(state1, state2, transferOrbit, epoch1, epoch2) {\r\n        return state1.velocity.sub_(transferOrbit.getStateByEpoch(epoch1)._velocity).mag +\r\n            state2.velocity.sub_(transferOrbit.getStateByEpoch(epoch2)._velocity).mag;\r\n    }\r\n\r\n    static calcDeltaV(state1, state2, startEpoch, flightTime, mu) {\r\n        const transferOrbit = this.solve(state1, state2, startEpoch, flightTime, mu);\r\n\r\n        if (!transferOrbit) {\r\n            return false;\r\n        }\r\n\r\n        return this.getDeltaV(state1, state2, transferOrbit, startEpoch, startEpoch + flightTime);\r\n    }\r\n\r\n    static findBestTransfer(originObject, targetObject, rPer1, rPer2, departureTime, flightTimeMin, flightTimeMax) {\r\n        const d = (flightTimeMax - flightTimeMin) * 1e-6;\r\n        const getDiff = (flightTime) => {\r\n            if (flightTime < flightTimeMin) {\r\n                return null;\r\n            }\r\n            if (flightTime > flightTimeMax) {\r\n                return null;\r\n            }\r\n            const v1 = this.solveFullTransfer(originObject, targetObject, rPer1, rPer2, departureTime, flightTime - d/2);\r\n            const v2 = this.solveFullTransfer(originObject, targetObject, rPer1, rPer2, departureTime, flightTime + d/2);\r\n\r\n            if (v1 === null || v2 === null) {\r\n                return null;\r\n            }\r\n\r\n            return (v2.totalDeltaV - v1.totalDeltaV) / d;\r\n        };\r\n\r\n        const stepCount = 50;\r\n        const step = (flightTimeMax - flightTimeMin) / (stepCount - 1);\r\n\r\n        let minDeltaV = 1e100;\r\n        let bestFlightTime;\r\n\r\n        for (let flightTime = flightTimeMin; flightTime <= flightTimeMax; flightTime += step) {\r\n            const transfer = this.solveFullTransfer(originObject, targetObject, rPer1, rPer2, departureTime, flightTime);\r\n            if (transfer === null) {\r\n                continue;\r\n            }\r\n            const deltaV = transfer.totalDeltaV;\r\n            // console.log(flightTime, deltaV);\r\n            if (deltaV < minDeltaV) {\r\n                bestFlightTime = flightTime;\r\n                minDeltaV = deltaV;\r\n            }\r\n        }\r\n\r\n        bestFlightTime = newtonSolve(getDiff, bestFlightTime, step * 1e-3, 1e-6, 10);\r\n\r\n        if (bestFlightTime === null) {\r\n            return {totalDeltaV: null};\r\n        }\r\n\r\n        return this.solveFullTransfer(originObject, targetObject, rPer1, rPer2, departureTime, bestFlightTime);\r\n    }\r\n\r\n    static solveFullTransfer(originObject, targetObject, rPer1, rPer2, departureTime, flightTime) {\r\n        if (flightTime <= 0) {\r\n            return null;\r\n        }\r\n\r\n        const parentObject = sim.starSystem.getCommonParentObject(originObject.id, targetObject.id, departureTime, departureTime + flightTime);\r\n\r\n        if (!(parentObject instanceof Body)) {\r\n            return null;\r\n        }\r\n\r\n        const rfMainId = ReferenceFrameFactory.buildId(\r\n            parentObject.id,\r\n            (parentObject.type === EphemerisObject.TYPE_STAR)\r\n                ? ReferenceFrame.INERTIAL_ECLIPTIC\r\n                : ReferenceFrame.INERTIAL_BODY_EQUATORIAL\r\n        );\r\n        const rfMain = sim.starSystem.getReferenceFrame(rfMainId);\r\n\r\n        const mu = parentObject.physicalModel.mu;\r\n\r\n        let state1;\r\n        let state2;\r\n\r\n        let calcOriginSoi = originObject instanceof Body;\r\n        let calcTargetSoi = targetObject instanceof Body;\r\n\r\n        let rfOrigin;\r\n        let rfTarget;\r\n        let originSoi;\r\n        let targetSoi;\r\n\r\n        if (calcOriginSoi) {\r\n            rfOrigin = sim.starSystem.getReferenceFrame(ReferenceFrameFactory.buildId(originObject.id, ReferenceFrame.INERTIAL_BODY_EQUATORIAL));\r\n            originSoi = originObject.data.patchedConics.soiRadius;\r\n        }\r\n        if (calcTargetSoi) {\r\n            targetSoi = targetObject.data.patchedConics.soiRadius;\r\n            rfTarget = sim.starSystem.getReferenceFrame(ReferenceFrameFactory.buildId(targetObject.id, ReferenceFrame.INERTIAL_BODY_EQUATORIAL));\r\n        }\r\n\r\n        let ejectionTime = 0;\r\n        let insertionTime = 0;\r\n        let ejectionPosShift = new Vector(3);\r\n        let insertionPosShift = new Vector(3);\r\n        let ejectionVelInf;\r\n        let insertionVelInf;\r\n        let steps = 0;\r\n        let transferKO;\r\n        let ejectionSoiEpoch;\r\n        let insertionSoiEpoch;\r\n\r\n        while (true) {\r\n            ejectionSoiEpoch = departureTime + ejectionTime;\r\n            insertionSoiEpoch = departureTime + flightTime - insertionTime;\r\n\r\n            state1 = originObject.trajectory.getStateByEpoch(ejectionSoiEpoch, rfMain);\r\n            if (calcOriginSoi) {\r\n                state1._position = rfOrigin.transformPositionByEpoch(ejectionSoiEpoch, ejectionPosShift, rfMain);\r\n            }\r\n\r\n            state2 = targetObject.trajectory.getStateByEpoch(insertionSoiEpoch, rfMain);\r\n            if (calcTargetSoi) {\r\n                state2._position = rfTarget.transformPositionByEpoch(insertionSoiEpoch, insertionPosShift, rfMain);\r\n            }\r\n\r\n            transferKO = this.solve(state1, state2, ejectionSoiEpoch, insertionSoiEpoch - ejectionSoiEpoch, mu);\r\n            if (transferKO === null) {\r\n                return null;\r\n            }\r\n\r\n            steps++;\r\n\r\n            let ejectionPosTime = [new Vector(3), 0];\r\n            let insertionPosTime = [new Vector(3), 0];\r\n\r\n            if (calcOriginSoi) {\r\n                ejectionVelInf = transferKO.getStateByEpoch(ejectionSoiEpoch)._velocity.sub_(state1._velocity);\r\n                const ejectionNormal  = state1._position.cross(ejectionVelInf);\r\n                ejectionPosTime = this.getSoiEdgePositionAndTime(\r\n                    rfMain.rotateVectorByEpoch(ejectionSoiEpoch, ejectionVelInf, rfOrigin),\r\n                    rfMain.rotateVectorByEpoch(ejectionSoiEpoch, ejectionNormal, rfOrigin),\r\n                    rPer1,\r\n                    originSoi,\r\n                    originObject.physicalModel.mu,\r\n                    1\r\n                );\r\n                ejectionTime = ejectionPosTime[1];\r\n            }\r\n\r\n            if (calcTargetSoi) {\r\n                insertionVelInf = transferKO.getStateByEpoch(insertionSoiEpoch)._velocity.sub_(state2._velocity);\r\n                const insertionNormal = state2._position.cross(insertionVelInf);\r\n                insertionPosTime = this.getSoiEdgePositionAndTime(\r\n                    rfMain.rotateVectorByEpoch(insertionSoiEpoch, insertionVelInf, rfTarget),\r\n                    rfMain.rotateVectorByEpoch(insertionSoiEpoch, insertionNormal, rfTarget),\r\n                    rPer2,\r\n                    targetSoi,\r\n                    targetObject.physicalModel.mu,\r\n                    -1\r\n                );\r\n                insertionTime = insertionPosTime[1];\r\n            }\r\n\r\n            if (steps > 10\r\n                || (\r\n                    (!calcOriginSoi || ejectionPosShift.sub(ejectionPosTime[0]).mag < 10)\r\n                    && (!calcTargetSoi || insertionPosShift.sub(insertionPosTime[0]).mag < 10)\r\n                )\r\n            ) {\r\n                ejectionPosShift = ejectionPosTime[0];\r\n                insertionPosShift = insertionPosTime[0];\r\n                break;\r\n            }\r\n\r\n            ejectionPosShift = ejectionPosTime[0];\r\n            insertionPosShift = insertionPosTime[0];\r\n        }\r\n\r\n        let ejectionDeltaV = 0;\r\n        let insertionDeltaV = 0;\r\n        let trajectory = new TrajectoryComposite();\r\n\r\n        const transfer = new TrajectoryKeplerianBasic(rfMainId, transferKO);\r\n        transfer.minEpoch = departureTime + ejectionTime;\r\n        transfer.maxEpoch = departureTime + flightTime - insertionTime;\r\n        trajectory.addComponent(transfer);\r\n\r\n        if (calcOriginSoi) {\r\n            const ejectionKO = KeplerianObject.createFromState(\r\n                new StateVector(ejectionPosShift, rfMain.rotateVectorByEpoch(ejectionSoiEpoch, ejectionVelInf, rfOrigin)),\r\n                originObject.physicalModel.mu,\r\n                departureTime + ejectionTime\r\n            );\r\n            ejectionDeltaV = ejectionKO.getPeriapsisSpeed() - Math.sqrt(originObject.physicalModel.mu / ejectionKO.getPeriapsisRadius());\r\n            const ejection = new TrajectoryKeplerianBasic(rfOrigin.id, ejectionKO);\r\n            ejection.minEpoch = departureTime;\r\n            ejection.maxEpoch = departureTime + ejectionTime;\r\n            trajectory.addComponent(ejection);\r\n        } else {\r\n            ejectionDeltaV = state1.velocity.sub(transferKO.getStateByEpoch(departureTime)._velocity).mag;\r\n        }\r\n\r\n        if (calcTargetSoi) {\r\n            const insertionKO = KeplerianObject.createFromState(\r\n                new StateVector(insertionPosShift, rfMain.rotateVectorByEpoch(insertionSoiEpoch, insertionVelInf, rfTarget)),\r\n                targetObject.physicalModel.mu,\r\n                departureTime + flightTime - insertionTime\r\n            );\r\n            insertionDeltaV = insertionKO.getPeriapsisSpeed() - Math.sqrt(targetObject.physicalModel.mu / insertionKO.getPeriapsisRadius());\r\n            const insertion = new TrajectoryKeplerianBasic(rfTarget.id, insertionKO);\r\n            insertion.minEpoch = departureTime + flightTime - insertionTime;\r\n            insertion.maxEpoch = departureTime + flightTime;\r\n            trajectory.addComponent(insertion);\r\n        } else {\r\n            insertionDeltaV = state2.velocity.sub(transferKO.getStateByEpoch(departureTime + flightTime)._velocity).mag;\r\n        }\r\n\r\n        return {\r\n            trajectory: trajectory,\r\n            ejectionDeltaV: ejectionDeltaV,\r\n            insertionDeltaV: insertionDeltaV,\r\n            totalDeltaV: ejectionDeltaV + insertionDeltaV,\r\n        };\r\n    }\r\n\r\n    static getSoiEdgePositionAndTime(velInf, normal, rPer, rInf, mu, direction) {\r\n        const sma = 1 / (2 / rInf - velInf.quadrance / mu);\r\n        const ecc = 1 - rPer / sma;\r\n        const trueAnomaly = direction * Math.acos((sma * (1 - ecc*ecc) / rInf - 1) / ecc);\r\n        const flightPathAngle = Math.atan(ecc * Math.sin(trueAnomaly) / (sma * (1 - ecc*ecc) / rInf));\r\n        const position = (new Quaternion(normal, flightPathAngle - Math.PI / 2)).rotate_(velInf.unit().mul_(rInf));\r\n\r\n        const H = this.getEccentricAnomalyByTrueAnomaly(trueAnomaly, ecc);\r\n        const time = (ecc > 1)\r\n            ? (ecc * Math.sinh(H) - H) / Math.sqrt(mu / sma / sma / Math.abs(sma))\r\n            : (H - ecc * Math.sin(H)) / Math.sqrt(mu / sma / sma / sma);\r\n\r\n        return [position, Math.abs(time)];\r\n    }\r\n\r\n    static solve(state1, state2, startEpoch, flightTime, mu) {\r\n        const maxError = 1;\r\n        const maxSteps = 30;\r\n\r\n        const r1vec = state1.position;\r\n        const r2vec = state2.position;\r\n        let normal = r1vec.cross(r2vec);\r\n        const r1 = r1vec.mag;\r\n        const r2 = r2vec.mag;\r\n        let transferAngle = r1vec.angle(r2vec);\r\n\r\n        if (normal.angle(state1._position.cross(state1._velocity)) > Math.PI / 2) {\r\n            transferAngle = 2 * Math.PI - transferAngle;\r\n            normal.mul_(-1);\r\n        }\r\n\r\n        const signSinTransferAngle = Math.sign(Math.sin(transferAngle));\r\n        const inc = normal.angle(new Vector([0, 0, 1]));\r\n        const nodeVector = (new Vector([0, 0, 1])).cross(normal);\r\n\r\n        let e, sma, ta1;\r\n        let raan = nodeVector.angle(new Vector([1, 0, 0]));\r\n        if ((new Vector([1, 0, 0])).cross(nodeVector).angle(new Vector([0, 0, 1])) > Math.PI / 2) {\r\n            raan = 2 * Math.PI - raan;\r\n        }\r\n\r\n        const d = Math.sqrt(r1*r1 + r2*r2 - 2 * r1vec.dot(r2vec)) / 2;\r\n\r\n        const parabolicTime = (Math.pow(r1+r2+2*d, 3/2) - signSinTransferAngle*Math.pow(r1+r2-2*d, 3/2)) / (6 * Math.sqrt(mu));\r\n\r\n        if (flightTime > parabolicTime) {\r\n            // ellipse\r\n            const A = (r2 - r1) / 2;\r\n            const E = d / A;\r\n            const B = Math.sqrt(d*d - A*A);\r\n            let y = newtonSolve(\r\n                (yParam) => this.getTimeByY(yParam, A, B, E, r1, r2, d, transferAngle, mu) - flightTime,\r\n                10000, 1, maxError, maxSteps\r\n            );\r\n\r\n            if (y === null) {\r\n                return null;\r\n            }\r\n\r\n            const x0 = -(r2 + r1) / 2 / E;\r\n            const y0 = B * Math.sqrt(x0 * x0 / A / A - 1);\r\n            const x = A * Math.sqrt(1 + y * y / B / B);\r\n            const temp = Math.sqrt((x0 - x) * (x0 - x) + (y0 - y) * (y0 - y));\r\n            const fx = (x0 - x) / temp;\r\n            const fy = (y0 - y) / temp;\r\n            ta1 = getAngleBySinCos(\r\n                signSinTransferAngle * ((x0 + d) * fy - y0 * fx) / r1,\r\n                -((x0 + d) * fx + y0 * fy) / r1\r\n            );\r\n            sma = E * (x - x0) / 2;\r\n            e = temp / 2 / sma;\r\n\r\n        } else {\r\n            // hyperbola\r\n            sma = newtonSolve(\r\n                (a) => {\r\n                    const alpha = Math.acosh(1 + (r1 + r2 + 2 * d) / 2 / Math.abs(a));\r\n                    const beta  = Math.acosh(1 + (r1 + r2 - 2 * d) / 2 / Math.abs(a));\r\n                    return Math.sqrt(Math.abs(Math.pow(a, 3)) / mu) *\r\n                        (Math.sinh(alpha) - alpha - signSinTransferAngle * (Math.sinh(beta) - beta)) - flightTime;\r\n                },\r\n                r1, 10, maxError, maxSteps\r\n            );\r\n\r\n            if (sma === null) {\r\n                return null;\r\n            }\r\n\r\n            if (sma > 0) {\r\n                sma = -sma;\r\n            }\r\n\r\n            let f1 = r1vec.rotate(nodeVector, -inc).mul_(-1);\r\n            let p2 = r2vec.rotate(nodeVector, -inc).add_(f1);\r\n            const d1 = r1 - 2 * sma;\r\n            const d2 = r2 - 2 * sma;\r\n            const tempAng = -Math.sign(p2.y) * p2.angle(new Vector([1,0,0]));\r\n            f1 = f1.rotateZ(tempAng);\r\n            p2 = p2.rotateZ(tempAng);\r\n\r\n            const f2x = (p2.x*p2.x - d2*d2 + d1*d1) / 2 / p2.x;\r\n            let f2y = Math.sqrt(d1*d1 - f2x*f2x);\r\n\r\n            if (transferAngle > Math.PI ? (f1.y < 0) : (f1.y > 0)) {\r\n                f2y = -f2y;\r\n            }\r\n\r\n            e = -f1.sub_(new Vector([f2x, f2y, 0])).mag / 2 / sma;\r\n\r\n            const p = sma * (1 - e*e);\r\n            ta1 = Math.acos((p / r1 - 1) / e);\r\n            const ta2 = Math.acos((p / r2 - 1) / e);\r\n\r\n            if (ta1 > ta2 || ta2 - transferAngle < 0) {\r\n                ta1 = -ta1;\r\n            }\r\n        }\r\n\r\n        const perVector = (new Quaternion(normal, -ta1)).rotate(r1vec);\r\n        let aop = nodeVector.angle(perVector);\r\n\r\n        if (nodeVector.cross(perVector).angle(normal) > Math.PI / 2) {\r\n            aop = 2 * Math.PI - aop;\r\n        }\r\n\r\n        return new KeplerianObject(e, sma, aop, inc, raan, ta1, startEpoch, mu, true);\r\n    }\r\n\r\n    static getTimeByY(y, A, B, E, r1, r2, d, alpha, mu) {\r\n        const rm = (r2 + r1) / 2;\r\n        const x0 = - rm / E;\r\n        const y0 = B * Math.sqrt(x0*x0/A/A - 1);\r\n        const x = A * Math.sqrt(1 + y*y/B/B);\r\n        const a = (rm + E * x) / 2;\r\n        const temp = Math.sqrt((x0 - x)*(x0 - x) + (y0 - y)*(y0 - y));\r\n        const e = temp / 2 / a;\r\n        const fx = (x0 - x) / temp;\r\n        const fy = (y0 - y) / temp;\r\n        const cosTa1 = -((x0 + d) * fx + y0 * fy) / r1;\r\n        const sinTa1 = Math.sign(Math.sin(alpha)) * ((x0 + d) * fy - y0 * fx) / r1;\r\n        const ta1 = getAngleBySinCos(sinTa1, cosTa1);\r\n        const n = Math.sqrt(mu/a/a/a);\r\n        const E1 = this.getEccentricAnomalyByTrueAnomaly(ta1, e);\r\n        let E2 = this.getEccentricAnomalyByTrueAnomaly(ta1 + alpha, e);\r\n        if (ta1 + alpha > 2 * Math.PI) {\r\n            E2 += 2 * Math.PI;\r\n        }\r\n        return (E2 - E1 - e * (Math.sin(E2) - Math.sin(E1))) / n;\r\n    }\r\n\r\n    static getEccentricAnomalyByTrueAnomaly(ta, ecc) {\r\n        if (ecc < 1) {\r\n            const cos = Math.cos(ta);\r\n            return getAngleBySinCos(\r\n                Math.sqrt(1 - ecc * ecc) * Math.sin(ta) / (1 + ecc * cos),\r\n                (ecc + cos) / (1 + ecc * cos)\r\n            );\r\n        } else {\r\n            return 2 * Math.atanh(Math.tan(ta / 2) / Math.sqrt((ecc + 1) / (ecc - 1)));\r\n        }\r\n    }\r\n\r\n}\r\n","import * as THREE from \"three\";\r\n\r\nimport VisualModelAbstract from \"./ModelAbstract\";\r\nimport {Quaternion, Vector} from \"../algebra\";\r\nimport {RF_BASE} from \"../ReferenceFrame/Factory\";\r\nimport { sim } from \"../Simulation\";\r\n\r\nexport default class VisualVector extends VisualModelAbstract\r\n{\r\n    constructor(vector, referenceFrameId) {\r\n        super();\r\n        if (referenceFrameId === undefined) {\r\n            referenceFrameId = RF_BASE;\r\n        }\r\n        this.referenceFrame = sim.starSystem.getReferenceFrame(referenceFrameId);\r\n        this.quaternion = Quaternion.transfer(new Vector([0,1,0]), vector);\r\n        this.setThreeObj(new THREE.ArrowHelper(\r\n            (new THREE.Vector3()).fromArray([1,0,0]),\r\n            new THREE.Vector3(),\r\n            vector.mag\r\n        ));\r\n    }\r\n\r\n    render(epoch) {\r\n        this.threeObj.quaternion.copy(this.quaternion.mul(this.referenceFrame.getQuaternionByEpoch(epoch)).toThreejs());\r\n        this.threeObj.position.copy(sim.getVisualCoords(this.referenceFrame.getOriginPositionByEpoch(epoch)));\r\n    }\r\n}\r\n","import $ from \"jquery\";\r\n\r\nimport UIPanel from \"../Panel\";\r\nimport LambertSolver from \"../../core/LambertSolver\";\r\nimport ReferenceFrameFactory, {ReferenceFrame} from \"../../core/ReferenceFrame/Factory\";\r\nimport VisualTrajectoryModelKeplerian from \"../../core/visual/TrajectoryModel/Keplerian\";\r\nimport VisualVector from \"../../core/visual/Vector\";\r\nimport EphemerisObject from \"../../core/EphemerisObject\";\r\nimport { sim } from \"../../core/Simulation\";\r\nimport Events from \"../../core/Events\";\r\n\r\nexport default class UIPanelLambert extends UIPanel\r\n{\r\n    constructor(panelDom) {\r\n        super(panelDom, true);\r\n\r\n        this.maxTransferTime = 86400 * 365.25 * 40;\r\n\r\n        this.jqSlider = this.jqDom.find('#transferTimeSlider');\r\n        this.jqSlider.on('input change', () => this.changeTransferTime(this.getCurrentTransferTime()));\r\n        this.transferTime = this.getCurrentTransferTime();\r\n\r\n        this.jqTransferTimeText = this.jqDom.find('#transferTimeValue');\r\n        this.jqTransferTimeText.html(this.formatTransferTime(this.transferTime));\r\n\r\n        this.jqDateText = this.jqDom.find('#departureDateValue');\r\n\r\n        this.jqDom.find('#useCurrentTime').click(() => this.useCurrentTime());\r\n\r\n        this.jqOrigin = this.jqDom.find('#originSelect');\r\n        this.jqOrigin.on('change', () => this.changeOrigin(0|this.jqOrigin.val()));\r\n\r\n        this.jqTarget = this.jqDom.find('#targetSelect');\r\n        this.jqTarget.on('change', () => this.changeTarget(0|this.jqTarget.val()));\r\n\r\n        this.useCurrentTime();\r\n\r\n        this.origin = 399;\r\n        this.jqOrigin.val(this.origin);\r\n\r\n        Events.addListener(Events.STAR_SYSTEM_LOADED, () => {\r\n            this.jqOrigin.html('');\r\n            this.jqTarget.html('');\r\n            this.updateTargetList();\r\n            this.updateOriginList();\r\n        });\r\n    }\r\n\r\n    solve() {\r\n        if (!this.origin || !this.target) {\r\n            return;\r\n        }\r\n\r\n        const parentObject = sim.starSystem.getCommonParentObject(this.origin, this.target, this.departureTime, this.departureTime + this.transferTime);\r\n        const referenceFrameId = ReferenceFrameFactory.buildId(parentObject.id, ReferenceFrame.INERTIAL_ECLIPTIC);\r\n        const origin = sim.starSystem.getObject(this.origin);\r\n        const target = sim.starSystem.getObject(this.target);\r\n        const state1 = origin.trajectory.getStateByEpoch(this.departureTime, referenceFrameId);\r\n        const state2 = target.trajectory.getStateByEpoch(this.departureTime + this.transferTime, referenceFrameId);\r\n\r\n        const solverResult = LambertSolver.solveFullTransfer(\r\n            origin,\r\n            target,\r\n            origin.physicalModel ? origin.physicalModel.radius + 200 : 0,\r\n            target.physicalModel ? target.physicalModel.radius + 200 : 0,\r\n            this.departureTime,\r\n            this.transferTime\r\n        );\r\n        if (!solverResult) {\r\n            return;\r\n        }\r\n        const transferTrajectory = solverResult.trajectory;\r\n        transferTrajectory.setObject(new EphemerisObject(-1, EphemerisObject.TYPE_UNKNOWN, origin.name + '->' + target.name + ' transfer'));\r\n\r\n        if (this.visualModel) {\r\n            this.visualModel.drop();\r\n            this.visualModel2 && this.visualModel2.drop();\r\n            this.visualModel3 && this.visualModel3.drop();\r\n            this.vector1.drop();\r\n            this.vector2.drop();\r\n        }\r\n\r\n        this.visualModel = new VisualTrajectoryModelKeplerian(transferTrajectory.components[0], 'yellow');\r\n        if (transferTrajectory.components[1]) {\r\n            this.visualModel2 = new VisualTrajectoryModelKeplerian(transferTrajectory.components[1], 'red');\r\n        }\r\n        if (transferTrajectory.components[2]) {\r\n            this.visualModel3 = new VisualTrajectoryModelKeplerian(transferTrajectory.components[2], 'red');\r\n        }\r\n        this.vector1 = new VisualVector(state1.position, referenceFrameId);\r\n        this.vector2 = new VisualVector(state2.position, referenceFrameId);\r\n\r\n        this.jqDom.find('#deltaVEjection').html(solverResult.ejectionDeltaV.toPrecision(4));\r\n        this.jqDom.find('#deltaVInsertion').html(solverResult.insertionDeltaV.toPrecision(4));\r\n        this.jqDom.find('#deltaVTotal').html((solverResult.ejectionDeltaV + solverResult.insertionDeltaV).toPrecision(4));\r\n    }\r\n\r\n    collapse() {\r\n        if (this.visualModel) {\r\n            this.visualModel.drop();\r\n            this.visualModel2.drop();\r\n            this.visualModel3.drop();\r\n            this.vector1.drop();\r\n            this.vector2.drop();\r\n            this.visualModel = null;\r\n        }\r\n        super.collapse();\r\n    }\r\n\r\n    useCurrentTime() {\r\n        this.departureTime = sim.currentEpoch;\r\n        this.updateTime(sim.currentDate);\r\n        this.solve();\r\n    }\r\n\r\n    changeOrigin(newOrigin) {\r\n        this.origin = newOrigin;\r\n        this.solve();\r\n    }\r\n\r\n    changeTarget(newTarget) {\r\n        this.target = newTarget;\r\n        this.solve();\r\n    }\r\n\r\n    changeTransferTime(newTransferTime) {\r\n        this.transferTime = newTransferTime;\r\n        this.jqTransferTimeText.html(this.formatTransferTime(this.transferTime));\r\n        this.solve();\r\n    }\r\n\r\n    getCurrentTransferTime() {\r\n        const val = this.jqSlider.val();\r\n        return val * val * val * val * this.maxTransferTime;\r\n    }\r\n\r\n    getNeededSliderValue(transferTime) {\r\n        const val = Math.sqrt(Math.sqrt(transferTime / this.maxTransferTime));\r\n        return Math.max(0, Math.min(1, val));\r\n    }\r\n\r\n    updateOriginList() {\r\n        $.each(sim.starSystem.getObjectNames(), (objId, objName) => {\r\n            if (this.jqOrigin.find(\"option[value='\" + objId + \"']\").length === 0) {\r\n                this.jqOrigin.append($('<option>', {value: objId}).text(objName));\r\n            }\r\n        });\r\n    }\r\n\r\n    updateTargetList() {\r\n        $.each(sim.starSystem.getObjectNames(), (objId, objName) => {\r\n            if (this.jqTarget.find(\"option[value='\" + objId + \"']\").length === 0) {\r\n                this.jqTarget.append($('<option>', {value: objId}).text(objName));\r\n            }\r\n        });\r\n    }\r\n\r\n    updateTime(date) {\r\n        this.jqDateText.html(sim.time.formatDateFull(date));\r\n    }\r\n\r\n\r\n    formatTransferTime(scale) {\r\n        const precision = 3;\r\n\r\n        const prefix = (scale < 0) ? '-' : '';\r\n        const abs = Math.abs(scale);\r\n        if (abs === 0) {\r\n            return '0';\r\n        }\r\n\r\n        if (abs < 60) {\r\n            return prefix + abs.toPrecision(precision) + ' s';\r\n        }\r\n\r\n        if (abs < 3600) {\r\n            return prefix + (abs / 60).toPrecision(precision) + ' min';\r\n        }\r\n\r\n        if (abs < 86400) {\r\n            return prefix + (abs / 3600).toPrecision(precision) + ' h';\r\n        }\r\n\r\n        if (abs < 2592000) {\r\n            return prefix + (abs / 86400).toPrecision(precision) + ' days';\r\n        }\r\n\r\n        if (abs < 31557600) {\r\n            return prefix + (abs / 2592000).toPrecision(precision) + ' months';\r\n        }\r\n\r\n        return prefix + (abs / 31557600).toPrecision(precision) + ' years';\r\n    }\r\n}\r\n","import UIPanel from \"../Panel\";\r\nimport EphemerisObject from \"../../core/EphemerisObject\";\r\nimport TrajectoryKeplerianBasic from \"../../core/Trajectory/KeplerianBasic\";\r\nimport ReferenceFrameFactory, {ReferenceFrame} from \"../../core/ReferenceFrame/Factory\";\r\nimport VisualTrajectoryModelKeplerian from \"../../core/visual/TrajectoryModel/Keplerian\";\r\nimport KeplerianObject from \"../../core/KeplerianObject\";\r\nimport TrajectoryComposite from \"../../core/Trajectory/Composite\";\r\nimport { sim } from \"../../core/Simulation\";\r\n\r\nexport default class UIPanelCreation extends UIPanel {\r\n    constructor(panelDom) {\r\n        super(panelDom);\r\n\r\n        this.jqPause = this.jqDom.find('#createOrbit');\r\n        this.jqPause.click(() => {\r\n            const center = sim.camera.orbitingPoint;\r\n            const object = sim.starSystem.getObject(center);\r\n            if (!object.physicalModel) {\r\n                return;\r\n            }\r\n            const sma = object.physicalModel.radius * 2;\r\n            const id = -11000000 - sim.starSystem.created;\r\n            sim.starSystem.created += 1;\r\n            let ephObject = new EphemerisObject(id, EphemerisObject.TYPE_UNKNOWN, \"Created #\" + sim.starSystem.created);\r\n            let traj = new TrajectoryKeplerianBasic(\r\n                ReferenceFrameFactory.buildId(center, ReferenceFrame.INERTIAL_BODY_EQUATORIAL),\r\n                new KeplerianObject(\r\n                    0.2, sma, Math.PI / 6, Math.PI / 3, Math.PI / 6, 0, sim.currentEpoch, object.physicalModel.mu\r\n                )\r\n            );\r\n            traj.setVisualModel(new VisualTrajectoryModelKeplerian(traj, {color: 'yellow'}));\r\n            traj.minEpoch = false;\r\n            traj.maxEpoch = false;\r\n            traj.isEditable = true;\r\n\r\n            let pTraj = new TrajectoryComposite();\r\n            const propagatorClass = sim.getPropagator('patchedConics');\r\n            pTraj.addComponent(traj);\r\n            pTraj.isEditable = true;\r\n            pTraj.propagator = new propagatorClass();\r\n\r\n            traj.setUpdateCallback(() => {pTraj.propagator.propagate(pTraj, traj.keplerianObject.epoch, {epoch: traj.keplerianObject.epoch + traj.keplerianObject.period})});\r\n            ephObject.setTrajectory(pTraj);\r\n            sim.starSystem.addObject(id, ephObject);\r\n            sim.selection.forceSelection(ephObject.trajectory);\r\n\r\n            pTraj.propagator.propagate(pTraj, traj.keplerianObject.epoch, {epoch: traj.keplerianObject.epoch + traj.keplerianObject.period});\r\n        });\r\n    }\r\n}\r\n","import $ from \"jquery\";\r\n\r\nimport UIPanelTime from \"./Panels/Time\";\r\nimport UIPanelCamera from \"./Panels/Camera\";\r\nimport UIPanelMetrics from \"./Panels/Metrics\";\r\nimport UIPanelLambert from \"./Panels/Lambert\";\r\nimport UIPanelCreation from \"./Panels/Creation\";\r\nimport { sim } from \"../core/Simulation\";\r\n\r\nexport default class UI\r\n{\r\n    constructor() {\r\n        this.timePanel     = new UIPanelTime    ($('#timePanel'));\r\n        this.cameraPanel   = new UIPanelCamera  ($('#cameraPanel'),  sim.camera);\r\n        this.metricsPanel  = new UIPanelMetrics ($('#metricsPanel'), sim.selection);\r\n        this.creationPanel = new UIPanelCreation($('#creationPanel'));\r\n        this.lambertPanel  = new UIPanelLambert ($('#lambertPanel'));\r\n    }\r\n}\r\n","import ReferenceFrameFactory from \"./ReferenceFrame/Factory\";\r\nimport Body from \"./Body\";\r\nimport Events from \"./Events\";\r\n\r\nexport const STAR_SYSTEM_BARYCENTER = 0;\r\n\r\nexport default class StarSystem\r\n{\r\n    constructor(id) {\r\n        this.id = id;\r\n        this.name = null;\r\n        this.stars = null;\r\n        this.mainObject = null;\r\n        this.referenceFrames = {};\r\n        this.objects = {};\r\n        this.created = 0;\r\n    }\r\n\r\n    unload() {\r\n        Object.entries(this.objects).map(entry => entry[1].drop());\r\n        this.stars && this.stars.drop();\r\n    }\r\n\r\n    addStars(stars) {\r\n        this.stars = stars;\r\n        return this;\r\n    }\r\n\r\n    addReferenceFrame(frame) {\r\n        this.referenceFrames[frame.id] = frame;\r\n    }\r\n\r\n    getReferenceFrame(id) {\r\n        if (this.referenceFrames[id] === undefined) {\r\n            this.referenceFrames[id] = ReferenceFrameFactory.createById(id);\r\n        }\r\n        return this.referenceFrames[id];\r\n    }\r\n\r\n    addObject(id, body) {\r\n        this.objects[id] = body;\r\n        Events.dispatch(Events.OBJECT_ADDED, {object: body});\r\n    }\r\n\r\n    getObject(id) {\r\n        if (this.objects[id] === undefined) {\r\n            return null;\r\n        }\r\n        return this.objects[id];\r\n    }\r\n\r\n    deleteObject(id) {\r\n        this.objects[id].drop();\r\n        delete this.objects[id];\r\n    }\r\n\r\n    getCommonParentObject(object1, object2, epoch1, epoch2) {\r\n        if (epoch2 === undefined) {\r\n            epoch2 = epoch1;\r\n        }\r\n\r\n        let chain1 = [object1];\r\n        let parent;\r\n\r\n        while (parent = this.getObject(chain1[chain1.length-1]).getParentObjectIdByEpoch(epoch1)) {\r\n            chain1.push(parent);\r\n        }\r\n        chain1.push(0);\r\n\r\n        parent = object2;\r\n        while ((parent = this.getObject(parent).getParentObjectIdByEpoch(epoch2)) !== null) {\r\n            if (chain1.indexOf(parent) !== -1) {\r\n                return this.getObject(parent);\r\n            }\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    isBody(objectId) {\r\n        if (this.objects[objectId] === undefined) {\r\n            return null;\r\n        }\r\n        return this.objects[objectId] instanceof Body;\r\n    }\r\n\r\n    getObjectNames() {\r\n        let names = {};\r\n        for (const object of Object.values(this.objects)) {\r\n            names[object.id] = object.name;\r\n        }\r\n        return names;\r\n    }\r\n\r\n    getBodies() {\r\n        let bodies = [];\r\n        for (const object of Object.values(this.objects)) {\r\n            if (object instanceof Body) {\r\n                bodies.push(object);\r\n            }\r\n        }\r\n        return bodies;\r\n    }\r\n}","import * as THREE from \"three\";\r\n\r\nimport {Quaternion, Vector} from \"../core/algebra\";\r\nimport {ReferenceFrame, RF_BASE} from \"../core/ReferenceFrame/Factory\";\r\nimport Events from \"../core/Events\";\r\nimport ReferenceFrameFactory from \"../core/ReferenceFrame/Factory\";\r\nimport { sim } from \"../core/Simulation\";\r\n\r\nexport default class Camera\r\n{\r\n    constructor(domElement) {\r\n        this.settings = {\r\n            fov: 60,\r\n            animationDuration: 200,\r\n            pixelsToObjectUnderMouse: 20\r\n        };\r\n\r\n        this.domElement = domElement;\r\n        this.threeCamera = new THREE.PerspectiveCamera(this.settings.fov, domElement.width / domElement.height, 1, 1e15);\r\n        this.threeCamera.position.fromArray([0, 0, 0]);\r\n\r\n        this.listenersAdded = false;\r\n    }\r\n\r\n    init(initialReferenceFrame, initialPosition) {\r\n        this.position = initialPosition;\r\n\r\n        this.referenceFrame = sim.starSystem.getReferenceFrame(initialReferenceFrame);\r\n        this.orbitingPoint = this.referenceFrame.originId;\r\n        this.frameType = this.referenceFrame.type;\r\n        this.quaternion = this._getQuaternionByPosition(this.position);\r\n\r\n        this.lastPosition = this.referenceFrame.transformPositionByEpoch(sim.currentEpoch, this.position, RF_BASE);\r\n\r\n        this.currentMousePos = new Vector([0, 0]);\r\n        this.accountedMousePos = new Vector([0, 0]);\r\n\r\n        this.isMouseDown = false;\r\n        this.isShiftDown = false;\r\n        this.rightButtonDown = false;\r\n        this.isLookingAside = false;\r\n        this.zoomingAside = 0;\r\n        this.isAnimnating = false;\r\n\r\n        if (!this.listenersAdded) {\r\n            sim.addEventListener('mousedown', this.onMouseDown.bind(this), 1);\r\n            sim.addEventListener('mousemove', this.onMouseMove.bind(this), 1);\r\n            sim.addEventListener('mouseup', this.onMouseUp.bind(this), 1);\r\n            sim.addEventListener('wheel', this.onMouseWheel.bind(this), 1);\r\n            this.listenersAdded = true;\r\n        }\r\n    }\r\n\r\n    _getQuaternionByPosition(position, pole) {\r\n        const defaultDirection = new Vector([0, 0, 1]); // must be unit length\r\n        const defaultUp = new Vector([0, 1, 0]);        // must be unit length\r\n\r\n        const directionQuaternion = (new Quaternion()).setAxisAngle(\r\n            defaultDirection.cross(position),\r\n            Math.acos(position.dot(defaultDirection) / position.mag)\r\n        );\r\n\r\n        const newUp = directionQuaternion.rotate(defaultUp);\r\n        const neededUp = (new Quaternion()).setAxisAngle(\r\n            position.cross(pole || new Vector([0, 0, 1])),\r\n            Math.PI / 2\r\n        ).rotate(position);\r\n\r\n        let rollQuaternion = (new Quaternion()).setAxisAngle(\r\n            newUp.cross(neededUp),\r\n            Math.acos(newUp.dot(neededUp) / neededUp.mag)\r\n        );\r\n\r\n        return rollQuaternion.mul_(directionQuaternion);\r\n    }\r\n\r\n    getAvailableFrameTypes(orbitingPoint) {\r\n        if (orbitingPoint === undefined) {\r\n            orbitingPoint = this.orbitingPoint;\r\n        }\r\n\r\n        if (orbitingPoint == 0) {\r\n            return [ReferenceFrame.INERTIAL_ECLIPTIC];\r\n        }\r\n\r\n        const isBody = sim.starSystem.isBody(orbitingPoint);\r\n\r\n        if (isBody === null) {\r\n            return [];\r\n        } else if (isBody) {\r\n            return [\r\n                ReferenceFrame.INERTIAL_ECLIPTIC,\r\n                ReferenceFrame.INERTIAL_BODY_EQUATORIAL,\r\n                ReferenceFrame.INERTIAL_BODY_FIXED\r\n            ];\r\n        } else {\r\n            return [\r\n                ReferenceFrame.INERTIAL_ECLIPTIC,\r\n                ReferenceFrame.INERTIAL_PARENT_BODY_EQUATORIAL\r\n            ];\r\n        }\r\n    }\r\n\r\n    changeReferenceFrameType(newType) {\r\n        this.changeReferenceFrame(ReferenceFrameFactory.buildId(this.orbitingPoint, newType), true);\r\n    }\r\n\r\n    changeOrigin(newObjectId) {\r\n        const newFrameTypes = this.getAvailableFrameTypes(newObjectId);\r\n        let newFrameType = (newFrameTypes.indexOf(this.frameType) !== -1)\r\n            ? this.frameType\r\n            : ReferenceFrame.INERTIAL_ECLIPTIC;\r\n        this.changeReferenceFrame(ReferenceFrameFactory.buildId(newObjectId, newFrameType), true);\r\n    }\r\n\r\n    changeReferenceFrame(newFrameId, animate) {\r\n        const newFrame = sim.starSystem.getReferenceFrame(newFrameId);\r\n\r\n        this.position = this.referenceFrame.transformPositionByEpoch(sim.currentEpoch, this.position, newFrame);\r\n        this.isLookingAside = false;\r\n        this.zoomingAside = 0;\r\n        this.orbitingPoint = newFrame.originId;\r\n        this.frameType = newFrame.type;\r\n\r\n        if (animate) {\r\n            this.startAnimation(newFrame);\r\n        } else {\r\n            this.quaternion = this._getQuaternionByPosition(this.position);\r\n        }\r\n\r\n        Events.dispatch(Events.CAMERA_RF_CHANGED, {old: this.referenceFrame, new: newFrame});\r\n\r\n        this.referenceFrame = newFrame;\r\n    }\r\n\r\n    startAnimation(newFrame) {\r\n        if (newFrame) {\r\n            let transferQuaternion = this.referenceFrame.getQuaternionByEpoch(sim.currentEpoch).invert_().mul_(newFrame.getQuaternionByEpoch(sim.currentEpoch));\r\n            this.quaternion = transferQuaternion.invert_().mul_(this.quaternion);\r\n        }\r\n\r\n        this.animationStartingTime = (new Date()).getTime();\r\n        this.animationDuration = this.settings.animationDuration;\r\n        this.animationStartingQuaternion = this.quaternion.copy();\r\n        this.isAnimnating = true;\r\n    }\r\n\r\n    animate() {\r\n        const time = (new Date()).getTime();\r\n        const percent = (time - this.animationStartingTime) / this.animationDuration;\r\n        const targetQuat = this._getQuaternionByPosition(this.position);\r\n\r\n        if (percent >= 1) {\r\n            this.quaternion = targetQuat;\r\n            this.isAnimnating = false;\r\n            this.isLookingAside = false;\r\n            return;\r\n        }\r\n\r\n        this.quaternion = Quaternion.slerp(this.animationStartingQuaternion, targetQuat, percent);\r\n    }\r\n\r\n    findObjectUnderMouse() {\r\n        let biggestRadius = 0;\r\n        let biggestObject = false;\r\n        for (const body of sim.starSystem.getBodies()) {\r\n            const dist = sim.raycaster.getPixelDistance(\r\n                body.getPositionByEpoch(sim.currentEpoch, RF_BASE)\r\n            );\r\n            if (dist < this.settings.pixelsToObjectUnderMouse) {\r\n                if (biggestObject === false) {\r\n                    biggestObject = body.id;\r\n                }\r\n                const r = body.physicalModel.radius;\r\n                if (r && r > biggestRadius) {\r\n                    biggestRadius = r;\r\n                    biggestObject = body.id;\r\n                }\r\n            }\r\n        }\r\n        return biggestObject;\r\n    }\r\n\r\n    onMouseWheel(event) {\r\n        if (!event.deltaY) {\r\n            return;\r\n        }\r\n\r\n        const defaultFactor = event.shiftKey ? (1 + (sim.settings.ui.camera.zoomFactor - 1) / 10) : sim.settings.ui.camera.zoomFactor;\r\n        const factor = event.deltaY < 0\r\n            ? 1 / defaultFactor\r\n            : defaultFactor;\r\n        let objectToZoomTo = this.findObjectUnderMouse();\r\n        let zoomingTo = this.orbitingPoint;\r\n\r\n        if (objectToZoomTo === this.orbitingPoint) {\r\n            objectToZoomTo = false;\r\n        }\r\n\r\n        if (objectToZoomTo !== false) {\r\n            this.position = this.referenceFrame.transformPositionByEpoch(sim.currentEpoch, this.position, objectToZoomTo * 100000 + 1000);\r\n            zoomingTo = objectToZoomTo;\r\n        } else {\r\n            this.zoomingAside = 0;\r\n        }\r\n\r\n        if (sim.starSystem.getObject(zoomingTo).physicalModel && sim.starSystem.getObject(zoomingTo).physicalModel.radius) {\r\n            const currentMag = this.position.mag;\r\n            this.position.mul_((sim.starSystem.getObject(zoomingTo).physicalModel.radius + (currentMag - sim.starSystem.getObject(zoomingTo).physicalModel.radius) * factor) / currentMag);\r\n        } else {\r\n            this.position.mul_(factor);\r\n        }\r\n\r\n        if (objectToZoomTo !== false) {\r\n            this.position = sim.starSystem.getReferenceFrame(objectToZoomTo * 100000 + 1000).transformPositionByEpoch(sim.currentEpoch, this.position, this.referenceFrame);\r\n            this.isLookingAside = true;\r\n            this.zoomingAside++;\r\n\r\n        } else if (this.isLookingAside) {\r\n            this.startAnimation();\r\n        }\r\n\r\n        if (this.zoomingAside === 3) {\r\n            this.changeOrigin(objectToZoomTo, true);\r\n        }\r\n    }\r\n\r\n    onMouseDown(event) {\r\n        this.accountedMousePos = new Vector([event.clientX, event.clientY]);\r\n        this.currentMousePos = this.accountedMousePos.copy();\r\n        this.isMouseDown = true;\r\n        switch (event.button) {\r\n            case 0: //left\r\n                break;\r\n            case 1: // middle\r\n                break;\r\n            case 2:\r\n                this.rightButtonDown = true;\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n\r\n    onMouseMove(event) {\r\n        if (this.isMouseDown) {\r\n            this.isShiftDown = !!event.shiftKey;\r\n            this.currentMousePos.set(event.clientX, event.clientY);\r\n        }\r\n    }\r\n\r\n    onMouseUp(event) {\r\n        this.isMouseDown = false;\r\n        this.rightButtonDown = false;\r\n    }\r\n\r\n    onResize() {\r\n        this.threeCamera.aspect = this.domElement.width / this.domElement.height;\r\n        this.threeCamera.updateProjectionMatrix();\r\n    }\r\n\r\n    getTopDirection(epoch) {\r\n        return this.referenceFrame.getQuaternionByEpoch(epoch).mul_(this.quaternion).rotate_(new Vector([0,1,0]));\r\n    }\r\n\r\n    update(epoch) {\r\n        const rfQuaternion = this.referenceFrame.getQuaternionByEpoch(epoch);\r\n        let mouseShift = this.currentMousePos.sub(this.accountedMousePos);\r\n\r\n        if (this.isAnimnating) {\r\n            this.animate();\r\n        }\r\n\r\n        if (mouseShift[0] || mouseShift[1]) {\r\n            const polarConstraint = 0.00001;\r\n            const sensitivity = (this.isShiftDown ? 0.1 : 1) * sim.settings.ui.camera.mouseSensitivity;\r\n            const pole = new Vector([0, 0, 1]);\r\n            let poleAngle = this.position.angle(pole);\r\n            let verticalRotationAxis = this.rightButtonDown\r\n                ? this.quaternion.rotate(new Vector([0, 0, 1])).cross(pole)\r\n                : this.position.cross(pole);\r\n\r\n            let verticalQuaternion = new Quaternion(verticalRotationAxis, Math.min(Math.max(mouseShift[1] * sensitivity, poleAngle - Math.PI + polarConstraint), poleAngle - polarConstraint));\r\n            let mainQuaternion = (new Quaternion(pole, -mouseShift[0] * sensitivity)).mul_(verticalQuaternion);\r\n\r\n            if (!this.rightButtonDown) {\r\n                mainQuaternion.rotate_(this.position);\r\n            }\r\n            this.quaternion = mainQuaternion.mul_(this.quaternion);\r\n\r\n            this.accountedMousePos = this.currentMousePos.copy();\r\n        }\r\n        this.threeCamera.quaternion.copy(rfQuaternion.mul_(this.quaternion).toThreejs());\r\n        this.lastPosition = this.referenceFrame.transformPositionByEpoch(epoch, this.position, RF_BASE);\r\n    }\r\n}\r\n","import { sim } from \"../core/Simulation\";\r\n\r\nexport default class StarSystemEntry\r\n{\r\n    constructor(idx, alias, label, moduleName) {\r\n        this.idx = idx;\r\n        this.alias = alias;\r\n        this.label = label;\r\n        this.moduleName = moduleName;\r\n    }\r\n\r\n    // used in UI\r\n    get value() {\r\n        return this.alias;\r\n    }\r\n\r\n    load() {\r\n        if (sim.isModuleLoaded(this.moduleName)) {\r\n            sim.getModule(this.moduleName).loadStarSystem(this.alias);\r\n        } else {\r\n            sim.loadModule(this.moduleName, module => module.loadStarSystem(this.alias));\r\n        }\r\n    }\r\n}\r\n","import StarSystemEntry from \"./StarSystemEntry\";\r\n\r\nexport default class StarSystemManager {\r\n    constructor() {\r\n        this._starSystems = [];\r\n        this._loadedIdx = null;\r\n\r\n        // The first one loads by default\r\n        this.add(\"solar_system\", \"SolarSystem\", \"Solar System\");\r\n        this.add(\"ksp\", \"KSP\", \"KSP System\");\r\n    }\r\n\r\n    get starSystems() {\r\n        return this._starSystems;\r\n    }\r\n\r\n    get defaultStarSystemIdx() {\r\n        return 0;\r\n    }\r\n\r\n    get defaultStarSystem() {\r\n        return this._starSystems[this.defaultStarSystemIdx];\r\n    }\r\n\r\n    add(alias, module, label) {\r\n        const idx = this._starSystems.length;\r\n\r\n        this._starSystems.push(new StarSystemEntry(idx, alias, label, module));\r\n    }\r\n\r\n    loadDefault() {\r\n        this.loadByIdx(this.defaultStarSystemIdx);\r\n    }\r\n\r\n    loadByIdx(idx) {\r\n        if (idx === this._loadedIdx) {\r\n            return;\r\n        }\r\n\r\n        const starSystem = this._findStarSystemByIdx(idx);\r\n\r\n        if (!starSystem) {\r\n            return;\r\n        }\r\n\r\n        starSystem.load();\r\n        this._loadedIdx = idx;\r\n    }\r\n\r\n    getCurrentStarSystem() {\r\n        if (this._loadedIdx === null) {\r\n            return undefined;\r\n        }\r\n\r\n        return this._starSystems[this._loadedIdx];\r\n    }\r\n\r\n    _findStarSystemByIdx(idx) {\r\n        // TODO: Add idx validation\r\n\r\n        return this._starSystems[idx];\r\n    }\r\n}\r\n","import * as THREE from \"three\";\r\nimport $ from \"jquery\";\r\nimport EventHandler from \"./EventHandler\";\r\nimport {Vector} from \"./algebra\";\r\nimport Events from \"./Events\";\r\nimport {ReferenceFrame} from \"./ReferenceFrame/Factory\";\r\nimport TimeLine from \"../ui-legacy/TimeLine\";\r\nimport StarSystemLoader from \"../interface/StarSystemLoader\";\r\nimport VisualRaycaster from \"./visual/Raycaster\";\r\nimport SelectionHandler from \"../ui-legacy/SelectionHandler\";\r\nimport UI from \"../ui-legacy/UI\";\r\nimport StarSystem from \"./StarSystem\";\r\nimport Camera from \"../ui-legacy/Camera\";\r\nimport ReferenceFrameFactory from \"./ReferenceFrame/Factory\";\r\nimport StarSystemManager from \"../interface/StarSystemManager\";\r\n\r\nclass Simulation\r\n{\r\n    constructor() {\r\n        this.modules = {};\r\n        this.propagators = {};\r\n        this.renderLoopActive = false;\r\n        this.starSystemManager = new StarSystemManager();\r\n\r\n        this._initSettings();\r\n    }\r\n\r\n    init(viewPortDomElement, renderLoopFunction) {\r\n        this.renderLoopFunction = renderLoopFunction;\r\n\r\n        this.scene = new THREE.Scene();\r\n        this.scene.add(new THREE.AmbientLight(0xFFEFD5, 0.15));\r\n\r\n        this.textureLoader = new THREE.TextureLoader();\r\n\r\n        this.renderer = new THREE.WebGLRenderer({antialias: true, logarithmicDepthBuffer: true});\r\n        this.renderer.setSize(window.innerWidth, window.innerHeight);\r\n        this.domElement = viewPortDomElement;\r\n        this.domElement.appendChild(this.renderer.domElement);\r\n        window.addEventListener(\"resize\", this.onWindowResize.bind(this));\r\n\r\n        this.rendererEvents = new EventHandler(this.renderer.domElement);\r\n\r\n        this.selection = new SelectionHandler();\r\n\r\n        this.time = new TimeLine(0, 1, true);\r\n\r\n        this.camera = new Camera(this.renderer.domElement);\r\n\r\n        this.raycaster = new VisualRaycaster(this.renderer.domElement, this.camera.threeCamera, 7);\r\n\r\n        this.ui = new UI();\r\n\r\n        this.starSystemManager.loadDefault();\r\n\r\n        Events.dispatch(Events.INIT_DONE);\r\n    }\r\n\r\n    loadStarSystem(jsonFile, onLoadFinish) {\r\n        $.getJSON(\"./star_systems/\" + jsonFile, starSystemConfig => {\r\n            this.starSystem && this.starSystem.unload();\r\n            this.starSystem = new StarSystem(starSystemConfig.id);\r\n\r\n            StarSystemLoader.loadFromConfig(this.starSystem, starSystemConfig);\r\n\r\n            this.camera.init(\r\n                ReferenceFrameFactory.buildId(\r\n                    this.starSystem.mainObject,\r\n                    ReferenceFrame.INERTIAL_BODY_EQUATORIAL\r\n                ),\r\n                new Vector([30000, 30000, 20000])\r\n            );\r\n\r\n            onLoadFinish && onLoadFinish(this.starSystem);\r\n            Events.dispatch(Events.STAR_SYSTEM_LOADED, {starSystem: this.starSystem});\r\n\r\n            this.startRendering();\r\n        });\r\n    }\r\n\r\n    startRendering() {\r\n        this.renderLoopActive = true;\r\n        requestAnimationFrame(this.renderLoopFunction);\r\n    }\r\n\r\n    stopRendering() {\r\n        this.renderLoopActive = false;\r\n    }\r\n\r\n    get currentEpoch() {\r\n        return this.time.epoch;\r\n    }\r\n\r\n    get currentDate() {\r\n        return this.time.getDateByEpoch(this.time.epoch);\r\n    }\r\n\r\n    forceEpoch(epoch) {\r\n        return this.time.forceEpoch(epoch);\r\n    }\r\n\r\n    _initSettings() {\r\n        this.settings = {\r\n            ui: {\r\n                showBodyLabels: true,\r\n                showAnglesOfSelectedOrbit: true,\r\n                camera: {\r\n                    mouseSensitivity: 0.007,\r\n                    zoomFactor: 1.5\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    addEventListener(eventName, listener, priority) {\r\n        this.rendererEvents.addListener(eventName, listener, priority);\r\n    }\r\n\r\n    removeEventListener(eventName, listener) {\r\n        this.rendererEvents.removeListener(eventName, listener);\r\n    }\r\n\r\n    onWindowResize() {\r\n        this.renderer.setSize(window.innerWidth, window.innerHeight);\r\n        this.camera.onResize();\r\n    }\r\n\r\n    tick(timeDelta) {\r\n        this.time.tick(timeDelta);\r\n\r\n        this.camera.update(this.time.epoch);\r\n\r\n        Events.dispatch(Events.RENDER, {epoch: this.time.epoch});\r\n\r\n        if (this.renderLoopActive) {\r\n            this.renderer.render(this.scene, this.camera.threeCamera);\r\n        }\r\n    }\r\n\r\n    getVisualCoords(simCoords) {\r\n        return (new THREE.Vector3()).fromArray(simCoords.sub(this.camera.lastPosition));\r\n    }\r\n\r\n    getSimCoords(visualCoords) {\r\n        return (new Vector(visualCoords.toArray())).add_(this.camera.lastPosition);\r\n    }\r\n\r\n    loadModule(alias, callback) {\r\n        const className = 'Module' + alias;\r\n        import('../modules/' + alias + '/' + className).then((module) => {\r\n            this.modules[alias] = new module.default();\r\n            this.modules[alias].init();\r\n            callback && callback(this.modules[alias]);\r\n        });\r\n    }\r\n\r\n    getModule(alias) {\r\n        if (this.modules[alias] === undefined) {\r\n            throw new Error('Unknown module: ' + alias);\r\n        }\r\n        return this.modules[alias];\r\n    }\r\n\r\n    isModuleLoaded(alias) {\r\n        return this.modules[alias] !== undefined;\r\n    }\r\n\r\n    getClass(alias) {\r\n        const periodPos = alias.indexOf(\".\");\r\n        if (periodPos === -1) {\r\n            throw new Error('Incorrect class alias! Period expected in ' + alias);\r\n        }\r\n        return this.getModule(alias.substr(0, periodPos)).getClass(alias.substr(periodPos + 1));\r\n    }\r\n\r\n    addPropagator(alias, propagatorClass) {\r\n        this.propagators[alias] = propagatorClass;\r\n    }\r\n\r\n    getPropagator(alias) {\r\n        return this.propagators[alias];\r\n    }\r\n}\r\n\r\nexport const sim = new Simulation();\r\n","import FunctionOfEpochAbstract from \"./Abstract\";\r\nimport { sim } from \"../Simulation\";\r\n\r\nexport default class FunctionOfEpochObjectState extends FunctionOfEpochAbstract\r\n{\r\n    constructor(objectId, referenceFrame) {\r\n        super();\r\n        this.objectId = objectId;\r\n        this.referenceFrame = referenceFrame;\r\n    }\r\n\r\n    evaluate(epoch) {\r\n        return sim.starSystem.getObject(this.objectId).trajectory.getStateByEpoch(epoch, this.referenceFrame);\r\n    }\r\n}\r\n","import ReferenceFrameAbstract from \"./Abstract\";\r\nimport {RF_BASE} from \"./Factory\";\r\nimport {Vector} from \"../algebra\";\r\nimport StateVector from \"../StateVector\";\r\nimport { sim } from \"../Simulation\";\r\n\r\nexport default class ReferenceFrameBodyFixed extends ReferenceFrameAbstract\r\n{\r\n    constructor(origin, isInertial) {\r\n        super();\r\n        this.origin = origin;\r\n        this.isInertial = isInertial;\r\n        this.body = sim.starSystem.getObject(this.origin);\r\n    }\r\n\r\n    getQuaternionByEpoch(epoch) {\r\n        return this.body.orientation.getQuaternionByEpoch(epoch);\r\n    }\r\n\r\n    getOriginStateByEpoch(epoch) {\r\n        return sim.starSystem.getObject(this.origin).trajectory.getStateByEpoch(epoch, RF_BASE);\r\n    }\r\n\r\n    getOriginPositionByEpoch(epoch) {\r\n        return this.getOriginStateByEpoch(epoch).position;\r\n    }\r\n\r\n    getRotationVelocityByEpoch(epoch) {\r\n        return new Vector([0, 0, this.body.orientation.angularVel]);\r\n    }\r\n\r\n    stateVectorFromBaseReferenceFrameByEpoch(epoch, state) {\r\n        const originState = this.getOriginStateByEpoch(epoch);\r\n        const rotation = this.getQuaternionByEpoch(epoch).invert_();\r\n\r\n        const destPos = rotation.rotate(state.position.sub_(originState.position));\r\n        let destVel = rotation.rotate(state.velocity.sub_(originState.velocity));\r\n\r\n        if (!this.isInertial) {\r\n            const rfVel = destPos.cross(this.getRotationVelocityByEpoch(epoch));\r\n            destVel.add_(rfVel);\r\n        }\r\n\r\n        return new StateVector(\r\n            destPos,\r\n            destVel\r\n        );\r\n    }\r\n\r\n    stateVectorToBaseReferenceFrameByEpoch(epoch, state) {\r\n        const originState = this.getOriginStateByEpoch(epoch);\r\n        const rotation = this.getQuaternionByEpoch(epoch);\r\n\r\n        const destPos = rotation.rotate(state.position).add_(originState.position);\r\n        let destVel;\r\n\r\n        if (!this.isInertial) {\r\n            const rfVel = state.position.cross(this.getRotationVelocityByEpoch(epoch));\r\n            destVel = rotation.rotate(state.velocity.sub_(rfVel)).add_(originState.velocity);\r\n        } else {\r\n            destVel = rotation.rotate(state.velocity).add_(originState.velocity);\r\n        }\r\n\r\n        return new StateVector(\r\n            destPos,\r\n            destVel\r\n        );\r\n    }\r\n}\r\n","import ReferenceFrameAbstract from \"./Abstract\";\r\nimport {RF_BASE} from \"./Factory\";\r\n\r\nexport default class ReferenceFrameBase extends ReferenceFrameAbstract\r\n{\r\n    constructor() {\r\n        super();\r\n        this.setId(RF_BASE);\r\n    }\r\n}","import ReferenceFrameBodyFixed from \"./BodyFixed\";\r\nimport {Quaternion, Vector} from \"../algebra\";\r\nimport {RF_BASE} from \"./Factory\";\r\nimport StateVector from \"../StateVector\";\r\nimport { sim } from \"../Simulation\";\r\n\r\nexport default class ReferenceFrameTopocentric extends ReferenceFrameBodyFixed\r\n{\r\n    constructor(origin, lat, lon, height, isInertial) {\r\n        super(origin, isInertial);\r\n        this.bodyFixedQuaternion = new Quaternion().setFromEuler(0, -lat, lon, 'ZYX');\r\n        this.bodyFixedPosition = (new Vector([this.body.physicalModel.radius + height, 0, 0])).rotateY(-lat).rotateZ(lon);\r\n    }\r\n\r\n    getQuaternionByEpoch(epoch) {\r\n        return this.body.orientation.getQuaternionByEpoch(epoch).mul_(this.bodyFixedQuaternion)\r\n    }\r\n\r\n    getRotationVelocityByEpoch(epoch) {\r\n        return this.bodyFixedQuaternion.invert().rotate(\r\n            new Vector([0, 0, this.body.orientation.angularVel])\r\n        );\r\n    }\r\n\r\n    getOriginStateByEpoch(epoch) {\r\n        const bodyState = sim.starSystem.getObject(this.origin).trajectory.getStateByEpoch(epoch, RF_BASE);\r\n        const bodyQuaternion = this.body.orientation.getQuaternionByEpoch(epoch);\r\n\r\n        let rfVel = this.bodyFixedPosition.cross(\r\n            new Vector([0, 0, this.body.orientation.angularVel])\r\n        );\r\n\r\n        const destPos = bodyQuaternion.rotate(this.bodyFixedPosition).add_(bodyState.position);\r\n        const destVel = bodyQuaternion.rotate_(rfVel.mul_(-1)).add_(bodyState.velocity);\r\n\r\n        return new StateVector(\r\n            destPos,\r\n            destVel\r\n        );\r\n    }\r\n}\r\n","import FunctionOfEpochObjectState from \"../FunctionOfEpoch/ObjectState\";\r\nimport {Quaternion, Vector} from \"../algebra\";\r\nimport FunctionOfEpochCustom from \"../FunctionOfEpoch/Custom\";\r\nimport ReferenceFrameBodyFixed from \"./BodyFixed\";\r\nimport ReferenceFrameBase from \"./Base\";\r\nimport ReferenceFrameInertial from \"./Inertial\";\r\nimport ReferenceFrameInertialDynamic from \"./InertialDynamic\";\r\nimport Body from \"../Body\";\r\nimport ReferenceFrameTopocentric from \"./Topocentric\";\r\nimport { sim } from \"../Simulation\";\r\n\r\nexport default class ReferenceFrameFactory\r\n{\r\n    static create(id, type, config) {\r\n        let res = null;\r\n\r\n        if (type == ReferenceFrame.INERTIAL_ECLIPTIC) {\r\n            res = new ReferenceFrameInertial(\r\n                new FunctionOfEpochObjectState(config.origin, RF_BASE),\r\n                new Quaternion()\r\n            );\r\n        } else if (type == ReferenceFrame.INERTIAL_BODY_EQUATORIAL) {\r\n            if (sim.starSystem.getObject(config.origin) instanceof Body) {\r\n                res = new ReferenceFrameInertialDynamic(\r\n                    new FunctionOfEpochObjectState(config.origin, RF_BASE),\r\n                    new FunctionOfEpochCustom((epoch) => {\r\n                        const z = sim.starSystem.getObject(config.origin).orientation.getQuaternionByEpoch(epoch).rotate_(new Vector([0, 0, 1]));\r\n                        const equinox = z.cross(new Vector([0, 0, 1]));\r\n                        if (equinox.mag === 0) {\r\n                            return new Quaternion();\r\n                        }\r\n                        return Quaternion.transfer(new Vector([0, 0, 1]), z).mul_(\r\n                            Quaternion.transfer(new Vector([1, 0, 0]), equinox)\r\n                        );\r\n                    })\r\n                );\r\n            } else {\r\n                res = null;\r\n            }\r\n        } else if (type == ReferenceFrame.INERTIAL_PARENT_BODY_EQUATORIAL) {\r\n            res = new ReferenceFrameInertialDynamic(\r\n                new FunctionOfEpochObjectState(config.origin, RF_BASE),\r\n                new FunctionOfEpochCustom((epoch) => {\r\n                    const parentId = sim.starSystem.getObject(config.origin).getParentObjectIdByEpoch(epoch);\r\n                    const parent = sim.starSystem.getObject(parentId);\r\n\r\n                    if (parent instanceof Body) {\r\n                        const z = parent.orientation.getQuaternionByEpoch(epoch).rotate_(new Vector([0, 0, 1]));\r\n                        const equinox = z.cross(new Vector([0, 0, 1]));\r\n                        return Quaternion.transfer(new Vector([0, 0, 1]), z).mul_(\r\n                            Quaternion.transfer(new Vector([1, 0, 0]), equinox)\r\n                        );\r\n                    } else {\r\n                        return new Quaternion();\r\n                    }\r\n                })\r\n            );\r\n        } else if (type == ReferenceFrame.INERTIAL_BODY_FIXED) {\r\n            if (sim.starSystem.getObject(config.origin) instanceof Body) {\r\n                res = new ReferenceFrameBodyFixed(\r\n                    config.origin,\r\n                    true\r\n                );\r\n            } else {\r\n                res = null;\r\n            }\r\n        } else if (type == ReferenceFrame.INERTIAL_TOPOCENTRIC) {\r\n            if (sim.starSystem.getObject(config.origin) instanceof Body) {\r\n                res = new ReferenceFrameTopocentric(\r\n                    config.origin,\r\n                    config.lat,\r\n                    config.lon,\r\n                    config.height,\r\n                    true\r\n                );\r\n            } else {\r\n                res = null;\r\n            }\r\n        } else if (type == ReferenceFrame.BODY_FIXED) {\r\n            if (sim.starSystem.getObject(config.origin) instanceof Body) {\r\n                res = new ReferenceFrameBodyFixed(\r\n                    config.origin,\r\n                    false\r\n                );\r\n            } else {\r\n                res = null;\r\n            }\r\n        } else if (type == ReferenceFrame.TOPOCENTRIC) {\r\n            if (sim.starSystem.getObject(config.origin) instanceof Body) {\r\n                res = new ReferenceFrameTopocentric(\r\n                    config.origin,\r\n                    config.lat,\r\n                    config.lon,\r\n                    /* height */ undefined, // TODO: We need to investigate why\r\n                    false\r\n                );\r\n            } else {\r\n                res = null;\r\n            }\r\n        } else if (type == ReferenceFrame.BASE) {\r\n            res = new ReferenceFrameBase();\r\n        }\r\n\r\n        return res ? res.setId(id) : null;\r\n    }\r\n\r\n    static getOriginIdByReferenceFrameId(referenceFrameId) {\r\n        return Math.sign(referenceFrameId) * Math.floor(Math.abs(referenceFrameId) / 100000);\r\n    }\r\n\r\n    static getTypeByReferenceFrameId(referenceFrameId) {\r\n        return Math.floor((Math.abs(referenceFrameId) % 100000) / 1000);\r\n    }\r\n\r\n    static createById(id) {\r\n        const type = this.getTypeByReferenceFrameId(id);\r\n\r\n        if ((type === ReferenceFrame.INERTIAL_ECLIPTIC)\r\n            || (type === ReferenceFrame.INERTIAL_BODY_EQUATORIAL)\r\n            || (type === ReferenceFrame.INERTIAL_BODY_FIXED)\r\n            || (type === ReferenceFrame.BODY_FIXED)\r\n            || (type === ReferenceFrame.INERTIAL_PARENT_BODY_EQUATORIAL)\r\n        ) {\r\n            return this.create(id, type, {origin: this.getOriginIdByReferenceFrameId(id)});\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    static buildId(origin, type) {\r\n        if ((type === ReferenceFrame.INERTIAL_ECLIPTIC)\r\n            || (type === ReferenceFrame.INERTIAL_BODY_EQUATORIAL)\r\n            || (type === ReferenceFrame.INERTIAL_BODY_FIXED)\r\n            || (type === ReferenceFrame.BODY_FIXED)\r\n            || (type === ReferenceFrame.INERTIAL_PARENT_BODY_EQUATORIAL)\r\n        ) {\r\n            return (origin ? Math.sign(origin) : 1) * (Math.abs(origin) * 100000 + type * 1000);\r\n        }\r\n\r\n        return null;\r\n    }\r\n}\r\n\r\nexport const RF_BASE = 1000;\r\n\r\nexport let RF_BASE_OBJ = new ReferenceFrameBase();\r\n\r\nexport const ReferenceFrame = {\r\n    BASE: 0,\r\n    INERTIAL_ECLIPTIC: 1,\r\n    INERTIAL_BODY_EQUATORIAL: 2,\r\n    INERTIAL_BODY_FIXED: 3,\r\n    INERTIAL_TOPOCENTRIC: 4,\r\n    // : 5, vacant\r\n    BODY_FIXED: 6,\r\n    TOPOCENTRIC: 7,\r\n    INERTIAL_PARENT_BODY_EQUATORIAL: 8,\r\n};\r\n","export default class Events\r\n{\r\n    static dispatch(event, detail) {\r\n        let eventObj;\r\n        if (detail) {\r\n            eventObj = new CustomEvent(\r\n                event,\r\n                {detail: detail}\r\n            );\r\n        } else {\r\n            eventObj = new CustomEvent(event);\r\n        }\r\n        document.dispatchEvent(eventObj);\r\n    }\r\n\r\n    static addListener(event, handler) {\r\n        return document.addEventListener(event, handler);\r\n    }\r\n\r\n    static removeListener(event, handler) {\r\n        return document.removeEventListener(event, handler);\r\n    }\r\n\r\n    static LOADING_BODIES_DONE = 'urb_load_bodies_done';\r\n    static LOADING_FRAMES_DONE = 'urb_load_frames_done';\r\n    static LOADING_TRAJECTORIES_DONE = 'urb_load_traj_done';\r\n\r\n    static RENDER = 'urb_render';\r\n    static INIT_DONE = 'urb_init_done';\r\n    static STAR_SYSTEM_LOADED = 'urb_star_system_loading_done';\r\n    static SELECT = 'urb_select';\r\n    static DESELECT = 'urb_deselect';\r\n    static SHOW_ORBIT_ANGLES_CHANGED = 'urb_show_orbit_angles_change';\r\n    static CAMERA_RF_CHANGED = 'urb_camera_rf_change';\r\n    static OBJECT_ADDED = 'urb_object_added';\r\n    static TIME_SCALE_CHANGED = 'urb_time_scale_change';\r\n    static TIME_PAUSED = 'urb_time_paused';\r\n    static TIME_UNPAUSED = 'urb_time_unpaused';\r\n    static EPOCH_CHANGED = 'urb_epoch_change';\r\n}\r\n","import { RF_BASE } from \"./ReferenceFrame/Factory\";\r\n\r\nexport default class EphemerisObject\r\n{\r\n    constructor(bodyId, type, name, data) {\r\n        this.id   = bodyId;\r\n        this.type = type;\r\n        this.name = name;\r\n        this.data = data || {};\r\n    }\r\n\r\n    setTrajectory(trajectory) {\r\n        this.trajectory = trajectory;\r\n        this.trajectory.setObject(this);\r\n    }\r\n\r\n    getParentObjectIdByEpoch(epoch) {\r\n        if (!this.trajectory) {\r\n            return null;\r\n        }\r\n\r\n        const rf = this.trajectory.getReferenceFrameByEpoch(epoch);\r\n        if (!rf) {\r\n            return null;\r\n        }\r\n\r\n        return rf.originId;\r\n    }\r\n\r\n    getPositionByEpoch(epoch, referenceFrame) {\r\n        return this.trajectory.getPositionByEpoch(epoch, referenceFrame || RF_BASE);\r\n    }\r\n\r\n    drop() {\r\n        if (this.trajectory) {\r\n            this.trajectory.drop();\r\n            delete this.trajectory;\r\n        }\r\n    }\r\n}\r\n\r\nEphemerisObject.TYPE_UNKNOWN    = 0;\r\nEphemerisObject.TYPE_STAR       = 1;\r\nEphemerisObject.TYPE_PLANET     = 2;\r\nEphemerisObject.TYPE_PLANETOID  = 3;\r\nEphemerisObject.TYPE_SATELLITE  = 4;\r\nEphemerisObject.TYPE_ASTEROID   = 5;\r\nEphemerisObject.TYPE_COMET      = 6;\r\nEphemerisObject.TYPE_SPACECRAFT = 7;\r\nEphemerisObject.TYPE_POINT      = 8;\r\n","import {Vector} from \"./algebra\";\r\n\r\nexport default class StateVector\r\n{\r\n    constructor(position, velocity) {\r\n        this._position = position ? position.copy() : new Vector();\r\n        this._velocity = velocity ? velocity.copy() : new Vector();\r\n    }\r\n\r\n    get position() {\r\n        return this._position.copy();\r\n    }\r\n\r\n    get velocity() {\r\n        return this._velocity.copy();\r\n    }\r\n\r\n    static create(x, y, z, vx, vy, vz) {\r\n        return new this(\r\n            new Vector([ x || 0,  y || 0,  z || 0]),\r\n            new Vector([vx || 0, vy || 0, vz || 0])\r\n        );\r\n    }\r\n\r\n    copy() {\r\n        return new StateVector(this._position, this._velocity);\r\n    }\r\n\r\n    rotate_(quaternion) {\r\n        quaternion.rotate_(this._position);\r\n        quaternion.rotate_(this._velocity);\r\n        return this;\r\n    }\r\n\r\n    rotate(quaternion) {\r\n        return this.copy().rotate_(quaternion);\r\n    }\r\n}\r\n","import Events from \"../Events\";\r\nimport { sim } from \"../Simulation\";\r\n\r\nexport default class VisualModelAbstract\r\n{\r\n    constructor() {\r\n        this.threeObj = null;\r\n        this.scene = sim.scene;\r\n    }\r\n\r\n    setThreeObj(obj) {\r\n        this.threeObj = obj;\r\n        this.scene.add(this.threeObj);\r\n        this.renderListener = this._onRender.bind(this);\r\n        document.addEventListener(Events.RENDER, this.renderListener);\r\n    }\r\n\r\n    _onRender(event) {\r\n        try {\r\n            this.render(event.detail.epoch);\r\n        } catch (e) {\r\n            // console.log('Error', e);\r\n            this.threeObj.visible = false;\r\n        }\r\n    }\r\n\r\n    render(epoch) {}\r\n\r\n    drop() {\r\n        if (this.threeObj) {\r\n            this.scene.remove(this.threeObj);\r\n            this.threeObj.traverse(object => {\r\n                if (object.geometry) object.geometry.dispose();\r\n                if (object.material) object.material.dispose();\r\n            });\r\n            delete this.threeObj;\r\n        }\r\n        document.removeEventListener(Events.RENDER, this.renderListener);\r\n    }\r\n}\r\n\r\nVisualModelAbstract.texturePath = 'texture/';\r\n","import { sim } from \"./Simulation\";\r\nimport Events from \"./Events\";\r\n\r\nfunction init(statistics, viewPortId = \"viewport-id\") {\r\n    let globalTime;\r\n\r\n    function render(curTime) {\r\n        if (!sim.renderLoopActive) {\r\n            return;\r\n        }\r\n\r\n        sim.tick((curTime - globalTime) / 1000);\r\n\r\n        globalTime = curTime;\r\n        statistics.update();\r\n        requestAnimationFrame(render);\r\n    }\r\n\r\n    function firstRender(curTime) {\r\n        globalTime = curTime;\r\n        requestAnimationFrame(render);\r\n    }\r\n\r\n    sim.init(document.getElementById(viewPortId), firstRender);\r\n    sim.loadModule('PatchedConics');\r\n    sim.loadModule('SolarSystem');\r\n}\r\n\r\nexport {\r\n    init,\r\n    sim,\r\n    Events,\r\n}\r\n","import FunctionOfEpochAbstract from \"./Abstract\";\r\n\r\nexport default class FunctionOfEpochCustom extends FunctionOfEpochAbstract\r\n{\r\n    constructor(func) {\r\n        super();\r\n        this.func = func;\r\n    }\r\n\r\n    evaluate(epoch) {\r\n        return this.func(epoch);\r\n    }\r\n}","import {Quaternion, TWO_PI, Vector} from \"./algebra\";\r\nimport StateVector from \"./StateVector\";\r\n\r\nexport default class KeplerianObject\r\n{\r\n    constructor(e, sma, aop, inc, raan, anomaly, epoch, mu, isAnomalyTrue) {\r\n        this._mu    = mu;\r\n        this._sma   = sma;\r\n        this._e     = e;\r\n        this._inc   = inc;\r\n        this._raan  = raan;\r\n        this._aop   = aop;\r\n        this._epoch = epoch;\r\n\r\n        if ((isAnomalyTrue === undefined) || (isAnomalyTrue === true)) {\r\n            this.ta = anomaly;\r\n        } else {\r\n            this.m0 = anomaly;\r\n        }\r\n\r\n        this.updateMeanMotion();\r\n    }\r\n\r\n    setUpdateCallback(callback) {\r\n        this.updateCallback = callback;\r\n    }\r\n\r\n    copy() {\r\n        return new KeplerianObject(this._e, this._sma, this._aop, this._inc, this._raan, this.m0, this._epoch, this._mu, false);\r\n    }\r\n\r\n    updateMeanMotion() {\r\n        this.meanMotion = Math.sqrt(this._mu / Math.abs(this._sma)) / Math.abs(this._sma);\r\n    }\r\n\r\n    get isHyperbolic() {\r\n        return this._e > 1;\r\n    }\r\n\r\n    get isElliptic() {\r\n        return this._e < 1;\r\n    }\r\n\r\n    get mu() {\r\n        return this._mu;\r\n    }\r\n\r\n    set mu(value) {\r\n        this._mu = value;\r\n        this.updateMeanMotion();\r\n        this.updateCallback && this.updateCallback();\r\n    }\r\n\r\n    get sma() {\r\n        return this._sma;\r\n    }\r\n\r\n    set sma(value) {\r\n        this._sma = value;\r\n        this.updateMeanMotion();\r\n        this.updateCallback && this.updateCallback();\r\n    }\r\n\r\n    get e() {\r\n        return this._e;\r\n    }\r\n\r\n    set e(value) {\r\n        this._e = value;\r\n        this.updateCallback && this.updateCallback();\r\n    }\r\n\r\n    get ecc() {\r\n        return this._e;\r\n    }\r\n\r\n    set ecc(value) {\r\n        this.e = value;\r\n    }\r\n\r\n    get inc() {\r\n        return this._inc;\r\n    }\r\n\r\n    set inc(value) {\r\n        this._inc = value;\r\n        this.updateCallback && this.updateCallback();\r\n    }\r\n\r\n    get raan() {\r\n        return this._raan;\r\n    }\r\n\r\n    set raan(value) {\r\n        this._raan = value;\r\n        this.updateCallback && this.updateCallback();\r\n    }\r\n\r\n    get aop() {\r\n        return this._aop;\r\n    }\r\n\r\n    set aop(value) {\r\n        this._aop = value;\r\n        this.updateCallback && this.updateCallback();\r\n    }\r\n\r\n    get ta() {\r\n        return this.getTrueAnomalyByEpoch(this._epoch);\r\n    }\r\n\r\n    set ta(value) {\r\n        this.m0 = this.getMeanAnomalyByTrueAnomaly(value);\r\n        this.updateCallback && this.updateCallback();\r\n    }\r\n\r\n    get epoch() {\r\n        return this._epoch;\r\n    }\r\n\r\n    set epoch(value) {\r\n        this._epoch = value;\r\n        this.updateCallback && this.updateCallback();\r\n    }\r\n\r\n    get period() {\r\n        if (!this.isElliptic) {\r\n            return 0;\r\n        }\r\n        return 2 * Math.PI * Math.sqrt(this._sma * this._sma * this._sma / this._mu);\r\n    }\r\n\r\n    getNodalPrecessionRate(r, j2) {\r\n        return -3/2 * r * r * j2 * Math.cos(this.inc) * this.meanMotion / Math.pow(this.sma * (1 - this.e * this.e), 2);\r\n    }\r\n\r\n    getNodalPrecessionByEpoch(r, j2, epoch) {\r\n        return (epoch - this._epoch) * this.getNodalPrecessionRate(r, j2);\r\n    }\r\n\r\n    addPrecession(r, j2, epoch) {\r\n        this.m0 = this.getMeanAnomalyByEpoch(epoch);\r\n        this._raan += this.getNodalPrecessionByEpoch(r, j2, epoch);\r\n        this._epoch = epoch;\r\n        return this;\r\n    }\r\n\r\n    getMeanAnomalyByEpoch(epoch) {\r\n        return this.m0 + this.meanMotion * (epoch - this._epoch);\r\n    }\r\n\r\n    getEccentricAnomalyByEpoch(epoch) {\r\n        return this.getEccentricAnomalyByMeanAnomaly(\r\n            this.getMeanAnomalyByEpoch(epoch)\r\n        );\r\n    }\r\n\r\n    getTrueAnomalyByEpoch(epoch) {\r\n        return this.getTrueAnomalyByMeanAnomaly(\r\n            this.getMeanAnomalyByEpoch(epoch)\r\n        );\r\n    }\r\n\r\n    getMeanAnomalyByEccentricAnomaly(ea) {\r\n        if (this.isElliptic) {\r\n            return ea - this._e * Math.sin(ea);\r\n        } else {\r\n            return this._e * Math.sinh(ea) - ea;\r\n        }\r\n    }\r\n\r\n    getMeanAnomalyByTrueAnomaly(ta) {\r\n        return this.getMeanAnomalyByEccentricAnomaly(\r\n            this.getEccentricAnomalyByTrueAnomaly(ta)\r\n        );\r\n    }\r\n\r\n    getEccentricAnomalyByMeanAnomaly(ma) {\r\n        const maxIter = 30;\r\n        const delta = 0.00000001;\r\n        let M = ma;\r\n        let E, F, i = 0;\r\n\r\n        if (this.isElliptic) {\r\n            M = M / (2.0 * Math.PI);\r\n            M = 2.0 * Math.PI * (M - Math.floor(M));\r\n\r\n            E = (this._e < 0.8) ? M : Math.PI;\r\n\r\n            F = E - this._e * Math.sin(E) - M;\r\n\r\n            while ((Math.abs(F) > delta) && (i < maxIter)) {\r\n                E = E - F / (1.0 - this._e * Math.cos(E));\r\n                F = E - this._e * Math.sin(E) - M;\r\n                i = i + 1;\r\n            }\r\n        } else {\r\n            E = (Math.log(2 * (Math.abs(M) + 1/3)) + 1) / this._e + (1 - 1 / this._e) * Math.asinh(Math.abs(M) / this._e);\r\n            E *= Math.sign(M);\r\n\r\n            F = this._e * Math.sinh(E) - E - M;\r\n\r\n            while ((Math.abs(F) > delta) && (i < maxIter)) {\r\n                E = E - F / (this._e * Math.cosh(E) - 1);\r\n                F = this._e * Math.sinh(E) - E - M;\r\n                i = i + 1;\r\n            }\r\n        }\r\n\r\n        return E;\r\n    }\r\n\r\n    getEccentricAnomalyByTrueAnomaly(ta) {\r\n        if (this.isElliptic) {\r\n            const cos = Math.cos(ta);\r\n            const cosE = (this._e + cos) / (1 + this._e * cos);\r\n            return ((ta + TWO_PI) % TWO_PI <= Math.PI)\r\n                ? Math.acos(cosE)\r\n                : TWO_PI - Math.acos(cosE);\r\n        } else {\r\n            return 2 * Math.atanh(Math.tan(ta / 2) / Math.sqrt((this._e + 1) / (this._e - 1)));\r\n        }\r\n    }\r\n\r\n    getTrueAnomalyByMeanAnomaly(ma) {\r\n        return this.getTrueAnomalyByEccentricAnomaly(\r\n            this.getEccentricAnomalyByMeanAnomaly(ma)\r\n        );\r\n    }\r\n\r\n    getTrueAnomalyByEccentricAnomaly(ea) {\r\n        if (this.isElliptic) {\r\n            const phi = Math.atan2(Math.sqrt(1.0 - this._e * this._e) * Math.sin(ea), Math.cos(ea) - this._e);\r\n            return (phi >= 0) ? phi : (phi + 2 * Math.PI);\r\n        } else {\r\n            return 2 * Math.atan(Math.sqrt((this._e + 1) / (this._e - 1)) * Math.tanh(ea / 2));\r\n        }\r\n    }\r\n\r\n    getOwnCoordsByTrueAnomaly(ta) {\r\n        const r = this._sma * (1.0 - this._e * this._e) / (1 + this._e * Math.cos(ta));\r\n        return new Vector([r * Math.cos(ta), r * Math.sin(ta), 0]);\r\n    }\r\n\r\n    getAsymptoteTa() {\r\n        if (this.isElliptic) {\r\n            return false;\r\n        }\r\n        return Math.acos(-1 / this._e);\r\n    }\r\n\r\n    getPeriapsisRadius() {\r\n        return this._sma * (1 - this._e);\r\n    }\r\n\r\n    getApoapsisRadius() {\r\n        return this._sma * (1 + this._e);\r\n    }\r\n\r\n    getPeriapsisSpeed() {\r\n        return Math.sqrt(this._mu * (2 / this.getPeriapsisRadius() - 1 / this._sma));\r\n    }\r\n\r\n    getApoapsisSpeed() {\r\n        return Math.sqrt(this._mu * (2 / this.getApoapsisRadius() - 1 / this._sma));\r\n    }\r\n\r\n    getEpochByTrueAnomaly(ta) {\r\n        if (ta === null) {\r\n            return null;\r\n        }\r\n        let diff = this.getMeanAnomalyByTrueAnomaly(ta) - this.m0;\r\n        if (diff < 0 && this.isElliptic) {\r\n            diff += TWO_PI;\r\n        }\r\n        return this._epoch + diff / this.meanMotion;\r\n    }\r\n\r\n    getSphereCrossingTrueAnomaly(radius) {\r\n        const apoR = this.getApoapsisRadius();\r\n        if ((apoR > 0 && radius > apoR) || radius < this.getPeriapsisRadius()) {\r\n            return false;\r\n        }\r\n        const ta = Math.acos((this._sma * (1.0 - this._e * this._e) / radius - 1) / this._e);\r\n        return [ta, TWO_PI - ta];\r\n    }\r\n\r\n    getPlaneCrossingTrueAnomaly(distanceToPlane) {\r\n        const a = this._sma * (1 - this._e * this._e) * Math.sin(this._inc) / distanceToPlane;\r\n        const b = this._e;\r\n        const c = Math.cos(this._aop);\r\n        const d = Math.sin(this._aop);\r\n        let taHigh = this._planeCrossingHelper( a * c,  a * d - b);  // top boundary\r\n        let taLow  = this._planeCrossingHelper(-a * c, -a * d - b);  // bottom boundary\r\n        let range1 = null;\r\n        let range2 = null;\r\n\r\n        if (taHigh === false && taLow === false) {\r\n            return false;\r\n        }\r\n\r\n        if (this.isHyperbolic) {\r\n            if (taHigh instanceof Array) {\r\n                if (!taLow instanceof Array) {\r\n                    return [taHigh];\r\n                }\r\n                return [\r\n                    [Math.min(taHigh[0], taLow[0]), Math.max(taHigh[0], taLow[0])],\r\n                    [Math.min(taHigh[1], taLow[1]), Math.max(taHigh[1], taLow[1])]\r\n                ];\r\n            }\r\n            if (taLow instanceof Array) {\r\n                return [taLow];\r\n            }\r\n            if (taHigh !== false && taLow !== false) {\r\n                return [[Math.min(taLow, taHigh), Math.max(taLow, taHigh)]];\r\n            }\r\n            // TODO implement\r\n            // this is a rare case where either taHigh or taLow is a number,\r\n            // which means that hyperbola asymptote is parallel to the horizontal plane\r\n            console.log('Error! getPlaneCrossingTrueAnomaly() not implemented!');\r\n            return false;\r\n        }\r\n\r\n        if (taHigh !== false) {\r\n            if (((this._aop + taHigh[0]) % TWO_PI) < ((this._aop + taHigh[1]) % TWO_PI)) {\r\n                range1 = [taHigh[1], taHigh[0]];\r\n            } else {\r\n                range1 = [taHigh[0], taHigh[1]];\r\n            }\r\n        }\r\n\r\n        if (taLow !== false) {\r\n            if (((this._aop + taLow[0]) % TWO_PI) < ((this._aop + taLow[1]) % TWO_PI)) {\r\n                range2 = [taLow[1], taLow[0]];\r\n            } else {\r\n                range2 = [taLow[0], taLow[1]];\r\n            }\r\n            return range1\r\n                ? [\r\n                    [range1[0], range2[1]],\r\n                    [range2[0], range1[1]]\r\n                ]\r\n                : [range2];\r\n        }\r\n\r\n        return [range1];\r\n    }\r\n\r\n    _planeCrossingHelper(a, b) {\r\n        const temp1 = a*a + b*b;\r\n        const temp2 = Math.sqrt(a*a * (temp1 - 1));\r\n        let ta1 = Math.atan2(\r\n            ((b * temp2 - b*b) / temp1 + 1) / a,\r\n            (b - temp2) / temp1\r\n        );\r\n\r\n        if (isNaN(ta1)) {\r\n            return false;\r\n        }\r\n\r\n        let ta2 = Math.atan2(\r\n            ((-b * temp2 - b*b) / temp1 + 1) / a,\r\n            (b + temp2) / temp1\r\n        );\r\n        if (this.isElliptic) {\r\n            return [\r\n                ta1 < 0 ? ta1 + TWO_PI : ta1,\r\n                ta2 < 0 ? ta2 + TWO_PI : ta2\r\n            ];\r\n        } else {\r\n            const asymptote = this.getAsymptoteTa();\r\n            ta1 = this._validateHyperbolicTa(asymptote, ta1);\r\n            ta2 = this._validateHyperbolicTa(asymptote, ta2);\r\n            if (ta1 !== false && ta2 !== false && ta1 !== ta2) {\r\n                return [Math.min(ta1, ta2), Math.max(ta1, ta2)];\r\n            } else if (ta1 !== false) {\r\n                return ta1;\r\n            } else if (ta2 !== false) {\r\n                return ta2;\r\n            } else {\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n\r\n    _validateHyperbolicTa(asymptote, ta) {\r\n        if (ta > Math.PI) {\r\n            ta -= TWO_PI;\r\n        }\r\n        if (ta > asymptote || ta < -asymptote) {\r\n            return false;\r\n        }\r\n        if (Math.abs(ta - Math.sign(ta) * asymptote) < 1e-14) {\r\n            return false;\r\n        }\r\n        return ta;\r\n    }\r\n\r\n    /**\r\n     *  @see http://microsat.sm.bmstu.ru/e-library/Ballistics/kepler.pdf\r\n     */\r\n    getStateByEpoch(epoch) {\r\n        if (this.isElliptic) {\r\n            const ea = this.getEccentricAnomalyByEpoch(epoch);\r\n            const cos = Math.cos(ea);\r\n            const sin = Math.sin(ea);\r\n            const koeff = Math.sqrt(this._mu / this._sma) / (1 - this._e * cos);\r\n\r\n            let pos = new Vector([\r\n                this._sma * (cos - this._e),\r\n                this._sma * Math.sqrt(1 - this._e * this._e) * sin,\r\n                0\r\n            ]);\r\n\r\n            let vel = new Vector([\r\n                -koeff * sin,\r\n                koeff * Math.sqrt(1 - this._e * this._e) * cos,\r\n                0\r\n            ]);\r\n\r\n            return new StateVector(\r\n                pos.rotateZ(this._aop).rotateX(this._inc).rotateZ(this._raan),\r\n                vel.rotateZ(this._aop).rotateX(this._inc).rotateZ(this._raan)\r\n            );\r\n        } else {\r\n            const ta = this.getTrueAnomalyByEpoch(epoch);\r\n            const orbitalQuat = this.getOrbitalFrameQuaternion();\r\n            const pos = this.getOwnCoordsByTrueAnomaly(ta);\r\n            const flightPathAngle = Math.atan(this._e * Math.sin(ta) / (1 + this._e * Math.cos(ta)));\r\n            let vel = new Vector([Math.sqrt(this._mu * (2 / pos.mag - 1 / this._sma)), 0, 0]);\r\n\r\n            return new StateVector(\r\n                orbitalQuat.rotate_(pos),\r\n                orbitalQuat.rotate_(vel.rotateZ(ta + Math.PI / 2 - flightPathAngle)),\r\n            );\r\n        }\r\n    }\r\n\r\n    getNormalVector() {\r\n        const nodeQuaternion = new Quaternion(new Vector([0, 0, 1]), this._raan);\r\n        const normalQuaternion = new Quaternion(nodeQuaternion.rotate_(new Vector([1, 0, 0])), this._inc);\r\n\r\n        return normalQuaternion.rotate_(new Vector([0, 0, 1]));\r\n    }\r\n\r\n    getPeriapsisVector() {\r\n        return this.getOrbitalFrameQuaternion().rotate_(new Vector([1, 0, 0]));\r\n    }\r\n\r\n    getOrbitalFrameQuaternion() {\r\n        return (new Quaternion(new Vector([0, 0, 1]), this._raan))\r\n            .mul_(new Quaternion(new Vector([1, 0, 0]), this._inc))\r\n            .mul_(new Quaternion(new Vector([0, 0, 1]), this._aop))\r\n        ;\r\n    }\r\n\r\n    /**\r\n     *  @see http://microsat.sm.bmstu.ru/e-library/Ballistics/kepler.pdf\r\n     */\r\n    static createFromState(state, mu, epoch) {\r\n        epoch = epoch || 0;\r\n\r\n        if (!state) {\r\n            return null;\r\n        }\r\n\r\n        const pos = state.position;\r\n        const vel = state.velocity;\r\n\r\n        const angMomentum = pos.cross(vel);\r\n\r\n        const raan = Math.atan2(angMomentum.x, -angMomentum.y);\r\n        const inc = Math.atan2((Math.sqrt(Math.pow(angMomentum.x, 2) + Math.pow(angMomentum.y, 2))) , angMomentum.z);\r\n        const sma = (mu * pos.mag) / (2.0 * mu - pos.mag * Math.pow(vel.mag, 2));\r\n        const e = Math.sqrt(1.0 - Math.min(1, Math.pow(angMomentum.mag, 2) / (mu * sma)));\r\n\r\n        const p = pos.rotateZ(-raan).rotateX(-inc);\r\n        const u = Math.atan2(p.y , p.x);\r\n\r\n        const radVel = pos.dot(vel);\r\n        const ta = Math.acos(Math.min(1, Math.max(-1, (sma*(1 - e*e) / pos.mag - 1) / e))) * Math.sign(radVel);\r\n\r\n        const aop = ((u - ta) > 0) ? (u - ta) : 2 * Math.PI + (u - ta);\r\n\r\n        return new KeplerianObject(e, sma, aop, inc, raan, ta, epoch, mu, true);\r\n    }\r\n\r\n}\r\n","import EphemerisObject from \"./EphemerisObject\";\r\n\r\nexport default class Body extends EphemerisObject\r\n{\r\n    constructor(bodyId, type, name, data, visualModel, physicalModel, orientation) {\r\n        super(bodyId, type, name, data);\r\n\r\n        this.visualModel   = visualModel;    // class VisualBodyModelBasic\r\n        this.physicalModel = physicalModel;  // class PhysicalBodyModel\r\n        this.orientation   = orientation;    // class OrientationAbstract\r\n\r\n        if (this.visualModel) {\r\n            this.visualModel.setObject(this);\r\n        }\r\n    }\r\n\r\n    drop() {\r\n        if (this.visualModel) {\r\n            this.visualModel.drop();\r\n            delete this.visualModel;\r\n        }\r\n        super.drop();\r\n    }\r\n}\r\n","import TrajectoryKeplerianAbstract from \"./KeplerianAbstract\";\r\n\r\nexport default class TrajectoryKeplerianBasic extends TrajectoryKeplerianAbstract\r\n{\r\n    constructor(referenceFrameId, keplerianObject) {\r\n        super(referenceFrameId);\r\n        this.keplerianObject = keplerianObject;\r\n    }\r\n\r\n    setUpdateCallback(callback) {\r\n        this.keplerianObject.setUpdateCallback(() => callback(this));\r\n    }\r\n\r\n    get mu() {\r\n        return this.keplerianObject.mu;\r\n    }\r\n\r\n    set mu(value) {\r\n        this.keplerianObject.mu = value;\r\n    }\r\n\r\n    get sma() {\r\n        return this.keplerianObject.sma;\r\n    }\r\n\r\n    set sma(value) {\r\n        this.keplerianObject.sma = value;\r\n    }\r\n\r\n    get ecc() {\r\n        return this.keplerianObject.ecc;\r\n    }\r\n\r\n    set ecc(value) {\r\n        this.keplerianObject.ecc = value;\r\n    }\r\n\r\n    get inc() {\r\n        return this.keplerianObject.inc;\r\n    }\r\n\r\n    set inc(value) {\r\n        this.keplerianObject.inc = value;\r\n    }\r\n\r\n    get raan() {\r\n        return this.keplerianObject.raan;\r\n    }\r\n\r\n    set raan(value) {\r\n        this.keplerianObject.raan = value;\r\n    }\r\n\r\n    get aop() {\r\n        return this.keplerianObject.aop;\r\n    }\r\n\r\n    set aop(value) {\r\n        this.keplerianObject.aop = value;\r\n    }\r\n\r\n    get ta() {\r\n        return this.keplerianObject.ta;\r\n    }\r\n\r\n    set ta(value) {\r\n        this.keplerianObject.ta = value;\r\n    }\r\n\r\n    get epoch() {\r\n        return this.keplerianObject.epoch;\r\n    }\r\n\r\n    set epoch(value) {\r\n        this.keplerianObject.epoch = value;\r\n    }\r\n\r\n    getKeplerianObjectByEpoch(epoch, referenceFrameOrId) {\r\n        this.validateEpoch(epoch);\r\n        return this._transformKeplerianObject(this.keplerianObject, referenceFrameOrId);\r\n    }\r\n}\r\n","import {Quaternion, Vector} from \"../algebra\";\r\nimport StateVector from \"../StateVector\";\r\nimport {RF_BASE} from \"./Factory\";\r\nimport ReferenceFrameFactory from \"./Factory\";\r\nimport { sim } from \"../Simulation\";\r\n\r\nexport default class ReferenceFrameAbstract\r\n{\r\n    setId(id) {\r\n        this.id = id;\r\n        this.originId = ReferenceFrameFactory.getOriginIdByReferenceFrameId(id);\r\n        this.type = ReferenceFrameFactory.getTypeByReferenceFrameId(id);\r\n        return this;\r\n    }\r\n\r\n    get mu() {\r\n        if (this._mu === undefined) {\r\n            const obj = sim.starSystem.getObject(this.originId);\r\n            this._mu = obj.physicalModel\r\n                ? obj.physicalModel.mu\r\n                : null;\r\n        }\r\n        return this._mu;\r\n    }\r\n\r\n    getQuaternionByEpoch(epoch) {\r\n        return new Quaternion();\r\n    }\r\n\r\n    getOriginPositionByEpoch(epoch) {\r\n        return new Vector(3);\r\n    }\r\n\r\n    getOriginStateByEpoch(epoch) {\r\n        return new StateVector();\r\n    }\r\n\r\n    transformStateVectorByEpoch(epoch, state, destinationFrameOrId) {\r\n        let destinationFrame = (destinationFrameOrId instanceof ReferenceFrameAbstract)\r\n            ? destinationFrameOrId\r\n            : sim.starSystem.getReferenceFrame(destinationFrameOrId);\r\n\r\n        if (this === destinationFrame) {\r\n            return state;\r\n        }\r\n\r\n        if (this.id === RF_BASE) {\r\n            return destinationFrame.stateVectorFromBaseReferenceFrameByEpoch(\r\n                epoch,\r\n                state\r\n            );\r\n        }\r\n\r\n        if (destinationFrame.id === RF_BASE) {\r\n            return this.stateVectorToBaseReferenceFrameByEpoch(epoch, state);\r\n        }\r\n\r\n        return destinationFrame.stateVectorFromBaseReferenceFrameByEpoch(\r\n            epoch,\r\n            this.stateVectorToBaseReferenceFrameByEpoch(epoch, state)\r\n        );\r\n    }\r\n\r\n    transformPositionByEpoch(epoch, pos, destinationFrameOrId) {\r\n        return this.transformStateVectorByEpoch(\r\n            epoch,\r\n            new StateVector(pos),\r\n            destinationFrameOrId\r\n        ).position;\r\n    }\r\n\r\n    rotateVectorByEpoch(epoch, vec, destinationFrameOrId) {\r\n        let destinationFrame = (destinationFrameOrId instanceof ReferenceFrameAbstract)\r\n            ? destinationFrameOrId\r\n            : sim.starSystem.getReferenceFrame(destinationFrameOrId);\r\n\r\n        if (this === destinationFrame) {\r\n            return vec.copy();\r\n        }\r\n\r\n        return destinationFrame.getQuaternionByEpoch(epoch).invert_().mul_(this.getQuaternionByEpoch(epoch)).rotate(vec);\r\n    }\r\n\r\n    stateVectorFromBaseReferenceFrameByEpoch(epoch, state) {}\r\n    stateVectorToBaseReferenceFrameByEpoch(epoch, state) {}\r\n}\r\n","import * as THREE from \"three\";\r\n\r\nimport VisualTrajectoryModelAbstract from \"./Abstract\";\r\nimport {RF_BASE} from \"../../ReferenceFrame/Factory\";\r\nimport {getAngleBySinCos, Vector} from \"../../algebra\";\r\nimport FunctionOfEpochCustom from \"../../FunctionOfEpoch/Custom\";\r\nimport ReferenceFrameInertial from \"../../ReferenceFrame/Inertial\";\r\nimport { sim } from \"../../Simulation\";\r\n\r\nexport default class VisualTrajectoryModelKeplerian extends VisualTrajectoryModelAbstract\r\n{\r\n    render(epoch)\r\n    {\r\n        super.render(epoch);\r\n\r\n        const renderingEpoch = this.getRenderingEpoch(epoch);\r\n\r\n        if (renderingEpoch === null) {\r\n            this.threeObj.visible = false;\r\n            return;\r\n        }\r\n\r\n        const keplerianObject = this.trajectory.getKeplerianObjectByEpoch(renderingEpoch);\r\n\r\n        if (keplerianObject.isElliptic) {\r\n            this.renderEllipse(keplerianObject, renderingEpoch, epoch);\r\n        } else {\r\n            this.renderHyperbola(keplerianObject, renderingEpoch, epoch);\r\n        }\r\n    }\r\n\r\n    renderHyperbola(traj, epoch, locationEpoch) {\r\n        const endingBrightness = 0.35;\r\n        const pointsNum = 100;\r\n\r\n        let maxTa = traj.getAsymptoteTa();\r\n        let minTa = -maxTa;\r\n\r\n        if (this.trajectory.minEpoch !== null && this.trajectory.minEpoch !== false) {\r\n            minTa = traj.getTrueAnomalyByEpoch(this.trajectory.minEpoch);\r\n        }\r\n        if (this.trajectory.maxEpoch !== null && this.trajectory.maxEpoch !== false) {\r\n            maxTa = traj.getTrueAnomalyByEpoch(this.trajectory.maxEpoch);\r\n        }\r\n\r\n        const orbitQuaternion = this.trajectory.pericentricReferenceFrame.getQuaternionByEpoch(epoch);\r\n        const curTa = traj.getTrueAnomalyByEpoch(epoch);\r\n        const taCut = (maxTa - minTa) / (pointsNum + 1);\r\n\r\n        let points = [];\r\n        let angs = [];\r\n        let ta = minTa + taCut;\r\n        let i = 0;\r\n\r\n        if (ta > (minTa + curTa) / 2) {\r\n            ta = (minTa + curTa) / 2;\r\n        }\r\n\r\n        const taStep = (Math.max(maxTa - taCut, curTa) - ta) / (pointsNum - 1);\r\n        let extraPoints = 0;\r\n\r\n        while (i < pointsNum + extraPoints) {\r\n            let coords = traj.getOwnCoordsByTrueAnomaly(ta);\r\n            points[i] = (new THREE.Vector2()).fromArray([coords[0], coords[1]]);\r\n            angs[i] = (ta > curTa) ? 0 : ((curTa == minTa) ? 1 : (ta - minTa) / (curTa - minTa));\r\n            i  += 1;\r\n            ta += taStep;\r\n\r\n            if (ta - taStep <= curTa && curTa < ta) {\r\n                coords = traj.getOwnCoordsByTrueAnomaly(curTa);\r\n                points[i] = (new THREE.Vector2()).fromArray([coords[0], coords[1]]);\r\n                angs[i] = 1;\r\n                i  += 1;\r\n                points[i] = (new THREE.Vector2()).fromArray([coords[0], coords[1]]);\r\n                angs[i] = 0;\r\n                i  += 1;\r\n                extraPoints += 2;\r\n            }\r\n        }\r\n\r\n        this.threeObj.visible = true;\r\n        this.updateGeometry(points, angs, endingBrightness);\r\n\r\n        this.threeObj.quaternion.copy(orbitQuaternion.toThreejs());\r\n        this.threeObj.position.copy(sim.getVisualCoords(this.trajectory.referenceFrame.getOriginPositionByEpoch(locationEpoch)));\r\n    }\r\n\r\n    renderEllipse(traj, epoch, locationEpoch) {\r\n        const endingBrightness = 0.35;\r\n        const pointsNum = 100;\r\n        const referenceFrame = new ReferenceFrameInertial(\r\n            new FunctionOfEpochCustom(epoch => this.trajectory.getReferenceFrameByEpoch(epoch).getOriginStateByEpoch(locationEpoch)),\r\n            this.trajectory.pericentricReferenceFrame.getQuaternionByEpoch(epoch)\r\n        );\r\n\r\n        const orbitQuaternion = this.trajectory.pericentricReferenceFrame.getQuaternionByEpoch(epoch);\r\n        const cameraPosition = sim.starSystem.getReferenceFrame(RF_BASE).transformPositionByEpoch(locationEpoch, sim.camera.lastPosition, referenceFrame);\r\n        const visualOrigin = new Vector([cameraPosition.x, cameraPosition.y, 0]);\r\n        const actualVisualOrigin = referenceFrame.transformPositionByEpoch(locationEpoch, visualOrigin, RF_BASE);\r\n        const ta = traj.getTrueAnomalyByEpoch(epoch);\r\n        const sinE = visualOrigin.y / visualOrigin.mag;\r\n        const cosE = visualOrigin.x / visualOrigin.mag;\r\n        const cameraTrueAnomaly = getAngleBySinCos(sinE, cosE);\r\n        const toClosestPoint = traj.getOwnCoordsByTrueAnomaly(cameraTrueAnomaly)                // not really closest\r\n            .sub(cameraPosition).mag;\r\n        const toFarthestPoint = traj.getOwnCoordsByTrueAnomaly(cameraTrueAnomaly + Math.PI)     // not really farthest\r\n            .sub(cameraPosition).mag;\r\n        let cameraAngle = Math.acos(\r\n            (traj.e + Math.cos(cameraTrueAnomaly)) / (1 + traj.e * Math.cos(cameraTrueAnomaly))\r\n        );\r\n        let ang = Math.acos(\r\n            (traj.e + Math.cos(ta)) / (1 + traj.e * Math.cos(ta))\r\n        );\r\n\r\n        if (ta > Math.PI) {\r\n            ang = 2 * Math.PI - ang;\r\n        }\r\n        if (cameraTrueAnomaly > Math.PI) {\r\n            cameraAngle = 2 * Math.PI - cameraAngle;\r\n        }\r\n\r\n        const ellipsePoints = this.getEllipsePoints(\r\n            new THREE.EllipseCurve(\r\n                -traj.sma * traj.e - visualOrigin.x,\r\n                -visualOrigin.y,\r\n                traj.sma,\r\n                traj.sma * Math.sqrt(1 - traj.e * traj.e),\r\n                ang,\r\n                2 * Math.PI + ang - 0.0000000000001,  // protection from rounding errors\r\n                false,\r\n                0\r\n            ),\r\n            pointsNum,\r\n            ((cameraAngle - ang) / (2 * Math.PI) + 1) % 1,\r\n            toFarthestPoint / toClosestPoint\r\n        );\r\n        this.threeObj.visible = true;\r\n        this.updateGeometry(ellipsePoints.coords, ellipsePoints.angs, endingBrightness);\r\n\r\n        this.threeObj.quaternion.copy(orbitQuaternion.toThreejs());\r\n        this.threeObj.position.copy(sim.getVisualCoords(actualVisualOrigin));\r\n    }\r\n\r\n    getEllipsePoints(curve, pointsNum, densityCenter, proportion) {\r\n        let nearSegmentSize = 0.25;\r\n        if (proportion > 30) {\r\n            nearSegmentSize = 1 / ((Math.min(proportion, 530) - 30) / 60 + 4);\r\n            proportion = 30;\r\n        }\r\n\r\n        let coords = [];\r\n        let angs = [];\r\n        const segments = pointsNum - 3;\r\n        const otherSegmentsSize = (1 - nearSegmentSize) / 3;\r\n        const segmentsFar    = Math.floor(segments / (proportion + 2 * Math.sqrt(proportion) + 1));\r\n        const segmentsMedium = Math.floor(Math.sqrt(proportion) * segmentsFar);\r\n        const segmentsNear   = segments - segmentsFar - 2 * segmentsMedium;\r\n        let curPos = densityCenter - nearSegmentSize / 2;\r\n\r\n        if (curPos < 0) {\r\n            curPos += 1;\r\n        }\r\n        coords.push(curve.getPoint(curPos));\r\n        angs.push(curPos);\r\n\r\n        for (const partSize of [[segmentsNear, nearSegmentSize], [segmentsMedium, otherSegmentsSize], [segmentsFar, otherSegmentsSize], [segmentsMedium, otherSegmentsSize]]) {\r\n            for (let i = 0; i < partSize[0]; ++i) {\r\n                curPos += partSize[1] / partSize[0];\r\n                if (curPos > 1) {\r\n                    coords.push(curve.getPoint(1));\r\n                    angs.push(1);\r\n                    coords.push(curve.getPoint(0));\r\n                    angs.push(0);\r\n                    curPos -= 1;\r\n                }\r\n                coords.push(curve.getPoint(curPos));\r\n                angs.push(curPos);\r\n            }\r\n        }\r\n\r\n        return {\r\n            coords: coords,\r\n            angs: angs\r\n        }\r\n    }\r\n}\r\n","export default class FunctionOfEpochAbstract\r\n{\r\n    evaluate(epoch) {\r\n        return null;\r\n    }\r\n}\r\n","import TrajectoryAbstract from \"./Abstract\";\r\nimport ExceptionOutOfRange from \"./ExceptionOutOfRange\";\r\n\r\nexport default class TrajectoryComposite extends TrajectoryAbstract\r\n{\r\n    constructor() {\r\n        super();\r\n        this.components = [];\r\n        this.lastUsedTrajectory = null;\r\n        this.isSelected = false;\r\n    }\r\n\r\n    select() {\r\n        this.isSelected = true;\r\n        this.visualModel && this.visualModel.select();\r\n        this.components.map(traj => traj.select());\r\n    }\r\n\r\n    deselect() {\r\n        super.deselect();\r\n        this.components.map(traj => traj.deselect());\r\n    }\r\n\r\n    drop() {\r\n        super.drop();\r\n        this.components.map(traj => traj.drop());\r\n    }\r\n\r\n    isEditableAtEpoch(epoch) {\r\n        return this.getComponentByEpoch(epoch).isEditableAtEpoch(epoch);\r\n    }\r\n\r\n    getReferenceFrameByEpoch(epoch) {\r\n        return this.getComponentByEpoch(epoch).getReferenceFrameByEpoch(epoch);\r\n    }\r\n\r\n    getStateInOwnFrameByEpoch(epoch) {\r\n        return this.getComponentByEpoch(epoch).getStateInOwnFrameByEpoch(epoch);\r\n    }\r\n\r\n    getKeplerianObjectByEpoch(epoch) {\r\n        return this.getComponentByEpoch(epoch).getKeplerianObjectByEpoch(epoch);\r\n    }\r\n\r\n    getStateByEpoch(epoch, referenceFrameOrId) {\r\n        return this.getComponentByEpoch(epoch).getStateByEpoch(epoch, referenceFrameOrId);\r\n    }\r\n\r\n    getComponentByEpoch(epoch) {\r\n        if (this.lastUsedTrajectory\r\n            && (this.lastUsedTrajectory.minEpoch <= epoch || this.lastUsedTrajectory.minEpoch === false)\r\n            && (this.lastUsedTrajectory.maxEpoch >= epoch || this.lastUsedTrajectory.maxEpoch === false)\r\n        ) {\r\n            return this.lastUsedTrajectory;\r\n        }\r\n\r\n        for (let trajectory of this.components) {\r\n            if ((trajectory.minEpoch <= epoch || trajectory.minEpoch === false)\r\n                && (trajectory.maxEpoch >= epoch || trajectory.maxEpoch === false)\r\n            ) {\r\n                this.lastUsedTrajectory = trajectory;\r\n                return trajectory;\r\n            }\r\n        }\r\n\r\n        throw new ExceptionOutOfRange(this.object, epoch, this.minEpoch, this.maxEpoch);\r\n    }\r\n\r\n    addComponent(trajectory) {\r\n        this.components.push(trajectory);\r\n        trajectory.setParent(this);\r\n\r\n        if (this.isSelected) {\r\n            trajectory.select();\r\n        }\r\n\r\n        if (this.minEpoch === null\r\n            || (trajectory.minEpoch !== null\r\n                && trajectory.minEpoch !== false\r\n                && this.minEpoch > trajectory.minEpoch\r\n            )\r\n        ) {\r\n            this.minEpoch = trajectory.minEpoch;\r\n        }\r\n        if (this.maxEpoch === null\r\n            || (trajectory.maxEpoch !== null\r\n                && trajectory.maxEpoch !== false\r\n                && this.maxEpoch < trajectory.maxEpoch\r\n            )\r\n        ) {\r\n            this.maxEpoch = trajectory.maxEpoch;\r\n        }\r\n    }\r\n\r\n    clearAfterEpoch(epoch) {\r\n        while (this.components[this.components.length - 1].minEpoch >= epoch) {\r\n            this.components[this.components.length - 1].drop();\r\n            this.components.pop();\r\n        }\r\n    }\r\n}\r\n","import FunctionOfEpochAbstract from \"./Abstract\";\r\n\r\nexport default class Constant extends FunctionOfEpochAbstract\r\n{\r\n    constructor(value) {\r\n        super();\r\n        this.value = value;\r\n    }\r\n\r\n    evaluate(epoch) {\r\n        return this.value;\r\n    }\r\n}","import * as THREE from \"three\";\r\n\r\nexport default class VirtualPlane extends THREE.Plane\r\n{\r\n    raycast(raycaster, intersects) {\r\n\r\n        this.visible = true; //it's actually not. Visibility is true only to satisfy raycaster.\r\n\r\n        let A = this.normal.x;\r\n        let B = this.normal.y;\r\n        let C = this.normal.z;\r\n\r\n        let point = new THREE.Vector3((this.constant * A) / Math.sqrt((A * A) + (B * B) + (C * C)),\r\n                                      (this.constant * B) / Math.sqrt((A * A) + (B * B) + (C * C)),\r\n                                      (this.constant * C) / Math.sqrt((A * A) + (B * B) + (C * C)));\r\n\r\n        const d = point.dot(this.normal) / raycaster.ray.direction.dot(this.normal);\r\n\r\n        let intersectionPoint = raycaster.ray.direction.clone().multiplyScalar(d);\r\n\r\n        intersects.push({\r\n            distance  : intersectionPoint.length(),\r\n            point     : intersectionPoint,\r\n            index     : 0,\r\n            face      : null,\r\n            faceIndex : null,\r\n            object    : this\r\n        });\r\n    }\r\n}\r\n","import * as THREE from \"three\";\r\n\r\nimport LineObject from \"./LineObject\";\r\n\r\nexport default class ArrowObject extends THREE.ArrowHelper\r\n{\r\n    constructor(dir, origin, length, color, headLength, headWidth) {\r\n        super(dir, origin, length, color, headLength, headWidth);\r\n        this.remove(this.line);\r\n        this.line = new LineObject(this.line.geometry, this.line.material);\r\n        this.add(this.line);\r\n    }\r\n}\r\n","import * as THREE from \"three\";\r\n\r\nimport Constant from \"../FunctionOfEpoch/Constant\";\r\nimport VisualModelAbstract from \"./ModelAbstract\";\r\nimport {RF_BASE} from \"../ReferenceFrame/Factory\";\r\nimport VirtualPlane from \"./VirtualPlane\";\r\nimport {TWO_PI} from \"../algebra\";\r\nimport ArrowObject from \"./Arrow\";\r\nimport { sim } from \"../Simulation\";\r\n\r\nexport default class VisualAngle extends VisualModelAbstract\r\n{\r\n    constructor(referenceFrame, position, orientation, value, color, size, type, editingCallback) {\r\n        super();\r\n\r\n        this._referenceFrame = referenceFrame;\r\n        this._position = position;\r\n        this._orientation = orientation;\r\n        this._value = value;\r\n        this.color = color;\r\n        this.type = type;\r\n        this.arcSize = size;\r\n        this.editingCallback = editingCallback;\r\n        this.isEditMode = !!editingCallback;\r\n\r\n        this.orientationUpdated = false;\r\n        this.valueUpdated = false;\r\n        this.isHidden = false;\r\n        this.sizeNeedsUpdate = false;\r\n\r\n        this.init();\r\n    }\r\n\r\n    hide() {\r\n        this.threeObj.visible = false;\r\n        this.isHidden = true;\r\n    }\r\n\r\n    show() {\r\n        this.threeObj.visible = true;\r\n        this.isHidden = false;\r\n    }\r\n\r\n    getReferenceFrame(epoch) {\r\n        return this._referenceFrame.evaluate(epoch);\r\n    }\r\n\r\n    getPosition(epoch) {\r\n        return this._position.evaluate(epoch);\r\n    }\r\n\r\n    getOrientation(epoch) {\r\n        return this._orientation.evaluate(epoch);\r\n    }\r\n\r\n    getValue(epoch) {\r\n        return this._value.evaluate(epoch);\r\n    }\r\n\r\n    init() {\r\n        this.onWheelListener = this.onMouseWheel.bind(this);\r\n        document.addEventListener('wheel', this.onWheelListener);\r\n\r\n        if (this.isEditMode) {\r\n            this.mouseDownListener = this.onMouseDown.bind(this);\r\n            document.addEventListener('mousedown', this.mouseDownListener);\r\n        }\r\n\r\n        this.size = sim.camera.position.mag / 6 * this.arcSize;\r\n\r\n        if (this.type === VisualAngle.TYPE_ARC) {\r\n            this.createArcObject();\r\n        } else {\r\n            this.createSectorObject();\r\n        }\r\n        this.valueUpdated = true;\r\n        this.orientationUpdated = true;\r\n    }\r\n\r\n    onMouseWheel() {\r\n        this.sizeNeedsUpdate = true;\r\n    }\r\n\r\n    onMouseDown(event) {\r\n        let intersection;\r\n        if (this.type === VisualAngle.TYPE_ARC) {\r\n            intersection = sim.raycaster.intersectObjects([this.threeAngle.line])[0];\r\n        } else {\r\n            intersection = sim.raycaster.intersectObjects(\r\n                [this.threeAngle.children[0].line, this.threeAngle.children[0].cone]\r\n            )[0];\r\n        }\r\n\r\n        if (intersection && (event.button == 0)) { //check if the mouse button pressed is left\r\n            this.mouseUpListener = this.onMouseUp.bind(this);\r\n            document.addEventListener('mouseup', this.mouseUpListener);\r\n            this.mouseMoveListener = this.onMouseMove.bind(this);\r\n            sim.addEventListener('mousemove', this.mouseMoveListener, 2);\r\n        }\r\n    }\r\n\r\n    onMouseUp(event) {\r\n        document.removeEventListener('mouseup', this.mouseUpListener);\r\n        sim.removeEventListener('mousemove', this.mouseMoveListener);\r\n    }\r\n\r\n    onMouseMove() {\r\n        const plane = this.getVirtualPlane();\r\n        let intersection = sim.raycaster.intersectObjects([plane])[0];\r\n        if (intersection) {\r\n            const direction = intersection.point\r\n                .clone()\r\n                .sub(this.threeObj.position)\r\n                .normalize();\r\n            let mainAxis = new THREE.Vector3(1, 0, 0);\r\n            mainAxis.applyQuaternion(this.threeObj.quaternion);\r\n\r\n            let newAngleValue = Math.acos(mainAxis.dot(direction) / mainAxis.length() / direction.length()); // no division by lengths because direction and mainAxis are normalized (length = 1)\r\n            mainAxis.cross(direction);\r\n\r\n            this._value = new Constant((mainAxis.dot(plane.normal) > 0) ? newAngleValue : TWO_PI - newAngleValue);\r\n            this.valueUpdated = true;\r\n            if (this.editingCallback) {\r\n                this.editingCallback(this._value.value);\r\n            }\r\n        }\r\n    }\r\n\r\n    getVirtualPlane() {\r\n        let normal = new THREE.Vector3(0, 0, 1);\r\n        normal.applyQuaternion(this.threeObj.quaternion);\r\n        const angle = Math.acos(normal.dot(this.threeObj.position) / this.threeObj.position.length() / normal.length());\r\n        const distance = this.threeObj.position.length() * Math.cos(angle);\r\n\r\n        if (this.virtualPlane) {\r\n            this.virtualPlane.normal.copy(normal);\r\n            this.virtualPlane.constant = distance;\r\n        } else {\r\n            this.virtualPlane = new VirtualPlane(normal, distance);\r\n        }\r\n\r\n        return this.virtualPlane;\r\n    }\r\n\r\n    createArcObject() {\r\n        let material = new THREE.LineBasicMaterial({color: this.color});\r\n        let threeObj = new THREE.Object3D();\r\n\r\n        this.threeArc = new THREE.Line(new THREE.Geometry(), material);\r\n        this.threeMainAxis = new THREE.Line(new THREE.Geometry(), material);\r\n        this.threeAngle = new THREE.Line(new THREE.Geometry(), material);\r\n\r\n        this.threeMainAxis.geometry.vertices.push(\r\n            new THREE.Vector3(0, 0, 0),\r\n            new THREE.Vector3(1, 0, 0),\r\n        );\r\n        this.threeAngle.geometry.vertices.push(\r\n            new THREE.Vector3(0, 0, 0),\r\n            new THREE.Vector3(1, 0, 0),\r\n        );\r\n\r\n        threeObj.add(this.threeArc);\r\n        threeObj.add(this.threeMainAxis);\r\n        threeObj.add(this.threeAngle);\r\n        threeObj.scale.set(this.size, this.size, this.size);\r\n\r\n        this.setThreeObj(threeObj);\r\n    }\r\n\r\n    updateArcObject(value) {\r\n        if (value < 0) {\r\n            value -= 2 * Math.PI * Math.floor(value / 2 / Math.PI);\r\n        }\r\n        // todo: optimize this\r\n        this.threeArc.geometry.dispose();\r\n        this.threeArc.geometry = new THREE.Geometry();\r\n        this.threeArc.geometry.setFromPoints(\r\n            (new THREE.EllipseCurve(\r\n                0, 0,\r\n                1 / 3,\r\n                1 / 3,\r\n                0, value,\r\n                false,\r\n                0\r\n            )).getPoints(Math.ceil(value * 30))\r\n        );\r\n    }\r\n\r\n    createSectorObject() {\r\n        let material = new THREE.MeshBasicMaterial({\r\n            color: this.color,\r\n            opacity: 0.175,\r\n            transparent: true,\r\n            side: THREE.DoubleSide\r\n        });\r\n        let threeObj = new THREE.Object3D();\r\n\r\n        this.threeArc = new THREE.Mesh(new THREE.Geometry(), material);\r\n        this.threeMainAxis = new ArrowObject(\r\n            new THREE.Vector3(1, 0, 0),\r\n            new THREE.Vector3(0, 0, 0),\r\n            1,\r\n            this.color\r\n        );\r\n        this.threeAngle = new THREE.Object3D();\r\n        this.threeAngle.add(new ArrowObject(\r\n            new THREE.Vector3(1, 0, 0),\r\n            new THREE.Vector3(0, 0, 0),\r\n            1,\r\n            this.isEditMode ? 0xc2f442 : this.color\r\n        ));\r\n\r\n        threeObj.add(this.threeArc);\r\n        threeObj.add(this.threeMainAxis);\r\n        threeObj.add(this.threeAngle);\r\n        threeObj.scale.set(this.size, this.size, this.size);\r\n\r\n        this.setThreeObj(threeObj);\r\n    }\r\n\r\n    updateSectorObject(value) {\r\n        if (value < 0) {\r\n            value -= 2 * Math.PI * Math.floor(value / 2 / Math.PI);\r\n        }\r\n        // todo: optimize this\r\n        this.threeArc.geometry.dispose();\r\n        this.threeArc.geometry = new THREE.CircleGeometry(\r\n            1,\r\n            Math.ceil(value * 30),\r\n            0,\r\n            value\r\n        );\r\n    }\r\n\r\n    drop() {\r\n        super.drop();\r\n        delete this.threeMainAxis;\r\n        delete this.threeAngle;\r\n        delete this.threeArc;\r\n        document.removeEventListener('wheel', this.onWheelListener);\r\n        if (this.mouseDownListener) {\r\n            document.removeEventListener('mousedown', this.mouseDownListener);\r\n        }\r\n    }\r\n\r\n    render(epoch) {\r\n        if (this.isHidden) {\r\n            return;\r\n        }\r\n\r\n        const referenceFrame = this.getReferenceFrame(epoch);\r\n        const pos = referenceFrame.transformPositionByEpoch(\r\n            epoch,\r\n            this.getPosition(epoch),\r\n            RF_BASE\r\n        );\r\n        this.threeObj.position.copy(sim.getVisualCoords(pos));\r\n        this.threeObj.visible = true;\r\n\r\n        if (this.valueUpdated || !(this._value instanceof Constant)) {\r\n            const value = this.getValue(epoch);\r\n            if (this.type === VisualAngle.TYPE_ARC) {\r\n                this.updateArcObject(value);\r\n            } else {\r\n                this.updateSectorObject(value);\r\n            }\r\n            this.threeAngle.rotation.z = value;\r\n            this.valueUpdated = false;\r\n        }\r\n\r\n        if (this.orientationUpdated || !(this._orientation instanceof Constant)) {\r\n            this.threeObj.quaternion.copy(referenceFrame.getQuaternionByEpoch(epoch).mul_(this.getOrientation(epoch)).toThreejs());\r\n            this.orientationUpdated = false;\r\n        }\r\n\r\n        if (this.sizeNeedsUpdate) {\r\n            this.size = this.threeObj.position.length() / 6 * this.arcSize;\r\n            this.threeObj.scale.set(this.size, this.size, this.size);\r\n            this.sizeNeedsUpdate = false;\r\n        }\r\n    }\r\n}\r\n\r\nVisualAngle.TYPE_ARC    = 'arc';\r\nVisualAngle.TYPE_SECTOR = 'sector';\r\n","import * as THREE from \"three\";\r\nimport VisualModelAbstract from \"./ModelAbstract\";\r\nimport {RF_BASE, RF_BASE_OBJ} from \"../ReferenceFrame/Factory\";\r\nimport VirtualPlane from \"./VirtualPlane\";\r\nimport {Vector} from \"../algebra\";\r\nimport { sim } from \"../Simulation\";\r\n\r\nexport default class VisualPlanePoint extends VisualModelAbstract\r\n{\r\n    constructor(referenceFrame, value, color, size, editingCallback, minBound, maxBound) {\r\n        super();\r\n\r\n        this._referenceFrame = referenceFrame;\r\n        this._value = value;\r\n        this.color = color;\r\n        this.size = size;\r\n        this.editingCallback = editingCallback;\r\n        this.minBound = minBound;\r\n        this.maxBound = maxBound;\r\n\r\n        this.isEditMode = !!editingCallback;\r\n\r\n        this.isHidden = false;\r\n        this.mouseMoved = false;\r\n\r\n        this.init();\r\n    }\r\n\r\n    hide() {\r\n        this.threeObj.visible = false;\r\n        this.isHidden = true;\r\n    }\r\n\r\n    show() {\r\n        this.threeObj.visible = true;\r\n        this.isHidden = false;\r\n    }\r\n\r\n    getReferenceFrame(epoch) {\r\n        return this._referenceFrame.evaluate(epoch);\r\n    }\r\n\r\n    init() {\r\n        this.setThreeObj(new THREE.Mesh(\r\n            new THREE.SphereGeometry(1, 8, 8),\r\n            new THREE.MeshBasicMaterial({color: this.color})\r\n        ));\r\n\r\n        if (this.isEditMode) {\r\n            this.mouseDownListener = this.onMouseDown.bind(this);\r\n            document.addEventListener('mousedown', this.mouseDownListener);\r\n        }\r\n    }\r\n\r\n    drop() {\r\n        super.drop();\r\n        if (this.mouseDownListener) {\r\n            document.removeEventListener('mousedown', this.mouseDownListener);\r\n        }\r\n    }\r\n\r\n    onMouseDown(event) {\r\n        if (event.button != 0) {\r\n            return;\r\n        }\r\n\r\n        let intersection = sim.raycaster.intersectObjects([this.threeObj])[0];\r\n        if (intersection && (event.button == 0)) { //check if the mouse button pressed is left\r\n            this.mouseUpListener = this.onMouseUp.bind(this);\r\n            document.addEventListener('mouseup', this.mouseUpListener);\r\n            this.mouseMoveListener = this.onMouseMove.bind(this);\r\n            sim.addEventListener('mousemove', this.mouseMoveListener, 2);\r\n        }\r\n    }\r\n\r\n    onMouseUp(event) {\r\n        document.removeEventListener('mouseup', this.mouseUpListener);\r\n        sim.removeEventListener('mousemove', this.mouseMoveListener);\r\n    }\r\n\r\n    onMouseMove() {\r\n        this.mouseMoved = true;\r\n    }\r\n\r\n    updateValue(epoch) {\r\n        const plane = this.getVirtualPlane(epoch);\r\n        let intersection = sim.raycaster.intersectObjects([plane])[0];\r\n        if (intersection) {\r\n            this._value = RF_BASE_OBJ.transformPositionByEpoch(epoch, sim.getSimCoords(intersection.point), this.getReferenceFrame(epoch));\r\n\r\n            for (let idx of [0,1,2]) {\r\n                if (this._value[idx] < this.minBound[idx]) {\r\n                    this._value[idx] = this.minBound[idx];\r\n                } else if (this._value[idx] > this.maxBound[idx]) {\r\n                    this._value[idx] = this.maxBound[idx];\r\n                }\r\n            }\r\n\r\n            if (this.editingCallback) {\r\n                this.editingCallback(this._value);\r\n            }\r\n        }\r\n    }\r\n\r\n    getVirtualPlane(epoch) {\r\n        const normal = (new THREE.Vector3()).fromArray(this.getReferenceFrame(epoch).getQuaternionByEpoch(epoch).rotate_(new Vector([0,0,1])));\r\n        const position = sim.getVisualCoords(this.getReferenceFrame(epoch).getOriginPositionByEpoch(epoch));\r\n        const angle = Math.acos(normal.dot(position) / position.length() / normal.length());\r\n        const distance = position.length() * Math.cos(angle);\r\n\r\n        if (this.virtualPlane) {\r\n            this.virtualPlane.normal.copy(normal);\r\n            this.virtualPlane.constant = distance;\r\n        } else {\r\n            this.virtualPlane = new VirtualPlane(normal, distance);\r\n        }\r\n\r\n        return this.virtualPlane;\r\n    }\r\n\r\n    render(epoch) {\r\n        if (this.mouseMoved) {\r\n            this.updateValue(epoch);\r\n            this.mouseMoved = false;\r\n        }\r\n\r\n        this.threeObj.position.copy(sim.getVisualCoords(\r\n            this.getReferenceFrame(epoch).transformPositionByEpoch(\r\n                epoch,\r\n                this._value,\r\n                RF_BASE\r\n            )\r\n        ));\r\n\r\n        const scaleKoeff = this.size * this.threeObj.position.length() * sim.raycaster.getPixelAngleSize();\r\n        this.threeObj.scale.x = scaleKoeff;\r\n        this.threeObj.scale.y = scaleKoeff;\r\n        this.threeObj.scale.z = scaleKoeff;\r\n    }\r\n}","import FunctionOfEpochCustom from \"./FunctionOfEpoch/Custom\";\r\nimport {Quaternion, Vector} from \"./algebra\";\r\nimport VisualAngle from \"./visual/Angle\";\r\nimport Constant from \"./FunctionOfEpoch/Constant\";\r\nimport VisualPlanePoint from \"./visual/PlanePoint\";\r\nimport { sim } from \"./Simulation\";\r\n\r\nexport default class KeplerianEditor\r\n{\r\n    constructor(trajectory) {\r\n        this.isEditMode = trajectory.isEditable;\r\n        this.trajectory = trajectory;\r\n\r\n        this.colorRaan = 0x7FFFD4; //lightblue\r\n        this.colorAop  = 0x9966CC; //violet\r\n        this.colorInc  = 0xB00000; //red\r\n        this.colorTa   = 0xFC0FC0; //pink\r\n\r\n        if (sim.settings.ui.showAnglesOfSelectedOrbit) {\r\n            this.init();\r\n        }\r\n    }\r\n\r\n    init() {\r\n        let referenceFrame = new FunctionOfEpochCustom(epoch => this.trajectory.getReferenceFrameByEpoch(epoch));\r\n        let position = new Constant(new Vector(3));\r\n\r\n        this.angleRaan = new VisualAngle(\r\n            referenceFrame,\r\n            position,\r\n            new Constant(new Quaternion()),\r\n            new FunctionOfEpochCustom(epoch => this.trajectory.getKeplerianObjectByEpoch(epoch).raan),\r\n            this.colorRaan,\r\n            1.5,\r\n            this.isEditMode ? VisualAngle.TYPE_SECTOR : VisualAngle.TYPE_ARC,\r\n            this.isEditMode ? value => { this.trajectory.raan = value; } : null\r\n        );\r\n\r\n        this.angleInc = new VisualAngle(\r\n            referenceFrame,\r\n            position,\r\n            new FunctionOfEpochCustom(epoch => {\r\n                const ko = this.trajectory.getKeplerianObjectByEpoch(epoch);\r\n                return (new Quaternion(new Vector([0,0,1]), ko.raan + Math.PI / 2))\r\n                    .mul_(new Quaternion(new Vector([1,0,0]), Math.PI / 2));\r\n            }),\r\n            new FunctionOfEpochCustom(epoch => this.trajectory.getKeplerianObjectByEpoch(epoch).inc),\r\n            this.colorInc,\r\n            2,\r\n            this.isEditMode ? VisualAngle.TYPE_SECTOR : VisualAngle.TYPE_ARC,\r\n            this.isEditMode ? value => { this.trajectory.inc = value; } : null\r\n        );\r\n\r\n        this.angleAop = new VisualAngle(\r\n            referenceFrame,\r\n            position,\r\n            new FunctionOfEpochCustom(epoch => {\r\n                const ko = this.trajectory.getKeplerianObjectByEpoch(epoch);\r\n                return (new Quaternion(new Vector([0,0,1]), ko.raan))\r\n                    .mul_(new Quaternion(new Vector([1,0,0]), ko.inc));\r\n            }),\r\n            new FunctionOfEpochCustom(epoch => this.trajectory.getKeplerianObjectByEpoch(epoch).aop),\r\n            this.colorAop,\r\n            2.5,\r\n            this.isEditMode ? VisualAngle.TYPE_SECTOR : VisualAngle.TYPE_ARC,\r\n            this.isEditMode ? value => { this.trajectory.aop = value; } : null\r\n        );\r\n\r\n        this.angleTa = new VisualAngle(\r\n            referenceFrame,\r\n            position,\r\n            new FunctionOfEpochCustom(epoch => {\r\n                const ko = this.trajectory.getKeplerianObjectByEpoch(epoch);\r\n                return (new Quaternion(new Vector([0,0,1]), ko.raan))\r\n                    .mul_(new Quaternion(new Vector([1,0,0]), ko.inc))\r\n                    .mul_(new Quaternion(new Vector([0,0,1]), ko.aop));\r\n            }),\r\n            new FunctionOfEpochCustom(epoch => this.trajectory.getKeplerianObjectByEpoch(epoch).getTrueAnomalyByEpoch(epoch)),\r\n            this.colorTa,\r\n            3,\r\n            VisualAngle.TYPE_ARC\r\n        );\r\n\r\n        if (this.isEditMode) {\r\n            this.pointApoapsis = new VisualPlanePoint(\r\n                new Constant(this.trajectory.pericentricReferenceFrame),\r\n                new Vector([-this.trajectory.sma * (1 + this.trajectory.ecc), 0, 0]),\r\n                'red',\r\n                10,\r\n                value => {\r\n                    const periapsis = this.trajectory.sma * (1 - this.trajectory.ecc);\r\n                    const sma = (-value.x + periapsis) / 2;\r\n                    this.trajectory.sma = sma;\r\n                    this.trajectory.ecc = 1 - periapsis / sma;\r\n                },\r\n                new Vector([-1e12, 0, 0]),\r\n                new Vector([0, 0, 0])\r\n            );\r\n        }\r\n    }\r\n\r\n    remove() {\r\n        if (this.angleRaan) this.angleRaan.drop();\r\n        if (this.angleAop)  this.angleAop.drop();\r\n        if (this.angleInc)  this.angleInc.drop();\r\n        if (this.angleTa)   this.angleTa.drop();\r\n\r\n        if (this.pointApoapsis) this.pointApoapsis.drop();\r\n    }\r\n}\r\n","import StateVector from \"../StateVector\";\r\nimport {RF_BASE} from \"../ReferenceFrame/Factory\";\r\nimport KeplerianObject from \"../KeplerianObject\";\r\nimport ExceptionOutOfRange from \"./ExceptionOutOfRange\";\r\nimport FunctionOfEpochCustom from \"../FunctionOfEpoch/Custom\";\r\nimport ReferenceFrameInertialDynamic from \"../ReferenceFrame/InertialDynamic\";\r\nimport KeplerianEditor from \"../KeplerianEditor\";\r\nimport {Quaternion} from \"../algebra\";\r\nimport ReferenceFrameAbstract from \"../ReferenceFrame/Abstract\";\r\nimport { sim } from \"../Simulation\";\r\nimport Events from \"../Events\";\r\n\r\nexport default class TrajectoryAbstract\r\n{\r\n    constructor() {\r\n        this.minEpoch = null;\r\n        this.maxEpoch = null;\r\n\r\n        this.cachedEpoch = null;\r\n        this.cachedState = null;\r\n\r\n        this.visualModel = null;\r\n        this.object = null;\r\n\r\n        this.parent = null;\r\n\r\n        this.referenceFrame = null;\r\n\r\n        this.isEditable = false;\r\n        this.isSelected = false;\r\n\r\n        this.propagator = null;\r\n\r\n        this.showOrbitAnglesListener = this._onShowOrbitAnglesChange.bind(this);\r\n\r\n        this.orbitalReferenceFrame = new ReferenceFrameInertialDynamic(\r\n            new FunctionOfEpochCustom(epoch => this.getStateByEpoch(epoch)),\r\n            new FunctionOfEpochCustom(epoch => {\r\n                const state = this.getStateInOwnFrameByEpoch(epoch);\r\n                return Quaternion.twoAxis(state.velocity, null, state.position);\r\n            }),\r\n        );\r\n\r\n        this.pericentricReferenceFrame = new ReferenceFrameInertialDynamic(\r\n            new FunctionOfEpochCustom((epoch) => {\r\n                return this.getReferenceFrameByEpoch(epoch).getOriginStateByEpoch(epoch);\r\n            }),\r\n            new FunctionOfEpochCustom((epoch) => {\r\n                const quat = this.getReferenceFrameByEpoch(epoch).getQuaternionByEpoch(epoch);\r\n                const ko = this.getKeplerianObjectByEpoch(epoch);\r\n                return quat.mul_(ko.getOrbitalFrameQuaternion());\r\n            })\r\n        );\r\n    }\r\n\r\n    isEditableAtEpoch(epoch) {\r\n        return this.isEditable;\r\n    }\r\n\r\n    setReferenceFrame(referenceFrameId) {\r\n        this.referenceFrame = sim.starSystem.getReferenceFrame(referenceFrameId);\r\n    }\r\n\r\n    getReferenceFrameByEpoch(epoch) {\r\n        return this.referenceFrame;\r\n    }\r\n\r\n    _transformKeplerianObject(keplerianObject, destinationFrameOrId, epoch) {\r\n        if (destinationFrameOrId === undefined) {\r\n            return keplerianObject;\r\n        }\r\n\r\n        let destinationFrame = (destinationFrameOrId instanceof ReferenceFrameAbstract)\r\n            ? destinationFrameOrId\r\n            : sim.starSystem.getReferenceFrame(destinationFrameOrId);\r\n        if (epoch === undefined) {\r\n            epoch = keplerianObject.epoch;\r\n        }\r\n        return KeplerianObject.createFromState(\r\n            this.referenceFrame.transformStateVectorByEpoch(\r\n                epoch,\r\n                keplerianObject.getStateByEpoch(epoch),\r\n                destinationFrame\r\n            ),\r\n            destinationFrame.mu,\r\n            epoch\r\n        );\r\n    }\r\n\r\n    getKeplerianObjectByEpoch(epoch, referenceFrameOrId) {\r\n        let destinationFrame = (referenceFrameOrId instanceof ReferenceFrameAbstract)\r\n            ? referenceFrameOrId\r\n            : referenceFrameOrId !== undefined\r\n                ? sim.starSystem.getReferenceFrame(referenceFrameOrId)\r\n                : this.getReferenceFrameByEpoch(epoch);\r\n        return KeplerianObject.createFromState(\r\n            this.getStateByEpoch(epoch, destinationFrame),\r\n            destinationFrame.mu,\r\n            epoch\r\n        );\r\n    }\r\n\r\n    setVisualModel(visualModel) {\r\n        this.visualModel = visualModel;\r\n    }\r\n\r\n    setParent(parent) {\r\n        this.parent = parent;\r\n    }\r\n\r\n    setObject(object) {\r\n        this.object = object;\r\n    }\r\n\r\n    drop() {\r\n        if (this.isSelected) {\r\n            this.deselect();\r\n        }\r\n        if (this.visualModel) {\r\n            this.visualModel.drop();\r\n        }\r\n    }\r\n\r\n    select() {\r\n        this.isSelected = true;\r\n        this.visualModel && this.visualModel.select();\r\n        this.keplerianEditor = new KeplerianEditor(this);\r\n        Events.addListener(Events.SHOW_ORBIT_ANGLES_CHANGED, this.showOrbitAnglesListener);\r\n    }\r\n\r\n    deselect() {\r\n        this.isSelected = false;\r\n        this.visualModel && this.visualModel.deselect();\r\n        if (this.keplerianEditor) {\r\n            this.keplerianEditor.remove();\r\n            delete this.keplerianEditor;\r\n            Events.removeListener(Events.SHOW_ORBIT_ANGLES_CHANGED, this.showOrbitAnglesListener);\r\n        }\r\n    }\r\n\r\n    _onShowOrbitAnglesChange(event) {\r\n        if (event.detail.value) {\r\n            this.keplerianEditor.init();\r\n        } else {\r\n            this.keplerianEditor.remove();\r\n        }\r\n    }\r\n\r\n    isValidAtEpoch(epoch) {\r\n        if (this.minEpoch !== null && this.minEpoch !== false) {\r\n            if (epoch < this.minEpoch) {\r\n                return false;\r\n            }\r\n        }\r\n        if (this.maxEpoch !== null && this.maxEpoch !== false) {\r\n            if (epoch > this.maxEpoch) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n    validateEpoch(epoch) {\r\n        if (!this.isValidAtEpoch(epoch)) {\r\n            throw new ExceptionOutOfRange(this.object, this, epoch, this.minEpoch, this.maxEpoch);\r\n        }\r\n    }\r\n\r\n    getStateInOwnFrameByEpoch(epoch) {\r\n        this.validateEpoch(epoch);\r\n        return new StateVector();\r\n    }\r\n\r\n    getStateByEpoch(epoch, referenceFrameOrId) {\r\n        let state;\r\n\r\n        if (this.referenceFrame === null) {\r\n            return null;\r\n        }\r\n\r\n        if (referenceFrameOrId === undefined) {\r\n            referenceFrameOrId = RF_BASE;\r\n        }\r\n\r\n        if (referenceFrameOrId === RF_BASE && epoch === this.cachedEpoch) {\r\n            state = this.cachedState;\r\n        } else {\r\n            state = this.getStateInOwnFrameByEpoch(epoch);\r\n            if (referenceFrameOrId === RF_BASE && epoch === sim.currentEpoch) {\r\n                this.cachedState = state;\r\n                this.cachedEpoch = epoch;\r\n            }\r\n        }\r\n\r\n        if (state === null) {\r\n            return null;\r\n        }\r\n\r\n        return this.referenceFrame.transformStateVectorByEpoch(epoch, state, referenceFrameOrId);\r\n    }\r\n\r\n    getPositionByEpoch(epoch, referenceFrameOrId) {\r\n        return this.getStateByEpoch(epoch, referenceFrameOrId).position;\r\n    }\r\n\r\n    getVelocityByEpoch(epoch, referenceFrameOrId) {\r\n        return this.getStateByEpoch(epoch, referenceFrameOrId).velocity;\r\n    }\r\n}\r\n","import ReferenceFrameInertialAbstract from \"./InertialAbstract\";\r\n\r\nexport default class ReferenceFrameInertialDynamic extends ReferenceFrameInertialAbstract\r\n{\r\n    constructor(stateOfEpoch, quaternionOfEpoch) {\r\n        super(stateOfEpoch);\r\n\r\n        this.quaternionOfEpoch = quaternionOfEpoch;\r\n    }\r\n\r\n    getQuaternionByEpoch(epoch) {\r\n        return this.quaternionOfEpoch.evaluate(epoch);\r\n    }\r\n}","export const GETTING_STARTED_WIZARD = \"getting-started-wizard\";\n","import TrajectoryAbstract from \"./Abstract\";\r\n\r\nexport default class TrajectoryKeplerianAbstract extends TrajectoryAbstract\r\n{\r\n    constructor(referenceFrameId) {\r\n        super();\r\n        this.setReferenceFrame(referenceFrameId);\r\n    }\r\n\r\n    getStateInOwnFrameByEpoch(epoch) {\r\n        return this.getKeplerianObjectByEpoch(epoch).getStateByEpoch(epoch);\r\n    }\r\n}\r\n","import ReferenceFrameInertialAbstract from \"./InertialAbstract\";\r\nimport {Quaternion} from \"../algebra\";\r\n\r\nexport default class ReferenceFrameInertial extends ReferenceFrameInertialAbstract\r\n{\r\n    constructor(stateOfEpoch, quaternion) {\r\n        super(stateOfEpoch);\r\n\r\n        this.quaternion = quaternion;\r\n    }\r\n\r\n    getQuaternionByEpoch(epoch) {\r\n        return Quaternion.copy(this.quaternion);\r\n    }\r\n}\r\n","import ReferenceFrameAbstract from \"./Abstract\";\r\nimport StateVector from \"../StateVector\";\r\n\r\nexport default class ReferenceFrameInertialAbstract extends ReferenceFrameAbstract\r\n{\r\n    constructor(stateOfEpoch) {\r\n        super();\r\n        this.stateOfEpoch = stateOfEpoch;\r\n    }\r\n\r\n    getOriginPositionByEpoch(epoch) {\r\n        return this.stateOfEpoch.evaluate(epoch).position;\r\n    }\r\n\r\n    getOriginStateByEpoch(epoch) {\r\n        return this.stateOfEpoch.evaluate(epoch);\r\n    }\r\n\r\n    stateVectorFromBaseReferenceFrameByEpoch(epoch, state) {\r\n        const originState = this.stateOfEpoch.evaluate(epoch);\r\n        const rotation = this.getQuaternionByEpoch(epoch).invert_();\r\n\r\n        return new StateVector(\r\n            rotation.rotate(state.position.sub_(originState.position)),\r\n            rotation.rotate(state.velocity.sub_(originState.velocity))\r\n        );\r\n    }\r\n\r\n    stateVectorToBaseReferenceFrameByEpoch(epoch, state) {\r\n        const originState = this.stateOfEpoch.evaluate(epoch);\r\n        const rotation = this.getQuaternionByEpoch(epoch);\r\n\r\n        return new StateVector(\r\n            rotation.rotate(state.position).add_(originState.position),\r\n            rotation.rotate(state.velocity).add_(originState.velocity)\r\n        );\r\n    }\r\n}","export default class ExceptionOutOfRange\r\n{\r\n    constructor(object, trajectory, epoch, minEpoch, maxEpoch) {\r\n        this.object = object;\r\n        this.trajectory = trajectory;\r\n        this.epoch = epoch;\r\n        this.minEpoch = minEpoch;\r\n        this.maxEpoch = maxEpoch;\r\n    }\r\n}","import * as THREE from \"three\";\r\n\r\nexport default class LineObject extends THREE.Line {\r\n    raycast(raycaster, intersects) {\r\n        const isBuffer = this.geometry.isBufferGeometry;\r\n        const verticesCount = isBuffer ? this.geometry.attributes.position.count : this.geometry.vertices.length;\r\n        let bestIntersection;\r\n\r\n        const ray = (new THREE.Ray())\r\n            .copy(raycaster.ray)\r\n            .applyMatrix4(\r\n                (new THREE.Matrix4())\r\n                .getInverse(this.matrixWorld)\r\n            );\r\n\r\n        for (let i = 0; i < verticesCount - 1; i++) {\r\n            let vertex1;\r\n            let vertex2;\r\n            if (isBuffer) {\r\n                const i1 = i * 3;\r\n                const i2 = ((i + 1) % verticesCount) * 3;\r\n                let positions = this.geometry.attributes.position.array;\r\n                vertex1 = new THREE.Vector3(positions[i1], positions[i1+1], positions[i1+2]);\r\n                vertex2 = new THREE.Vector3(positions[i2], positions[i2+1], positions[i2+2]);\r\n            } else {\r\n                vertex1 = (new THREE.Vector3())\r\n                    .copy(this.geometry.vertices[i]);\r\n                vertex2 = (new THREE.Vector3())\r\n                    .copy(this.geometry.vertices[(i + 1) % verticesCount]);\r\n            }\r\n\r\n            const currentLineDirection = (new THREE.Vector3()).subVectors(\r\n                vertex1,\r\n                vertex2\r\n            );\r\n\r\n            const commonPerpendicularDirection = (new THREE.Vector3()).crossVectors(\r\n                currentLineDirection,\r\n                ray.direction\r\n            );\r\n\r\n            const planeNormalVector = (new THREE.Vector3()).crossVectors(\r\n                ray.direction,\r\n                commonPerpendicularDirection\r\n            );\r\n\r\n            let distanceCoeff = (new THREE.Vector3()).subVectors(\r\n                ray.origin,\r\n                vertex1\r\n            ).dot(planeNormalVector);\r\n\r\n            distanceCoeff /= planeNormalVector.clone().dot(currentLineDirection);\r\n\r\n            let intersectionPoint = (new THREE.Vector3()).addVectors(\r\n                vertex1,\r\n                currentLineDirection.multiplyScalar(distanceCoeff)\r\n            );\r\n\r\n            if ((new THREE.Vector3()).subVectors(\r\n                    vertex1, intersectionPoint\r\n                ).dot(\r\n                    (new THREE.Vector3()).subVectors(\r\n                        intersectionPoint, vertex2\r\n                    )\r\n                ) < 0\r\n            ) {\r\n                // вне отркзка\r\n                intersectionPoint =\r\n                    (intersectionPoint.distanceTo(vertex1) < intersectionPoint.distanceTo(vertex2))\r\n                        ? vertex1\r\n                        : vertex2;\r\n            }\r\n\r\n            const currentDistance = (new THREE.Vector3()).crossVectors(\r\n                (new THREE.Vector3()).subVectors(\r\n                    intersectionPoint,\r\n                    ray.origin\r\n                ),\r\n                ray.direction\r\n            ).length();\r\n\r\n            if (!bestIntersection || (bestIntersection.distance > currentDistance)) {\r\n                bestIntersection = {\r\n                    distance: currentDistance,\r\n                    point: intersectionPoint,\r\n                    index: i,\r\n                    face: null,\r\n                    faceIndex: null,\r\n                    object: this\r\n                }\r\n            }\r\n        }\r\n\r\n        if (bestIntersection\r\n            && (bestIntersection.distance / ray.origin.distanceTo(bestIntersection.point)\r\n                < raycaster.pixelPrecision * raycaster.pixelAngleSize\r\n            )\r\n        ) {\r\n            bestIntersection.point.applyMatrix4(this.matrixWorld);\r\n            intersects.push(bestIntersection);\r\n        }\r\n    }\r\n}\r\n","import * as THREE from \"three\";\r\n\r\nimport VisualModelAbstract from \"../ModelAbstract\";\r\nimport LineObject from \"../LineObject\";\r\nimport { sim } from \"../../Simulation\";\r\n\r\nexport default class VisualTrajectoryModelAbstract extends VisualModelAbstract\r\n{\r\n    constructor(trajectory, config) {\r\n        super();\r\n\r\n        this.trajectory = trajectory;\r\n        this.standardColor = config.color;\r\n        this.color = config.color;\r\n\r\n        this.minEpoch = (config.minEpoch !== undefined) ? config.minEpoch : (trajectory.minEpoch || null);\r\n        this.maxEpoch = (config.maxEpoch !== undefined) ? config.maxEpoch : (trajectory.maxEpoch || null);\r\n\r\n        this.setThreeObj(new LineObject(\r\n            new THREE.Geometry(),\r\n            new THREE.LineBasicMaterial({vertexColors: THREE.VertexColors})\r\n        ));\r\n\r\n        this.point = new THREE.Mesh(\r\n            new THREE.SphereGeometry(1, 8, 8),\r\n            new THREE.MeshBasicMaterial({color: this.color})\r\n        );\r\n        this.scene.add(this.point);\r\n        this.pointSize = 4;\r\n\r\n        this.threeObj.userData = {trajectory: trajectory};\r\n        sim.selection.addSelectableObject(this.threeObj);\r\n    }\r\n\r\n    updateGeometry(points, colorMults, endingBrightness) {\r\n        const mainColor = new THREE.Color(this.color);\r\n        this.threeObj.geometry.dispose();\r\n        this.threeObj.geometry = (new THREE.Geometry()).setFromPoints(points);\r\n\r\n        for (let i = 0; i < colorMults.length; i++) {\r\n            let curColor = (new THREE.Color()).copy(mainColor);\r\n            const mult = endingBrightness + (1 - endingBrightness) * colorMults[i];\r\n\r\n            this.threeObj.geometry.colors.push(\r\n                curColor.multiplyScalar(mult)\r\n            );\r\n        }\r\n    }\r\n\r\n    getRenderingEpoch(epoch) {\r\n        if ((this.minEpoch !== null && epoch < this.minEpoch)\r\n            || (this.maxEpoch !== null && epoch > this.maxEpoch)\r\n        ) {\r\n            return null;\r\n        }\r\n\r\n        if (!this.trajectory.isValidAtEpoch(epoch)) {\r\n            if (this.trajectory.minEpoch !== null && epoch < this.trajectory.minEpoch) {\r\n                return this.trajectory.minEpoch;\r\n            }\r\n            if (this.trajectory.maxEpoch !== null && epoch > this.trajectory.maxEpoch) {\r\n                return this.trajectory.maxEpoch;\r\n            }\r\n        }\r\n\r\n        return epoch;\r\n    }\r\n\r\n    render(epoch) {\r\n        if (!this.trajectory.isValidAtEpoch(epoch)) {\r\n            this.point.visible = false;\r\n            return;\r\n        }\r\n\r\n        this.point.visible = true;\r\n        this.point.position.copy(sim.getVisualCoords(this.trajectory.getPositionByEpoch(epoch)));\r\n        const scaleKoeff = this.pointSize * this.point.position.length() * sim.raycaster.getPixelAngleSize();\r\n        this.point.scale.x = scaleKoeff;\r\n        this.point.scale.y = scaleKoeff;\r\n        this.point.scale.z = scaleKoeff;\r\n    }\r\n\r\n    select() {\r\n        this.setColor(0xFFFFFF);\r\n    }\r\n\r\n    deselect() {\r\n        this.setColor(this.standardColor);\r\n    }\r\n\r\n    setColor(color) {\r\n        this.color = color;\r\n        this.point.material.color.set(this.color);\r\n        this.point.material.needsUpdate = true;\r\n    }\r\n\r\n    drop() {\r\n        sim.selection.removeSelectableObject(this.threeObj);\r\n\r\n        this.scene.remove(this.point);\r\n        if (this.point.geometry) {\r\n            this.point.geometry.dispose();\r\n        }\r\n        if (this.point.material) {\r\n            this.point.material.dispose();\r\n        }\r\n        delete this.point;\r\n\r\n        super.drop();\r\n    }\r\n}\r\n","export default class OrientationAbstract\r\n{\r\n    getQuaternionByEpoch(epoch) {}\r\n}\r\n","import OrientationAbstract from \"./Abstract\";\r\nimport {Quaternion, Vector} from \"../algebra\";\r\n\r\nexport default class OrientationConstantAxis extends OrientationAbstract\r\n{\r\n    constructor(config) {\r\n        super();\r\n        const angularVelocity = new Vector(config.vector);\r\n        this.axisQuaternion = Quaternion.transfer(new Vector([0, 0, 1]), angularVelocity);\r\n        this.angularSpeed = angularVelocity.mag;\r\n        this.initialAngle = config.angle || 0;\r\n        this.initialEpoch = config.epoch || 0;\r\n    }\r\n\r\n    getQuaternionByEpoch(epoch) {\r\n        return this.axisQuaternion.mul(\r\n            new Quaternion(\r\n                [0, 0, 1],\r\n                this.initialAngle + (epoch - this.initialEpoch) * this.angularSpeed\r\n            )\r\n        );\r\n    }\r\n}\r\n","export default class PhysicalBodyModel\r\n{\r\n    constructor(config) {\r\n        this.mu       = config.mu;     // gravitational parameter\r\n        this.radius   = config.radius;\r\n        this.eqRadius = config.eqRadius;\r\n        this.j2       = config.j2 || 0;\r\n    }\r\n}","import TrajectoryKeplerianAbstract from \"./KeplerianAbstract\";\r\nimport {approximateAngle, approximateNumber} from \"../algebra\";\r\nimport KeplerianObject from \"../KeplerianObject\";\r\nimport StateVector from \"../StateVector\";\r\n\r\nexport default class TrajectoryKeplerianArray extends TrajectoryKeplerianAbstract\r\n{\r\n    constructor(referenceFrameId) {\r\n        super(referenceFrameId);\r\n        this.keplerianObjects = []; // array of class KeplerianObject\r\n    }\r\n\r\n    addState(keplerianObject) {\r\n        this.keplerianObjects.push(keplerianObject);\r\n    }\r\n\r\n    getKeplerianObjectByEpoch(epoch, referenceFrameOrId) {\r\n        this.validateEpoch(epoch);\r\n\r\n        let nextIdx = Math.ceil((epoch - this.minEpoch) / (this.maxEpoch - this.minEpoch) * (this.keplerianObjects.length - 1));\r\n        let searchDirection = this.keplerianObjects[nextIdx].epoch > epoch ? -1 : 1;\r\n\r\n        while ((nextIdx < this.keplerianObjects.length) && (nextIdx >= 0)) {\r\n            if (this.keplerianObjects[nextIdx].epoch == epoch) {\r\n                return this.keplerianObjects[nextIdx];\r\n            }\r\n            if ((this.keplerianObjects[nextIdx].epoch > epoch)\r\n                && (this.keplerianObjects[nextIdx - 1].epoch < epoch)\r\n            ) {\r\n                break;\r\n            }\r\n            nextIdx += searchDirection;\r\n        }\r\n\r\n        if ((nextIdx === this.keplerianObjects.length) || (nextIdx === 0)) {\r\n            nextIdx -= searchDirection;\r\n        }\r\n\r\n        return this._transformKeplerianObject(this.approximateKeplerianObject(\r\n            this.keplerianObjects[nextIdx - 1],\r\n            this.keplerianObjects[nextIdx],\r\n            epoch\r\n        ), referenceFrameOrId);\r\n    }\r\n\r\n    approximateKeplerianObject(object1, object2, epoch) {\r\n        const proportion = (epoch - object1.epoch) / (object2.epoch - object1.epoch);\r\n\r\n        if ((0.95 < object1.e && object1.e < 1.05)\r\n            || (0.95 < object2.e && object2.e < 1.05)\r\n            || (object1.isElliptic !== object2.isElliptic)\r\n        ) {\r\n            const state1 = object1.getStateByEpoch(epoch);\r\n            const state2 = object2.getStateByEpoch(epoch);\r\n            return KeplerianObject.createFromState(\r\n                new StateVector(\r\n                    state1.position.mul_(1 - proportion).add_(state2.position.mul_(proportion)),\r\n                    state1.velocity.mul_(1 - proportion).add_(state2.velocity.mul_(proportion)),\r\n                ),\r\n                approximateNumber(object1.mu, object2.mu, proportion),\r\n                epoch\r\n            );\r\n        }\r\n\r\n        const ma = object1.isElliptic\r\n            ? approximateAngle(object1.getMeanAnomalyByEpoch(epoch), object2.getMeanAnomalyByEpoch(epoch), proportion)\r\n            : approximateNumber(object1.getMeanAnomalyByEpoch(epoch), object2.getMeanAnomalyByEpoch(epoch), proportion);\r\n\r\n        return new KeplerianObject(\r\n            approximateNumber(object1.e, object2.e, proportion),\r\n            approximateNumber(object1.sma, object2.sma, proportion),\r\n            approximateAngle(object1.aop, object2.aop, proportion),\r\n            approximateAngle(object1.inc, object2.inc, proportion),\r\n            approximateAngle(object1.raan, object2.raan, proportion),\r\n            ma,\r\n            epoch,\r\n            approximateNumber(object1.mu, object2.mu, proportion),\r\n            false\r\n        );\r\n    }\r\n}\r\n","import TrajectoryKeplerianArray from \"./KeplerianArray\";\r\n\r\nexport default class TrajectoryKeplerianPrecessingArray extends TrajectoryKeplerianArray\r\n{\r\n    constructor(referenceFrameId, r, j2) {\r\n        super(referenceFrameId);\r\n        this.r = r;\r\n        this.j2 = j2;\r\n    }\r\n\r\n    approximateKeplerianObject(object1, object2, epoch) {\r\n        let obj1 = object1.copy();\r\n        let obj2 = object2.copy();\r\n        obj1.raan += obj1.getNodalPrecessionByEpoch(this.r, this.j2, epoch);\r\n        obj2.raan += obj2.getNodalPrecessionByEpoch(this.r, this.j2, epoch);\r\n        return super.approximateKeplerianObject(\r\n            obj1,\r\n            obj2,\r\n            epoch\r\n        );\r\n    }\r\n}","import TrajectoryKeplerianBasic from \"./KeplerianBasic\";\r\nimport KeplerianObject from \"../KeplerianObject\";\r\n\r\nexport default class TrajectoryKeplerianPrecessing extends TrajectoryKeplerianBasic\r\n{\r\n    constructor(referenceFrameId, keplerianObject, r, j2) {\r\n        super(referenceFrameId, keplerianObject);\r\n\r\n        this.r = r;\r\n        this.j2 = j2;\r\n    }\r\n\r\n    getKeplerianObjectByEpoch(epoch, referenceFrameOrId) {\r\n        this.validateEpoch(epoch);\r\n        return this._transformKeplerianObject(\r\n            this.keplerianObject.addPrecession(this.r, this.j2, epoch),\r\n            referenceFrameOrId\r\n        );\r\n    }\r\n\r\n    static createFromState(referenceFrame, state, mu, r, j2, epoch, color) {\r\n        return new TrajectoryKeplerianPrecessing(\r\n            referenceFrame,\r\n            KeplerianObject.createFromState(state, mu, epoch),\r\n            r,\r\n            j2,\r\n            color\r\n        );\r\n    }\r\n}\r\n","import VisualTrajectoryModelAbstract from \"./Abstract\";\r\nimport {deg2rad} from \"../../algebra\";\r\nimport { sim } from \"../../Simulation\";\r\n\r\nexport default class VisualTrajectoryModelPointArray extends VisualTrajectoryModelAbstract\r\n{\r\n    constructor(trajectory, config) {\r\n        super(trajectory, config);\r\n\r\n        this.referenceFrame = sim.starSystem.getReferenceFrame(config.pointArrayModel.referenceFrame);\r\n        this.showAhead = config.pointArrayModel.showAhead;\r\n        this.showBehind = config.pointArrayModel.showBehind;\r\n        this.trailPeriod = config.pointArrayModel.trailPeriod;\r\n\r\n        this.minCos = Math.cos(deg2rad(config.pointArrayModel.maxAngle || 2));\r\n        this.minStep = config.pointArrayModel.minStep || 180;\r\n        this.threeObj.position.set(0, 0, 0);\r\n\r\n        this.initVertices();\r\n    }\r\n\r\n    render(epoch) {\r\n        super.render(epoch);\r\n\r\n        epoch = this.getRenderingEpoch(epoch);\r\n\r\n        if (epoch === null) {\r\n            this.threeObj.visible = false;\r\n            return;\r\n        }\r\n\r\n        const endingBrightness = 0.4;\r\n        const originPos = this.referenceFrame.getOriginPositionByEpoch(epoch);\r\n        let points = [];\r\n        let colors = [];\r\n\r\n        for (let i = 0; i < this.positions.length; ++i) {\r\n            if (this.epochs[i] < epoch - this.trailPeriod) {\r\n                if (this.showBehind) {\r\n                    points.push(this.positions[i]);\r\n                    colors.push(0);\r\n                }\r\n                if (this.epochs[i+1] > epoch - this.trailPeriod) {\r\n                    points.push(\r\n                        this.trajectory.getPositionByEpoch(epoch - this.trailPeriod, this.referenceFrame)\r\n                    );\r\n                    colors.push(0);\r\n                }\r\n            } else if (this.epochs[i] < epoch) {\r\n                points.push(this.positions[i]);\r\n                colors.push(1 - (epoch - this.epochs[i]) / this.trailPeriod);\r\n            } else if (this.epochs[i] > epoch && this.showAhead) {\r\n                points.push(this.positions[i]);\r\n                colors.push(0);\r\n            }\r\n\r\n            if ((this.epochs[i] < epoch)\r\n                && (this.epochs[i+1] >= epoch)\r\n            ) {\r\n                const pos = this.trajectory.getPositionByEpoch(epoch, this.referenceFrame);\r\n                points.push(pos);\r\n                points.push(pos);\r\n                colors.push(1);\r\n                colors.push(0);\r\n            }\r\n        }\r\n\r\n        this.threeObj.visible = true;\r\n        this.updateGeometry(points, colors, endingBrightness);\r\n\r\n        this.threeObj.position.copy(sim.getVisualCoords(originPos));\r\n        this.threeObj.quaternion.copy(this.referenceFrame.getQuaternionByEpoch(epoch).toThreejs());\r\n\r\n        super.render(epoch);\r\n    }\r\n\r\n    findPointByEpoch(epoch) {\r\n        let low  = 0;\r\n        let high = this.epochs.length - 1;\r\n        let idx = Math.floor((low + high) / 2);\r\n\r\n        do {\r\n            if (this.epochs[idx] < epoch) {\r\n                low = idx;\r\n            } else if (this.epochs[idx] > epoch) {\r\n                high = idx;\r\n            } else {\r\n                return idx;\r\n            }\r\n            idx = Math.floor((low + high) / 2)\r\n        } while (idx != low);\r\n\r\n        return (epoch - this.epochs[idx] > this.epochs[idx + 1] - epoch)\r\n            ? idx + 1\r\n            : idx;\r\n    }\r\n\r\n    initVertices() {\r\n        const traj = this.trajectory;\r\n        let step = this.minStep;\r\n        let curEpoch = traj.minEpoch;\r\n        let curState = traj.getStateByEpoch(curEpoch, this.referenceFrame);\r\n        let curVelocity = curState.velocity.unit_();\r\n\r\n        this.positions = [curState.position];\r\n        this.epochs = [curEpoch];\r\n        let i = 1;\r\n\r\n        while (curEpoch < traj.maxEpoch) {\r\n            let lastState;\r\n            let lastEpoch;\r\n            let lastDrMag;\r\n            let isIncreasing = null;\r\n            let stepsLeft = 20;\r\n            while (true) {\r\n                const nextEpoch = (curEpoch + step > traj.maxEpoch)\r\n                    ? traj.maxEpoch\r\n                    : curEpoch + step;\r\n                step = nextEpoch - curEpoch;\r\n                const newState = traj.getStateByEpoch(nextEpoch, this.referenceFrame);\r\n                const dr = newState._position.sub(curState._position);\r\n                const drMag = dr.mag;\r\n                let angleCos = dr.dot(curVelocity) / drMag;\r\n\r\n                if (nextEpoch != traj.maxEpoch) {\r\n                    const nextNextEpoch = (nextEpoch + step > traj.maxEpoch)\r\n                        ? traj.maxEpoch\r\n                        : nextEpoch + step;\r\n                    const nextNewState = traj.getStateByEpoch(nextNextEpoch, this.referenceFrame);\r\n                    const nextDr = nextNewState._position.sub(newState._position);\r\n                    angleCos = Math.min(angleCos, dr.dot(nextDr) / drMag / nextDr.mag);\r\n                }\r\n\r\n                // angle is too big\r\n                if (angleCos < this.minCos) {\r\n                    if (isIncreasing === true) {\r\n                        break;\r\n                    }\r\n                    step /= 2;\r\n                    isIncreasing = false;\r\n                // angle is acceptable\r\n                } else {\r\n                    lastState = newState;\r\n                    lastEpoch = nextEpoch;\r\n                    lastDrMag = drMag;\r\n                    if (isIncreasing === false || nextEpoch === traj.maxEpoch) {\r\n                        break;\r\n                    }\r\n                    step *= 2;\r\n                    isIncreasing = true;\r\n                }\r\n\r\n                --stepsLeft;\r\n                if (stepsLeft === 0 || Math.abs(step) < this.minStep) {\r\n                    step = this.minStep * Math.sign(step);\r\n                    if (lastState === undefined) {\r\n                        lastState = newState;\r\n                        lastEpoch = nextEpoch;\r\n                        lastDrMag = drMag;\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n\r\n            this.epochs[i] = lastEpoch;\r\n            this.positions[i] = lastState.position;\r\n\r\n            curState = lastState;\r\n            curVelocity = curState.velocity.unit_();\r\n            curEpoch = lastEpoch;\r\n            i++;\r\n        }\r\n    }\r\n}\r\n","import TrajectoryAbstract from \"./Abstract\";\r\nimport StateVector from \"../StateVector\";\r\n\r\nexport default class TrajectoryStaticPosition extends TrajectoryAbstract\r\n{\r\n    constructor(referenceFrameId, pos) {\r\n        super();\r\n        this.setReferenceFrame(referenceFrameId);\r\n        this.pos = pos;\r\n    }\r\n\r\n    getStateInOwnFrameByEpoch(epoch) {\r\n        this.validateEpoch(epoch);\r\n        return new StateVector(this.pos);\r\n    }\r\n}\r\n","import TrajectoryKeplerianArray from \"../core/Trajectory/KeplerianArray\";\r\nimport TrajectoryKeplerianPrecessingArray from \"../core/Trajectory/KeplerianPrecessingArray\";\r\nimport TrajectoryKeplerianBasic from \"../core/Trajectory/KeplerianBasic\";\r\nimport TrajectoryKeplerianPrecessing from \"../core/Trajectory/KeplerianPrecessing\";\r\nimport KeplerianObject from \"../core/KeplerianObject\";\r\nimport TrajectoryComposite from \"../core/Trajectory/Composite\";\r\nimport VisualTrajectoryModelPointArray from \"../core/visual/TrajectoryModel/PointArray\";\r\nimport VisualTrajectoryModelKeplerian from \"../core/visual/TrajectoryModel/Keplerian\";\r\nimport TrajectoryStaticPosition from \"../core/Trajectory/StaticPosition\";\r\nimport {Vector} from \"../core/algebra\";\r\nimport { sim } from \"../core/Simulation\";\r\n\r\nexport default class TrajectoryLoader\r\n{\r\n    static create(config) {\r\n        let type = config.type;\r\n        let trajectory;\r\n        let visualModel;\r\n\r\n        if (type === 'keplerian') {\r\n            trajectory = this.createKeplerianBasic(config);\r\n        } else if (type === 'keplerian_precessing') {\r\n            trajectory = this.createKeplerianPrecessing(config);\r\n        } else if (type === 'keplerian_array') {\r\n            trajectory = this.createKeplerianArray(config);\r\n        } else if (type === 'keplerian_precessing_array') {\r\n            trajectory = this.createKeplerianPrecessingArray(config);\r\n        } else if (type === 'composite') {\r\n            trajectory = this.createComposite(config);\r\n        } else if (type === 'static') {\r\n            trajectory = this.createStatic(config);\r\n        } else {\r\n            const className = sim.getClass(type);\r\n            trajectory = new className(config.data);\r\n        }\r\n\r\n        if (config.periodStart !== undefined) {\r\n            trajectory.minEpoch = config.periodStart;\r\n        }\r\n        if (config.periodEnd !== undefined) {\r\n            trajectory.maxEpoch = config.periodEnd;\r\n        }\r\n\r\n        // temporary\r\n        if (config.rendering) {\r\n            config.visual = config.rendering;\r\n        }\r\n\r\n        if (config.visual !== undefined) {\r\n            if (config.visual.keplerianModel) {\r\n                visualModel = new VisualTrajectoryModelKeplerian(trajectory, config.visual);\r\n            } else if (config.visual.pointArrayModel) {\r\n                visualModel = new VisualTrajectoryModelPointArray(trajectory, config.visual);\r\n            }\r\n        }\r\n\r\n        if (visualModel) {\r\n            trajectory.setVisualModel(visualModel);\r\n        }\r\n\r\n        return trajectory;\r\n    }\r\n\r\n    static createComposite(config) {\r\n        let traj = new TrajectoryComposite();\r\n        for (const partConfig of config.data) {\r\n            traj.addComponent(this.create(partConfig));\r\n        }\r\n        return traj;\r\n    }\r\n\r\n    static createKeplerianArray(config) {\r\n        let traj = new TrajectoryKeplerianArray(\r\n            config.data.referenceFrame\r\n        );\r\n\r\n        for (const entry of config.data.elementsArray) {\r\n            traj.addState(this.createKeplerianObject(entry, config.data.mu));\r\n        }\r\n        return traj;\r\n    }\r\n\r\n    static createKeplerianPrecessingArray(config) {\r\n        let traj = new TrajectoryKeplerianPrecessingArray(\r\n            config.data.referenceFrame,\r\n            config.data.radius,\r\n            config.data.j2\r\n        );\r\n\r\n        for (const entry of config.data.elementsArray) {\r\n            traj.addState(this.createKeplerianObject(entry, config.data.mu));\r\n        }\r\n        return traj;\r\n    }\r\n\r\n    static createKeplerianBasic(config) {\r\n        return new TrajectoryKeplerianBasic(\r\n            config.data.referenceFrame,\r\n            this.createKeplerianObject(config.data.elements)\r\n        );\r\n    }\r\n\r\n    static createKeplerianPrecessing(config) {\r\n        return new TrajectoryKeplerianPrecessing(\r\n            config.data.referenceFrame,\r\n            this.createKeplerianObject(config.data.elements),\r\n            config.data.radius,\r\n            config.data.j2\r\n        );\r\n    }\r\n\r\n    static createStatic(config) {\r\n        return new TrajectoryStaticPosition(\r\n            config.data.referenceFrame,\r\n            new Vector(config.data.position)\r\n        );\r\n    }\r\n\r\n    static createKeplerianObject(elements, mu) {\r\n        return new KeplerianObject(\r\n            elements[0], // ecc\r\n            elements[1] / (1 - elements[0]), // sma = Rper / (1 - ecc)\r\n            elements[2], // aop\r\n            elements[3], // inc\r\n            elements[4], // raan\r\n            elements[5], // mean anomaly\r\n            elements[6], // epoch\r\n            mu ? mu : elements[7], // mu\r\n            false\r\n        );\r\n    }\r\n}\r\n","import * as THREE from \"three\";\r\n\r\nimport { deg2rad, Quaternion } from \"../algebra\";\r\nimport VisualModelAbstract from \"./ModelAbstract\";\r\n\r\nexport default class VisualStarsModel extends VisualModelAbstract\r\n{\r\n    constructor(data) {\r\n        super();\r\n\r\n        let threeGeometry = new THREE.Geometry();\r\n\r\n        const starDist = 1e12;\r\n\r\n        for(let params of data) {\r\n\r\n            threeGeometry.vertices.push(new THREE.Vector3(\r\n                starDist * Math.cos(deg2rad(params[0])) * Math.cos(deg2rad(params[1])),\r\n                starDist * Math.sin(deg2rad(params[0])) * Math.cos(deg2rad(params[1])),\r\n                starDist * Math.sin(deg2rad(params[1]))\r\n            ));\r\n\r\n            threeGeometry.colors.push(new THREE.Color(\r\n                params[2] / 50,\r\n                params[2] / 50,\r\n                params[2] / 50\r\n            ));\r\n        }\r\n\r\n        this.setThreeObj(new THREE.Points(\r\n            threeGeometry,\r\n            new THREE.PointsMaterial({\r\n                vertexColors: THREE.VertexColors,\r\n                size: 2,\r\n                sizeAttenuation: false\r\n            })\r\n        ));\r\n\r\n        this.threeObj.quaternion.copy(new Quaternion([-1, 0, 0], deg2rad(23.4)).toThreejs());\r\n    }\r\n}\r\n","import * as THREE from \"three\";\r\n\r\nimport VisualModelAbstract from \"./ModelAbstract\";\r\nimport { sim } from \"../Simulation\";\r\n\r\nexport default class VisualLabel extends VisualModelAbstract {\r\n    constructor(functionOfEpoch, parameters) {\r\n        super();\r\n\r\n        this.visible = true;\r\n\r\n        this.parameters = Object.assign({}, VisualLabel.DEFAULT_SETTINGS, parameters);\r\n        this.functionOfEpoch = functionOfEpoch;\r\n\r\n        this.canvas = document.createElement('canvas');\r\n\r\n        this.setThreeObj(new THREE.Sprite(new THREE.SpriteMaterial(\r\n            {map: new THREE.CanvasTexture(this.canvas)}\r\n        )));\r\n\r\n        this.setText(this.parameters.text);\r\n    }\r\n\r\n    setText(text) {\r\n        let context = this.canvas.getContext('2d');\r\n        context.font = this.parameters.fontSize + 'px ' + this.parameters.font;\r\n\r\n        let canvasWidth = context.measureText(text).width;\r\n        let canvasHeight = this.parameters.fontSize * (1 + this.parameters.margin) * 2;\r\n        this.canvas.width = THREE.Math.ceilPowerOfTwo(canvasWidth);\r\n        this.canvas.height = THREE.Math.ceilPowerOfTwo(canvasHeight);\r\n\r\n        context.font = this.parameters.fontSize + 'px ' + this.parameters.font;\r\n        context.fillStyle = this.parameters.color;\r\n        context.textAlign = 'center';\r\n        context.textBaseline = 'bottom';\r\n        context.fillText(\r\n            text,\r\n            this.canvas.width / 2,\r\n            this.parameters.fontSize + (this.canvas.height - canvasHeight) / 2\r\n        );\r\n\r\n        this.threeObj.material.map.needsUpdate = true;\r\n    }\r\n\r\n    render(epoch) {\r\n        if (!this.visible) {\r\n            this.threeObj.visible = false;\r\n            return;\r\n        }\r\n\r\n        this.threeObj.position.copy(sim.getVisualCoords(this.functionOfEpoch.evaluate(epoch)));\r\n\r\n        const distance = this.threeObj.position.length();\r\n\r\n        const scaleCoeff = this.calculateScaleCoeff(distance, this.parameters.scaling) / 2;\r\n        this.threeObj.scale.x = this.canvas.width  * scaleCoeff;\r\n        this.threeObj.scale.y = this.canvas.height * scaleCoeff;\r\n\r\n        this.threeObj.visible = 1 < Math.max(this.threeObj.scale.x, this.threeObj.scale.y) /\r\n            (distance * sim.raycaster.getPixelAngleSize()) / 2;\r\n    }\r\n\r\n    calculateScaleCoeff(distance, scaling) {\r\n        if (typeof scaling.callback === 'string') {\r\n            return VisualLabel.scalingFunctions[scaling.callback](distance, scaling.range);\r\n        }\r\n        return scaling.callback(distance, scaling.range);\r\n    }\r\n}\r\n\r\nVisualLabel.DEFAULT_SETTINGS = {\r\n    text: '',\r\n    font: 'Arial',\r\n    color: 'white',\r\n    fontSize: 32,\r\n    margin: 0,\r\n    scaling: {\r\n        range: {\r\n            from: 30000,\r\n            to: 700000,\r\n        },\r\n        callback: 'range'\r\n    }\r\n};\r\n\r\nVisualLabel.scalingFunctions = {\r\n    alwaysVisible: (distance) => distance * sim.raycaster.getPixelAngleSize(),\r\n    range: (distance, range) => {\r\n        if (distance < range.from) {\r\n            return range.from * sim.raycaster.getPixelAngleSize();\r\n        }\r\n        if (distance > range.to) {\r\n            return range.to * sim.raycaster.getPixelAngleSize();\r\n        }\r\n        return distance * sim.raycaster.getPixelAngleSize();\r\n    }\r\n};\r\n","import * as THREE from \"three\";\r\n\r\nimport VisualModelAbstract from \"../ModelAbstract\";\r\nimport VisualLabel from \"../VisualLabel\";\r\nimport Events from \"../../Events\";\r\nimport EphemerisObject from \"../../EphemerisObject\";\r\nimport FunctionOfEpochCustom from \"../../FunctionOfEpoch/Custom\";\r\nimport { sim } from \"../../Simulation\";\r\n\r\nexport default class VisualBodyModelAbstract extends VisualModelAbstract\r\n{\r\n    constructor(shape, config) {\r\n        super();\r\n\r\n        this.shape = shape;   // class VisualShapeAbstract\r\n        this.color = config.color;\r\n        this.body = null; // class Body\r\n\r\n        this.setThreeObj(this.getThreeObj());\r\n        this.threeObj.add(new THREE.AxesHelper(shape.radius * 2));\r\n    }\r\n\r\n    getThreeObj() {\r\n        return new THREE.Mesh(\r\n            this.shape.getThreeGeometry(),\r\n            this.getMaterial({color: this.color, wireframe: true})\r\n        );\r\n    }\r\n\r\n    setObject(obj) {\r\n        this.body = obj;\r\n        this.label = new VisualLabel(\r\n            new FunctionOfEpochCustom((epoch) => {\r\n                return obj.getPositionByEpoch(epoch).add_(sim.camera.getTopDirection(epoch).mul_(this.shape.getMaxDimension() / 2));\r\n            }),\r\n            {\r\n                text: this.body.name,\r\n                margin: 0.3,\r\n                scaling: (this.body.type === EphemerisObject.TYPE_STAR\r\n                        || this.body.type === EphemerisObject.TYPE_PLANET)\r\n                    ? {callback: 'alwaysVisible'}\r\n                    : (this.body.type === EphemerisObject.TYPE_PLANETOID\r\n                        || this.body.type === EphemerisObject.TYPE_SATELLITE)\r\n                        ? {\r\n                            callback: 'range',\r\n                            range: {\r\n                                from: 5 * this.shape.getMaxDimension(),\r\n                                to: 1000 * this.shape.getMaxDimension()\r\n                            }\r\n                        }\r\n                        : VisualLabel.DEFAULT_SETTINGS.scaling\r\n            }\r\n        );\r\n    }\r\n\r\n    getMaterial(parameters) {\r\n        return new THREE.MeshStandardMaterial(parameters);\r\n    }\r\n\r\n    drop() {\r\n        if (this.label) {\r\n            this.label.drop();\r\n        }\r\n\r\n        super.drop();\r\n    }\r\n\r\n    render(epoch) {\r\n        if (this.label) {\r\n            this.label.visible = sim.settings.ui.showBodyLabels;\r\n        }\r\n        this.threeObj.position.copy(sim.getVisualCoords(this.body.getPositionByEpoch(epoch)));\r\n        this.threeObj.quaternion.copy(\r\n            this.body.orientation.getQuaternionByEpoch(epoch).toThreejs()\r\n        );\r\n    }\r\n}\r\n","import * as THREE from \"three\";\r\n\r\nimport VisualBodyModelAbstract from \"./Abstract\";\r\nimport VisualModelAbstract from \"../ModelAbstract\"\r\nimport { sim } from \"../../Simulation\";\r\n\r\nexport default class VisualBodyModelBasic extends VisualBodyModelAbstract\r\n{\r\n    constructor(shape, config) {\r\n        super(shape, config);\r\n\r\n        this.texturePath = config.texturePath;\r\n        this.isTextureRequested = false;\r\n    }\r\n\r\n    getMaterial(parameters) {\r\n        parameters.metalness = 0;\r\n        parameters.roughness = 1;\r\n        return new THREE.MeshStandardMaterial(parameters);\r\n    }\r\n\r\n    render(epoch) {\r\n        super.render(epoch);\r\n        if (!this.isTextureRequested\r\n            && this.texturePath\r\n            && this.shape.getMaxDimension() / this.threeObj.position.length() > sim.raycaster.getPixelAngleSize()\r\n        ) {\r\n            this.isTextureRequested = true;\r\n            sim.textureLoader.load(\r\n                VisualModelAbstract.texturePath + this.texturePath,\r\n                (txt) => {\r\n                    this.threeObj.material.dispose();\r\n                    this.threeObj.material = this.getMaterial({map: txt});\r\n                },\r\n                undefined,\r\n                function(err) {\r\n                    console.log(err);\r\n                }\r\n            );\r\n        }\r\n    }\r\n}\r\n","import * as THREE from \"three\";\r\n\r\nimport VisualBodyModelBasic from \"./Basic\";\r\nimport { sim } from \"../../Simulation\";\r\n\r\nexport default class VisualBodyModelLight extends VisualBodyModelBasic\r\n{\r\n    constructor(shape, config) {\r\n        super(shape, config);\r\n        this.light = new THREE.PointLight(\r\n            config.lightColor,\r\n            config.lightIntensity,\r\n            config.lightDistance || null,\r\n            config.lightDecay || null\r\n        );\r\n        this.scene.add(this.light);\r\n    }\r\n\r\n    render(epoch) {\r\n        super.render(epoch);\r\n        this.light.position.copy(sim.getVisualCoords(this.body.getPositionByEpoch(epoch)));\r\n    }\r\n\r\n    getMaterial(parameters) {\r\n        return new THREE.MeshBasicMaterial(parameters);\r\n    }\r\n\r\n    drop() {\r\n        this.scene.remove(this.light);\r\n        super.drop();\r\n    }\r\n}\r\n","import * as THREE from \"three\";\r\n\r\nimport VisualBodyModelAbstract from \"./Abstract\";\r\nimport VisualModelAbstract from \"../ModelAbstract\"\r\nimport { sim } from \"../../Simulation\";\r\n\r\nexport default class VisualBodyModelRings extends VisualBodyModelAbstract\r\n{\r\n    constructor(shape, config) {\r\n        super(shape, config);\r\n\r\n        this.texturePath = config.texturePath;\r\n        this.ringsRadius = config.ringsRadius;\r\n        this.ringsColorMapPath = config.ringsColorMapPath;\r\n        this.ringsAlphaMapPath = config.ringsAlphaMapPath;\r\n        this.isTextureRequested = false;\r\n    }\r\n\r\n    getThreeObj() {\r\n        let container = new THREE.Object3D();\r\n\r\n        this.bodyThreeObj = new THREE.Mesh(\r\n            this.shape.getThreeGeometry(),\r\n            this.getMaterial({color: this.color, wireframe: true})\r\n        );\r\n\r\n        this.ringsThreeObj = new THREE.Mesh(\r\n            new THREE.CircleGeometry(140220, 64),\r\n            this.getMaterial({color: this.color, wireframe: true})\r\n        );\r\n\r\n        container.add(this.bodyThreeObj);\r\n        container.add(this.ringsThreeObj);\r\n\r\n        return container;\r\n    }\r\n\r\n    updateRingsMaterial() {\r\n        if (this.ringsColorMap && this.ringsAlphaMap) {\r\n            this.ringsThreeObj.material.dispose();\r\n            this.ringsThreeObj.material = this.getMaterial({\r\n                map: this.ringsColorMap,\r\n                alphaMap: this.ringsAlphaMap,\r\n                side: THREE.DoubleSide,\r\n                transparent: true\r\n            });\r\n        }\r\n    }\r\n\r\n    getMaterial(parameters) {\r\n        parameters.metalness = 0;\r\n        parameters.roughness = 1;\r\n        return new THREE.MeshStandardMaterial(parameters);\r\n    }\r\n\r\n    render(epoch) {\r\n        super.render(epoch);\r\n        if (!this.isTextureRequested\r\n            && this.texturePath\r\n            && this.shape.getMaxDimension() / this.threeObj.position.length() > sim.raycaster.getPixelAngleSize()\r\n        ) {\r\n            this.isTextureRequested = true;\r\n            sim.textureLoader.load(\r\n                VisualModelAbstract.texturePath + this.texturePath,\r\n                (txt) => {\r\n                    this.bodyThreeObj.material.dispose();\r\n                    this.bodyThreeObj.material = this.getMaterial({map: txt});\r\n                },\r\n                undefined,\r\n                function(err) {\r\n                    console.log(err);\r\n                }\r\n            );\r\n            sim.textureLoader.load(\r\n                VisualModelAbstract.texturePath + this.ringsColorMapPath,\r\n                (txt) => {\r\n                    this.ringsColorMap = txt;\r\n                    this.updateRingsMaterial();\r\n                },\r\n                undefined,\r\n                function(err) {\r\n                    console.log(err);\r\n                }\r\n            );\r\n            sim.textureLoader.load(\r\n                VisualModelAbstract.texturePath + this.ringsAlphaMapPath,\r\n                (txt) => {\r\n                    this.ringsAlphaMap = txt;\r\n                    this.updateRingsMaterial();\r\n                },\r\n                undefined,\r\n                function(err) {\r\n                    console.log(err);\r\n                }\r\n            );\r\n        }\r\n    }\r\n}\r\n","import * as THREE from \"three\";\r\n\r\nimport VisualShapeAbstract from \"./Abstract\";\r\n\r\nexport default class VisualShapeSphere extends VisualShapeAbstract\r\n{\r\n    constructor(radius, segments) {\r\n        super();\r\n        this.radius = radius;\r\n        this.segments = segments;\r\n    }\r\n\r\n    getThreeGeometry() {\r\n        if (!this.threeGeometry) {\r\n            this.threeGeometry = new THREE.SphereGeometry(this.radius, this.segments * 2, this.segments);\r\n            this.threeGeometry.rotateX(Math.PI / 2);\r\n        }\r\n\r\n        return this.threeGeometry;\r\n    }\r\n\r\n    getMaxDimension() {\r\n        return this.radius * 2;\r\n    }\r\n}\r\n","import $ from \"jquery\";\r\n\r\nimport ReferenceFrameFactory, {RF_BASE_OBJ} from \"../core/ReferenceFrame/Factory\";\r\nimport Body from \"../core/Body\";\r\nimport OrientationConstantAxis from \"../core/Orientation/ConstantAxis\";\r\nimport PhysicalBodyModel from \"../core/PhysicalBodyModel\";\r\nimport EphemerisObject from \"../core/EphemerisObject\";\r\nimport TrajectoryLoader from \"./TrajectoryLoader\";\r\nimport VisualStarsModel from \"../core/visual/StarsModel\";\r\nimport VisualBodyModelLight from \"../core/visual/BodyModel/Light\";\r\nimport VisualBodyModelRings from \"../core/visual/BodyModel/Rings\";\r\nimport VisualBodyModelBasic from \"../core/visual/BodyModel/Basic\";\r\nimport VisualShapeSphere from \"../core/visual/Shape/Sphere\";\r\nimport Events from \"../core/Events\";\r\nimport { sim } from \"../core/Simulation\";\r\n\r\nexport default class StarSystemLoader\r\n{\r\n    static loadFromConfig(starSystem, config) {\r\n        // Loading name\r\n        starSystem.name = config.name;\r\n\r\n        // Loading main object\r\n        starSystem.mainObject = config.mainObject;\r\n\r\n        starSystem.addObject(0, new EphemerisObject(0, EphemerisObject.TYPE_POINT, 'Star system barycenter'));\r\n\r\n        // Loading objects\r\n        for (const objectConfig of config.objects) {\r\n            this._loadObject(starSystem, objectConfig);\r\n        }\r\n\r\n        Events.dispatch(Events.LOADING_BODIES_DONE);\r\n\r\n        // Loading reference frames\r\n        starSystem.addReferenceFrame(RF_BASE_OBJ);\r\n\r\n        for (const frame of config.referenceFrames) {\r\n            starSystem.addReferenceFrame(\r\n                ReferenceFrameFactory.create(frame.id, frame.type, frame.config)\r\n            );\r\n        }\r\n\r\n        Events.dispatch(Events.LOADING_FRAMES_DONE);\r\n\r\n        // Loading trajectories\r\n        for (const objectConfig of config.objects) {\r\n            starSystem.getObject(objectConfig.id).setTrajectory(TrajectoryLoader.create(objectConfig.trajectory));\r\n        }\r\n\r\n        Events.dispatch(Events.LOADING_TRAJECTORIES_DONE);\r\n\r\n        // Loading stars\r\n        starSystem.addStars(new VisualStarsModel(config.stars));\r\n    }\r\n\r\n    static loadObjectByUrl(starSystem, url) {\r\n        $.getJSON(url, (objectConfig) => {\r\n            this._loadObject(starSystem, objectConfig);\r\n            starSystem.getObject(objectConfig.id).setTrajectory(TrajectoryLoader.create(objectConfig.trajectory));\r\n        });\r\n    }\r\n\r\n    static _loadObject(starSystem, config) {\r\n        let object;\r\n        let visualModel = null;\r\n        let physicalModel = null;\r\n        let orientation = null;\r\n\r\n        if (config.visual) {\r\n            const visualShape = new VisualShapeSphere(\r\n                config.visual.config.radius,\r\n                config.visual.config.texturePath ? 32 : 12\r\n            );\r\n            const visualModelClass = {\r\n                'basic': VisualBodyModelBasic,\r\n                'light': VisualBodyModelLight,\r\n                'rings': VisualBodyModelRings,\r\n            }[config.visual.model];\r\n\r\n            if (visualModelClass !== undefined) {\r\n                visualModel = new visualModelClass(visualShape, config.visual.config);\r\n            }\r\n        }\r\n\r\n        if (config.physical || config.orientation) {\r\n            if (!config.orientation) {\r\n                config.orientation = {\r\n                    type: 'constantAxis',\r\n                    config: {\r\n                        vector: [0, 0, 1e-11]\r\n                    }\r\n                };\r\n            }\r\n            let className;\r\n            if (config.orientation.type === 'constantAxis') {\r\n                className = OrientationConstantAxis;\r\n            } else {\r\n                className = sim.getClass(config.orientation.type);\r\n            }\r\n            orientation = new className(config.orientation.config);\r\n        }\r\n\r\n        if (config.physical) {\r\n            physicalModel = new PhysicalBodyModel(\r\n                config.physical\r\n            );\r\n        }\r\n\r\n        if (visualModel || physicalModel || orientation) {\r\n            object = new Body(\r\n                config.id,\r\n                config.type || EphemerisObject.TYPE_UNKNOWN,\r\n                config.name,\r\n                config.data,\r\n                visualModel,\r\n                physicalModel,\r\n                orientation\r\n            );\r\n        } else {\r\n            object = new EphemerisObject(\r\n                config.id,\r\n                config.type || EphemerisObject.TYPE_UNKNOWN,\r\n                config.name,\r\n                config.data\r\n            );\r\n        }\r\n\r\n        starSystem.addObject(\r\n            config.id,\r\n            object\r\n        );\r\n    }\r\n}\r\n","var map = {\n\t\"./KSP/ModuleKSP\": [\n\t\t67,\n\t\t1\n\t],\n\t\"./KSP/ModuleKSP.js\": [\n\t\t67,\n\t\t1\n\t],\n\t\"./PatchedConics/ModulePatchedConics\": [\n\t\t68,\n\t\t2\n\t],\n\t\"./PatchedConics/ModulePatchedConics.js\": [\n\t\t68,\n\t\t2\n\t],\n\t\"./PatchedConics/PropagatorPatchedConics\": [\n\t\t64,\n\t\t3\n\t],\n\t\"./PatchedConics/PropagatorPatchedConics.js\": [\n\t\t64,\n\t\t3\n\t],\n\t\"./SolarSystem/ModuleSolarSystem\": [\n\t\t62,\n\t\t0\n\t],\n\t\"./SolarSystem/ModuleSolarSystem.js\": [\n\t\t62,\n\t\t0\n\t],\n\t\"./SolarSystem/Orientation/IAUModel\": [\n\t\t63,\n\t\t4\n\t],\n\t\"./SolarSystem/Orientation/IAUModel.js\": [\n\t\t63,\n\t\t4\n\t],\n\t\"./SolarSystem/Trajectory/ELP2000\": [\n\t\t65,\n\t\t0\n\t],\n\t\"./SolarSystem/Trajectory/ELP2000.js\": [\n\t\t65,\n\t\t0\n\t],\n\t\"./SolarSystem/Trajectory/VSOP87\": [\n\t\t66,\n\t\t0\n\t],\n\t\"./SolarSystem/Trajectory/VSOP87.js\": [\n\t\t66,\n\t\t0\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tvar ids = map[req];\n\tif(!ids) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\tvar id = ids[0];\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 75;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./getting-started-wizard\": [\n\t\t69,\n\t\t5\n\t],\n\t\"./getting-started-wizard.js\": [\n\t\t69,\n\t\t5\n\t],\n\t\"./wizard-ids\": [\n\t\t39\n\t],\n\t\"./wizard-ids.js\": [\n\t\t39\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tvar ids = map[req];\n\tif(!ids) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\treturn Promise.all(ids.slice(1).map(__webpack_require__.e)).then(function() {\n\t\tvar id = ids[0];\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 78;\nmodule.exports = webpackAsyncContext;","export const TOP_MENU_ITEMS = {\r\n    SIMULATION: \"Simulation\",\r\n    EDIT: \"Edit\",\r\n    VIEW: \"View\",\r\n    SETTINGS: \"Settings\",\r\n    HELP: \"Help\",\r\n};\r\n\r\nexport const HELP_PAGE_URL =\r\n    \"https://github.com/tossha/urbain/wiki/%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5-Urbain\";\r\n","import { HELP_PAGE_URL, TOP_MENU_ITEMS } from \"./constants\";\r\nimport { createContext } from \"./context\";\r\n\r\nexport const MenuItemType = {\r\n    NONE: 0,\r\n    LINK: 1,\r\n    DROPDOWN: 2,\r\n};\r\n\r\nclass MenuItem {\r\n    constructor(label, type = MenuItemType.NONE) {\r\n        this.label = label;\r\n        this.type = type;\r\n    }\r\n\r\n    get isClickable() {\r\n        return true;\r\n    }\r\n}\r\n\r\nclass LinkMenuItem extends MenuItem {\r\n    constructor(label, { href = \"\", target = \"_self\" } = {}) {\r\n        super(label, MenuItemType.LINK);\r\n\r\n        this.href = href;\r\n        this.target = target;\r\n    }\r\n\r\n    get isClickable() {\r\n        return Boolean(this.href);\r\n    }\r\n}\r\n\r\nclass DropDownMenuItem extends MenuItem {\r\n    constructor(label, options = []) {\r\n        super(label, MenuItemType.DROPDOWN);\r\n\r\n        this.options = options;\r\n    }\r\n\r\n    onSelect = selectedLabel => {\r\n        this.options = this.options.map(option => {\r\n            const newOption = {\r\n                ...option,\r\n                selected: selectedLabel === option.label ? !option.selected : option.selected,\r\n            };\r\n\r\n            if (selectedLabel === option.label && option.onUpdate) {\r\n                option.onUpdate(newOption);\r\n            }\r\n\r\n            return newOption;\r\n        });\r\n    };\r\n}\r\n\r\nclass Store {\r\n    constructor(simulation) {\r\n        this._simulation = simulation;\r\n    }\r\n\r\n    viewSettings = {\r\n        showStatistics: false,\r\n        showBodyLabels: true,\r\n        showOrbitCreationPanel: false,\r\n        showTransferCalculationPanel: false,\r\n    };\r\n\r\n    topMenu = [\r\n        new DropDownMenuItem(TOP_MENU_ITEMS.SIMULATION, [\r\n            {\r\n                label: \"Orbit creation panel\",\r\n                selected: this.viewSettings.showOrbitCreationPanel,\r\n                onUpdate: ({ selected }) => {\r\n                    this.viewSettings.showOrbitCreationPanel = selected;\r\n                },\r\n            },\r\n            {\r\n                label: \"Transfer calculation panel\",\r\n                selected: this.viewSettings.showTransferCalculationPanel,\r\n                onUpdate: ({ selected }) => {\r\n                    this.viewSettings.showTransferCalculationPanel = selected;\r\n                },\r\n            },\r\n        ]),\r\n        new LinkMenuItem(TOP_MENU_ITEMS.EDIT),\r\n        new DropDownMenuItem(TOP_MENU_ITEMS.VIEW, [\r\n            {\r\n                label: \"Body Labels\",\r\n                selected: this.viewSettings.showBodyLabels,\r\n                onUpdate: ({ selected }) => {\r\n                    this._simulation.settings.ui.showBodyLabels = selected;\r\n                    this.viewSettings.showBodyLabels = selected;\r\n                },\r\n            },\r\n            {\r\n                label: \"Statistics badge\",\r\n                selected: false,\r\n                onUpdate: ({ selected }) => {\r\n                    this.viewSettings.showStatistics = selected;\r\n                },\r\n            },\r\n        ]),\r\n        new LinkMenuItem(TOP_MENU_ITEMS.HELP, {\r\n            href: HELP_PAGE_URL,\r\n            target: \"_blank\",\r\n        }),\r\n    ];\r\n\r\n    get starSystemSelectorSettings() {\r\n        const { starSystemManager } = this._simulation;\r\n\r\n        return {\r\n            options: starSystemManager.starSystems,\r\n            defaultValue: starSystemManager.defaultStarSystem,\r\n            onSelect: item => starSystemManager.loadByIdx(item.idx),\r\n        };\r\n    }\r\n}\r\n\r\nconst { Provider, Consumer } = createContext();\r\n\r\nexport { Store, TOP_MENU_ITEMS, Provider, Consumer };\r\n","import React from \"react\";\r\n\r\nexport function createContext(defaultValue) {\r\n    const { Provider, Consumer } = React.createContext(defaultValue);\r\n\r\n    return {\r\n        Provider,\r\n        Consumer,\r\n    };\r\n}\r\n","import React, { Component } from \"react\";\r\nimport Stats from \"stats.js\";\r\n\r\nimport { Consumer } from \"../../../../store/index\";\r\nimport \"./index.css\";\r\n\r\nclass StatisticsBadge extends Component {\r\n    elementRef = React.createRef();\r\n\r\n    componentDidMount() {\r\n        this.elementRef.current.appendChild(this.props.stats.dom);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        this.elementRef = null;\r\n    }\r\n\r\n    render() {\r\n        return <div ref={this.elementRef} className=\"statistics-badge\" />;\r\n    }\r\n}\r\n\r\nexport default () => (\r\n    <Consumer>\r\n        {({ store, stats }) => (store.viewSettings.showStatistics ? <StatisticsBadge stats={stats} /> : null)}\r\n    </Consumer>\r\n);\r\n\r\nexport function createStatsBadge() {\r\n    const statsBadge = new Stats();\r\n    statsBadge.dom.classList.add(\"stats-badge\");\r\n\r\n    return statsBadge;\r\n}\r\n","class LocalStorageWatchStatusService {\n    static KEY = \"urbain-watched-wizards\";\n\n    constructor(storage) {\n        this._storage = storage;\n    }\n\n    canWatch(wizardId) {\n        return !this._getWatchedWizards().some(id => id === wizardId);\n    }\n\n    _getWatchedWizards() {\n        const wizardIdsRawString = this._storage.getItem(LocalStorageWatchStatusService.KEY);\n\n        if (!wizardIdsRawString) {\n            return [];\n        }\n\n        return JSON.parse(wizardIdsRawString);\n    }\n\n    _saveStatuses(wizardIds) {\n        this._storage.setItem(LocalStorageWatchStatusService.KEY, JSON.stringify(wizardIds));\n    }\n}\n\nexport default LocalStorageWatchStatusService;\n","import React from \"react\";\r\n\r\nconst Logo = ({ className }) => <div className={className} />;\r\n\r\nexport default Logo;\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport ReactSelect, { components } from \"react-select\";\r\n\r\nconst DEFAULT = {\r\n    background: \"var(--black)\",\r\n    color: \"var(--white-text)\",\r\n    containerHeight: 24,\r\n};\r\n\r\nconst customSelectStyles = {\r\n    container: base => ({\r\n        ...base,\r\n        background: DEFAULT.background,\r\n        color: DEFAULT.color,\r\n        minHeight: DEFAULT.containerHeight,\r\n        height: DEFAULT.containerHeight,\r\n        minWidth: 50,\r\n    }),\r\n\r\n    control: base => ({\r\n        ...base,\r\n        background: DEFAULT.background,\r\n        borderRadius: 0,\r\n        borderStyle: \"none\",\r\n        minHeight: DEFAULT.containerHeight,\r\n        height: DEFAULT.containerHeight,\r\n    }),\r\n\r\n    menu: base => ({\r\n        ...base,\r\n        borderRadius: 0,\r\n        marginTop: 0,\r\n        marginBottom: 0,\r\n    }),\r\n\r\n    menuList: base => ({\r\n        ...base,\r\n        background: \"var(--dark-gray)\",\r\n    }),\r\n\r\n    option: (base, state) => ({\r\n        ...base,\r\n        backgroundColor: state.isFocused ? \"var(--gray)\" : \"transparent\",\r\n    }),\r\n\r\n    singleValue: (base, state) => {\r\n        const opacity = state.isDisabled ? 0.5 : 1;\r\n        const transition = \"opacity 300ms\";\r\n\r\n        return {\r\n            ...base,\r\n            color: DEFAULT.color,\r\n            opacity,\r\n            transition,\r\n        };\r\n    },\r\n\r\n    dropdownIndicator: () => ({\r\n        padding: 0,\r\n        background: `url(\"/images/chevron-down-solid.svg\") 0 0 no-repeat`,\r\n        marginRight: 5,\r\n        height: 10,\r\n        width: 10,\r\n    }),\r\n\r\n    indicatorSeparator: () => ({\r\n        display: \"none\",\r\n    }),\r\n};\r\n\r\nconst IndicatorsContainer = props => {\r\n    return components.IndicatorsContainer && <components.IndicatorsContainer {...props} />;\r\n};\r\n\r\nconst DropdownIndicator = props => {\r\n    return (\r\n        components.DropdownIndicator && (\r\n            <components.DropdownIndicator {...props}>\r\n                <span />\r\n            </components.DropdownIndicator>\r\n        )\r\n    );\r\n};\r\n\r\nconst Select = ({ id, className, options, value, onSelect = () => {} }) => {\r\n    return (\r\n        <ReactSelect\r\n            id={id}\r\n            className={className}\r\n            classNamePrefix=\"select\"\r\n            placeholder=\"\"\r\n            styles={customSelectStyles}\r\n            isSearchable={false}\r\n            options={options}\r\n            defaultValue={value}\r\n            components={{ IndicatorsContainer, DropdownIndicator }}\r\n            onChange={onSelect}\r\n        />\r\n    );\r\n};\r\n\r\nexport const optionPropTypes = PropTypes.shape({\r\n    label: PropTypes.string,\r\n    value: PropTypes.string,\r\n});\r\n\r\nSelect.propTypes = {\r\n    id: PropTypes.string,\r\n    className: PropTypes.string,\r\n    options: PropTypes.arrayOf(optionPropTypes).isRequired,\r\n    value: optionPropTypes,\r\n    onSelect: PropTypes.func,\r\n};\r\n\r\nexport default Select;\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\n\r\nimport { Consumer } from \"../../../../store\";\r\nimport Select, { optionPropTypes } from \"../../../common/select/select\";\r\nimport \"./star-system-selector.css\";\r\n\r\nfunction StarSystemSelector({ options, defaultValue, onSelect }) {\r\n    return (\r\n        <div className=\"star-system-selector\">\r\n            <div className=\"star-system-selector__label\">Star system</div>\r\n            <Select\r\n                className=\"star-system-selector__selector\"\r\n                options={options}\r\n                value={defaultValue || options[0]}\r\n                onSelect={onSelect}\r\n            />\r\n        </div>\r\n    );\r\n}\r\n\r\nStarSystemSelector.propTypes = {\r\n    options: PropTypes.arrayOf(optionPropTypes).isRequired,\r\n    defaultValue: optionPropTypes,\r\n    onSelect: PropTypes.func,\r\n};\r\n\r\nexport default () => (\r\n    <Consumer>\r\n        {({ store }) => {\r\n            const { options, defaultValue, onSelect } = store.starSystemSelectorSettings;\r\n\r\n            return <StarSystemSelector options={options} defaultValue={defaultValue} onSelect={onSelect} />;\r\n        }}\r\n    </Consumer>\r\n);\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\n\r\nclass DropdownMenuItem extends Component {\r\n    static propTypes = {\r\n        text: PropTypes.string.isRequired,\r\n        selected: PropTypes.bool,\r\n        onClick: PropTypes.func,\r\n    };\r\n\r\n    handleClick = () => {\r\n        this.props.onClick(this.props.text);\r\n    };\r\n\r\n    render() {\r\n        const { text, selected } = this.props;\r\n\r\n        return (\r\n            <li className=\"drop-down-menu__menu-item\" onClick={this.handleClick}>\r\n                <span className=\"drop-down-menu__menu-item-icon\">{selected && <FontAwesomeIcon icon=\"check\" />}</span>\r\n                {text}\r\n            </li>\r\n        );\r\n    }\r\n}\r\n\r\nexport default DropdownMenuItem;\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\n\r\nimport { Consumer } from \"../../../../../store/index\";\r\nimport DropDownMenuItem from \"./drop-down-menu-item\";\r\nimport \"./drop-down-menu.scss\";\r\n\r\nclass DropDownMenu extends Component {\r\n    static propTypes = {\r\n        text: PropTypes.string.isRequired,\r\n        options: PropTypes.arrayOf(\r\n            PropTypes.shape({\r\n                label: PropTypes.string.isRequired,\r\n                selected: PropTypes.bool,\r\n                onUpdate: PropTypes.func,\r\n                onClick: PropTypes.func,\r\n            }),\r\n        ).isRequired,\r\n        onSelect: PropTypes.func,\r\n    };\r\n\r\n    handleSelect = selectedItem => {\r\n        const { store, updateStore, text } = this.props;\r\n        const dropDownMenuData = store.topMenu.find(item => item.label === text);\r\n\r\n        dropDownMenuData.onSelect(selectedItem);\r\n        updateStore(store);\r\n    };\r\n\r\n    render() {\r\n        const { text, options } = this.props;\r\n        const hasOptionsToShow = options.length > 0;\r\n\r\n        return (\r\n            <ul className=\"drop-down-menu\">\r\n                <li>\r\n                    <span className=\"drop-down-menu__toggler\">\r\n                        {text}\r\n                        {hasOptionsToShow && <FontAwesomeIcon className=\"drop-down-menu__caret\" icon=\"chevron-down\" />}\r\n                    </span>\r\n                    {hasOptionsToShow && (\r\n                        <ul className=\"drop-down-menu__menu\">\r\n                            {options.map(({ label, selected, onClick }) => {\r\n                                return (\r\n                                    <DropDownMenuItem\r\n                                        key={label}\r\n                                        selected={selected}\r\n                                        text={label}\r\n                                        onClick={onClick || this.handleSelect}\r\n                                    />\r\n                                );\r\n                            })}\r\n                        </ul>\r\n                    )}\r\n                </li>\r\n            </ul>\r\n        );\r\n    }\r\n}\r\n\r\nexport default props => (\r\n    <Consumer>\r\n        {({ store, updateStore }) => {\r\n            const dropDownMenuData = store.topMenu.find(item => item.label === props.text);\r\n            const options = dropDownMenuData ? dropDownMenuData.options : [];\r\n\r\n            return <DropDownMenu {...props} store={store} updateStore={updateStore} options={options} />;\r\n        }}\r\n    </Consumer>\r\n);\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\n\r\nconst MenuLink = ({ text, href, className = \"\", target = \"_self\" }) => (\r\n    <a className={`main-menu__link ${className}`} href={href} target={target}>\r\n        {text}\r\n    </a>\r\n);\r\n\r\nMenuLink.propTypes = {\r\n    text: PropTypes.string.isRequired,\r\n    href: PropTypes.string.isRequired,\r\n    className: PropTypes.string,\r\n    target: PropTypes.string,\r\n};\r\n\r\nexport default MenuLink;\r\n","import React from \"react\";\r\nimport cn from \"classnames\";\r\n\r\nimport \"./main-menu.scss\";\r\nimport DropDownMenu from \"./components/drop-down-menu\";\r\nimport MenuLink from \"./components/menu-link\";\r\nimport { Consumer, MenuItemType } from \"../../../../store\";\r\n\r\nfunction MainMenuItem({ menuItem, clickable }) {\r\n    return (\r\n        <div className=\"main-menu__item\">\r\n            <div className={cn(clickable && \"main-menu__clickable-zone\")}>\r\n                {menuItem.type === MenuItemType.LINK && <MenuLink text={menuItem.label} {...menuItem} />}\r\n                {menuItem.type === MenuItemType.DROPDOWN && <DropDownMenu text={menuItem.label} {...menuItem} />}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction MainMenu() {\r\n    return (\r\n        <nav className=\"main-menu\">\r\n            <Consumer>\r\n                {({ store }) =>\r\n                    store.topMenu.map(menuItem => (\r\n                        <MainMenuItem key={menuItem.label} menuItem={menuItem} clickable={menuItem.isClickable} />\r\n                    ))\r\n                }\r\n            </Consumer>\r\n        </nav>\r\n    );\r\n}\r\n\r\nexport default MainMenu;\r\n","import React from \"react\";\r\nimport cn from \"classnames\";\r\n\r\nimport \"./header.scss\";\r\nimport Logo from \"./components/logo\";\r\nimport StarSystemSelector from \"./components/star-system-selector/star-system-selector\";\r\nimport MainMenu from \"./components/main-menu/main-menu\";\r\n\r\nconst Header = ({ className }) => (\r\n    <header className={cn(className, \"header\", \"noselect\")}>\r\n        <div className=\"header__logo-wrapper\">\r\n            <Logo className=\"header__logo\" />\r\n        </div>\r\n        <div className=\"header__top-menu\">\r\n            <MainMenu />\r\n        </div>\r\n        <div className=\"header__star-system-selector\">\r\n            <StarSystemSelector />\r\n        </div>\r\n    </header>\r\n);\r\n\r\nexport default Header;\r\n","import React from \"react\";\r\nimport cn from \"classnames\";\r\n\r\nimport \"./arrow-logo.css\";\r\n\r\nexport default function ArrowLogo({ direction }) {\r\n    const classNames = cn(\"arrow-logo\", `arrow-logo--to-${direction}`);\r\n\r\n    return (\r\n        <svg\r\n            className={classNames}\r\n            role=\"img\"\r\n            width=\"10\"\r\n            height=\"8\"\r\n            viewBox=\"0 0 10 8\"\r\n            fill=\"none\"\r\n            xmlns=\"http://www.w3.org/2000/svg\"\r\n        >\r\n            <path\r\n                d=\"M1.50359 3.64645C1.30833 3.84171 1.30833 4.15829 1.50359 4.35355L4.68557 7.53553C4.88083 7.7308 5.19741 7.7308 5.39268 7.53553C5.58794 7.34027 5.58794 7.02369 5.39268 6.82843L2.56425 4L5.39268 1.17157C5.58794 0.97631 5.58794 0.659728 5.39268 0.464466C5.19741 0.269204 4.88083 0.269203 4.68557 0.464466L1.50359 3.64645ZM1.5 8V0H0.5V8H1.5ZM10 3.5L1.85714 3.5L1.85714 4.5L10 4.5L10 3.5Z\"\r\n                fill=\"#8F9193\"\r\n            />\r\n        </svg>\r\n    );\r\n}\r\n","import React from \"react\";\r\n\r\nconst MaximizeLogo = () => {\r\n    return (\r\n        <svg role=\"img\" width=\"10\" height=\"8\" viewBox=\"0 0 10 8\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n            <path d=\"M3 3V1H9V5H7M7 5V7H1V3H7V5Z\" stroke=\"#8F9193\" strokeWidth=\"0.5\" />\r\n        </svg>\r\n    );\r\n};\r\n\r\nexport default MaximizeLogo;\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\n\r\nimport ArrowLogo from \"../../logos/arrow-logo\";\r\nimport MaximizeLogo from \"../../logos/maximize-logo\";\r\n\r\nconst CollapseButton = ({ isCollapsed, onClick, isToRight = false, className = \"\", collapseDirection = \"left\" }) => (\r\n    <button type=\"button\" className={className} onClick={onClick}>\r\n        {isCollapsed ? <MaximizeLogo /> : <ArrowLogo direction={collapseDirection} />}\r\n    </button>\r\n);\r\n\r\nCollapseButton.propTypes = {\r\n    className: PropTypes.string,\r\n    isCollapsed: PropTypes.bool.isRequired,\r\n    onClick: PropTypes.func.isRequired,\r\n    collapseDirection: PropTypes.oneOf([\"right\", \"left\"]),\r\n};\r\n\r\nexport default CollapseButton;\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport cn from \"classnames\";\r\n\r\nimport CollapseButton from \"./components/collapse-button\";\r\nimport \"./index.css\";\r\n\r\nclass Panel extends Component {\r\n    static propTypes = {\r\n        id: PropTypes.string,\r\n        className: PropTypes.string,\r\n        children: PropTypes.node,\r\n        caption: PropTypes.string,\r\n        hideCollapseButton: PropTypes.bool,\r\n        titleIcon: PropTypes.node,\r\n        collapsedByDefault: PropTypes.bool,\r\n        hidden: PropTypes.bool,\r\n        collapseDirection: PropTypes.oneOf([\"right\", \"left\"]),\r\n    };\r\n\r\n    static defaultProps = {\r\n        caption: \"\",\r\n        hideCollapseButton: false,\r\n        className: \"\",\r\n        id: \"\",\r\n        collapsedByDefault: false,\r\n        hidden: false,\r\n        collapseDirection: \"left\",\r\n    };\r\n\r\n    state = {\r\n        isCollapsed: this.props.collapsedByDefault,\r\n    };\r\n\r\n    handleToggle = () => {\r\n        this.setState(prevState => ({\r\n            isCollapsed: !prevState.isCollapsed,\r\n        }));\r\n    };\r\n\r\n    render() {\r\n        const {\r\n            id,\r\n            className,\r\n            caption,\r\n            hideCollapseButton,\r\n            children,\r\n            titleIcon,\r\n            hidden,\r\n            collapseDirection,\r\n        } = this.props;\r\n        const { isCollapsed } = this.state;\r\n        const classNames = cn(\r\n            \"panel\",\r\n            \"noselect\",\r\n            {\r\n                \"panel--hidden\": hidden,\r\n                \"panel--collapsed\": isCollapsed,\r\n            },\r\n            className,\r\n        );\r\n\r\n        return (\r\n            <div id={id} className={classNames}>\r\n                <div className=\"panel__header\">\r\n                    <div className=\"panel__caption\">\r\n                        {titleIcon && <span className=\"panel__caption-icon\">{titleIcon}</span>}\r\n                        <span className=\"panel__caption-text\">{caption}</span>\r\n                    </div>\r\n                    {!hideCollapseButton && (\r\n                        <CollapseButton\r\n                            className=\"panel__collapse-button\"\r\n                            onClick={this.handleToggle}\r\n                            isCollapsed={isCollapsed}\r\n                            collapseDirection={collapseDirection}\r\n                        />\r\n                    )}\r\n                </div>\r\n                <div style={{ display: isCollapsed ? \"none\" : \"block\" }} className=\"panel__content\">\r\n                    {children}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default Panel;\r\n","import React from \"react\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\n\r\nimport \"./camera-panel.css\";\r\nimport Panel from \"../../../../../common/panel\";\r\n\r\nconst CameraPanel = ({ className }) => (\r\n    <Panel\r\n        id=\"cameraPanel\"\r\n        className={`camera-panel ${className}`}\r\n        caption=\"Camera\"\r\n        titleIcon={<FontAwesomeIcon icon=\"expand\" />}\r\n        collapseDirection=\"right\"\r\n    >\r\n        <div className=\"camera-panel__content\">\r\n            <label className=\"panel__field camera-panel__field\">\r\n                <span className=\"panel__field-label\">Target:</span>\r\n                <select className=\"camera-panel__field-control\" id=\"targetSelect\" />\r\n            </label>\r\n            <label className=\"panel__field camera-panel__field\">\r\n                <span className=\"panel__field-label\">Frame type:</span>\r\n                <select className=\"camera-panel__field-control\" id=\"rfTypeSelect\" />\r\n            </label>\r\n        </div>\r\n    </Panel>\r\n);\r\n\r\nexport default CameraPanel;\r\n","import React from \"react\";\r\nimport \"./index.css\";\r\n\r\nfunction TimeLine({ className }) {\r\n    return <canvas className={`time-line ${className}`} id=\"timeLineCanvas\" />;\r\n}\r\n\r\nexport default TimeLine;\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport cn from \"classnames\";\r\n\r\nimport { sim, Events } from \"../../../../../../core/index\";\r\nimport \"./index.css\";\r\n\r\nclass PauseButton extends Component {\r\n    static propTypes = {\r\n        className: PropTypes.string,\r\n    };\r\n\r\n    state = {\r\n        isTimeRunning: true,\r\n    };\r\n\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        document.addEventListener(Events.TIME_PAUSED, () => {\r\n            this.setState({ isTimeRunning: false });\r\n        });\r\n        document.addEventListener(Events.TIME_UNPAUSED, () => {\r\n            this.setState({ isTimeRunning: true });\r\n        });\r\n    }\r\n\r\n    handleClick = () => {\r\n        const timeLine = sim.time;\r\n\r\n        if (timeLine) {\r\n            timeLine.togglePause();\r\n        }\r\n    };\r\n\r\n    render() {\r\n        const { isTimeRunning } = this.state;\r\n\r\n        return (\r\n            <div\r\n                role=\"button\"\r\n                className={cn(\r\n                    \"pause-button\",\r\n                    \"noselect\",\r\n                    {\r\n                        \"pause-button--paused\": !isTimeRunning,\r\n                    },\r\n                    this.props.className,\r\n                )}\r\n                onClick={this.handleClick}\r\n            >\r\n                <div>\r\n                    <FontAwesomeIcon className=\"pause-button__icon\" icon={isTimeRunning ? \"pause\" : \"play\"} />\r\n                </div>\r\n                <div>{isTimeRunning ? \"Pause\" : \"Resume\"}</div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default PauseButton;\r\n","import React from \"react\";\r\n\r\nexport default function({ className }) {\r\n    return (\r\n        <svg\r\n            className={className}\r\n            role=\"img\"\r\n            width=\"4\"\r\n            height=\"9\"\r\n            viewBox=\"0 0 4 9\"\r\n            fill=\"none\"\r\n            xmlns=\"http://www.w3.org/2000/svg\"\r\n        >\r\n            <path\r\n                d=\"M3.71197 2.33602L3.58397 3.42402H2.35197L1.96797 6.14402C1.92531 6.38936 1.92531 6.57069 1.96797 6.68802C2.01064 6.80536 2.11731 6.86402 2.28797 6.86402C2.46931 6.86402 2.62397 6.84269 2.75197 6.80002C2.87997 6.74669 2.96531 6.71469 3.00797 6.70402V7.76002C2.96531 7.77069 2.90131 7.79736 2.81597 7.84002C2.73064 7.88269 2.63464 7.92536 2.52797 7.96802C2.26131 8.08536 1.96264 8.14402 1.63197 8.14402C1.11997 8.14402 0.773306 8.01069 0.591973 7.74402C0.410639 7.46669 0.362639 7.00269 0.447973 6.35202L0.879973 3.42402H0.271973L0.415973 2.33602H1.02397L1.21597 0.976023L2.73597 0.736023L2.49597 2.33602H3.71197Z\"\r\n                fill=\"#A1A1A3\"\r\n            />\r\n        </svg>\r\n    );\r\n}\r\n","import React from \"react\";\r\n\r\nimport Panel from \"../../../../../common/panel\";\r\nimport Logo from \"./logo\";\r\nimport \"./index.css\";\r\n\r\nfunction TimeSettingsPanel({ className }) {\r\n    return (\r\n        <Panel\r\n            className={`time-settings-panel ${className}`}\r\n            id=\"timePanel\"\r\n            data-panel-name=\"time\"\r\n            caption=\"Time\"\r\n            titleIcon={<Logo className=\"time-settings-panel__logo\" />}\r\n        >\r\n            <div className=\"time-settings-panel__content\">\r\n                <label className=\"panel__field time-settings-panel__field\">\r\n                    <span className=\"panel__field-label\">Current:</span>\r\n                    <time id=\"currentDateValue\">01.01.2000 12:00:00</time>\r\n                    <button type=\"button\" className=\"panel__button\" id=\"useCurrentTime\">\r\n                        Now\r\n                    </button>\r\n                </label>\r\n                <label className=\"panel__field time-settings-panel__field\">\r\n                    <span className=\"panel__field-label\">Rate:</span>\r\n                    <span id=\"timeScaleValue\" />\r\n                    <button type=\"button\" className=\"panel__button\" id=\"setRealTimeScale\">\r\n                        Real\r\n                    </button>\r\n                </label>\r\n                <label className=\"panel__field time-settings-panel__field\">\r\n                    <input\r\n                        id=\"timeScaleSlider\"\r\n                        type=\"range\"\r\n                        className=\"time-settings-panel__scale-slider\"\r\n                        min=\"-1\"\r\n                        max=\"1\"\r\n                        step=\"0.001\"\r\n                        defaultValue={\"0.001\"}\r\n                        style={{ width: \"100%\" }}\r\n                    />\r\n                </label>\r\n            </div>\r\n        </Panel>\r\n    );\r\n}\r\n\r\nexport default TimeSettingsPanel;\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport cn from \"classnames\";\r\n\r\nimport \"./index.css\";\r\nimport CameraPanel from \"./components/camera-panel/camera-panel\";\r\nimport TimeLine from \"./components/time-line\";\r\nimport PauseButton from \"./components/pause-button\";\r\nimport TimeSettingsPanel from \"./components/time-settings-panel\";\r\nimport StatisticsBadge from \"../statistics-badge/index\";\r\n\r\nfunction BottomPanel({ className }) {\r\n    return (\r\n        <div className={cn(className, \"bottom-panel\")}>\r\n            <TimeSettingsPanel className=\"bottom-panel__time-settings-panel\" />\r\n            <PauseButton className=\"bottom-panel__pause-button\" />\r\n            <div className=\"bottom-panel__time-line-container\">\r\n                <TimeLine className=\"bottom-panel__time-line\" />\r\n            </div>\r\n            <CameraPanel className=\"bottom-panel__camera-panel\" />\r\n            <StatisticsBadge />\r\n        </div>\r\n    );\r\n}\r\n\r\nBottomPanel.propTypes = {\r\n    className: PropTypes.string,\r\n};\r\n\r\nexport default BottomPanel;\r\n","import React from \"react\";\r\n\r\nimport Panel from \"../../common/panel\";\r\nimport { Consumer } from \"../../../store\";\r\n\r\nconst CreationPanel = ({ className }) => (\r\n    <Consumer>\r\n        {({ store }) => (\r\n            <Panel\r\n                className={className}\r\n                id=\"creationPanel\"\r\n                data-panel-name=\"creation\"\r\n                caption=\"Orbit creation\"\r\n                hidden={!store.viewSettings.showOrbitCreationPanel}\r\n            >\r\n                <div style={{ height: 44 }}>\r\n                    <label className=\"panel__field\">\r\n                        Create Orbit: <button id=\"createOrbit\">Create</button>\r\n                    </label>\r\n                </div>\r\n            </Panel>\r\n        )}\r\n    </Consumer>\r\n);\r\n\r\nexport default CreationPanel;\r\n","import React from \"react\";\r\nimport cn from \"classnames\";\r\n\r\nimport { Consumer } from \"../../../../store\";\r\nimport Panel from \"../../../common/panel\";\r\nimport \"./index.css\";\r\n\r\nconst TransferCalculationPanel = ({ className }) => (\r\n    <Consumer>\r\n        {({ store }) => (\r\n            <Panel\r\n                className={cn(className, \"transfer-calculation-panel\")}\r\n                id=\"lambertPanel\"\r\n                caption=\"Transfer calculation\"\r\n                hidden={!store.viewSettings.showTransferCalculationPanel}\r\n            >\r\n                <div className=\"panel__field-set\">\r\n                    <label className=\"panel__field\">\r\n                        <span className=\"panel__field-label\">Origin:</span>\r\n                        <select className=\"panel__field-control\" id=\"originSelect\" />\r\n                    </label>\r\n                    <label className=\"panel__field\">\r\n                        <span className=\"panel__field-label\">Target:</span>\r\n                        <select className=\"panel__field-control\" id=\"targetSelect\" />\r\n                    </label>\r\n                    <label className=\"panel__field\">\r\n                        <span className=\"panel__field-label\">Transfer type:</span>\r\n                        <span className=\"panel__field-control\">Ballistic</span>\r\n                    </label>\r\n                    <label className=\"panel__field\">\r\n                        <span className=\"panel__field-label\">Departure:</span>\r\n                        <time id=\"departureDateValue\">01.01.2000 12:00:00</time>\r\n                        <button type=\"button\" className=\"panel__button\" id=\"useCurrentTime\">\r\n                            Now\r\n                        </button>\r\n                    </label>\r\n                    <label className=\"panel__field\">\r\n                        <span className=\"panel__field-label\">Transfer time:</span>\r\n                        <span id=\"transferTimeValue\" />\r\n                        {/*<button type=\"button\" className=\"panel__button\" id=\"optimalTransferTime\">*/}\r\n                        {/*Optimal*/}\r\n                        {/*</button>*/}\r\n                    </label>\r\n                    <label className=\"panel__field\">\r\n                        <input\r\n                            id=\"transferTimeSlider\"\r\n                            type=\"range\"\r\n                            min=\"0\"\r\n                            max=\"1\"\r\n                            step=\"0.001\"\r\n                            defaultValue={\"0.5\"}\r\n                            style={{ width: \"100%\" }}\r\n                        />\r\n                    </label>\r\n                </div>\r\n                <div className=\"transfer-calculation-panel__delta-v-calc panel__field-set\" data-panel-name=\"lambert\">\r\n                    <div className=\"panel__field panel__field-header\">Delta-V</div>\r\n                    <div className=\"panel__field\">\r\n                        <span className=\"panel__field-label\">Ejection:</span>\r\n                        <span className=\"panel__field-control\" id=\"deltaVEjection\">\r\n                            0\r\n                        </span>\r\n                        <span className=\"transfer-calculation-panel__dimension\">km/s</span>\r\n                    </div>\r\n                    <div className=\"panel__field\">\r\n                        <span className=\"panel__field-label\">Insertion:</span>\r\n                        <span className=\"panel__field-control\" id=\"deltaVInsertion\">\r\n                            0\r\n                        </span>\r\n                        <span className=\"transfer-calculation-panel__dimension\">km/s</span>\r\n                    </div>\r\n                    <div className=\"panel__field\">\r\n                        <span className=\"panel__field-label\">Total:</span>\r\n                        <span className=\"panel__field-control\" id=\"deltaVTotal\">\r\n                            0\r\n                        </span>\r\n                        <span className=\"transfer-calculation-panel__dimension\">km/s</span>\r\n                    </div>\r\n                </div>\r\n            </Panel>\r\n        )}\r\n    </Consumer>\r\n);\r\n\r\nexport default TransferCalculationPanel;\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport cn from \"classnames\";\r\n\r\nimport \"./keplerian-view.css\";\r\n\r\nexport default function KeplerianView({ className = \"\" }) {\r\n    return (\r\n        <div className={cn(className, \"keplerian-view\")}>\r\n            <div className=\"keplerian-view__column\">\r\n                <div className=\"keplerian-view__field\">\r\n                    <span className=\"panel__field-label keplerian-view__field-label\">Ecc</span>\r\n                    <span className=\"panel__field-control\" id=\"elements-ecc\" />\r\n                    <span className=\"metrics-panel__dimension\" />\r\n                </div>\r\n                <div className=\"keplerian-view__field\">\r\n                    <span className=\"panel__field-label keplerian-view__field-label\">SMA</span>\r\n                    <span className=\"panel__field-control\" id=\"elements-sma\" />\r\n                    <span className=\"metrics-panel__dimension\">km</span>\r\n                </div>\r\n                <div className=\"keplerian-view__field\">\r\n                    <span className=\"panel__field-label keplerian-view__field-label\">Inc</span>\r\n                    <span className=\"panel__field-control\" id=\"elements-inc\" />\r\n                    <span className=\"metrics-panel__dimension\">deg.</span>\r\n                </div>\r\n                <div className=\"keplerian-view__field\">\r\n                    <span className=\"panel__field-label keplerian-view__field-label\">AoP</span>\r\n                    <span className=\"panel__field-control\" id=\"elements-aop\" />\r\n                    <span className=\"metrics-panel__dimension\">deg.</span>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"keplerian-view__column\">\r\n                <div className=\"keplerian-view__field\">\r\n                    <span className=\"panel__field-label keplerian-view__field-label\">RAAN</span>\r\n                    <span className=\"panel__field-control\" id=\"elements-raan\" />\r\n                    <span className=\"metrics-panel__dimension\">deg.</span>\r\n                </div>\r\n                <div className=\"keplerian-view__field\">\r\n                    <span className=\"panel__field-label keplerian-view__field-label\">TA</span>\r\n                    <span className=\"panel__field-control\" id=\"elements-ta\" />\r\n                    <span className=\"metrics-panel__dimension\">deg.</span>\r\n                </div>\r\n                <div className=\"keplerian-view__field\">\r\n                    <span className=\"panel__field-label keplerian-view__field-label\">Period</span>\r\n                    <span className=\"panel__field-control\" id=\"elements-period\" />\r\n                    <span className=\"metrics-panel__dimension\">days</span>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nKeplerianView.propTypes = { className: PropTypes.string };\r\n","import React from \"react\";\r\nimport cn from \"classnames\";\r\n\r\nimport \"./vector-component-view.css\";\r\n\r\nfunction VectorComponentView({ className, label = \"x\", valueClassName = \"vec-x\", dimension = \"km\" }) {\r\n    return (\r\n        <div className={cn(className, \"vector-component\")}>\r\n            <span className=\"vector-component__label\">{label}</span>\r\n            <span className={cn(\"vector-component__value\", valueClassName)} />\r\n            <span className=\"metrics-panel__dimension vector-component__dimension\">{dimension}</span>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default VectorComponentView;\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport cn from \"classnames\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\n\r\nimport \"./index.scss\";\r\n\r\nfunction ExpandButton({ className, onClick, expanded = false }) {\r\n    return (\r\n        <button\r\n            type=\"button\"\r\n            className={cn(className, \"expand-button\", {\r\n                \"expand-button--expanded\": expanded,\r\n            })}\r\n            onClick={onClick}\r\n        >\r\n            <FontAwesomeIcon className=\"expand-button__icon\" icon=\"chevron-down\" />\r\n        </button>\r\n    );\r\n}\r\n\r\nExpandButton.propTypes = {\r\n    className: PropTypes.string,\r\n    expanded: PropTypes.bool,\r\n    onClick: PropTypes.func,\r\n};\r\n\r\nexport default ExpandButton;\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport cn from \"classnames\";\r\n\r\nimport VectorComponentView from \"./vector-component-view\";\r\nimport ExpandButton from \"../../../../common/expand-button/index\";\r\nimport \"./cartesian-vector-view.css\";\r\n\r\nclass CartesianVectorView extends Component {\r\n    static propTypes = {\r\n        className: PropTypes.string,\r\n        isExpanded: PropTypes.bool,\r\n        vectorMagnitudeLabel: PropTypes.string.isRequired,\r\n        dimension: PropTypes.string.isRequired,\r\n    };\r\n\r\n    static defaultProps = {\r\n        isExpanded: false,\r\n    };\r\n\r\n    state = {\r\n        isExpanded: this.props.isExpanded,\r\n    };\r\n\r\n    handleToggle = () => {\r\n        this.setState(({ isExpanded }) => ({ isExpanded: !isExpanded }));\r\n    };\r\n\r\n    render() {\r\n        const { isExpanded } = this.state;\r\n        const { className, vectorMagnitudeLabel, dimension } = this.props;\r\n\r\n        return (\r\n            <div className={cn(className, \"panel__field cartesian-vector-view\")}>\r\n                <header className=\"cartesian-vector-view__header\">\r\n                    <VectorComponentView\r\n                        label={vectorMagnitudeLabel}\r\n                        valueClassName=\"vec-magnitude\"\r\n                        dimension={dimension}\r\n                    />\r\n                    <ExpandButton\r\n                        className=\"cartesian-vector-view__expand-button\"\r\n                        expanded={isExpanded}\r\n                        onClick={this.handleToggle}\r\n                    />\r\n                </header>\r\n                <div className={cn(\"cartesian-vector-view__vector-components\", { hidden: !isExpanded })}>\r\n                    <VectorComponentView label=\"x\" valueClassName=\"vec-x\" dimension={dimension} />\r\n                    <VectorComponentView label=\"y\" valueClassName=\"vec-y\" dimension={dimension} />\r\n                    <VectorComponentView label=\"z\" valueClassName=\"vec-z\" dimension={dimension} />\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default CartesianVectorView;\r\n","import React from \"react\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\n\r\nimport Panel from \"../../../common/panel\";\r\nimport \"./index.css\";\r\nimport KeplerianView from \"./components/keplerian-view\";\r\nimport CartesianVectorView from \"./components/cartesian-vector-view\";\r\n\r\nconst MetricsPanel = () => (\r\n    <Panel\r\n        id=\"metricsPanel\"\r\n        className=\"metrics-panel\"\r\n        caption=\"Metrics\"\r\n        titleIcon={<FontAwesomeIcon icon=\"bars\" />}\r\n        collapseDirection=\"right\"\r\n    >\r\n        <div className=\"metrics-panel__content\">\r\n            <div className=\"panel__field-set\">\r\n                <div className=\"panel__field\">\r\n                    <span className=\"panel__field-label\">Object</span>\r\n                    <span className=\"panel__field-control\" id=\"metricsOf\" />\r\n                </div>\r\n                <div className=\"panel__field\">\r\n                    <span className=\"panel__field-label\">Relative to</span>\r\n                    <span className=\"panel__field-control\" id=\"relativeTo\" />\r\n                </div>\r\n            </div>\r\n            <div className=\"panel__field-set\">\r\n                <label className=\"panel__field panel__field--left-aligned\">\r\n                    <input\r\n                        className=\"metrics-panel__angles-checker\"\r\n                        type=\"checkbox\"\r\n                        id=\"showAnglesOfSelectedOrbit\"\r\n                        defaultChecked\r\n                    />\r\n                    <span className=\"panel__field-label\">Visualize angles</span>\r\n                    <button className=\"metrics-panel__unload-object-button\" type=\"button\" id=\"unloadObject\">\r\n                        Unload object\r\n                    </button>\r\n                </label>\r\n            </div>\r\n            <div className=\"panel__field-set\">\r\n                <div className=\"panel__field panel__field-header\">Main</div>\r\n                <div className=\"panel__field\">\r\n                    <span className=\"panel__field-label\">Orbit</span>\r\n                    <span className=\"panel__field-control\" id=\"elements-orbit-alt\" />\r\n                    <span className=\"metrics-panel__dimension\">km</span>\r\n                </div>\r\n                <div className=\"panel__field\">\r\n                    <span className=\"panel__field-label\">Avg height</span>\r\n                    <span className=\"panel__field-control\" id=\"elements-orbit-avg\" />\r\n                    <span className=\"metrics-panel__dimension\">km</span>\r\n                </div>\r\n                <div className=\"panel__field\">\r\n                    <span className=\"panel__field-label\">Altitude</span>\r\n                    <span className=\"panel__field-control\" id=\"elements-alt\" />\r\n                    <span className=\"metrics-panel__dimension\">km</span>\r\n                </div>\r\n                <div className=\"panel__field\">\r\n                    <span className=\"panel__field-label\">Speed</span>\r\n                    <span className=\"panel__field-control\" id=\"elements-speed\" />\r\n                    <span className=\"metrics-panel__dimension\">m/s</span>\r\n                </div>\r\n                <div className=\"panel__field\">\r\n                    <span className=\"panel__field-label\">Precession</span>\r\n                    <span className=\"panel__field-control\" id=\"elements-precession\" />\r\n                    <span className=\"metrics-panel__dimension\">deg/day</span>\r\n                </div>\r\n\r\n                <div className=\"panel__field\" id=\"row-node-time\" style={{ display: \"none\" }}>\r\n                    <span className=\"panel__field-label\">Node local time</span>\r\n                    <span className=\"panel__field-control\" id=\"elements-node-time\" />\r\n                    <span className=\"metrics-panel__dimension\" />\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"panel__field-set\">\r\n                <div className=\"panel__field panel__field-header\">Keplerian</div>\r\n                <KeplerianView className=\"panel__field\" />\r\n            </div>\r\n\r\n            <div className=\"panel__field-set\">\r\n                <div className=\"panel__field panel__field-header\">Cartesian</div>\r\n                <CartesianVectorView\r\n                    className=\"metrics-panel__cartesian-position-vector js-metrics-panel-cartesian-position-vector\"\r\n                    vectorMagnitudeLabel=\"Position\"\r\n                    dimension=\"km\"\r\n                />\r\n                <CartesianVectorView\r\n                    className=\"metrics-panel__cartesian-velocity-vector js-metrics-panel-cartesian-velocity-vector\"\r\n                    vectorMagnitudeLabel=\"Velocity\"\r\n                    dimension=\"km/s\"\r\n                />\r\n            </div>\r\n        </div>\r\n    </Panel>\r\n);\r\n\r\nexport default MetricsPanel;\r\n","import React from \"react\";\r\nimport cn from \"classnames\";\r\nimport \"./index.css\";\r\n\r\nconst SideBar = ({ className, right, children }) => {\r\n    return <aside className={cn(className, \"side-bar\")}>{children}</aside>;\r\n};\r\n\r\nexport default SideBar;\r\n","import React from \"react\";\r\nimport cn from \"classnames\";\r\n\r\nimport \"./main-view.css\";\r\nimport BottomPanel from \"./components/bottom-panel\";\r\nimport CreationPanel from \"./components/creation-panel\";\r\nimport TransferCalculationPanel from \"./components/transfer-calculation-panel\";\r\nimport MetricsPanel from \"./components/metrics-panel/index\";\r\nimport SideBar from \"../common/side-bar\";\r\n\r\nconst MainView = ({ className, children }) => {\r\n    return (\r\n        <main className={cn(className, \"main-view\")}>\r\n            <div id=\"viewport-id\" />\r\n            {children}\r\n            <SideBar className=\"main-view__left-side-bar\">\r\n                <CreationPanel className=\"main-view__creation-panel\" />\r\n                <TransferCalculationPanel className=\"main-view__transfer-calculation-panel\" />\r\n            </SideBar>\r\n            <SideBar className=\"main-view__right-side-bar\" right>\r\n                <MetricsPanel />\r\n            </SideBar>\r\n            <BottomPanel className=\"main-view__bottom-panel\" />\r\n        </main>\r\n    );\r\n};\r\n\r\nexport default MainView;\r\n","import React from \"react\";\r\n\r\nconst Footer = ({ className }) => <footer className={`${className} footer`} />;\r\n\r\nexport default Footer;\r\n","import React from \"react\";\n\nimport { showWizard, wizardIds } from \"./tutorials\";\nimport \"./common/app-layout.scss\";\nimport Header from \"./header/header\";\nimport MainView from \"./main-view/main-view\";\nimport Footer from \"./footer/footer\";\n\nclass App extends React.Component {\n    componentDidMount() {\n        showWizard(wizardIds.GETTING_STARTED_WIZARD);\n    }\n\n    render() {\n        return (\n            <div className=\"app-layout\">\n                <MainView className=\"app-layout__main\">\n                    <Header className=\"app-layout__header\" />\n                </MainView>\n                <Footer className=\"app-layout__footer\" />\n            </div>\n        );\n    }\n}\n\nexport default App;\n","import * as wizardIds from \"./wizards/wizard-ids\";\nimport LocalStorageWatchStatusService from \"./services/local-storage-watch-status-service\";\n\nfunction showWizard(wizardId, watchStatusService = new LocalStorageWatchStatusService(window.localStorage)) {\n    if (!watchStatusService.canWatch(wizardId)) {\n        return;\n    }\n\n    Promise.all([\n        import(/* webpackChunkName: \"[request]\" */ `./wizards/${wizardId}`),\n        import(/* webpackChunkName: \"createIntroJs\" */ `./create-intro-js`),\n        import(/* webpackChunkName: \"introjsStyles\" */ \"./introjs.scss\"),\n    ]).then(([{ default: wizardConfig }, { createIntroJs }]) => {\n        const intro = createIntroJs(wizardConfig);\n        intro.start();\n    });\n}\n\nexport { showWizard, wizardIds };\n","import { sim } from \"./core/index\";\r\n\r\nexport const loadTLE = function(noradId) {\r\n    sim.getModule(\"SolarSystem\").loadTLE(sim.starSystem, noradId);\r\n};\r\n\r\nexport const loadKSP = function() {\r\n    sim.loadModule(\"KSP\");\r\n};\r\n","import { init } from \"./core/index\";\r\nimport { loadTLE, loadKSP } from \"./api\";\r\nimport { Store } from \"./store\";\r\n\r\nclass Application {\r\n    constructor(sim) {\r\n        this._store = new Store(sim);\r\n    }\r\n\r\n    init(statsBadge) {\r\n        init(statsBadge);\r\n    }\r\n\r\n    getInitialState() {\r\n        return this._store;\r\n    }\r\n\r\n    getApi() {\r\n        return {\r\n            loadTLE,\r\n            loadKSP,\r\n        };\r\n    }\r\n}\r\n\r\nexport default Application;\r\n","import { library } from \"@fortawesome/fontawesome-svg-core\";\r\nimport { faExpand, faPlay, faPause, faChevronDown, faCheck, faBars } from \"@fortawesome/free-solid-svg-icons\";\r\n\r\nexport function configureLibs() {\r\n    library.add(faExpand);\r\n    library.add(faPlay);\r\n    library.add(faPause);\r\n    library.add(faChevronDown);\r\n    library.add(faCheck);\r\n    library.add(faBars);\r\n}\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\n\r\nimport { configureLibs } from \"./libs\";\r\nimport { Provider } from \"./store\";\r\nimport { sim } from \"./core/index\";\r\nimport { createStatsBadge } from \"./components/main-view/components/statistics-badge/index\";\r\nimport AppComponent from \"./components/app\";\r\nimport Application from \"./application\";\r\n\r\nconfigureLibs();\r\n\r\nconst statsBadge = createStatsBadge();\r\nconst app = new Application(sim);\r\nconst initialState = app.getInitialState();\r\nwindow.api = app.getApi();\r\n\r\nclass App extends React.Component {\r\n    state = {\r\n        stats: statsBadge,\r\n        store: this.props.store,\r\n        updateStore: updatedStore => {\r\n            this.setState({\r\n                store: updatedStore,\r\n            });\r\n        },\r\n    };\r\n\r\n    render() {\r\n        return (\r\n            <Provider value={this.state}>\r\n                <AppComponent />\r\n            </Provider>\r\n        );\r\n    }\r\n}\r\n\r\nReactDOM.render(<App store={initialState} />, document.getElementById(\"root\"));\r\n\r\napp.init(statsBadge);\r\n"],"sourceRoot":""}