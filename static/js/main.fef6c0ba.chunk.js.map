{"version":3,"sources":["core/algebra.js","core/EventHandler.js","ui-legacy/TimeLine.js","core/visual/Raycaster.js","ui-legacy/SelectionHandler.js","ui-legacy/Panel.js","ui-legacy/Panels/Time.js","ui-legacy/Panels/Camera.js","ui-legacy/Panels/Vector.js","ui-legacy/Panels/Metrics.js","core/LambertSolver.js","core/visual/Vector.js","ui-legacy/Panels/Lambert.js","core/visual/Trajectory/Dynamic.js","ui-legacy/Panels/Creation.js","ui-legacy/Panels/Maneuver.js","ui-legacy/Panels/DynamicTrajectory.js","ui-legacy/UI.js","ui-legacy/Camera.js","interface/StarSystemEntry.js","interface/StarSystemManager.js","core/Simulation.js","core/FunctionOfEpoch/ObjectState.js","core/ReferenceFrame/BodyFixed.js","core/ReferenceFrame/Base.js","core/ReferenceFrame/Topocentric.js","core/ReferenceFrame/Factory.js","core/Events.js","ui/components/common/button/index.js","core/EphemerisObject.js","core/StateVector.js","core/visual/ModelAbstract.js","core/FunctionOfEpoch/Custom.js","ui/store/constants.js","ui/store/menu-item-type.js","ui/store/store.js","ui/utils.js","ui/store/root-context.js","ui/store/index.js","core/index.js","core/KeplerianObject.js","core/Body.js","core/FunctionOfEpoch/Constant.js","core/Trajectory/KeplerianBasic.js","core/visual/Trajectory/Keplerian.js","core/ReferenceFrame/Abstract.js","core/FlightEvent/ImpulsiveBurn.js","core/FunctionOfEpoch/Abstract.js","core/Trajectory/Dynamic.js","modules/PatchedConics/FlightEvent/SOIDeparture.js","modules/PatchedConics/FlightEvent/SOIArrival.js","core/Trajectory/Composite.js","modules/PatchedConics/FlightEvent/SOIChangeAbstract.js","core/visual/FlightEvent/Abstract.js","core/visual/Trajectory/Abstract.js","core/visual/VirtualPlane.js","core/visual/Arrow.js","core/visual/Angle.js","core/visual/PlanePoint.js","core/KeplerianEditor.js","core/Trajectory/Abstract.js","core/ReferenceFrame/InertialDynamic.js","ui/components/tutorials/services/local-storage-watch-status-service.js","ui/components/tutorials/language-selector/index.js","ui/components/tutorials/services/step-handler-service.js","ui/components/tutorials/index.js","core/StarSystem.js","ui/components/tutorials/wizards/wizard-ids.js","core/Trajectory/KeplerianAbstract.js","modules/PatchedConics/visual/FlightEvent/SOIDeparture.js","modules/PatchedConics/visual/FlightEvent/SOIArrival.js","core/ReferenceFrame/Inertial.js","core/ReferenceFrame/InertialAbstract.js","core/Trajectory/ExceptionOutOfRange.js","core/visual/LineObject.js","core/FlightEvent/Abstract.js","core/visual/Marker/Pericenter.js","core/visual/Marker/Abstract.js","core/visual/Marker/Apocenter.js","core/visual/FlightEvent/ImpulsiveBurn.js","core/visual/Sprite.js","core/visual/SpriteStatic.js","core/Orientation/Abstract.js","core/Orientation/ConstantAxis.js","core/PhysicalBodyModel.js","core/Trajectory/KeplerianArray.js","core/Trajectory/KeplerianPrecessingArray.js","core/Trajectory/KeplerianPrecessing.js","core/visual/Trajectory/PointArray.js","core/Trajectory/StaticPosition.js","interface/TrajectoryLoader.js","core/visual/StarsModel.js","core/visual/Label.js","core/visual/BodyModel/Abstract.js","core/visual/BodyModel/Basic.js","core/visual/BodyModel/Light.js","core/visual/BodyModel/Rings.js","core/visual/Shape/Sphere.js","interface/StarSystemLoader.js","ui/services/satellite-finder/satelite.js","ui/services/satellite-finder/transformers/satellite-transformer.js","modules lazy /^/.*$/ groupOptions: {} namespace object","ui/components/tutorials/wizards lazy /^/.*/index$/ groupOptions: {} namespace object","ui/components/tutorials/wizards lazy /^/.*$/ groupOptions: {} namespace object","ui/components/statistics-badge/index.js","ui/services/satellite-finder/search-api-params-builder.js","ui/services/satellite-finder/api-config.js","ui/services/satellite-finder/satellite-finder.js","ui/components/header/components/logo.js","ui/components/common/select/select.js","ui/components/header/components/star-system-selector/star-system-selector.js","ui/components/header/components/main-menu/components/drop-down-menu-item.js","ui/components/header/components/main-menu/components/drop-down-menu.js","ui/components/header/components/main-menu/components/menu-link.js","ui/components/header/components/main-menu/main-menu.js","ui/components/header/header.js","ui/components/common/side-bar/index.js","ui/components/common/logos/arrow-logo.js","ui/components/common/logos/maximize-logo.js","ui/components/common/panel/components/collapse-button.js","ui/components/common/panel/components/field.js","ui/components/common/panel/components/field-label.js","ui/components/common/panel/components/field-control.js","ui/components/common/panel/components/button.js","ui/components/common/panel/components/field-set.js","ui/components/common/panel/components/dimension.js","ui/components/common/panel/index.js","ui/components/main-view/components/bottom-panel/components/camera-panel/camera-panel.js","ui/components/main-view/components/bottom-panel/components/time-line/index.js","ui/components/main-view/components/bottom-panel/components/pause-button/index.js","ui/components/main-view/components/bottom-panel/components/time-settings-panel/logo.js","ui/components/main-view/components/bottom-panel/components/time-settings-panel/index.js","ui/components/main-view/components/bottom-panel/index.js","ui/components/main-view/components/creation-panel.js","ui/components/main-view/components/transfer-calculation-panel/index.js","ui/components/main-view/components/metrics-panel/components/keplerian-view.js","ui/components/main-view/components/metrics-panel/components/vector-component-view.js","ui/components/common/expand-button/index.js","ui/components/main-view/components/metrics-panel/components/cartesian-vector-view.js","ui/components/main-view/components/metrics-panel/index.js","ui/components/main-view/components/maneuver-panel/index.js","ui/components/main-view/components/dynamic-trajectory-panel.js","ui/components/main-view/main-view.js","ui/app.js","ui/libs/index.js","ui/index.js","ui/services/index.js","api.js","index.js","application.js"],"names":["Vector","_Array","dimOrArray","_this","Object","D_Projects_github_com_urbain_ru_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__","this","D_Projects_github_com_urbain_ru_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__","D_Projects_github_com_urbain_ru_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__","call","undefined","Array","i","length","setPrototypeOf","D_Projects_github_com_urbain_ru_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_5__","prototype","D_Projects_github_com_urbain_ru_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_4__","D_Projects_github_com_urbain_ru_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__","key","value","arrayOrVarargs","vals","arguments","vec","res","cos","dot","mag","Math","PI","acos","scalar","axis","angle","Quaternion","rotate_","div_","v","unit","set","mul_","copy","add_","sub_","unit_","projectOn_","radians","sin","get","sqrt","quadrance","D_Projects_github_com_urbain_ru_node_modules_babel_runtime_helpers_esm_wrapNativeSuper__WEBPACK_IMPORTED_MODULE_6__","vector","t","setAxisAngle","invert_","len","normalize_","cx","cross","cx2","quat","w","x","y","z","ow","ox","oy","oz","order","c1","c2","c3","s1","s2","s3","THREE","q","q1","q2","fromVector","toVector","normal1","normal2","transfer","cosHalfTheta","sinHalfTheta","halfTheta","atan2","ratio1","ratio2","invert","TWO_PI","newtonSolve","func","start","d","maxError","maxSteps","error","step","val","v1","v2","diff","abs","deg2rad","degrees","rad2deg","acosSigned","sinSign","ang","angleIntervalIntersection","int1","int2","getAngleIntervalsIntersection","intervals1","intervals2","result","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","next","done","interval1","int11","int12","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","interval2","int21","int22","r","push","err","return","isInInterval","interval","getEpochIntervalsIntersection","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","epoch1","epoch2","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_step4","_iterator4","epoch21","epoch22","approximateAngle","ang1","ang2","proportion","approximateNumber","n1","n2","presentNumberWithSuffix","number","toFixed","toPrecision","EventHandler","domElement","classCallCheck","listeners","handlers","eventName","listener","priority","event","handleEvent","addEventListener","handler","list","idx","splice","removeEventListener","eventObject","highestPriority","reduce","a","max","nextPriority","handlersLeft","TimeLine","epoch","timeScale","isTimeRunning","mouseState","leftButton","rightButton","timeLineCanvasDomElement","document","getElementById","canvasContext","getContext","canvasRect","updateCanvasStyle","initValues","onMouseDown","bind","window","onMouseUp","onMouseMove","onMouseWheel","e","togglePause","oncontextmenu","scales","minute","fiveMinutes","tenMinutes","thirtyMinutes","hour","threeHours","sixHours","day","week","month","threeMonths","year","fiveYears","span","markDistance","scaleType","leftEpoch","updateScaleType","getDateByEpoch","getEpochByDate","roundDateUp","nextRenderingDate","formatDate","formatDateFull","newScale","Events","dispatch","TIME_SCALE_CHANGED","old","new","TIME_UNPAUSED","TIME_PAUSED","timePassed","left","width","EPOCH_CHANGED","date","redraw","newEpoch","tick","forceEpoch","Date","fillStyle","fillRect","height","drawCurrentTimeMark","strokeStyle","font","markDate","markEpoch","drawMark","getCanvasPositionByEpoch","getBoundingClientRect","right","bottom","top","secondsPerPeriod","bestScale","scale","text","beginPath","moveTo","lineTo","stroke","fillText","measureText","button","_this2","keys","b","_this3","mult","deltaY","newSpan","min","getMinScale","getMaxScale","setSeconds","setMinutes","getMinutes","setHours","getHours","setDate","getDate","getDay","setMonth","getMonth","setFullYear","getFullYear","string","getYear","padStart","toString","getSeconds","VisualRaycaster","threeCamera","pixelPrecision","raycaster","mouse","camera","setPixelPrecision","updatePixelAngleSize","clientX","clientY","pixelAngleSize","fov","threeObjects","setFromCamera","intersectObjects","point","pointDirection","subVectors","sim","lastPosition","ray","direction","SelectionHandler","possibleConstructorReturn","getPrototypeOf","selectableObjects","selectedObject","bestIntersection","selectionMouseButton","pointSize","setThreeObj","color","assertThisInitialized","mouseMoveListener","mouseUpListener","object","filter","intersections","distance","threeObj","visible","position","scaleKoeff","getPixelAngleSize","hasMouseMoved","mouseClickStart","wasSelected","selectionObject","userData","Function","deselect","select","onClick","SELECT","DESELECT","VisualModelAbstract","UIPanel","panelDom","isCollapsed","jqDom","$","name","data","jqCollapseButton","find","click","toggleCollapse","collapse","expand","show","hide","html","UIPanelTime","maxTimeScale","jqSlider","on","time","setTimeScale","getCurrentTimeScale","getNeededSliderValue","jqScaleText","formatTimeScale","detail","jqDateText","updateTime","useCurrentTime","sign","prefix","UIPanelCamera","jqTarget","changeOrigin","jqFrameType","changeReferenceFrameType","addListener","STAR_SYSTEM_LOADED","starSystem","updateTargetList","updateTarget","orbitingPoint","updateFrameTypeList","updateFrameType","frameType","CAMERA_RF_CHANGED","originId","type","OBJECT_ADDED","each","getObjectNames","objId","objName","append","selected","getAvailableFrameTypes","typeId","frameTypeNames","_UIPanelCamera$frameT","defineProperty","ReferenceFrame","INERTIAL_ECLIPTIC","INERTIAL_BODY_EQUATORIAL","INERTIAL_BODY_FIXED","INERTIAL_PARENT_BODY_EQUATORIAL","UIPanelVector","vectorOfEpoch","jqMag","jqX","jqY","jqZ","update","FunctionOfEpochAbstract","evaluate","UIPanelMetrics","selection","precision","renderListener","render","handleSelect","handleDeselect","getSelectedObject","deleteObject","id","settings","ui","showAnglesOfSelectedOrbit","checked","SHOW_ORBIT_ANGLES_CHANGED","positionPanel","velocityPanel","selectedTrajectory","trajectory","parent","referenceFrame","getReferenceFrameByEpoch","getObject","updateMain","updateCartesian","updateKeplerian","keplerianObject","getKeplerianObjectByEpoch","sma","per","ecc","apo","surfaceAlt","physicalModel","radius","state","getStateInOwnFrameByEpoch","velocity","j2","getNodalPrecessionRate","eqRadius","inc","aop","raan","getTrueAnomalyByEpoch","period","EphemerisObject","TYPE_SPACECRAFT","TYPE_UNKNOWN","RENDER","LambertSolver","orbit1","orbit2","epochMin","epochMax","transferMin","transferMax","points","epochStep","flightTimeStep","startEpoch","flightTime","j","calcDeltaV","getStateByEpoch","mu","plotData","ctx","clearRect","row","col","round","state1","state2","transferOrbit","_velocity","solve","getDeltaV","originObject","targetObject","rPer1","rPer2","departureTime","flightTimeMin","flightTimeMax","bestFlightTime","minDeltaV","solveFullTransfer","deltaV","totalDeltaV","parentObject","getModule","getCommonParent","Body","rfOrigin","rfTarget","originSoi","targetSoi","rfMainId","ReferenceFrameFactory","buildId","TYPE_STAR","rfMain","getReferenceFrame","calcOriginSoi","calcTargetSoi","patchedConics","soiRadius","ejectionVelInf","insertionVelInf","transferKO","ejectionSoiEpoch","insertionSoiEpoch","ejectionTime","insertionTime","ejectionPosShift","insertionPosShift","steps","_position","transformPositionByEpoch","ejectionPosTime","insertionPosTime","ejectionNormal","getSoiEdgePositionAndTime","rotateVectorByEpoch","insertionNormal","sub","ejectionDeltaV","insertionDeltaV","TrajectoryComposite","TrajectoryKeplerianBasic","minEpoch","maxEpoch","addComponent","ejectionKO","KeplerianObject","createFromState","StateVector","getPeriapsisSpeed","getPeriapsisRadius","ejection","insertionKO","insertion","velInf","normal","rPer","rInf","trueAnomaly","flightPathAngle","atan","H","getEccentricAnomalyByTrueAnomaly","sinh","r1vec","r2vec","r1","r2","transferAngle","ta1","signSinTransferAngle","nodeVector","parabolicTime","pow","A","E","B","yParam","getTimeByY","x0","y0","temp","fx","fy","alpha","acosh","beta","f1","rotate","p2","d1","d2","tempAng","rotateZ","f2x","f2y","p","ta2","perVector","rm","cosTa1","sinTa1","n","E1","E2","ta","atanh","tan","VisualVector","referenceFrameId","RF_BASE","quaternion","fromArray","mul","getQuaternionByEpoch","toThreejs","setPosition","getOriginPositionByEpoch","UIPanelLambert","maxTransferTime","changeTransferTime","getCurrentTransferTime","transferTime","jqTransferTimeText","formatTransferTime","jqOrigin","changeTarget","origin","listData","buildListData","updateList","target","solverResult","transferTrajectory","setObject","visualModel","drop","visualModel2","visualModel3","vector1","vector2","VisualTrajectoryModelKeplerian","components","currentEpoch","currentDate","newOrigin","updateSliderScale","newTarget","periods","getRelativePeriod","period1","period2","newTransferTime","root","getRootSoi","buildSoiTreeData","soiObject","level","childSois","child","concat","jqList","entry","repeat","VisualTrajectoryDynamic","VisualTrajectoryAbstract","NO_THREE_OBJ","UIPanelCreation","jqCreate","center","created","traj","setVisualModel","propagatorClass","getPropagator","pTraj","TrajectoryDynamic","ephObject","setTrajectory","addObject","forceSelection","propagate","jqImport","dump","JSON","parse","lastComponent","componentDump","loan","m0","oldSoi","newSoi","addFlightEvent","FlightEventSOIDeparture","FlightEventSOIArrival","events","eventDump","FlightEventImpulsiveBurn","onUpdate","newEvent","oldEvent","sortFlightEvents","console","log","UIPanelManeuver","increment","updateHandler","handleTrajectoryUpdate","setBurnIdx","burnIdx","burn","getOrbitPeriod","_arr","_loop","comp","_i","removeFlightEvent","init","updateBurns","burns","indexOf","orbit","getComponentByEpoch","flightEvents","newIdx","setScale","removeListener","prograde","radial","_increment","UIPanelDynamicTrajectory","jqDump","json","stringify","prompt","UI","timePanel","cameraPanel","metricsPanel","creationPanel","lambertPanel","maneuverPanel","dynamicTrajectoryPanel","Camera","animationDuration","pixelsToObjectUnderMouse","listenersAdded","initialReferenceFrame","initialPosition","_getQuaternionByPosition","currentMousePos","accountedMousePos","isMouseDown","isShiftDown","rightButtonDown","isLookingAside","zoomingAside","isAnimnating","pole","defaultDirection","defaultUp","directionQuaternion","newUp","neededUp","isBody","newType","changeReferenceFrame","newObjectId","newFrameType","newFrameId","animate","newFrame","startAnimation","transferQuaternion","animationStartingTime","getTime","animationStartingQuaternion","percent","targetQuat","slerp","biggestRadius","biggestObject","getBodies","body","getPixelDistance","getPositionByEpoch","defaultFactor","shiftKey","zoomFactor","factor","objectToZoomTo","findObjectUnderMouse","zoomingTo","currentMag","aspect","updateProjectionMatrix","rfQuaternion","mouseShift","sensitivity","mouseSensitivity","poleAngle","verticalRotationAxis","verticalQuaternion","mainQuaternion","StarSystemEntry","alias","label","moduleName","callback","isModuleLoaded","loadStarSystem","loadModule","module","StarSystemManager","_starSystems","_loadedIdx","add","loadByIdx","defaultStarSystemIdx","_findStarSystemByIdx","load","Simulation","modules","propagators","renderLoopActive","starSystemManager","_initSettings","viewPortDomElement","renderLoopFunction","scene","textureLoader","renderer","antialias","logarithmicDepthBuffer","_setRenderSize","appendChild","onWindowResize","rendererEvents","loadDefault","requestAnimationFrame","VisualFlightEventImpulsiveBurn","preloadTexture","VisualMarkerPericenter","VisualMarkerApocenter","INIT_DONE","jsonFile","onLoadFinish","Promise","resolve","getJSON","starSystemConfig","unload","StarSystem","StarSystemLoader","loadFromConfig","mainObject","startRendering","showBodyLabels","onResize","timeDelta","simCoords","visualCoords","toArray","className","__webpack_require__","then","default","Error","periodPos","substr","getClass","_footerDomElement","footerHeight","clientHeight","innerHeight","setSize","clientWidth","FunctionOfEpochObjectState","objectId","ReferenceFrameBodyFixed","isInertial","orientation","getOriginStateByEpoch","angularVel","originState","rotation","destPos","destVel","rfVel","getRotationVelocityByEpoch","ReferenceFrameAbstract","ReferenceFrameBase","setId","ReferenceFrameTopocentric","lat","lon","bodyFixedQuaternion","setFromEuler","bodyFixedPosition","rotateY","bodyState","bodyQuaternion","config","ReferenceFrameInertial","ReferenceFrameInertialDynamic","FunctionOfEpochCustom","equinox","parentId","getParentObjectIdByEpoch","INERTIAL_TOPOCENTRIC","BODY_FIXED","TOPOCENTRIC","BASE","floor","getTypeByReferenceFrameId","create","getOriginIdByReferenceFrameId","RF_BASE_OBJ","eventObj","CustomEvent","dispatchEvent","LOADING_BODIES_DONE","LOADING_FRAMES_DONE","LOADING_TRAJECTORIES_DONE","react__WEBPACK_IMPORTED_MODULE_0__","react__WEBPACK_IMPORTED_MODULE_0___default","classnames__WEBPACK_IMPORTED_MODULE_1__","classnames__WEBPACK_IMPORTED_MODULE_1___default","Button","_ref","children","_ref$small","small","_ref$disabled","disabled","_ref$onClick","createElement","cn","button--disabled","button--small","bodyId","rf","TYPE_PLANET","TYPE_PLANETOID","TYPE_SATELLITE","TYPE_ASTEROID","TYPE_COMET","TYPE_POINT","vx","vy","vz","_isHidden","obj","_onRender","getVisualCoords","remove","traverse","geometry","dispose","material","texturePath","TOP_MENU_ITEMS","SIMULATION","EDIT","VIEW","SETTINGS","HELP","HELP_PAGE_URL","MenuItemType","NONE","LINK","DROPDOWN","MenuItem","_ref$type","LinkMenuItem","_ref2","_ref2$href","href","_ref2$target","Boolean","DropDownMenuItem","options","onSelect","selectedLabel","map","option","newOption","objectSpread","Store","simulation","loadTLE","viewSettings","showStatistics","showOrbitCreationPanel","showTransferCalculationPanel","satelliteSearchPanel","isVisible","toggle","topMenu","_ref3","_ref4","_ref5","_simulation","_ref6","url","open","showWizard","wizardId","wizardIds","GETTING_STARTED_WIZARD","ignoreWatchStatusCheck","loadSatellite","noradId","_loadTLE","unloadSatellite","starSystems","defaultValue","defaultStarSystem","item","React","createContext","stats","store","updateStore","webApiServices","satelliteFinder","__webpack_exports__","root_context","menu_item_type","_Simulation__WEBPACK_IMPORTED_MODULE_0__","_Events__WEBPACK_IMPORTED_MODULE_1__","statistics","globalTime","viewPortId","curTime","anomaly","isAnomalyTrue","_mu","_sma","_ecc","_inc","_raan","_aop","_epoch","updateMeanMotion","_updateCallback","meanMotion","getMeanAnomalyByEpoch","getNodalPrecessionByEpoch","getEccentricAnomalyByMeanAnomaly","getTrueAnomalyByMeanAnomaly","ea","isElliptic","getMeanAnomalyByEccentricAnomaly","ma","F","M","asinh","cosh","cosE","getTrueAnomalyByEccentricAnomaly","phi","tanh","getApoapsisRadius","getMeanAnomalyByTrueAnomaly","apoR","distanceToPlane","c","taHigh","_planeCrossingHelper","taLow","range1","range2","isHyperbolic","temp1","temp2","isNaN","asymptote","getAsymptoteTa","_validateHyperbolicTa","getEccentricAnomalyByEpoch","koeff","pos","vel","rotateX","orbitalQuat","getOrbitalFrameQuaternion","getOwnCoordsByTrueAnomaly","nodeQuaternion","angMomentum","u","radVel","D_Projects_github_com_urbain_ru_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_6__","D_Projects_github_com_urbain_ru_node_modules_babel_runtime_helpers_esm_get__WEBPACK_IMPORTED_MODULE_4__","Constant","setUpdateCallback","referenceFrameOrId","validateEpoch","_transformKeplerianObject","TrajectoryKeplerianAbstract","VisualTrajectoryKeplerian","showFull","trailPeriod","lastPositionEpoch","lastFrameEpoch","_markers","positionEpoch","getPositionEpoch","renderEllipse","renderHyperbola","framePos","stateVectorFromBaseReferenceFrameByEpoch","getEpochByTrueAnomaly","frameEpoch","maxTa","minTa","orbitQuaternion","pericentricReferenceFrame","curTa","angs","taStep","extraPoints","coords","updateGeometry","disable","enable","relativeCameraPosition","projectedRelativeCameraPosition","projectedCameraPosition","cameraTrueAnomaly","toClosestPoint","toFarthestPoint","cameraAngle","minAnglePart","maxAnglePart","maxMa","curMa","ellipsePoints","getEllipsePoints","curve","pointsNum","densityCenter","nearSegmentSize","segments","otherSegmentsSize","segmentsFar","segmentsMedium","segmentBounds","segmentSteps","curPos","getPoint","VisualTrajectoryModelAbstract","destinationFrameOrId","destinationFrame","stateVectorToBaseReferenceFrameByEpoch","transformStateVectorByEpoch","_vector","flightEvent","_update","FlightEventAbstract","VISUAL_CLASS","propagator","updateHandlers","dumpObj","component","isEditable","pointEpoch","h","FlightEventSOIChangeAbstract","VisualFlightEventSOIDeparture","VisualFlightEventSOIArrival","lastUsedTrajectory","isSelected","selectedVisualModel","noCache","isValidAtEpoch","ExceptionOutOfRange","setParent","pop","clearAfterEpoch","TrajectoryAbstract","VisualFlightEventAbstract","D_Projects_github_com_urbain_ru_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_1__","D_Projects_github_com_urbain_ru_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_2__","_flightEvent","_trajectory","setPositionOfEpoch","VisualSpriteStatic","_isSelected","initFlightEvents","_defaultMarkerScale","_selectedMarkerScale","_minEpoch","_maxEpoch","constructor","LineObject","vertexColors","addSelectableObject","intersection","getEpochByPoint","getSimCoords","getVisualClass","model","colorMults","endingBrightness","mainColor","setFromPoints","curColor","colors","multiplyScalar","ko","_updateMarkerScales","setColor","selectedColor","_updateScales","multiplier","k","needsUpdate","removeSelectableObject","VirtualPlane","intersects","constant","intersectionPoint","clone","index","face","faceIndex","ArrowObject","dir","headLength","headWidth","line","VisualAngle","size","editingCallback","_referenceFrame","_orientation","_value","arcSize","isEditMode","bounds","customPriority","orientationUpdated","valueUpdated","sizeNeedsUpdate","minValue","maxValue","onWheelListener","mouseDownListener","TYPE_ARC","createArcObject","createSectorObject","threeAngle","cone","mouseMoved","input","Number","newAngleValue","plane","getVirtualPlane","normalize","mainAxis","applyQuaternion","oldAngleValue","virtualPlane","threeArc","threeMainAxis","vertices","getPoints","ceil","opacity","transparent","side","getPosition","getValue","updateArcObject","updateSectorObject","getOrientation","TYPE_SECTOR","VisualPlanePoint","minBound","maxBound","lastEpoch","updateValue","KeplerianEditor","colorRaan","colorAop","colorInc","colorTa","angleRaan","angleInc","setBounds","angleAop","angleTa","pointApoapsis","periapsis","pointPeriapsis","apoapsis","angleTaEditing","cachedEpoch","cachedState","clickHandler","showOrbitAnglesListener","_onShowOrbitAnglesChange","orbitalReferenceFrame","twoAxis","found","sort","e1","e2","newEvents","keplerianEditor","stateOfEpoch","quaternionOfEpoch","ReferenceFrameInertialAbstract","LocalStorageWatchStatusService","storage","_storage","_getWatchedWizards","some","canWatch","wizards","_saveStatuses","wizardIdsRawString","getItem","KEY","setItem","showLangSelectorDialog","langs","rootNode","react_default","description","buttonLabel","unmountComponentAtNode","parentNode","removeChild","StepHandlerService","goalPrefix","durationPrefix","_goalPrefix","_durationPrefix","_stepStartTimes","_metrika","yaCounter47040543","nextStepIdx","stepName","durationName","reachGoal","isAnyTutorialVisible","_callee","_ref$ignoreWatchStatu","_ref$watchStatusServi","watchStatusService","_ref$stepHandlerServi","stepHandlerService","wizard","selectedId","_args","regenerator_default","wrap","_context","prev","localStorage","abrupt","sent","handleStep","all","slicedToArray","wizardConfig","createIntroJs","onStep","_currentStep","onComplete","markAsWatched","catch","message","stop","STAR_SYSTEM_BARYCENTER","stars","referenceFrames","objects","entries","frame","createById","names","values","bodies","_arr2","_i2","getRus","getEng","setReferenceFrame","_textureName","isBuffer","isBufferGeometry","verticesCount","attributes","count","applyMatrix4","getInverse","matrixWorld","vertex1","vertex2","i1","i2","positions","array","currentLineDirection","commonPerpendicularDirection","crossVectors","planeNormalVector","distanceCoeff","addVectors","distanceTo","currentDistance","_visualModel","VisualMarkerAbstract","_alignVertical","_alignHorizontal","parentThreeObj","_parent","_isEnabled","VisualSprite","positionOfEpoch","verticalAlign","horizontalAlign","loadTexture","texture","setTexture","textureObj","_dropped","sizeAttenuation","updateCenter","image","vertical","horizontal","setAlign","_texture","OrientationAbstract","OrientationConstantAxis","angularVelocity","axisQuaternion","angularSpeed","initialAngle","initialEpoch","PhysicalBodyModel","TrajectoryKeplerianArray","keplerianObjects","nextIdx","searchDirection","approximateKeplerianObject","object1","object2","TrajectoryKeplerianPrecessingArray","obj1","obj2","TrajectoryKeplerianPrecessing","addPrecession","VisualTrajectoryPointArray","showAhead","showBehind","minCos","maxAngle","minStep","initVertices","originPos","epochs","low","high","curEpoch","curState","curVelocity","lastState","isIncreasing","stepsLeft","nextEpoch","newState","dr","drMag","angleCos","nextNextEpoch","nextDr","TrajectoryStaticPosition","TrajectoryLoader","createKeplerianBasic","createKeplerianPrecessing","createKeplerianArray","createKeplerianPrecessingArray","createComposite","createStatic","periodStart","periodEnd","rendering","visual","regular","createVisualModel","setSelectedVisualModel","keplerianModel","pointArrayModel","VisualTrajectoryModelPointArray","partConfig","elementsArray","addState","createKeplerianObject","elements","VisualStarsModel","threeGeometry","params","VisualLabel","parameters","assign","DEFAULT_SETTINGS","canvas","renderOrder","setText","context","fontSize","canvasWidth","canvasHeight","margin","ceilPowerOfTwo","textAlign","textBaseline","scaleCoeff","calculateScaleCoeff","scaling","scalingFunctions","range","from","to","alwaysVisible","VisualBodyModelAbstract","shape","getThreeObj","getThreeGeometry","getMaterial","wireframe","getTopDirection","getMaxDimension","VisualBodyModelBasic","isTextureRequested","metalness","roughness","txt","VisualBodyModelLight","light","lightColor","lightIntensity","lightDistance","lightDecay","VisualBodyModelRings","ringsRadius","ringsColorMapPath","ringsAlphaMapPath","container","bodyThreeObj","ringsThreeObj","ringsColorMap","ringsAlphaMap","alphaMap","updateRingsMaterial","VisualShapeSphere","objectConfig","_loadObject","addReferenceFrame","addStars","visualShape","visualModelClass","basic","rings","physical","Satellite","satelliteRawData","objectType","intlDes","country","launchDate","decayDate","launchSite","apogee","perigee","launchYear","launchNum","launchPiece","objectName","objectNumber","./KSP/ModuleKSP","./KSP/ModuleKSP.js","./PatchedConics/FlightEvent/SOIArrival","./PatchedConics/FlightEvent/SOIArrival.js","./PatchedConics/FlightEvent/SOIChangeAbstract","./PatchedConics/FlightEvent/SOIChangeAbstract.js","./PatchedConics/FlightEvent/SOIDeparture","./PatchedConics/FlightEvent/SOIDeparture.js","./PatchedConics/ModulePatchedConics","./PatchedConics/ModulePatchedConics.js","./PatchedConics/PropagatorPatchedConics","./PatchedConics/PropagatorPatchedConics.js","./PatchedConics/visual/FlightEvent/SOIArrival","./PatchedConics/visual/FlightEvent/SOIArrival.js","./PatchedConics/visual/FlightEvent/SOIDeparture","./PatchedConics/visual/FlightEvent/SOIDeparture.js","./SolarSystem/ModuleSolarSystem","./SolarSystem/ModuleSolarSystem.js","./SolarSystem/Orientation/IAUModel","./SolarSystem/Orientation/IAUModel.js","./SolarSystem/Trajectory/ELP2000","./SolarSystem/Trajectory/ELP2000.js","./SolarSystem/Trajectory/VSOP87","./SolarSystem/Trajectory/VSOP87.js","webpackAsyncContext","req","ids","slice","code","exports","./getting-started-wizard/index","./getting-started-wizard","./getting-started-wizard/","./getting-started-wizard/getting-started-wizard-eng","./getting-started-wizard/getting-started-wizard-eng.js","./getting-started-wizard/getting-started-wizard-ru","./getting-started-wizard/getting-started-wizard-ru.js","./getting-started-wizard/index.js","./wizard-ids","./wizard-ids.js","StatisticsBadge","elementRef","createRef","current","props","dom","ref","Component","components_statistics_badge","ui_store","Consumer","statistics_badge_StatisticsBadge","SearchApiParamsBuilder","_params","param","paramName","relation","valueToCompare","addWithValue","limit","FieldType","NumberFieldRelationType","GreaterThan","LessThan","Equal","allValues","DateFieldRelationType","StringFieldRelationType","Like","ServerFieldName","allKeys","SERVER_FIELDS_TYPE","Map","FieldParameter","fieldName","_fieldName","createClass","AllFields","SatelliteFinder","apiEndpoint","_apiUrl","urlParams","_createParams","axios","_prepareResult","t0","serverResponseData","_isOk","totalRows","satellites","s","_isError","paramsBuilder","addWithRelation","build","resp","status","Logo","DEFAULT","customSelectStyles","base","background","minHeight","minWidth","control","borderRadius","borderStyle","menu","marginTop","marginBottom","menuList","backgroundColor","isFocused","singleValue","isDisabled","transition","dropdownIndicator","padding","marginRight","indicatorSeparator","display","IndicatorsContainer","react_select_esm","DropdownIndicator","Select","PropTypes","_ref$onSelect","classNamePrefix","placeholder","styles","isSearchable","onChange","StarSystemSelector","select_select","star_system_selector_star_system_selector","_store$starSystemSele","starSystemSelectorSettings","DropdownMenuItem","handleClick","_this$props","react_fontawesome_index_es","icon","DropDownMenu","selectedItem","_this$context","dropDownMenuData","hasOptionsToShow","drop_down_menu_item","contextType","RootContext","MenuLink","_ref$className","_ref$target","MainMenuItem","menuItem","clickable","menu_link","components_drop_down_menu","MainMenu","isClickable","Header","logo","main_menu_main_menu","SideBar","ArrowLogo","classNames","role","viewBox","fill","xmlns","MaximizeLogo","strokeWidth","CollapseButton","isToRight","_ref$collapseDirectio","collapseDirection","common_button","maximize_logo","Field","_ref$leftAligned","leftAligned","_ref$centered","centered","panel__field--left-aligned","panel__field--centered","FieldLabel","_ref$tag","tag","ComponentType","_ref$normal","_ref$middle","middle","panel__field-label--normal","panel__field-label--middle","panel__field-label--small","FieldControl","_ref$fullSize","fullSize","panel__field-control--full-size","PanelButton","FieldSet","Dimension","Panel","collapsedByDefault","handleToggle","setState","prevState","caption","hideCollapseButton","titleIcon","hidden","panel--hidden","panel--collapsed","collapse_button","style","defaultProps","CameraPanel","panel_Panel","field","field_label","field_control","PauseButton","timeLine","pause-button--paused","time_settings_panel_logo","TimeSettingsPanel","components_button","BottomPanel","components_time_settings_panel","components_pause_button","components_time_line","camera_panel_camera_panel","CreationPanel","TransferCalculationPanel","field_set","data-panel-name","components_dimension","KeplerianView","VectorComponentView","_ref$label","_ref$valueClassName","valueClassName","_ref$dimension","dimension","ExpandButton","_ref$expanded","expanded","expand-button--expanded","CartesianVectorView","isExpanded","vectorMagnitudeLabel","components_vector_component_view","common_expand_button","MetricsPanel","defaultChecked","components_cartesian_vector_view","ManeuverPanel","DynamicTrajectoryPanel","SatelliteSearchPanel","lazy","MainView","common_side_bar","creation_panel","components_maneuver_panel","components_transfer_calculation_panel","components_metrics_panel","dynamic_trajectory_panel","react","fallback","components_bottom_panel","App","Fragment","header_header","main_view_main_view","process","library","faExpand","faPlay","faPause","faChevronDown","faCheck","faBars","statsBadge","Stats","classList","createStatsBadge","Root","_handleUpdateStore","updatedStore","Provider","app","initialState","loadKSP","Application","_store","getInitialState","api","getApi","ReactDOM","ui_Root"],"mappings":"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","file":"static/js/main.fef6c0ba.chunk.js","sourcesContent":["import * as THREE from \"three\";\r\n\r\nexport class Vector extends Array\r\n{\r\n    constructor(dimOrArray) {\r\n        super();\r\n        if (dimOrArray === undefined) {\r\n            dimOrArray = 3;\r\n        }\r\n        if (dimOrArray instanceof Array) {\r\n            for (let i = 0; i < dimOrArray.length; ++i) {\r\n                this[i] = dimOrArray[i];\r\n            }\r\n        } else {\r\n            for (let i = 0; i < dimOrArray; ++i) {\r\n                this[i] = 0;\r\n            }\r\n        }\r\n\r\n        Object.setPrototypeOf(this, Vector.prototype);\r\n    }\r\n\r\n    get x() {\r\n        return this[0];\r\n    }\r\n\r\n    set x(value) {\r\n        this[0] = value;\r\n    }\r\n\r\n    get y() {\r\n        return this[1];\r\n    }\r\n\r\n    set y(value) {\r\n        this[1] = value;\r\n    }\r\n\r\n    get z() {\r\n        return this[2];\r\n    }\r\n\r\n    set z(value) {\r\n        this[2] = value;\r\n    }\r\n\r\n    get quadrance() {\r\n        let res = 0;\r\n        for (let i = 0; i < this.length; ++i) {\r\n            res += this[i] * this[i];\r\n        }\r\n        return res;\r\n    }\r\n\r\n    get mag() {\r\n        return Math.sqrt(this.quadrance);\r\n    }\r\n\r\n    copy() {\r\n        return new Vector(this);\r\n    }\r\n\r\n    set(arrayOrVarargs) {\r\n        let vals = (arguments.length === 1) ? arguments[0] : arguments;\r\n        if (vals.length == null) {\r\n            vals = [vals];\r\n        }\r\n        for (let i = 0; i < this.length; ++i) {\r\n            this[i] = vals[i];\r\n        }\r\n        return this;\r\n    }\r\n\r\n    dot(vec) {\r\n        let res = 0;\r\n        for (let i = 0; i < this.length; ++i) {\r\n            res += this[i] * vec[i];\r\n        }\r\n        return res;\r\n    }\r\n\r\n    cross(vec) {\r\n        return new Vector([\r\n            this[1] * vec[2] - this[2] * vec[1],\r\n            this[2] * vec[0] - this[0] * vec[2],\r\n            this[0] * vec[1] - this[1] * vec[0],\r\n        ]);\r\n    }\r\n\r\n    angle(vec) {\r\n        const cos = this.dot(vec) / this.mag / vec.mag;\r\n        if (cos <= -1) {\r\n            return Math.PI;\r\n        }\r\n        if (cos >= 1) {\r\n            return 0;\r\n        }\r\n        return Math.acos(cos);\r\n    }\r\n\r\n    add_(vec) {\r\n        for (let i = 0; i < this.length; ++i) {\r\n            this[i] += vec[i];\r\n        }\r\n        return this;\r\n    }\r\n\r\n    sub_(vec) {\r\n        for (let i = 0; i < this.length; ++i) {\r\n            this[i] -= vec[i];\r\n        }\r\n        return this;\r\n    }\r\n\r\n    mul_(scalar) {\r\n        for (let i = 0; i < this.length; ++i) {\r\n            this[i] *= scalar;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    div_(scalar) {\r\n        for (let i = 0; i < this.length; ++i) {\r\n            this[i] /= scalar;\r\n        }\r\n        return this;\r\n    }\r\n\r\n    rotate_(axis, angle) {\r\n        return (new Quaternion(axis, angle)).rotate_(this);\r\n    }\r\n\r\n    unit_() {\r\n        return this.div_(this.mag);\r\n    }\r\n\r\n    projectOn_(v) {\r\n        let unit = v.unit();\r\n        this.set(unit.mul_(this.dot(unit)));\r\n        return this;\r\n    }\r\n\r\n    add(vec) {\r\n        return this.copy().add_(vec);\r\n    }\r\n\r\n    sub(vec) {\r\n        return this.copy().sub_(vec);\r\n    }\r\n\r\n    mul(scalar) {\r\n        return this.copy().mul_(scalar);\r\n    }\r\n\r\n    div(scalar) {\r\n        return this.copy().div_(scalar);\r\n    }\r\n\r\n    unit() {\r\n        return this.copy().unit_();\r\n    }\r\n\r\n    projectOn(v) {\r\n        return this.copy().projectOn_(v);\r\n    }\r\n\r\n    projectionOn(v) {\r\n        return this.dot(v.unit());\r\n    }\r\n\r\n    rotate(axis, angle) {\r\n        return this.copy().rotate_(axis, angle);\r\n    }\r\n\r\n    rotateX(radians) {\r\n        let sin = Math.sin(radians);\r\n        let cos = Math.cos(radians);\r\n        return new Vector([\r\n            this[0],\r\n            this[1] * cos - this[2] * sin,\r\n            this[1] * sin + this[2] * cos,\r\n        ]);\r\n    }\r\n\r\n    rotateY(radians) {\r\n        let sin = Math.sin(radians);\r\n        let cos = Math.cos(radians);\r\n        return new Vector([\r\n            this[0] * cos + this[2] * sin,\r\n            this[1],\r\n            -this[0] * sin + this[2] * cos,\r\n        ]);\r\n    }\r\n\r\n    rotateZ(radians) {\r\n        let sin = Math.sin(radians);\r\n        let cos = Math.cos(radians);\r\n        return new Vector([\r\n            this[0] * cos - this[1] * sin,\r\n            this[0] * sin + this[1] * cos,\r\n            this[2],\r\n        ]);\r\n    }\r\n}\r\n\r\nexport class Quaternion\r\n{\r\n    constructor(vector, angle) {\r\n        this.t = 1;\r\n        this.v = new Vector(3);\r\n\r\n        if (vector instanceof Array) {\r\n            this.setAxisAngle(vector || [1, 0, 0], angle || 0);\r\n        }\r\n    }\r\n\r\n    static copy(q) {\r\n        return q.copy();\r\n    }\r\n\r\n    static mul(q1, q2) {\r\n        return q1.copy().mul_(q2);\r\n    }\r\n\r\n    static transfer(fromVector, toVector) {\r\n        const angle = fromVector.angle(toVector);\r\n        if (angle) {\r\n            return new Quaternion(fromVector.cross(toVector), angle);\r\n        } else {\r\n            return new Quaternion();\r\n        }\r\n    }\r\n\r\n    static twoAxis(x, y, z) {\r\n        let normal1;\r\n        let normal2;\r\n        let quat;\r\n        if (x && y) {\r\n            normal1 = new Vector([0, 0, 1]);\r\n            normal2 = x.cross(y);\r\n        } else if (x && z) {\r\n            normal1 = new Vector([0, 1, 0]);\r\n            normal2 = z.cross(x);\r\n        } else if (y && z) {\r\n            normal1 = new Vector([1, 0, 0]);\r\n            normal2 = y.cross(z);\r\n        }\r\n        quat = Quaternion.transfer(normal1, normal2);\r\n        return x\r\n            ? Quaternion.transfer(quat.rotate_(new Vector([1,0,0])), x).mul_(quat)\r\n            : Quaternion.transfer(quat.rotate_(new Vector([0,1,0])), y).mul_(quat);\r\n    }\r\n\r\n    static slerp(q1, q2, t) {\r\n        if (t == 0) {\r\n            return q1.copy();\r\n        } else if (t == 1) {\r\n            return q2.copy();\r\n        }\r\n\r\n        let res = q2.copy();\r\n        let cosHalfTheta = q1.t * q2.t + q1.v[0] * q2.v[0] + q1.v[1] * q2.v[1] + q1.v[2] * q2.v[2];\r\n\r\n        if (cosHalfTheta < 0) {\r\n            res.t = -q2.t;\r\n            res.v[0] = -q2.v[0];\r\n            res.v[1] = -q2.v[1];\r\n            res.v[2] = -q2.v[2];\r\n            cosHalfTheta = -cosHalfTheta;\r\n        }\r\n\r\n        if (cosHalfTheta >= 1) {\r\n            return q1.copy();\r\n        }\r\n\r\n        let sinHalfTheta = Math.sqrt(1 - cosHalfTheta * cosHalfTheta);\r\n\r\n        if (sinHalfTheta < 0.001) {\r\n            res.t = (q1.t + res.t) / 2;\r\n            res.v[0] = (q1.v[0] + res.v[0]) / 2;\r\n            res.v[1] = (q1.v[1] + res.v[1]) / 2;\r\n            res.v[2] = (q1.v[2] + res.v[2]) / 2;\r\n            return res;\r\n        }\r\n\r\n        const halfTheta = Math.atan2(sinHalfTheta, cosHalfTheta);\r\n        const ratio1 = Math.sin((1 - t) * halfTheta) / sinHalfTheta;\r\n        const ratio2 = Math.sin(t * halfTheta) / sinHalfTheta;\r\n\r\n        res.t = q1.t * ratio1 + res.t * ratio2;\r\n        res.v[0] = q1.v[0] * ratio1 + res.v[0] * ratio2;\r\n        res.v[1] = q1.v[1] * ratio1 + res.v[1] * ratio2;\r\n        res.v[2] = q1.v[2] * ratio1 + res.v[2] * ratio2;\r\n        return res;\r\n    }\r\n\r\n    static invert(quat) {\r\n        return quat.invert();\r\n    }\r\n\r\n    copy() {\r\n        let res = new Quaternion();\r\n        res.t = this.t;\r\n        res.v = this.v.copy();\r\n        return res;\r\n    }\r\n\r\n    quadrance() {\r\n        return this.t * this.t + this.v[0] * this.v[0] + this.v[1] * this.v[1] + this.v[2] * this.v[2];\r\n    }\r\n\r\n    length() {\r\n        return Math.sqrt(this.quadrance());\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @returns {Quaternion}\r\n     */\r\n    invert_() {\r\n        let quadrance = this.quadrance();\r\n        this.t /= quadrance;\r\n        this.v.div_(-quadrance);\r\n        return this;\r\n    }\r\n\r\n    invert() {\r\n        return this.copy().invert_();\r\n    }\r\n\r\n    normalize_() {\r\n        let len = this.length();\r\n        this.t /= len;\r\n        this.v.div_(len);\r\n        return this;\r\n    }\r\n\r\n    normalize() {\r\n        return this.copy().normalize_();\r\n    }\r\n\r\n    rotate_(vector) {\r\n        let cx = this.v.cross(vector).mul_(2);\r\n        let cx2 = this.v.cross(cx);\r\n        vector[0] += this.t * cx[0] + cx2[0];\r\n        vector[1] += this.t * cx[1] + cx2[1];\r\n        vector[2] += this.t * cx[2] + cx2[2];\r\n        return vector;\r\n    }\r\n\r\n    rotate(vector) {\r\n        return this.rotate_(vector.copy());\r\n    }\r\n\r\n    mul_(quat) {\r\n        const w = this.t;\r\n        const x = this.v[0];\r\n        const y = this.v[1];\r\n        const z = this.v[2];\r\n        const ow = quat.t;\r\n        const ox = quat.v[0];\r\n        const oy = quat.v[1];\r\n        const oz = quat.v[2];\r\n\r\n        this.t = w * ow - x * ox - y * oy - z * oz;\r\n        this.v[0] = w * ox + x * ow + y * oz - z * oy;\r\n        this.v[1] = w * oy - x * oz + y * ow + z * ox;\r\n        this.v[2] = w * oz + x * oy - y * ox + z * ow;\r\n\r\n        return this;\r\n    }\r\n\r\n    mul(quat) {\r\n        return this.copy().mul_(quat);\r\n    }\r\n\r\n    setAxisAngle(axis, angle) {\r\n        this.t = Math.cos(angle / 2);\r\n        this.v.set(axis);\r\n        this.v.mul_(Math.sin(angle / 2) / this.v.mag);\r\n        return this;\r\n    }\r\n\r\n    setFromEuler(x, y, z, order) {\r\n        const c1 = Math.cos(x / 2);\r\n        const c2 = Math.cos(y / 2);\r\n        const c3 = Math.cos(z / 2);\r\n        const s1 = Math.sin(x / 2);\r\n        const s2 = Math.sin(y / 2);\r\n        const s3 = Math.sin(z / 2);\r\n\r\n        order = order || 'ZYX';\r\n\r\n        if (order === 'XYZ') {\r\n            this.v.set([\r\n                s1 * c2 * c3 + c1 * s2 * s3,\r\n                c1 * s2 * c3 - s1 * c2 * s3,\r\n                c1 * c2 * s3 + s1 * s2 * c3\r\n            ]);\r\n            this.t = c1 * c2 * c3 - s1 * s2 * s3;\r\n        } else if (order === 'YXZ') {\r\n            this.v.set([\r\n                s1 * c2 * c3 + c1 * s2 * s3,\r\n                c1 * s2 * c3 - s1 * c2 * s3,\r\n                c1 * c2 * s3 - s1 * s2 * c3\r\n            ]);\r\n            this.t = c1 * c2 * c3 + s1 * s2 * s3;\r\n        } else if (order === 'ZXY') {\r\n            this.v.set([\r\n                s1 * c2 * c3 - c1 * s2 * s3,\r\n                c1 * s2 * c3 + s1 * c2 * s3,\r\n                c1 * c2 * s3 + s1 * s2 * c3\r\n            ]);\r\n            this.t = c1 * c2 * c3 - s1 * s2 * s3;\r\n        } else if (order === 'ZYX') {\r\n            this.v.set([\r\n                s1 * c2 * c3 - c1 * s2 * s3,\r\n                c1 * s2 * c3 + s1 * c2 * s3,\r\n                c1 * c2 * s3 - s1 * s2 * c3\r\n            ]);\r\n            this.t = c1 * c2 * c3 + s1 * s2 * s3;\r\n        } else if (order === 'YZX') {\r\n            this.v.set([\r\n                s1 * c2 * c3 + c1 * s2 * s3,\r\n                c1 * s2 * c3 + s1 * c2 * s3,\r\n                c1 * c2 * s3 - s1 * s2 * c3\r\n            ]);\r\n            this.t = c1 * c2 * c3 - s1 * s2 * s3;\r\n        } else if (order === 'XZY') {\r\n            this.v.set([\r\n                s1 * c2 * c3 - c1 * s2 * s3,\r\n                c1 * s2 * c3 - s1 * c2 * s3,\r\n                c1 * c2 * s3 + s1 * s2 * c3\r\n            ]);\r\n            this.t = c1 * c2 * c3 + s1 * s2 * s3;\r\n        } else if (order === 'ZXZ') {\r\n            this.v.set([\r\n                Math.cos((x - z) / 2) * s2,\r\n                Math.sin((x - z) / 2) * s2,\r\n                Math.sin((x + z) / 2) * c2\r\n            ]);\r\n            this.t = Math.cos((x + z) / 2) * c2\r\n        }\r\n        return this;\r\n    }\r\n\r\n    toThreejs() {\r\n        return new THREE.Quaternion(this.v[0], this.v[1], this.v[2], this.t);\r\n    }\r\n}\r\n\r\nexport const TWO_PI = 2 * Math.PI;\r\n\r\nexport function newtonSolve(func, start, d, maxError, maxSteps) {\r\n    let step = 0;\r\n    let val = start;\r\n    let error;\r\n\r\n    do {\r\n        const v1 = func(val);\r\n        const v2 = func(val + d);\r\n        const diff = (v2 - v1) / d;\r\n\r\n        if (v1 === null || v2 === null) {\r\n            return null;\r\n        }\r\n\r\n        error = Math.abs(v1);\r\n        val -= v1 / diff;\r\n        step += 1;\r\n    } while (error > maxError && step < maxSteps);\r\n\r\n    return (error > maxError) ? null : val;\r\n}\r\n\r\nexport function deg2rad(degrees) {\r\n    return degrees / 180 * Math.PI;\r\n}\r\n\r\nexport function rad2deg(radians) {\r\n    return radians * 180 / Math.PI;\r\n}\r\n\r\nexport function acosSigned(cos, sinSign) {\r\n    const ang = Math.acos(cos);\r\n    return (sinSign > 0)\r\n        ? ang\r\n        : (TWO_PI - ang);\r\n}\r\n\r\nexport function angleIntervalIntersection(int1, int2) {\r\n    if (!int1 || !int2) {\r\n        return false;\r\n    } else if (int1[0] <= int2[0] && int2[1] <= int1[1]) {\r\n        return int2;\r\n    } else if (int2[0] <= int1[0] && int1[1] <= int2[1]) {\r\n        return int1;\r\n    } else if (int1[0] <= int2[0] && int2[0] <= int1[1]) {\r\n        return [int2[0], int1[1]];\r\n    } else if (int1[0] <= int2[1] && int2[1] <= int1[1]) {\r\n        return [int1[0], int2[1]];\r\n    }\r\n    return false;\r\n}\r\n\r\nexport function getAngleIntervalsIntersection(intervals1, intervals2) {\r\n    let result = [];\r\n    if (intervals1 === false || intervals2 === false) {\r\n        return false;\r\n    }\r\n    if (intervals1 === true) {\r\n        return intervals2;\r\n    }\r\n    if (intervals2 === true) {\r\n        return intervals1;\r\n    }\r\n    for (let interval1 of intervals1) {\r\n        const int11 = [interval1[0], interval1[1] > interval1[0] ? interval1[1] : TWO_PI];\r\n        const int12 = interval1[1] > interval1[0] ? false : [0, interval1[1]];\r\n        for (let interval2 of intervals2) {\r\n            const int21 = [interval2[0], interval2[1] > interval2[0] ? interval2[1] : TWO_PI];\r\n            const int22 = interval2[1] > interval2[0] ? false : [0, interval2[1]];\r\n            let r;\r\n            if (r = angleIntervalIntersection(int11, int21))\r\n                result.push(r);\r\n            if (r = angleIntervalIntersection(int11, int22))\r\n                result.push(r);\r\n            if (r = angleIntervalIntersection(int12, int21))\r\n                result.push(r);\r\n            if (r = angleIntervalIntersection(int12, int22))\r\n                result.push(r);\r\n        }\r\n    }\r\n    return result.length ? result : false;\r\n}\r\n\r\nexport function isInInterval(angle, interval) {\r\n    const int1 = (interval[0] + TWO_PI) % TWO_PI;\r\n    const int2 = (interval[1] + TWO_PI) % TWO_PI;\r\n    angle = (angle + TWO_PI) % TWO_PI;\r\n    if (int1 <= int2) {\r\n        return (int1 <= angle) && (angle <= int2);\r\n    } else {\r\n        return (int1 <= angle) || (angle <= int2);\r\n    }\r\n}\r\n\r\nexport function getEpochIntervalsIntersection(intervals1, intervals2) {\r\n    let result = [];\r\n    if (intervals1 === false || intervals2 === false) {\r\n        return false;\r\n    }\r\n    if (intervals1 === true) {\r\n        return intervals2;\r\n    }\r\n    if (intervals2 === true) {\r\n        return intervals1;\r\n    }\r\n    for (let interval1 of intervals1) {\r\n        const epoch1 = interval1[0];\r\n        const epoch2 = interval1[1];\r\n        for (let interval2 of intervals2) {\r\n            const epoch21 = interval2[0];\r\n            const epoch22 = interval2[1];\r\n            if (epoch1 <= epoch21 && epoch21 < epoch2) {\r\n                result.push([\r\n                    epoch21,\r\n                    epoch2 < epoch22 ? epoch2 : epoch22\r\n                ]);\r\n            } else if (epoch1 < epoch22 && epoch22 <= epoch2) {\r\n                result.push([\r\n                    epoch1,\r\n                    epoch22,\r\n                ]);\r\n            } else if (epoch1 < epoch21 && epoch22 < epoch2) {\r\n                result.push([\r\n                    epoch21,\r\n                    epoch22,\r\n                ]);\r\n            } else if (epoch21 < epoch1 && epoch2 < epoch22) {\r\n                result.push([\r\n                    epoch1,\r\n                    epoch2,\r\n                ]);\r\n            }\r\n        }\r\n    }\r\n    return result.length ? result : false;\r\n}\r\n\r\nexport function approximateAngle(ang1, ang2, proportion) {\r\n    ang1 = ((ang1 % TWO_PI) + TWO_PI) % TWO_PI;\r\n    ang2 = ((ang2 % TWO_PI) + TWO_PI) % TWO_PI;\r\n\r\n    let diff = ang2 - ang1;\r\n\r\n    if (Math.abs(diff) > Math.PI) {\r\n        diff = (diff > 0)\r\n            ? (diff - TWO_PI)\r\n            : (diff + TWO_PI);\r\n    }\r\n\r\n    return ((ang1 + diff * proportion) + TWO_PI) % TWO_PI;\r\n}\r\n\r\nexport function approximateNumber(n1, n2, proportion) {\r\n    return n1 + (n2 - n1) * proportion;\r\n}\r\n\r\nexport function presentNumberWithSuffix(number) {\r\n    if (Math.abs(number) >= 1000000000) {\r\n        return (number / 1000000000).toFixed(3) + ' G';\r\n    }\r\n    if (Math.abs(number) >= 1000000) {\r\n        return (number / 1000000).toFixed(3) + ' M';\r\n    }\r\n    if (Math.abs(number) >= 1000) {\r\n        return (number / 1000).toFixed(3) + ' K';\r\n    }\r\n    if (Math.abs(number) <= 0.000000001) {\r\n        return (number / 0.000000001).toFixed(3) + ' n';\r\n    }\r\n    if (Math.abs(number) <= 0.000001) {\r\n        return (number / 0.000001).toFixed(3) + ' µ';\r\n    }\r\n    if (Math.abs(number) <= 0.001) {\r\n        return (number / 0.001).toFixed(3) + ' m';\r\n    }\r\n    return number.toPrecision(6) + ' ';\r\n}\r\n","export default class EventHandler\r\n{\r\n    constructor(domElement) {\r\n        this.domElement = domElement;\r\n        this.listeners = {};\r\n        this.handlers = {};\r\n    }\r\n\r\n    addListener(eventName, listener, priority) {\r\n        if (!this.handlers[eventName]) {\r\n            this.listeners[eventName] = [];\r\n            this.handlers[eventName] = (event) => this.handleEvent(eventName, event);\r\n            this.domElement.addEventListener(eventName, this.handlers[eventName]);\r\n        }\r\n\r\n        this.listeners[eventName].push({\r\n            handler: listener,\r\n            priority: priority\r\n        });\r\n    }\r\n\r\n    removeListener(eventName, listener) {\r\n        const list = this.listeners[eventName];\r\n        for (let idx = 0; idx < list.length; idx++) {\r\n            if (list[idx].handler === listener) {\r\n                list.splice(idx, 1);\r\n                break;\r\n            }\r\n        }\r\n\r\n        if (list.length === 0) {\r\n            this.domElement.removeEventListener(eventName, this.handlers[eventName]);\r\n            delete this.handlers[eventName];\r\n            delete this.listeners[eventName];\r\n        }\r\n    }\r\n\r\n    handleEvent(eventName, eventObject) {\r\n        const list = this.listeners[eventName];\r\n\r\n        if (!list) {\r\n            return;\r\n        }\r\n\r\n        let highestPriority = list.reduce((val, a) => Math.max(val, a.priority), list[0].priority);\r\n\r\n        let nextPriority = true;\r\n        let handlersLeft = list.length;\r\n\r\n        while (nextPriority && handlersLeft > 0) {\r\n            handlersLeft = 0;\r\n            for (const listener of list) {\r\n                if (listener.priority === highestPriority) {\r\n                    if (listener.handler(eventObject) !== true) {\r\n                        nextPriority = false;\r\n                    }\r\n                } else if (listener.priority < highestPriority) {\r\n                    handlersLeft++;\r\n                }\r\n            }\r\n            highestPriority--;\r\n        }\r\n    }\r\n}\r\n","import Events from \"../core/Events\";\r\n\r\nexport const J2000_TIMESTAMP = 946728000;\r\n\r\nexport default class TimeLine\r\n{\r\n    constructor(epoch, timeScale, isTimeRunning) {\r\n        this.epoch = epoch;\r\n        this.timeScale = timeScale;\r\n        this.isTimeRunning = isTimeRunning;\r\n\r\n        this.mouseState = {\r\n            x: 0,\r\n            y: 0,\r\n            leftButton: false,\r\n            rightButton: false\r\n        };\r\n\r\n        this.timeLineCanvasDomElement = document.getElementById(\"timeLineCanvas\");\r\n        this.canvasContext = this.timeLineCanvasDomElement.getContext(\"2d\");\r\n        this.canvasRect = {};\r\n        this.updateCanvasStyle();\r\n        this.initValues();\r\n\r\n        this.timeLineCanvasDomElement.addEventListener(\"mousedown\",  this.onMouseDown  .bind(this));\r\n        window                       .addEventListener(\"mouseup\",    this.onMouseUp    .bind(this));\r\n        window                       .addEventListener(\"mousemove\",  this.onMouseMove  .bind(this));\r\n        this.timeLineCanvasDomElement.addEventListener(\"mousewheel\", this.onMouseWheel .bind(this));\r\n\r\n        window.addEventListener('keypress', e => {\r\n            if (e.key === ' ') {\r\n                this.togglePause();\r\n            }\r\n        });\r\n\r\n        window.addEventListener(\"resize\", this.updateCanvasStyle.bind(this));\r\n        window.oncontextmenu = () => false;\r\n    }\r\n\r\n    initValues() {\r\n        this.scales = {\r\n            minute: 60,\r\n            fiveMinutes: 300,\r\n            tenMinutes: 600,\r\n            thirtyMinutes: 1800,\r\n            hour: 3600,\r\n            threeHours: 10800,\r\n            sixHours: 21600,\r\n            day: 86400,\r\n            week: 604800,\r\n            month: 2592000,\r\n            threeMonths: 7776000,\r\n            year: 31557600,\r\n            fiveYears: 157788000,\r\n        };\r\n\r\n        this.span = this.timeScale * 86400 * 5;\r\n        this.markDistance = 300;\r\n        this.scaleType = \"month\";\r\n        this.leftEpoch = this.epoch - this.span / 2;\r\n\r\n        this.updateScaleType();\r\n\r\n        this.getDateByEpoch = TimeLine.getDateByEpoch;\r\n        this.getEpochByDate = TimeLine.getEpochByDate;\r\n\r\n        this.roundDateUp = TimeLine.roundDateUp;\r\n        this.nextRenderingDate = TimeLine.nextRenderingDate;\r\n        this.formatDate = TimeLine.formatDate;\r\n        this.formatDateFull = TimeLine.formatDateFull;\r\n    }\r\n\r\n    setTimeScale(newScale) {\r\n        Events.dispatch(Events.TIME_SCALE_CHANGED, {old: this.timeScale, new: newScale});\r\n        this.timeScale = newScale;\r\n    }\r\n\r\n    togglePause() {\r\n        this.isTimeRunning = !this.isTimeRunning;\r\n        Events.dispatch(this.isTimeRunning ? Events.TIME_UNPAUSED : Events.TIME_PAUSED);\r\n    }\r\n\r\n    tick(timePassed) {\r\n        if (this.mouseState.leftButton) {\r\n            this.epoch = this.leftEpoch + (this.mouseState.x\r\n                - this.canvasRect.left) * this.span / this.timeLineCanvasDomElement.width;\r\n        } else if (this.isTimeRunning) {\r\n            if ((this.leftEpoch < this.epoch)\r\n                && (this.epoch < this.leftEpoch + this.span)\r\n            ) {\r\n                this.leftEpoch += this.timeScale * timePassed;\r\n            }\r\n\r\n            this.epoch += this.timeScale * timePassed;\r\n        }\r\n\r\n        Events.dispatch(Events.EPOCH_CHANGED, {\r\n            epoch: this.epoch,\r\n            date: this.getDateByEpoch(this.epoch)\r\n        });\r\n\r\n        this.redraw();\r\n    }\r\n\r\n    forceEpoch(newEpoch) {\r\n        this.leftEpoch += newEpoch - this.epoch;\r\n        this.epoch = newEpoch;\r\n        this.tick(0);\r\n    }\r\n\r\n    useCurrentTime() {\r\n        this.forceEpoch(this.getEpochByDate(new Date()));\r\n    }\r\n\r\n    redraw() {\r\n        this.canvasContext.fillStyle = \"#222\";\r\n        this.canvasContext.fillRect(0, 0, this.timeLineCanvasDomElement.width, this.timeLineCanvasDomElement.height);\r\n\r\n        this.canvasContext.fillStyle = this.isTimeRunning ? \"#2846ed\" : \"#393b40\";\r\n        this.drawCurrentTimeMark();\r\n\r\n        this.canvasContext.strokeStyle = \"#fdfdfd\";\r\n        this.canvasContext.fillStyle   = \"#fdfdfd\";\r\n        this.canvasContext.font        = \"11px sans-serif\";\r\n\r\n        let markDate = this.roundDateUp(this.getDateByEpoch(this.leftEpoch), this.scaleType);\r\n        let markEpoch = this.getEpochByDate(markDate);\r\n\r\n        while (markEpoch < this.leftEpoch + this.span) {\r\n            this.drawMark(this.getCanvasPositionByEpoch(markEpoch), this.formatDate(markDate, this.scaleType));\r\n            markDate = this.nextRenderingDate(markDate, this.scaleType);\r\n            markEpoch = this.getEpochByDate(markDate);\r\n        }\r\n    }\r\n\r\n    getCanvasPositionByEpoch(epoch) {\r\n        return (epoch - this.leftEpoch) * this.timeLineCanvasDomElement.width / this.span;\r\n    }\r\n\r\n    updateCanvasStyle() {\r\n        this.canvasRect = this.timeLineCanvasDomElement.getBoundingClientRect();\r\n        this.timeLineCanvasDomElement.width  = this.canvasRect.right  - this.canvasRect.left;\r\n        this.timeLineCanvasDomElement.height = this.canvasRect.bottom - this.canvasRect.top;\r\n    }\r\n\r\n    updateScaleType() {\r\n        const secondsPerPeriod = this.markDistance * this.span / this.timeLineCanvasDomElement.width;\r\n        let bestScale = false;\r\n\r\n        for (const scale in this.scales) {\r\n            if (!bestScale) {\r\n                bestScale = scale;\r\n                continue;\r\n            }\r\n\r\n            if (Math.abs(this.scales[bestScale] / secondsPerPeriod - 1)\r\n                > Math.abs(this.scales[scale] / secondsPerPeriod - 1)\r\n            ) {\r\n                bestScale = scale;\r\n            }\r\n        }\r\n\r\n        this.scaleType = bestScale;\r\n    }\r\n\r\n    drawMark(x, text) {\r\n        this.canvasContext.beginPath();\r\n        this.canvasContext.moveTo(x, 0);\r\n        this.canvasContext.lineTo(x, this.timeLineCanvasDomElement.height / 2);\r\n        this.canvasContext.stroke();\r\n        this.canvasContext.fillText(\r\n            text,\r\n            x - this.canvasContext.measureText(text).width / 2,\r\n            this.timeLineCanvasDomElement.height - 2\r\n        );\r\n    }\r\n\r\n    drawCurrentTimeMark() {\r\n        this.canvasContext.fillRect(0, 0, this.getCanvasPositionByEpoch(this.epoch), this.timeLineCanvasDomElement.height);\r\n    }\r\n\r\n    onMouseDown(e) {\r\n        if (e.button === 0) {\r\n            this.mouseState.leftButton = true;\r\n        } else if (e.button === 2) {\r\n            this.mouseState.rightButton = true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    onMouseUp(e) {\r\n        if (e.button === 0) {\r\n            this.mouseState.leftButton = false;\r\n        } else if (e.button === 2) {\r\n            this.mouseState.rightButton = false;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    onMouseMove(e) {\r\n        if (this.mouseState.rightButton) {\r\n            this.leftEpoch += (this.mouseState.x - e.x) * this.span / this.timeLineCanvasDomElement.width;\r\n        }\r\n\r\n        this.mouseState.x = e.x;\r\n        this.mouseState.y = e.y;\r\n        return false;\r\n    }\r\n\r\n    getMinScale() {\r\n        return Object.keys(this.scales).reduce((a, b) => { return this.scales[a] < this.scales[b] ? a : b });\r\n    }\r\n\r\n    getMaxScale() {\r\n        return Object.keys(this.scales).reduce((a, b) => { return this.scales[a] > this.scales[b] ? a : b });\r\n    }\r\n\r\n    onMouseWheel(e) {\r\n        const stepMult = 1.3;\r\n        const mult = (e.deltaY > 0) ? stepMult : (1 / stepMult);\r\n        const newSpan = Math.min(Math.max(this.span * mult,\r\n            (this.canvasRect.right - this.canvasRect.left) / this.markDistance * this.scales[this.getMinScale()]),\r\n            (this.canvasRect.right - this.canvasRect.left) / this.markDistance * this.scales[this.getMaxScale()]);\r\n        this.leftEpoch += (this.mouseState.x - this.canvasRect.left)\r\n            * (this.span - newSpan) / (this.canvasRect.right - this.canvasRect.left);\r\n        this.span = newSpan;\r\n\r\n        this.updateScaleType();\r\n        return false;\r\n    }\r\n\r\n    static getDateByEpoch(epoch) {\r\n        return new Date((J2000_TIMESTAMP + epoch) * 1000);\r\n    }\r\n\r\n    static getEpochByDate(date) {\r\n        return date / 1000 - J2000_TIMESTAMP;\r\n    }\r\n\r\n    static roundDateUp(date, scaleType) {\r\n        const d = new Date(date);\r\n        if (scaleType === \"minute\") {\r\n            d.setSeconds(60, 0);\r\n        } else if (scaleType === \"fiveMinutes\") {\r\n            d.setMinutes(5 + d.getMinutes() - d.getMinutes() % 5, 0, 0);\r\n        } else if (scaleType === \"tenMinutes\") {\r\n            d.setMinutes(10 + d.getMinutes() - d.getMinutes() % 10, 0, 0);\r\n        } else if (scaleType === \"thirtyMinutes\") {\r\n            d.setMinutes(30 + d.getMinutes() - d.getMinutes() % 30, 0, 0);\r\n        } else if (scaleType === \"hour\") {\r\n            d.setMinutes(60, 0, 0);\r\n        } else if (scaleType === \"threeHours\") {\r\n            d.setHours(3 + d.getHours() - d.getHours() % 3, 0, 0, 0);\r\n        } else if (scaleType === \"sixHours\") {\r\n            d.setHours(6 + d.getHours() - d.getHours() % 6, 0, 0, 0);\r\n        } else if (scaleType === \"day\") {\r\n            d.setHours(24, 0, 0, 0);\r\n        } else if (scaleType === \"week\") {\r\n            d.setHours(0, 0, 0, 0);\r\n            d.setDate(7 + d.getDate() - d.getDay());\r\n        } else if (scaleType === \"month\") {\r\n            d.setHours(0, 0, 0, 0);\r\n            d.setDate(1);\r\n            d.setMonth(d.getMonth() + 1);\r\n        } else if (scaleType === \"threeMonths\") {\r\n            d.setHours(0, 0, 0, 0);\r\n            d.setDate(1);\r\n            d.setMonth(3 + d.getMonth() - d.getMonth() % 3);\r\n        } else if (scaleType === \"year\") {\r\n            d.setHours(0, 0, 0, 0);\r\n            d.setMonth(0, 1);\r\n        } else if (scaleType === \"fiveYears\") {\r\n            d.setHours(0, 0, 0, 0);\r\n            d.setFullYear(5 + d.getFullYear() - d.getFullYear() % 5, 0, 1);\r\n        } else {\r\n            return;\r\n        }\r\n        return d;\r\n    }\r\n\r\n    static nextRenderingDate(date, scaleType) {\r\n        const d = new Date(date);\r\n        if (scaleType === \"minute\") {\r\n            d.setMinutes(d.getMinutes() + 1);\r\n        } else if (scaleType === \"fiveMinutes\") {\r\n            d.setMinutes(d.getMinutes() + 5);\r\n        } else if (scaleType === \"tenMinutes\") {\r\n            d.setMinutes(d.getMinutes() + 10);\r\n        } else if (scaleType === \"thirtyMinutes\") {\r\n            d.setMinutes(d.getMinutes() + 30);\r\n        } else if (scaleType === \"hour\") {\r\n            d.setHours(d.getHours() + 1);\r\n        } else if (scaleType === \"threeHours\") {\r\n            d.setHours(d.getHours() + 3);\r\n        } else if (scaleType === \"sixHours\") {\r\n            d.setHours(d.getHours() + 6);\r\n        } else if (scaleType === \"day\") {\r\n            d.setDate(d.getDate() + 1);\r\n        } else if (scaleType === \"week\") {\r\n            d.setDate(d.getDate() + 7);\r\n        } else if (scaleType === \"month\") {\r\n            d.setMonth(d.getMonth() + 1);\r\n        } else if (scaleType === \"threeMonths\") {\r\n            d.setMonth(d.getMonth() + 3);\r\n        } else if (scaleType === \"year\") {\r\n            d.setFullYear(d.getFullYear() + 1, d.getMonth(), d.getDate());\r\n        } else if (scaleType === \"fiveYears\") {\r\n            d.setFullYear(d.getFullYear() + 5, d.getMonth(), d.getDate());\r\n        } else {\r\n            return;\r\n        }\r\n        return d;\r\n    }\r\n\r\n    static formatDate(date, scaleType) {\r\n        if ((scaleType === \"minute\")\r\n            || (scaleType === \"fiveMinutes\")\r\n            || (scaleType === \"tenMinutes\")\r\n            || (scaleType === \"thirtyMinutes\")\r\n            || (scaleType === \"hour\")\r\n            || (scaleType === \"threeHours\")\r\n            || (scaleType === \"sixHours\")\r\n        ) {\r\n            let string = date.getYear() + 1900;\r\n            string += '-' + ((date.getMonth() + 1) + '').padStart(2, '0');\r\n            string += '-' + (date.getDate() + '').padStart(2, '0');\r\n            string += ' ' + (date.getHours() + '').padStart(2, '0');\r\n            string += ':' + (date.getMinutes() + '').padStart(2, '0');\r\n            return string;\r\n        } else if ((scaleType === \"day\")\r\n            || (scaleType === \"week\")\r\n        ) {\r\n            let string = date.getYear() + 1900;\r\n            string += '-' + ((date.getMonth() + 1) + '').padStart(2, '0');\r\n            string += '-' + (date.getDate() + '').padStart(2, '0');\r\n            return string;\r\n        } else if ((scaleType === \"month\")\r\n            || (scaleType === \"threeMonths\")\r\n        ) {\r\n            const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\r\n            return months[date.getMonth()] + ' ' + (date.getYear() + 1900);\r\n        } else if ((scaleType === \"year\")\r\n            || (scaleType === \"fiveYears\")\r\n        ) {\r\n            return (date.getYear() + 1900) + '';\r\n        }\r\n        return date.toString();\r\n    }\r\n\r\n    static formatDateFull(date) {\r\n        let string = date.getYear() + 1900;\r\n        string += '-' + ((date.getMonth() + 1) + '').padStart(2, '0');\r\n        string += '-' + (date.getDate() + '').padStart(2, '0');\r\n        string += ' ' + (date.getHours() + '').padStart(2, '0');\r\n        string += ':' + (date.getMinutes() + '').padStart(2, '0');\r\n        string += ':' + (date.getSeconds() + '').padStart(2, '0');\r\n        return string;\r\n    }\r\n}\r\n","import * as THREE from \"three\";\r\n\r\nimport {deg2rad} from \"../algebra\";\r\nimport { sim } from \"../Simulation\";\r\n\r\nexport default class VisualRaycaster\r\n{\r\n    constructor(domElement, threeCamera, pixelPrecision) {\r\n        this.raycaster = new THREE.Raycaster();\r\n        this.mouse = new THREE.Vector2();\r\n        this.camera = threeCamera;\r\n        this.domElement = domElement;\r\n\r\n        this.setPixelPrecision(pixelPrecision);\r\n        this.updatePixelAngleSize();\r\n\r\n        this.domElement.addEventListener('mousemove', this.onMouseMove.bind(this));\r\n        this.domElement.addEventListener('resize', this.updatePixelAngleSize.bind(this));\r\n    }\r\n\r\n    onMouseMove(event) {\r\n        this.mouse.x = (event.clientX / this.domElement.width) * 2 - 1;\r\n        this.mouse.y = -(event.clientY / this.domElement.height) * 2 + 1;\r\n    }\r\n\r\n    setPixelPrecision(value) {\r\n        this.raycaster.pixelPrecision = value;\r\n    }\r\n\r\n    updatePixelAngleSize() {\r\n        this.raycaster.pixelAngleSize = deg2rad(this.camera.fov) / this.domElement.height;\r\n    }\r\n\r\n    getPixelAngleSize() {\r\n        return this.raycaster.pixelAngleSize;\r\n    }\r\n\r\n    intersectObjects(threeObjects) {\r\n        this.raycaster.setFromCamera(this.mouse, this.camera);\r\n        return this.raycaster.intersectObjects(threeObjects);\r\n    }\r\n\r\n    getPixelDistance(point) {\r\n        this.raycaster.setFromCamera(this.mouse, this.camera);\r\n\r\n        const pointDirection = (new THREE.Vector3()).subVectors(\r\n            point,\r\n            sim.camera.lastPosition\r\n        );\r\n\r\n        const angle = Math.acos(\r\n            this.raycaster.ray.direction.dot(pointDirection) / pointDirection.length()\r\n        );\r\n\r\n        return angle / this.raycaster.pixelAngleSize;\r\n    }\r\n}\r\n","import * as THREE from \"three\";\r\n\r\nimport VisualModelAbstract from \"../core/visual/ModelAbstract\";\r\nimport { sim, Events } from \"../core/index\";\r\n\r\nexport default class SelectionHandler extends VisualModelAbstract\r\n{\r\n    constructor() {\r\n        super();\r\n\r\n        this.selectableObjects = [];\r\n\r\n        this.selectedObject = null;\r\n        this.bestIntersection = null;\r\n\r\n        this.selectionMouseButton = 0;\r\n        this.pointSize = 5;\r\n\r\n        this.setThreeObj(new THREE.Mesh(\r\n            new THREE.SphereGeometry(1, 10, 10),\r\n            new THREE.MeshBasicMaterial({color: 0xFFFF00})\r\n        ));\r\n\r\n        sim.addEventListener('mousedown', this.onMouseDown.bind(this), 1);\r\n\r\n        this.mouseMoveListener = this.onMouseMove.bind(this);\r\n        this.mouseUpListener = this.onMouseUp.bind(this);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param object - must be a three.js object with its userData.selectionObject\r\n     *                 property set to object (or a function returning that object)\r\n     *                 that will be selected (and its select() method will be called)\r\n     */\r\n    addSelectableObject(object) {\r\n        this.selectableObjects.push(object);\r\n    }\r\n\r\n    removeSelectableObject(object) {\r\n        for (let i in this.selectableObjects) {\r\n            if (this.selectableObjects[i] === object) {\r\n                delete this.selectableObjects[i];\r\n                break;\r\n            }\r\n        }\r\n        this.selectableObjects = this.selectableObjects.filter(val => val);\r\n    }\r\n\r\n    render() {\r\n        const intersections = sim.raycaster.intersectObjects(this.selectableObjects);\r\n\r\n        if (intersections.length > 0) {\r\n            this.bestIntersection = intersections[0];\r\n\r\n            for(var i = 1; i < intersections.length; i++) {\r\n                if (intersections[i].distance < this.bestIntersection.distance) {\r\n                    this.bestIntersection = intersections[i];\r\n                }\r\n            }\r\n\r\n            this.threeObj.visible = true;\r\n            this.threeObj.position.copy(this.bestIntersection.point);\r\n\r\n            const scaleKoeff = this.pointSize * this.bestIntersection.point.length() * sim.raycaster.getPixelAngleSize();\r\n\r\n            this.threeObj.scale.x = scaleKoeff;\r\n            this.threeObj.scale.y = scaleKoeff;\r\n            this.threeObj.scale.z = scaleKoeff;\r\n        }\r\n        else {\r\n            this.threeObj.visible = false;\r\n            this.bestIntersection = null;\r\n        }\r\n    }\r\n\r\n    onMouseDown(event) {\r\n        if (event.button === this.selectionMouseButton) {\r\n            document.addEventListener('mousemove', this.mouseMoveListener);\r\n            document.addEventListener('mouseup', this.mouseUpListener);\r\n            this.hasMouseMoved = false;\r\n            this.mouseClickStart = [event.clientX, event.clientY];\r\n        }\r\n    }\r\n\r\n    onMouseMove(event) {\r\n        if (this.mouseClickStart[0] !== event.clientX || this.mouseClickStart[1] !== event.clientY) {\r\n            this.hasMouseMoved = true;\r\n        }\r\n    }\r\n\r\n    onMouseUp(event) {\r\n        const wasSelected = this.selectedObject;\r\n\r\n        if (event.button !== this.selectionMouseButton) {\r\n            return;\r\n        }\r\n\r\n        document.removeEventListener('mousemove', this.mouseMoveListener);\r\n        document.removeEventListener('mouseup', this.mouseUpListener);\r\n\r\n        if (this.hasMouseMoved) {\r\n            return;\r\n        }\r\n\r\n        if (!this.bestIntersection) {\r\n            this.deselect();\r\n            return;\r\n        }\r\n\r\n        let selectionObject = this.bestIntersection.object.userData.selectionObject;\r\n        if (selectionObject instanceof Function) {\r\n            selectionObject = selectionObject();\r\n        }\r\n        if (selectionObject && selectionObject !== wasSelected) {\r\n            this.deselect();\r\n            this.select(selectionObject);\r\n        } else if (selectionObject && this.bestIntersection.object.userData.onClick) {\r\n            this.bestIntersection.object.userData.onClick(this.bestIntersection);\r\n        }\r\n    }\r\n\r\n    forceSelection(object) {\r\n        this.deselect();\r\n        this.select(object);\r\n    }\r\n\r\n    getSelectedObject() {\r\n        return this.selectedObject;\r\n    }\r\n\r\n    select(object) {\r\n        this.selectedObject = object;\r\n        this.selectedObject.select();\r\n\r\n        Events.dispatch(Events.SELECT, {object: this.selectedObject});\r\n    }\r\n\r\n    deselect() {\r\n        if (!this.selectedObject) {\r\n            return;\r\n        }\r\n\r\n        Events.dispatch(Events.DESELECT, {object: this.selectedObject});\r\n\r\n        this.selectedObject.deselect();\r\n        this.selectedObject = null;\r\n    }\r\n}\r\n","import $ from \"jquery\";\r\n\r\nexport default class UIPanel\r\n{\r\n    constructor(panelDom, isCollapsed) {\r\n        this.jqDom = $(panelDom);\r\n        this.name = this.jqDom.data('panelName');\r\n        this.jqCollapseButton = this.jqDom.find(\".collapseButton[data-panel-name='\" + this.name + \"']\");\r\n        this.jqCollapseButton.click(() => this.toggleCollapse());\r\n        this.isCollapsed = !!isCollapsed;\r\n\r\n        this.isCollapsed ? this.collapse() : this.expand();\r\n    }\r\n\r\n    show() {\r\n        this.jqDom.show();\r\n    }\r\n\r\n    hide() {\r\n        this.jqDom.hide();\r\n    }\r\n\r\n    toggleCollapse() {\r\n        this.isCollapsed ? this.expand() : this.collapse();\r\n    }\r\n\r\n    collapse() {\r\n        this.jqCollapseButton.html('Show');\r\n        this.isCollapsed = true;\r\n        this.jqDom.find(\".panelContent[data-panel-name='\" + this.name + \"']\").hide();\r\n\r\n        // this.jqCollapseButton.attr('disabled', 'true');\r\n        // this.jqDom.find(\".panelContent[data-panel-name='\" + this.name + \"']\").fadeToggle(200, 'swing', () => {\r\n        //     this.jqCollapseButton.removeAttr('disabled');\r\n        // });\r\n    }\r\n\r\n    expand() {\r\n        this.jqCollapseButton.html('Hide');\r\n        this.isCollapsed = false;\r\n        this.jqDom.find(\".panelContent[data-panel-name='\" + this.name + \"']\").show();\r\n\r\n        // this.jqCollapseButton.attr('disabled', 'true');\r\n        // this.jqDom.find(\".panelContent[data-panel-name='\" + this.name + \"']\").fadeToggle(200, 'swing', () => {\r\n        //     this.jqCollapseButton.removeAttr('disabled');\r\n        // });\r\n    }\r\n}\r\n","import Events from \"../../core/Events\";\r\nimport UIPanel from \"../Panel\";\r\nimport { sim } from \"../../core/Simulation\"\r\n\r\nexport default class UIPanelTime extends UIPanel\r\n{\r\n    constructor(panelDom) {\r\n        super(panelDom);\r\n\r\n        this.maxTimeScale = 6 * 30 * 86400;\r\n\r\n        this.jqSlider = this.jqDom.find('#timeScaleSlider');\r\n        this.jqSlider.on('input change', () => sim.time.setTimeScale(this.getCurrentTimeScale()));\r\n        this.jqSlider.val(this.getNeededSliderValue(sim.time.timeScale));\r\n\r\n        this.jqScaleText = this.jqDom.find('#timeScaleValue');\r\n        this.jqScaleText.html(this.formatTimeScale(sim.time.timeScale));\r\n\r\n        document.addEventListener(Events.TIME_SCALE_CHANGED, (event) => {\r\n            this.jqSlider.val(this.getNeededSliderValue(event.detail.new));\r\n            this.jqScaleText.html(this.formatTimeScale(event.detail.new));\r\n        });\r\n\r\n        this.jqDateText = this.jqDom.find('#currentDateValue');\r\n        document.addEventListener(Events.EPOCH_CHANGED, (event) => this.updateTime(event.detail.date));\r\n\r\n        this.jqDom.find('#setRealTimeScale').click(() => sim.time.setTimeScale(1));\r\n        this.jqDom.find('#useCurrentTime').click(() => sim.time.useCurrentTime());\r\n    }\r\n\r\n    updateTime(date) {\r\n        this.jqDateText.html(sim.time.formatDateFull(date));\r\n    }\r\n\r\n    /**\r\n     * @returns {number} — simulation seconds per 1 real life second\r\n     */\r\n    getCurrentTimeScale() {\r\n        const val = this.jqSlider.val();\r\n        return Math.sign(val) * val * val * val * val * this.maxTimeScale;\r\n    }\r\n\r\n    getNeededSliderValue(timeScale) {\r\n        const val = Math.sqrt(Math.sqrt(Math.abs(timeScale) / this.maxTimeScale));\r\n        return Math.sign(timeScale) * Math.min(1, val);\r\n    }\r\n\r\n    formatTimeScale(scale) {\r\n        const precision = 2;\r\n\r\n        const prefix = (scale < 0) ? '-' : '';\r\n        const abs = Math.abs(scale);\r\n        if (abs === 0) {\r\n            return '0';\r\n        }\r\n\r\n        if (abs < 60) {\r\n            return prefix + abs.toPrecision(precision) + ' s/s';\r\n        }\r\n\r\n        if (abs < 3600) {\r\n            return prefix + (abs / 60).toPrecision(precision) + ' min/s';\r\n        }\r\n\r\n        if (abs < 86400) {\r\n            return prefix + (abs / 3600).toPrecision(precision) + ' h/s';\r\n        }\r\n\r\n        if (abs < 2592000) {\r\n            return prefix + (abs / 86400).toPrecision(precision) + ' days/s';\r\n        }\r\n\r\n        if (abs < 31557600) {\r\n            return prefix + (abs / 2592000).toPrecision(precision) + ' months/s';\r\n        }\r\n\r\n        return prefix + (abs / 31557600).toPrecision(precision) + ' years/s';\r\n    }\r\n}\r\n","import $ from \"jquery\";\r\n\r\nimport Events from \"../../core/Events\";\r\nimport UIPanel from \"../Panel\";\r\nimport {ReferenceFrame} from \"../../core/ReferenceFrame/Factory\";\r\n\r\nexport default class UIPanelCamera extends UIPanel\r\n{\r\n    constructor(panelDom, camera) {\r\n        super(panelDom);\r\n\r\n        this.camera = camera;\r\n\r\n        this.jqTarget = this.jqDom.find('#targetSelect');\r\n        this.jqTarget.on('change', () => this.camera.changeOrigin(0|this.jqTarget.val()));\r\n\r\n        this.jqFrameType = this.jqDom.find('#rfTypeSelect');\r\n        this.jqFrameType.on('change', () => this.camera.changeReferenceFrameType(0|this.jqFrameType.val()));\r\n\r\n        Events.addListener(Events.STAR_SYSTEM_LOADED, (event) => {\r\n            this.starSystem = event.detail.starSystem;\r\n\r\n            this.jqTarget.html('');\r\n            this.updateTargetList();\r\n            this.updateTarget(this.camera.orbitingPoint);\r\n\r\n            this.updateFrameTypeList();\r\n            this.updateFrameType(this.camera.frameType);\r\n        });\r\n        Events.addListener(Events.CAMERA_RF_CHANGED, (event) => {\r\n            this.updateTarget(event.detail.new.originId);\r\n            this.updateFrameTypeList();\r\n            this.updateFrameType(event.detail.new.type);\r\n        });\r\n        Events.addListener(Events.OBJECT_ADDED, () => {\r\n            this.updateTargetList();\r\n        });\r\n    }\r\n\r\n    updateTargetList() {\r\n        if (!this.starSystem) {\r\n            return;\r\n        }\r\n        $.each(this.starSystem.getObjectNames(), (objId, objName) => {\r\n            if (this.jqTarget.find(\"option[value='\" + objId + \"']\").length === 0) {\r\n                this.jqTarget.append($('<option>', {value: objId}).text(objName));\r\n            }\r\n        });\r\n    }\r\n\r\n    updateFrameTypeList() {\r\n        const selected = 0|this.jqFrameType.val();\r\n        this.jqFrameType.html('');\r\n        $.each(this.camera.getAvailableFrameTypes(), (idx, typeId) => {\r\n            this.jqFrameType.append($('<option>', {value: typeId, selected: typeId == selected}).text(UIPanelCamera.frameTypeNames[typeId]));\r\n        });\r\n    }\r\n\r\n    updateTarget(value) {\r\n        this.jqTarget.val(value);\r\n    }\r\n\r\n    updateFrameType(value) {\r\n        this.jqFrameType.val(value);\r\n    }\r\n}\r\n\r\nUIPanelCamera.frameTypeNames = {\r\n    [ReferenceFrame.INERTIAL_ECLIPTIC]: 'Ecliptic',\r\n    [ReferenceFrame.INERTIAL_BODY_EQUATORIAL]: 'Equatorial',\r\n    [ReferenceFrame.INERTIAL_BODY_FIXED]: 'Body fixed',\r\n    [ReferenceFrame.INERTIAL_PARENT_BODY_EQUATORIAL]: 'Parent equatorial',\r\n};\r\n","\r\nimport UIPanel from \"../Panel\";\r\nimport {presentNumberWithSuffix, Vector} from \"../../core/algebra\";\r\nimport FunctionOfEpochAbstract from \"../../core/FunctionOfEpoch/Abstract\";\r\n\r\nexport default class UIPanelVector extends UIPanel\r\n{\r\n    constructor(panelDom, vectorOfEpoch) {\r\n        super(panelDom, true);\r\n        this.vectorOfEpoch = vectorOfEpoch;\r\n        this.jqMag = this.jqDom.find('.vec-magnitude');\r\n        this.jqX = this.jqDom.find('.vec-x');\r\n        this.jqY = this.jqDom.find('.vec-y');\r\n        this.jqZ = this.jqDom.find('.vec-z');\r\n    }\r\n\r\n    set(vector, epoch) {\r\n        this.vectorOfEpoch = vector;\r\n        this.update(epoch);\r\n    }\r\n\r\n    update(epoch) {\r\n        let vector = this.vectorOfEpoch;\r\n        if ((epoch || epoch === 0)\r\n            && (vector instanceof FunctionOfEpochAbstract)\r\n        ) {\r\n            vector = vector.evaluate(epoch);\r\n        }\r\n\r\n        if (!vector instanceof Vector) {\r\n            return;\r\n        }\r\n\r\n        this.jqMag.html(presentNumberWithSuffix(vector.mag));\r\n        this.jqX.html  (presentNumberWithSuffix(vector.x));\r\n        this.jqY.html  (presentNumberWithSuffix(vector.y));\r\n        this.jqZ.html  (presentNumberWithSuffix(vector.z));\r\n    }\r\n}\r\n","import $ from \"jquery\";\r\n\r\nimport UIPanel from \"../Panel\";\r\nimport Events from \"../../core/Events\";\r\nimport UIPanelVector from \"./Vector\";\r\nimport {presentNumberWithSuffix, rad2deg} from \"../../core/algebra\";\r\nimport EphemerisObject from \"../../core/EphemerisObject\";\r\nimport { sim } from \"../../core/Simulation\";\r\n\r\nexport default class UIPanelMetrics extends UIPanel\r\n{\r\n    constructor(panelDom, selection) {\r\n        super(panelDom);\r\n\r\n        this.selection = selection;\r\n        this.precision = 5;\r\n\r\n        this.renderListener = this.render.bind(this);\r\n\r\n        document.addEventListener(Events.SELECT, this.handleSelect.bind(this));\r\n        document.addEventListener(Events.DESELECT, this.handleDeselect.bind(this));\r\n\r\n        this.jqDom.find('#unloadObject').on('click', function() {\r\n            let wasSelected = selection.getSelectedObject();\r\n            selection.deselect();\r\n            sim.starSystem.deleteObject(wasSelected.id);\r\n        });\r\n        this.jqDom.find('#showAnglesOfSelectedOrbit').on('change', function() {\r\n            sim.settings.ui.showAnglesOfSelectedOrbit = this.checked;\r\n            Events.dispatch(Events.SHOW_ORBIT_ANGLES_CHANGED, {value: this.checked});\r\n        });\r\n\r\n        this.positionPanel = new UIPanelVector(this.jqDom.find(\".js-metrics-panel-cartesian-position-vector\"), null);\r\n        this.velocityPanel = new UIPanelVector(this.jqDom.find(\".js-metrics-panel-cartesian-velocity-vector\"), null);\r\n\r\n        this.hide();\r\n    }\r\n\r\n    render(event) {\r\n        const selectedTrajectory = this.selection.getSelectedObject().trajectory;\r\n        let parent = null;\r\n        if (!selectedTrajectory) {\r\n            return;\r\n        }\r\n\r\n        try {\r\n            const referenceFrame = selectedTrajectory.getReferenceFrameByEpoch(event.detail.epoch);\r\n            if (referenceFrame) {\r\n                parent = sim.starSystem.getObject(referenceFrame.originId);\r\n                this.jqDom.find('#relativeTo').html(parent.name);\r\n            }\r\n\r\n            this.updateMain(selectedTrajectory, event.detail.epoch, parent);\r\n            this.updateCartesian(selectedTrajectory, event.detail.epoch);\r\n            this.updateKeplerian(selectedTrajectory, event.detail.epoch);\r\n        } catch (e) {\r\n\r\n        }\r\n    }\r\n\r\n    updateMain(selectedObject, epoch, parent) {\r\n        const keplerianObject = selectedObject.getKeplerianObjectByEpoch(epoch);\r\n        const sma = keplerianObject.sma;\r\n        const per = sma * (1 - keplerianObject.ecc);\r\n        const apo = sma * (1 + keplerianObject.ecc);\r\n        const surfaceAlt = parent.physicalModel ? parent.physicalModel.radius : 0;\r\n        const state = selectedObject.getStateInOwnFrameByEpoch(epoch);\r\n\r\n        this.jqDom.find('#elements-orbit-alt' ).html(\r\n            '' + (per - surfaceAlt).toPrecision(this.precision)\r\n            + ' x ' + (apo - surfaceAlt).toPrecision(this.precision)\r\n        );\r\n\r\n        this.jqDom.find('#elements-orbit-avg' ).html(''   + (sma - surfaceAlt).toPrecision(this.precision));\r\n        this.jqDom.find('#elements-alt' ).html(''   + (state.position.mag - surfaceAlt).toPrecision(this.precision));\r\n        this.jqDom.find('#elements-speed' ).html('' + (state.velocity.mag * 1000).toPrecision(this.precision));\r\n\r\n        if (parent.physicalModel && parent.physicalModel.j2 && parent.physicalModel.j2) {\r\n            this.jqDom.find('#elements-precession').html('' + (\r\n                rad2deg(keplerianObject.getNodalPrecessionRate(parent.physicalModel.eqRadius, parent.physicalModel.j2) * 86400)\r\n            ).toPrecision(this.precision));\r\n        }\r\n    }\r\n\r\n    updateCartesian(selectedObject, epoch) {\r\n        const state = selectedObject.getStateInOwnFrameByEpoch(epoch);\r\n        this.positionPanel.set(state.position);\r\n        this.velocityPanel.set(state.velocity);\r\n    }\r\n\r\n    updateKeplerian(selectedObject, epoch) {\r\n        const keplerianObject = selectedObject.getKeplerianObjectByEpoch(epoch);\r\n        this.jqDom.find('#elements-ecc' ).html('' +        ( keplerianObject.ecc ).toPrecision(this.precision));\r\n        this.jqDom.find('#elements-sma' ).html('' + presentNumberWithSuffix(keplerianObject.sma));\r\n        this.jqDom.find('#elements-inc' ).html('' + rad2deg( keplerianObject.inc ).toPrecision(this.precision));\r\n        this.jqDom.find('#elements-aop' ).html('' + rad2deg( keplerianObject.aop ).toPrecision(this.precision));\r\n        this.jqDom.find('#elements-raan').html('' + rad2deg( keplerianObject.raan).toPrecision(this.precision));\r\n        this.jqDom.find('#elements-ta'  ).html('' + rad2deg( keplerianObject.getTrueAnomalyByEpoch(epoch)  ).toPrecision(this.precision));\r\n        this.jqDom.find('#elements-period').html('' + (keplerianObject.period / 86400).toPrecision(this.precision));\r\n    }\r\n\r\n    handleSelect() {\r\n        this.show();\r\n\r\n        const object = this.selection.getSelectedObject();\r\n        if (object) {\r\n            $('#metricsOf').html(object.name);\r\n        } else {\r\n            $('#relativeTo,#metricsOf').html('');\r\n        }\r\n\r\n        if (object.type === EphemerisObject.TYPE_SPACECRAFT || object.type === EphemerisObject.TYPE_UNKNOWN) {\r\n            this.jqDom.find('#unloadObject').show();\r\n        } else {\r\n            this.jqDom.find('#unloadObject').hide();\r\n        }\r\n\r\n        document.addEventListener(Events.RENDER, this.renderListener);\r\n    }\r\n\r\n    handleDeselect() {\r\n        this.hide();\r\n        document.removeEventListener(Events.RENDER, this.renderListener);\r\n    }\r\n}\r\n","import {acosSigned, Vector, Quaternion, newtonSolve} from \"./algebra\";\r\nimport KeplerianObject from \"./KeplerianObject\";\r\nimport EphemerisObject from \"./EphemerisObject\";\r\nimport ReferenceFrameFactory, {ReferenceFrame} from \"./ReferenceFrame/Factory\";\r\nimport Body from \"./Body\";\r\nimport StateVector from \"./StateVector\";\r\nimport TrajectoryComposite from \"./Trajectory/Composite\";\r\nimport TrajectoryKeplerianBasic from \"./Trajectory/KeplerianBasic\";\r\nimport { sim } from \"./Simulation\";\r\n\r\nexport default class LambertSolver\r\n{\r\n    static getPlotData(orbit1, orbit2, epochMin, epochMax, transferMin, transferMax, points) {\r\n        const epochStep = (epochMax - epochMin) / (points - 1);\r\n        const flightTimeStep = (transferMax - transferMin) / (points - 1);\r\n        let result = [];\r\n        let startEpoch = epochMin;\r\n        let i = 0;\r\n\r\n        while (startEpoch <= epochMax) {\r\n            let flightTime = transferMin;\r\n            let j = 0;\r\n\r\n            result[i] = [];\r\n            while (flightTime <= transferMax) {\r\n                let res = this.calcDeltaV(\r\n                    orbit1.getStateByEpoch(startEpoch),\r\n                    orbit2.getStateByEpoch(startEpoch + flightTime),\r\n                    startEpoch,\r\n                    flightTime,\r\n                    orbit1.mu\r\n                );\r\n                result[i][j] = res;\r\n                flightTime += flightTimeStep;\r\n                j++;\r\n\r\n            }\r\n            startEpoch += epochStep;\r\n            i++;\r\n        }\r\n        return result;\r\n    }\r\n\r\n    static plot(plotData) {\r\n        let min = 1e99, max = 0;\r\n        let ctx = document.getElementById('lambertCanvas').getContext('2d');\r\n\r\n        ctx.clearRect(0, 0, 300, 300);\r\n\r\n        for (let row of plotData) {\r\n            for (let res of row) {\r\n                if (res === false) {\r\n                    continue;\r\n                }\r\n                if (res < min) {\r\n                    min = res;\r\n                }\r\n                if (res > max) {\r\n                    max = res;\r\n                }\r\n            }\r\n        }\r\n\r\n        for (let row in plotData) {\r\n            for (let col in plotData[row]) {\r\n                const res = plotData[row][col];\r\n                if (res === false) {\r\n                    ctx.fillStyle = \"rgba(255,0,0,1)\";\r\n                } else {\r\n                    const color = Math.round((1 - (res - min) / (max - min)) * 255);\r\n                    ctx.fillStyle = \"rgba(\" + color + \",\" + color + \",\" + color + \", 1)\";\r\n                }\r\n                ctx.fillRect(0|row, 0|col, 1, 1);\r\n            }\r\n        }\r\n    }\r\n\r\n    static getDeltaV(state1, state2, transferOrbit, epoch1, epoch2) {\r\n        return state1.velocity.sub_(transferOrbit.getStateByEpoch(epoch1)._velocity).mag +\r\n            state2.velocity.sub_(transferOrbit.getStateByEpoch(epoch2)._velocity).mag;\r\n    }\r\n\r\n    static calcDeltaV(state1, state2, startEpoch, flightTime, mu) {\r\n        const transferOrbit = this.solve(state1, state2, startEpoch, flightTime, mu);\r\n\r\n        if (!transferOrbit) {\r\n            return false;\r\n        }\r\n\r\n        return this.getDeltaV(state1, state2, transferOrbit, startEpoch, startEpoch + flightTime);\r\n    }\r\n\r\n    static findBestTransfer(originObject, targetObject, rPer1, rPer2, departureTime, flightTimeMin, flightTimeMax) {\r\n        const d = (flightTimeMax - flightTimeMin) * 1e-6;\r\n        const getDiff = (flightTime) => {\r\n            if (flightTime < flightTimeMin) {\r\n                return null;\r\n            }\r\n            if (flightTime > flightTimeMax) {\r\n                return null;\r\n            }\r\n            const v1 = this.solveFullTransfer(originObject, targetObject, rPer1, rPer2, departureTime, flightTime - d/2);\r\n            const v2 = this.solveFullTransfer(originObject, targetObject, rPer1, rPer2, departureTime, flightTime + d/2);\r\n\r\n            if (v1 === null || v2 === null) {\r\n                return null;\r\n            }\r\n\r\n            return (v2.totalDeltaV - v1.totalDeltaV) / d;\r\n        };\r\n\r\n        const stepCount = 50;\r\n        const step = (flightTimeMax - flightTimeMin) / (stepCount - 1);\r\n\r\n        let minDeltaV = 1e100;\r\n        let bestFlightTime;\r\n\r\n        for (let flightTime = flightTimeMin; flightTime <= flightTimeMax; flightTime += step) {\r\n            const transfer = this.solveFullTransfer(originObject, targetObject, rPer1, rPer2, departureTime, flightTime);\r\n            if (transfer === null) {\r\n                continue;\r\n            }\r\n            const deltaV = transfer.totalDeltaV;\r\n            // console.log(flightTime, deltaV);\r\n            if (deltaV < minDeltaV) {\r\n                bestFlightTime = flightTime;\r\n                minDeltaV = deltaV;\r\n            }\r\n        }\r\n\r\n        bestFlightTime = newtonSolve(getDiff, bestFlightTime, step * 1e-3, 1e-6, 10);\r\n\r\n        if (bestFlightTime === null) {\r\n            return {totalDeltaV: null};\r\n        }\r\n\r\n        return this.solveFullTransfer(originObject, targetObject, rPer1, rPer2, departureTime, bestFlightTime);\r\n    }\r\n\r\n    static solveFullTransfer(originObject, targetObject, rPer1, rPer2, departureTime, flightTime) {\r\n        if (flightTime <= 0) {\r\n            return null;\r\n        }\r\n\r\n        const parentObject = sim.getModule('PatchedConics').getCommonParent(originObject.id, targetObject.id);\r\n\r\n        if (!(parentObject instanceof Body)) {\r\n            return null;\r\n        }\r\n\r\n        const rfMainId = ReferenceFrameFactory.buildId(\r\n            parentObject.id,\r\n            (parentObject.type === EphemerisObject.TYPE_STAR)\r\n                ? ReferenceFrame.INERTIAL_ECLIPTIC\r\n                : ReferenceFrame.INERTIAL_BODY_EQUATORIAL\r\n        );\r\n        const rfMain = sim.starSystem.getReferenceFrame(rfMainId);\r\n\r\n        const mu = parentObject.physicalModel.mu;\r\n\r\n        let state1;\r\n        let state2;\r\n\r\n        let calcOriginSoi = originObject instanceof Body;\r\n        let calcTargetSoi = targetObject instanceof Body;\r\n\r\n        let rfOrigin;\r\n        let rfTarget;\r\n        let originSoi;\r\n        let targetSoi;\r\n\r\n        if (calcOriginSoi) {\r\n            rfOrigin = sim.starSystem.getReferenceFrame(ReferenceFrameFactory.buildId(originObject.id, ReferenceFrame.INERTIAL_BODY_EQUATORIAL));\r\n            originSoi = originObject.data.patchedConics.soiRadius;\r\n        }\r\n        if (calcTargetSoi) {\r\n            targetSoi = targetObject.data.patchedConics.soiRadius;\r\n            rfTarget = sim.starSystem.getReferenceFrame(ReferenceFrameFactory.buildId(targetObject.id, ReferenceFrame.INERTIAL_BODY_EQUATORIAL));\r\n        }\r\n\r\n        let ejectionTime = 0;\r\n        let insertionTime = 0;\r\n        let ejectionPosShift = new Vector(3);\r\n        let insertionPosShift = new Vector(3);\r\n        let ejectionVelInf;\r\n        let insertionVelInf;\r\n        let steps = 0;\r\n        let transferKO;\r\n        let ejectionSoiEpoch;\r\n        let insertionSoiEpoch;\r\n\r\n        while (true) {\r\n            ejectionSoiEpoch = departureTime + ejectionTime;\r\n            insertionSoiEpoch = departureTime + flightTime - insertionTime;\r\n\r\n            state1 = originObject.trajectory.getStateByEpoch(ejectionSoiEpoch, rfMain);\r\n            if (calcOriginSoi) {\r\n                state1._position = rfOrigin.transformPositionByEpoch(ejectionSoiEpoch, ejectionPosShift, rfMain);\r\n            }\r\n\r\n            state2 = targetObject.trajectory.getStateByEpoch(insertionSoiEpoch, rfMain);\r\n            if (calcTargetSoi) {\r\n                state2._position = rfTarget.transformPositionByEpoch(insertionSoiEpoch, insertionPosShift, rfMain);\r\n            }\r\n\r\n            transferKO = this.solve(state1, state2, ejectionSoiEpoch, insertionSoiEpoch - ejectionSoiEpoch, mu);\r\n            if (transferKO === null) {\r\n                return null;\r\n            }\r\n\r\n            steps++;\r\n\r\n            let ejectionPosTime = [new Vector(3), 0];\r\n            let insertionPosTime = [new Vector(3), 0];\r\n\r\n            if (calcOriginSoi) {\r\n                ejectionVelInf = transferKO.getStateByEpoch(ejectionSoiEpoch)._velocity.sub_(state1._velocity);\r\n                const ejectionNormal  = state1._position.cross(ejectionVelInf);\r\n                ejectionPosTime = this.getSoiEdgePositionAndTime(\r\n                    rfMain.rotateVectorByEpoch(ejectionSoiEpoch, ejectionVelInf, rfOrigin),\r\n                    rfMain.rotateVectorByEpoch(ejectionSoiEpoch, ejectionNormal, rfOrigin),\r\n                    rPer1,\r\n                    originSoi,\r\n                    originObject.physicalModel.mu,\r\n                    1\r\n                );\r\n                ejectionTime = ejectionPosTime[1];\r\n            }\r\n\r\n            if (calcTargetSoi) {\r\n                insertionVelInf = transferKO.getStateByEpoch(insertionSoiEpoch)._velocity.sub_(state2._velocity);\r\n                const insertionNormal = state2._position.cross(insertionVelInf);\r\n                insertionPosTime = this.getSoiEdgePositionAndTime(\r\n                    rfMain.rotateVectorByEpoch(insertionSoiEpoch, insertionVelInf, rfTarget),\r\n                    rfMain.rotateVectorByEpoch(insertionSoiEpoch, insertionNormal, rfTarget),\r\n                    rPer2,\r\n                    targetSoi,\r\n                    targetObject.physicalModel.mu,\r\n                    -1\r\n                );\r\n                insertionTime = insertionPosTime[1];\r\n            }\r\n\r\n            if (steps > 10\r\n                || (\r\n                    (!calcOriginSoi || ejectionPosShift.sub(ejectionPosTime[0]).mag < 10)\r\n                    && (!calcTargetSoi || insertionPosShift.sub(insertionPosTime[0]).mag < 10)\r\n                )\r\n            ) {\r\n                ejectionPosShift = ejectionPosTime[0];\r\n                insertionPosShift = insertionPosTime[0];\r\n                break;\r\n            }\r\n\r\n            ejectionPosShift = ejectionPosTime[0];\r\n            insertionPosShift = insertionPosTime[0];\r\n        }\r\n\r\n        let ejectionDeltaV = 0;\r\n        let insertionDeltaV = 0;\r\n        let trajectory = new TrajectoryComposite();\r\n\r\n        const transfer = new TrajectoryKeplerianBasic(rfMainId, transferKO);\r\n        transfer.minEpoch = departureTime + ejectionTime;\r\n        transfer.maxEpoch = departureTime + flightTime - insertionTime;\r\n        trajectory.addComponent(transfer);\r\n\r\n        if (calcOriginSoi) {\r\n            const ejectionKO = KeplerianObject.createFromState(\r\n                new StateVector(ejectionPosShift, rfMain.rotateVectorByEpoch(ejectionSoiEpoch, ejectionVelInf, rfOrigin)),\r\n                originObject.physicalModel.mu,\r\n                departureTime + ejectionTime\r\n            );\r\n            ejectionDeltaV = ejectionKO.getPeriapsisSpeed() - Math.sqrt(originObject.physicalModel.mu / ejectionKO.getPeriapsisRadius());\r\n            const ejection = new TrajectoryKeplerianBasic(rfOrigin.id, ejectionKO);\r\n            ejection.minEpoch = departureTime;\r\n            ejection.maxEpoch = departureTime + ejectionTime;\r\n            trajectory.addComponent(ejection);\r\n        } else {\r\n            ejectionDeltaV = state1.velocity.sub(transferKO.getStateByEpoch(departureTime)._velocity).mag;\r\n        }\r\n\r\n        if (calcTargetSoi) {\r\n            const insertionKO = KeplerianObject.createFromState(\r\n                new StateVector(insertionPosShift, rfMain.rotateVectorByEpoch(insertionSoiEpoch, insertionVelInf, rfTarget)),\r\n                targetObject.physicalModel.mu,\r\n                departureTime + flightTime - insertionTime\r\n            );\r\n            insertionDeltaV = insertionKO.getPeriapsisSpeed() - Math.sqrt(targetObject.physicalModel.mu / insertionKO.getPeriapsisRadius());\r\n            const insertion = new TrajectoryKeplerianBasic(rfTarget.id, insertionKO);\r\n            insertion.minEpoch = departureTime + flightTime - insertionTime;\r\n            insertion.maxEpoch = departureTime + flightTime;\r\n            trajectory.addComponent(insertion);\r\n        } else {\r\n            insertionDeltaV = state2.velocity.sub(transferKO.getStateByEpoch(departureTime + flightTime)._velocity).mag;\r\n        }\r\n\r\n        return {\r\n            trajectory: trajectory,\r\n            ejectionDeltaV: ejectionDeltaV,\r\n            insertionDeltaV: insertionDeltaV,\r\n            totalDeltaV: ejectionDeltaV + insertionDeltaV,\r\n        };\r\n    }\r\n\r\n    static getSoiEdgePositionAndTime(velInf, normal, rPer, rInf, mu, direction) {\r\n        const sma = 1 / (2 / rInf - velInf.quadrance / mu);\r\n        const ecc = 1 - rPer / sma;\r\n        const trueAnomaly = direction * Math.acos((sma * (1 - ecc*ecc) / rInf - 1) / ecc);\r\n        const flightPathAngle = Math.atan(ecc * Math.sin(trueAnomaly) / (sma * (1 - ecc*ecc) / rInf));\r\n        const position = (new Quaternion(normal, flightPathAngle - Math.PI / 2)).rotate_(velInf.unit().mul_(rInf));\r\n\r\n        const H = this.getEccentricAnomalyByTrueAnomaly(trueAnomaly, ecc);\r\n        const time = (ecc > 1)\r\n            ? (ecc * Math.sinh(H) - H) / Math.sqrt(mu / sma / sma / Math.abs(sma))\r\n            : (H - ecc * Math.sin(H)) / Math.sqrt(mu / sma / sma / sma);\r\n\r\n        return [position, Math.abs(time)];\r\n    }\r\n\r\n    static solve(state1, state2, startEpoch, flightTime, mu) {\r\n        const maxError = 1;\r\n        const maxSteps = 30;\r\n\r\n        const r1vec = state1.position;\r\n        const r2vec = state2.position;\r\n        let normal = r1vec.cross(r2vec);\r\n        const r1 = r1vec.mag;\r\n        const r2 = r2vec.mag;\r\n        let transferAngle = r1vec.angle(r2vec);\r\n\r\n        if (normal.angle(state1._position.cross(state1._velocity)) > Math.PI / 2) {\r\n            transferAngle = 2 * Math.PI - transferAngle;\r\n            normal.mul_(-1);\r\n        }\r\n\r\n        const signSinTransferAngle = Math.sign(Math.sin(transferAngle));\r\n        const inc = normal.angle(new Vector([0, 0, 1]));\r\n        const nodeVector = (new Vector([0, 0, 1])).cross(normal);\r\n\r\n        let e, sma, ta1;\r\n        let raan = nodeVector.angle(new Vector([1, 0, 0]));\r\n        if ((new Vector([1, 0, 0])).cross(nodeVector).angle(new Vector([0, 0, 1])) > Math.PI / 2) {\r\n            raan = 2 * Math.PI - raan;\r\n        }\r\n\r\n        const d = Math.sqrt(r1*r1 + r2*r2 - 2 * r1vec.dot(r2vec)) / 2;\r\n\r\n        const parabolicTime = (Math.pow(r1+r2+2*d, 3/2) - signSinTransferAngle*Math.pow(r1+r2-2*d, 3/2)) / (6 * Math.sqrt(mu));\r\n\r\n        if (flightTime > parabolicTime) {\r\n            // ellipse\r\n            const A = (r2 - r1) / 2;\r\n            const E = d / A;\r\n            const B = Math.sqrt(d*d - A*A);\r\n            let y = newtonSolve(\r\n                (yParam) => this.getTimeByY(yParam, A, B, E, r1, r2, d, transferAngle, mu) - flightTime,\r\n                10000, 1, maxError, maxSteps\r\n            );\r\n\r\n            if (y === null) {\r\n                return null;\r\n            }\r\n\r\n            const x0 = -(r2 + r1) / 2 / E;\r\n            const y0 = B * Math.sqrt(x0 * x0 / A / A - 1);\r\n            const x = A * Math.sqrt(1 + y * y / B / B);\r\n            const temp = Math.sqrt((x0 - x) * (x0 - x) + (y0 - y) * (y0 - y));\r\n            const fx = (x0 - x) / temp;\r\n            const fy = (y0 - y) / temp;\r\n            ta1 = acosSigned(\r\n                -((x0 + d) * fx + y0 * fy) / r1,\r\n                signSinTransferAngle * ((x0 + d) * fy - y0 * fx)\r\n            );\r\n            sma = E * (x - x0) / 2;\r\n            e = temp / 2 / sma;\r\n\r\n        } else {\r\n            // hyperbola\r\n            sma = newtonSolve(\r\n                (a) => {\r\n                    const alpha = Math.acosh(1 + (r1 + r2 + 2 * d) / 2 / Math.abs(a));\r\n                    const beta  = Math.acosh(1 + (r1 + r2 - 2 * d) / 2 / Math.abs(a));\r\n                    return Math.sqrt(Math.abs(Math.pow(a, 3)) / mu) *\r\n                        (Math.sinh(alpha) - alpha - signSinTransferAngle * (Math.sinh(beta) - beta)) - flightTime;\r\n                },\r\n                r1, 10, maxError, maxSteps\r\n            );\r\n\r\n            if (sma === null) {\r\n                return null;\r\n            }\r\n\r\n            if (sma > 0) {\r\n                sma = -sma;\r\n            }\r\n\r\n            let f1 = r1vec.rotate(nodeVector, -inc).mul_(-1);\r\n            let p2 = r2vec.rotate(nodeVector, -inc).add_(f1);\r\n            const d1 = r1 - 2 * sma;\r\n            const d2 = r2 - 2 * sma;\r\n            const tempAng = -Math.sign(p2.y) * p2.angle(new Vector([1,0,0]));\r\n            f1 = f1.rotateZ(tempAng);\r\n            p2 = p2.rotateZ(tempAng);\r\n\r\n            const f2x = (p2.x*p2.x - d2*d2 + d1*d1) / 2 / p2.x;\r\n            let f2y = Math.sqrt(d1*d1 - f2x*f2x);\r\n\r\n            if (transferAngle > Math.PI ? (f1.y < 0) : (f1.y > 0)) {\r\n                f2y = -f2y;\r\n            }\r\n\r\n            e = -f1.sub_(new Vector([f2x, f2y, 0])).mag / 2 / sma;\r\n\r\n            const p = sma * (1 - e*e);\r\n            ta1 = Math.acos((p / r1 - 1) / e);\r\n            const ta2 = Math.acos((p / r2 - 1) / e);\r\n\r\n            if (ta1 > ta2 || ta2 - transferAngle < 0) {\r\n                ta1 = -ta1;\r\n            }\r\n        }\r\n\r\n        const perVector = (new Quaternion(normal, -ta1)).rotate(r1vec);\r\n        let aop = nodeVector.angle(perVector);\r\n\r\n        if (nodeVector.cross(perVector).angle(normal) > Math.PI / 2) {\r\n            aop = 2 * Math.PI - aop;\r\n        }\r\n\r\n        return new KeplerianObject(e, sma, aop, inc, raan, ta1, startEpoch, mu, true);\r\n    }\r\n\r\n    static getTimeByY(y, A, B, E, r1, r2, d, alpha, mu) {\r\n        const rm = (r2 + r1) / 2;\r\n        const x0 = - rm / E;\r\n        const y0 = B * Math.sqrt(x0*x0/A/A - 1);\r\n        const x = A * Math.sqrt(1 + y*y/B/B);\r\n        const a = (rm + E * x) / 2;\r\n        const temp = Math.sqrt((x0 - x)*(x0 - x) + (y0 - y)*(y0 - y));\r\n        const e = temp / 2 / a;\r\n        const fx = (x0 - x) / temp;\r\n        const fy = (y0 - y) / temp;\r\n        const cosTa1 = -((x0 + d) * fx + y0 * fy) / r1;\r\n        const sinTa1 = Math.sign(Math.sin(alpha)) * ((x0 + d) * fy - y0 * fx); // TODO optimize\r\n        const ta1 = acosSigned(cosTa1, sinTa1);\r\n        const n = Math.sqrt(mu/a/a/a);\r\n        const E1 = this.getEccentricAnomalyByTrueAnomaly(ta1, e);\r\n        let E2 = this.getEccentricAnomalyByTrueAnomaly(ta1 + alpha, e);\r\n        if (ta1 + alpha > 2 * Math.PI) {\r\n            E2 += 2 * Math.PI;\r\n        }\r\n        return (E2 - E1 - e * (Math.sin(E2) - Math.sin(E1))) / n;\r\n    }\r\n\r\n    static getEccentricAnomalyByTrueAnomaly(ta, ecc) {\r\n        if (ecc < 1) {\r\n            const cos = Math.cos(ta);\r\n            return acosSigned(\r\n                (ecc + cos) / (1 + ecc * cos),\r\n                Math.sin(ta) // TODO optimize\r\n            );\r\n        } else {\r\n            return 2 * Math.atanh(Math.tan(ta / 2) / Math.sqrt((ecc + 1) / (ecc - 1)));\r\n        }\r\n    }\r\n\r\n}\r\n","import * as THREE from \"three\";\r\n\r\nimport VisualModelAbstract from \"./ModelAbstract\";\r\nimport {Quaternion, Vector} from \"../algebra\";\r\nimport {RF_BASE} from \"../ReferenceFrame/Factory\";\r\nimport { sim } from \"../Simulation\";\r\n\r\nexport default class VisualVector extends VisualModelAbstract\r\n{\r\n    constructor(vector, referenceFrameId) {\r\n        super();\r\n        if (referenceFrameId === undefined) {\r\n            referenceFrameId = RF_BASE;\r\n        }\r\n        this.referenceFrame = sim.starSystem.getReferenceFrame(referenceFrameId);\r\n        this.quaternion = Quaternion.transfer(new Vector([0,1,0]), vector);\r\n        this.setThreeObj(new THREE.ArrowHelper(\r\n            (new THREE.Vector3()).fromArray([1,0,0]),\r\n            new THREE.Vector3(),\r\n            vector.mag\r\n        ));\r\n    }\r\n\r\n    render(epoch) {\r\n        this.threeObj.quaternion.copy(this.quaternion.mul(this.referenceFrame.getQuaternionByEpoch(epoch)).toThreejs());\r\n        this.setPosition(this.referenceFrame.getOriginPositionByEpoch(epoch));\r\n    }\r\n}\r\n","import $ from \"jquery\";\r\n\r\nimport UIPanel from \"../Panel\";\r\nimport LambertSolver from \"../../core/LambertSolver\";\r\nimport ReferenceFrameFactory, {ReferenceFrame} from \"../../core/ReferenceFrame/Factory\";\r\nimport VisualTrajectoryModelKeplerian from \"../../core/visual/Trajectory/Keplerian\";\r\nimport VisualVector from \"../../core/visual/Vector\";\r\nimport EphemerisObject from \"../../core/EphemerisObject\";\r\nimport { sim } from \"../../core/Simulation\";\r\nimport Events from \"../../core/Events\";\r\n\r\nexport default class UIPanelLambert extends UIPanel\r\n{\r\n    constructor(panelDom) {\r\n        super(panelDom, true);\r\n\r\n        this.maxTransferTime = 86400 * 365.25 * 40;\r\n\r\n        this.jqSlider = this.jqDom.find('#transferTimeSlider');\r\n        this.jqSlider.on('input change', () => this.changeTransferTime(this.getCurrentTransferTime()));\r\n        this.transferTime = this.getCurrentTransferTime();\r\n\r\n        this.jqTransferTimeText = this.jqDom.find('#transferTimeValue');\r\n        this.jqTransferTimeText.html(this.formatTransferTime(this.transferTime));\r\n\r\n        this.jqDateText = this.jqDom.find('#departureDateValue');\r\n\r\n        this.jqDom.find('#useCurrentTime').click(() => this.useCurrentTime());\r\n\r\n        this.jqOrigin = this.jqDom.find('#originSelect');\r\n        this.jqOrigin.on('change', () => this.changeOrigin(0|this.jqOrigin.val()));\r\n\r\n        this.jqTarget = this.jqDom.find('#targetSelect');\r\n        this.jqTarget.on('change', () => this.changeTarget(0|this.jqTarget.val()));\r\n\r\n        this.useCurrentTime();\r\n\r\n        this.origin = 399;\r\n        this.jqOrigin.val(this.origin);\r\n\r\n        Events.addListener(Events.STAR_SYSTEM_LOADED, () => {\r\n            this.jqOrigin.html('');\r\n            this.jqTarget.html('');\r\n            const listData = this.buildListData();\r\n            if (listData) {\r\n                this.updateList(this.jqTarget, listData);\r\n                this.updateList(this.jqOrigin, listData);\r\n            }\r\n        });\r\n    }\r\n\r\n    solve() {\r\n        if (!this.origin || !this.target || this.origin === this.target) {\r\n            return;\r\n        }\r\n\r\n        const parentObject = sim.getModule('PatchedConics').getCommonParent(this.origin, this.target);\r\n\r\n        if (parentObject === null || parentObject.id == this.origin || parentObject.id == this.target) {\r\n            return;\r\n        }\r\n\r\n        const referenceFrameId = ReferenceFrameFactory.buildId(parentObject.id, ReferenceFrame.INERTIAL_ECLIPTIC);\r\n        const origin = sim.starSystem.getObject(this.origin);\r\n        const target = sim.starSystem.getObject(this.target);\r\n        const state1 = origin.trajectory.getStateByEpoch(this.departureTime, referenceFrameId);\r\n        const state2 = target.trajectory.getStateByEpoch(this.departureTime + this.transferTime, referenceFrameId);\r\n\r\n        const solverResult = LambertSolver.solveFullTransfer(\r\n            origin,\r\n            target,\r\n            origin.physicalModel ? origin.physicalModel.radius + 200 : 0,\r\n            target.physicalModel ? target.physicalModel.radius + 200 : 0,\r\n            this.departureTime,\r\n            this.transferTime\r\n        );\r\n        if (!solverResult) {\r\n            return;\r\n        }\r\n        const transferTrajectory = solverResult.trajectory;\r\n        transferTrajectory.setObject(new EphemerisObject(-1, EphemerisObject.TYPE_UNKNOWN, origin.name + '->' + target.name + ' transfer'));\r\n\r\n        if (this.visualModel) {\r\n            this.visualModel.drop();\r\n            this.visualModel2 && this.visualModel2.drop();\r\n            this.visualModel3 && this.visualModel3.drop();\r\n            this.vector1.drop();\r\n            this.vector2.drop();\r\n        }\r\n\r\n        this.visualModel = new VisualTrajectoryModelKeplerian(transferTrajectory.components[0], 'yellow');\r\n        if (transferTrajectory.components[1]) {\r\n            this.visualModel2 = new VisualTrajectoryModelKeplerian(transferTrajectory.components[1], 'red');\r\n        }\r\n        if (transferTrajectory.components[2]) {\r\n            this.visualModel3 = new VisualTrajectoryModelKeplerian(transferTrajectory.components[2], 'red');\r\n        }\r\n        this.vector1 = new VisualVector(state1.position, referenceFrameId);\r\n        this.vector2 = new VisualVector(state2.position, referenceFrameId);\r\n\r\n        this.jqDom.find('#deltaVEjection').html(solverResult.ejectionDeltaV.toPrecision(4));\r\n        this.jqDom.find('#deltaVInsertion').html(solverResult.insertionDeltaV.toPrecision(4));\r\n        this.jqDom.find('#deltaVTotal').html((solverResult.ejectionDeltaV + solverResult.insertionDeltaV).toPrecision(4));\r\n    }\r\n\r\n    collapse() {\r\n        if (this.visualModel) {\r\n            this.visualModel.drop();\r\n            this.visualModel2.drop();\r\n            this.visualModel3.drop();\r\n            this.vector1.drop();\r\n            this.vector2.drop();\r\n            this.visualModel = null;\r\n        }\r\n        super.collapse();\r\n    }\r\n\r\n    useCurrentTime() {\r\n        this.departureTime = sim.currentEpoch;\r\n        this.updateTime(sim.currentDate);\r\n        this.solve();\r\n    }\r\n\r\n    changeOrigin(newOrigin) {\r\n        this.origin = newOrigin;\r\n        this.updateSliderScale();\r\n        this.solve();\r\n    }\r\n\r\n    changeTarget(newTarget) {\r\n        this.target = newTarget;\r\n        this.updateSliderScale();\r\n        this.solve();\r\n    }\r\n\r\n    updateSliderScale() {\r\n        if (!this.origin || !this.target || this.origin === this.target) {\r\n            return;\r\n        }\r\n\r\n        const periods = sim.getModule('PatchedConics').getRelativePeriod(this.origin, this.target, this.departureTime);\r\n\r\n        if (periods === null) {\r\n            return;\r\n        }\r\n\r\n        this.maxTransferTime = Math.max(periods.period1, periods.period2);\r\n        this.jqSlider.val(this.getNeededSliderValue((periods.period1 + periods.period2) / 4));\r\n        this.changeTransferTime(this.getCurrentTransferTime());\r\n    }\r\n\r\n    changeTransferTime(newTransferTime) {\r\n        this.transferTime = newTransferTime;\r\n        this.jqTransferTimeText.html(this.formatTransferTime(this.transferTime));\r\n        this.solve();\r\n    }\r\n\r\n    getCurrentTransferTime() {\r\n        const val = this.jqSlider.val();\r\n        return val * val * val * val * this.maxTransferTime;\r\n    }\r\n\r\n    getNeededSliderValue(transferTime) {\r\n        const val = Math.sqrt(Math.sqrt(transferTime / this.maxTransferTime));\r\n        return Math.max(0, Math.min(1, val));\r\n    }\r\n\r\n    buildListData() {\r\n        const root = sim.getModule('PatchedConics').getRootSoi();\r\n\r\n        if (!root) {\r\n            return null;\r\n        }\r\n\r\n        return this.buildSoiTreeData(root, 0);\r\n    }\r\n\r\n    buildSoiTreeData(soiObject, level) {\r\n        let result = [{id: soiObject.id, level: level, name: soiObject.name}];\r\n        for (let child of soiObject.data.patchedConics.childSois) {\r\n            result = result.concat(this.buildSoiTreeData(child, level + 1));\r\n        }\r\n        return result;\r\n    }\r\n\r\n    updateList(jqList, data) {\r\n        const indent = '&nbsp;&nbsp;&nbsp;';\r\n        for (let entry of data) {\r\n            jqList.append($('<option>', {value: entry.id}).html(indent.repeat(entry.level) + entry.name));\r\n        }\r\n    }\r\n\r\n    updateTime(date) {\r\n        this.jqDateText.html(sim.time.formatDateFull(date));\r\n    }\r\n\r\n\r\n    formatTransferTime(scale) {\r\n        const precision = 3;\r\n\r\n        const prefix = (scale < 0) ? '-' : '';\r\n        const abs = Math.abs(scale);\r\n        if (abs === 0) {\r\n            return '0';\r\n        }\r\n\r\n        if (abs < 60) {\r\n            return prefix + abs.toPrecision(precision) + ' s';\r\n        }\r\n\r\n        if (abs < 3600) {\r\n            return prefix + (abs / 60).toPrecision(precision) + ' min';\r\n        }\r\n\r\n        if (abs < 86400) {\r\n            return prefix + (abs / 3600).toPrecision(precision) + ' h';\r\n        }\r\n\r\n        if (abs < 2592000) {\r\n            return prefix + (abs / 86400).toPrecision(precision) + ' days';\r\n        }\r\n\r\n        if (abs < 31557600) {\r\n            return prefix + (abs / 2592000).toPrecision(precision) + ' months';\r\n        }\r\n\r\n        return prefix + (abs / 31557600).toPrecision(precision) + ' years';\r\n    }\r\n}\r\n","\r\nimport VisualTrajectoryAbstract from \"./Abstract\";\r\n\r\nexport default class VisualTrajectoryDynamic extends VisualTrajectoryAbstract\r\n{\r\n    static NO_THREE_OBJ = true;\r\n}\r\n","import UIPanel from \"../Panel\";\r\nimport EphemerisObject from \"../../core/EphemerisObject\";\r\nimport TrajectoryKeplerianBasic from \"../../core/Trajectory/KeplerianBasic\";\r\nimport ReferenceFrameFactory, {ReferenceFrame} from \"../../core/ReferenceFrame/Factory\";\r\nimport VisualTrajectoryModelKeplerian from \"../../core/visual/Trajectory/Keplerian\";\r\nimport KeplerianObject from \"../../core/KeplerianObject\";\r\nimport TrajectoryDynamic from \"../../core/Trajectory/Dynamic\";\r\nimport { sim } from \"../../core/Simulation\";\r\nimport VisualTrajectoryDynamic from \"../../core/visual/Trajectory/Dynamic\";\r\nimport FlightEventSOIDeparture from \"../../modules/PatchedConics/FlightEvent/SOIDeparture\";\r\nimport FlightEventSOIArrival from \"../../modules/PatchedConics/FlightEvent/SOIArrival\";\r\nimport FlightEventImpulsiveBurn from \"../../core/FlightEvent/ImpulsiveBurn\";\r\nimport {Vector} from \"../../core/algebra\";\r\n\r\nexport default class UIPanelCreation extends UIPanel {\r\n    constructor(panelDom) {\r\n        super(panelDom);\r\n\r\n        this.jqCreate = this.jqDom.find('#createOrbit');\r\n        this.jqCreate.click(() => {\r\n            const center = sim.camera.orbitingPoint;\r\n            const object = sim.starSystem.getObject(center);\r\n            if (!object.physicalModel) {\r\n                return;\r\n            }\r\n            const sma = object.physicalModel.radius * 2;\r\n            const id = -11000000 - sim.starSystem.created;\r\n            sim.starSystem.created += 1;\r\n\r\n            let traj = new TrajectoryKeplerianBasic(\r\n                ReferenceFrameFactory.buildId(center, ReferenceFrame.INERTIAL_BODY_EQUATORIAL),\r\n                new KeplerianObject(\r\n                    0.2, sma, Math.PI / 6, Math.PI / 3, Math.PI / 6, 0, sim.currentEpoch, object.physicalModel.mu\r\n                )\r\n            );\r\n            traj.setVisualModel(new VisualTrajectoryModelKeplerian(traj, {color: 'yellow'}));\r\n            traj.minEpoch = false;\r\n            traj.maxEpoch = false;\r\n\r\n            const propagatorClass = sim.getPropagator('patchedConics');\r\n            let pTraj = new TrajectoryDynamic(new propagatorClass());\r\n            pTraj.setVisualModel(new VisualTrajectoryDynamic(pTraj, {color: 'yellow'}));\r\n            pTraj.addComponent(traj);\r\n\r\n            let ephObject = new EphemerisObject(id, EphemerisObject.TYPE_UNKNOWN, \"Created #\" + sim.starSystem.created);\r\n            ephObject.setTrajectory(pTraj);\r\n            sim.starSystem.addObject(id, ephObject);\r\n            sim.selection.forceSelection(ephObject);\r\n\r\n            pTraj.propagate(traj.epoch);\r\n        });\r\n\r\n        this.jqImport = this.jqDom.find('#importOrbit');\r\n        this.jqImport.click(() => {\r\n            let dump = JSON.parse(this.jqDom.find('#dump').val());\r\n            if (!dump) {\r\n                console.log('Bad json');\r\n                return;\r\n            }\r\n            if (!dump.components || !dump.visualModel) {\r\n                console.log('No components or visualModel found');\r\n                return;\r\n            }\r\n\r\n            const propagatorClass = sim.getPropagator('patchedConics');\r\n            let pTraj = new TrajectoryDynamic(new propagatorClass());\r\n            pTraj.setVisualModel(new VisualTrajectoryDynamic(pTraj, dump.visualModel));\r\n            let lastComponent = false;\r\n\r\n            for (let componentDump of dump.components) {\r\n                let traj = new TrajectoryKeplerianBasic(\r\n                    componentDump.referenceFrame,\r\n                    new KeplerianObject(\r\n                        componentDump.keplerianObject.ecc,\r\n                        componentDump.keplerianObject.sma,\r\n                        componentDump.keplerianObject.aop,\r\n                        componentDump.keplerianObject.inc,\r\n                        componentDump.keplerianObject.loan,\r\n                        componentDump.keplerianObject.m0,\r\n                        componentDump.keplerianObject.epoch,\r\n                        componentDump.keplerianObject.mu,\r\n                        false,\r\n                    )\r\n                );\r\n                traj.setVisualModel(new VisualTrajectoryModelKeplerian(traj, componentDump.visualModel));\r\n                traj.minEpoch = componentDump.minEpoch;\r\n                traj.maxEpoch = componentDump.maxEpoch;\r\n\r\n                if (lastComponent && lastComponent.referenceFrame.id !== traj.referenceFrame.id) {\r\n                    const oldSoi = sim.starSystem.getObject(lastComponent.referenceFrame.originId);\r\n                    const newSoi = sim.starSystem.getObject(traj.referenceFrame.originId);\r\n                    lastComponent.addFlightEvent(new FlightEventSOIDeparture(\r\n                        traj.minEpoch,\r\n                        oldSoi,\r\n                        newSoi\r\n                    ));\r\n                    traj.addFlightEvent(new FlightEventSOIArrival(\r\n                        traj.minEpoch,\r\n                        oldSoi,\r\n                        newSoi\r\n                    ));\r\n                }\r\n\r\n                pTraj.addComponent(traj);\r\n                lastComponent = traj;\r\n            }\r\n\r\n            for (let eventDump of dump.events) {\r\n                pTraj.addFlightEvent((new FlightEventImpulsiveBurn(\r\n                    eventDump.epoch,\r\n                    new Vector([eventDump.x, eventDump.y, eventDump.z])\r\n                )).onUpdate((newEvent, oldEvent) => {\r\n                    pTraj.sortFlightEvents();\r\n                    pTraj.propagate(Math.min(oldEvent.epoch, newEvent.epoch));\r\n                }));\r\n            }\r\n\r\n            const id = -11000000 - sim.starSystem.created;\r\n            sim.starSystem.created++;\r\n            let ephObject = new EphemerisObject(id, EphemerisObject.TYPE_UNKNOWN, \"Created #\" + sim.starSystem.created);\r\n            ephObject.setTrajectory(pTraj);\r\n            sim.starSystem.addObject(id, ephObject);\r\n            sim.selection.forceSelection(ephObject);\r\n        });\r\n    }\r\n}\r\n","import UIPanel from \"../Panel\";\r\nimport Events from \"../../core/Events\";\r\nimport TrajectoryDynamic from \"../../core/Trajectory/Dynamic\";\r\nimport FlightEventImpulsiveBurn from \"../../core/FlightEvent/ImpulsiveBurn\";\r\nimport { sim } from \"../../core/Simulation\";\r\n\r\nexport default class UIPanelManeuver extends UIPanel {\r\n    constructor(panelDom) {\r\n        super(panelDom);\r\n\r\n        this.increment = 1;\r\n\r\n        document.addEventListener(Events.SELECT, this.handleSelect.bind(this));\r\n        document.addEventListener(Events.DESELECT, this.handleDeselect.bind(this));\r\n\r\n        this.updateHandler = this.handleTrajectoryUpdate.bind(this);\r\n\r\n        this.jqDom.find('#incr001').on('click', () => {this.increment = 0.01});\r\n        this.jqDom.find('#incr01').on('click', () => {this.increment = 0.1});\r\n        this.jqDom.find('#incr1').on('click', () => {this.increment = 1});\r\n        this.jqDom.find('#incr10').on('click', () => {this.increment = 10});\r\n        this.jqDom.find('#incr100').on('click', () => {this.increment = 100});\r\n        this.jqDom.find('#incr1000').on('click', () => {this.increment = 1000});\r\n\r\n        this.jqDom.find('#prev-burn').on('click', () => this.setBurnIdx(this.burnIdx - 1));\r\n        this.jqDom.find('#next-burn').on('click', () => this.setBurnIdx(this.burnIdx + 1));\r\n\r\n        this.jqDom.find('#period-minus').on('click', () => {this.burn.epoch -= this.getOrbitPeriod();this.update()});\r\n        this.jqDom.find('#period-plus' ).on('click', () => {this.burn.epoch += this.getOrbitPeriod();this.update()});\r\n\r\n\r\n        this.jqDom.find('#epoch-minus').on('click', () => {this.burn.epoch -= this.increment;this.update()});\r\n        this.jqDom.find('#epoch-plus').on('click', () => {this.burn.epoch += this.increment;this.update()});\r\n        for (let comp of ['prograde', 'normal', 'radial']) {\r\n            this.jqDom.find('#' + comp +'-minus').on('click', () => {this.burn[comp] -= this.increment / 1000;this.update()});\r\n            this.jqDom.find('#' + comp + '-plus').on('click', () => {this.burn[comp] += this.increment / 1000;this.update()});\r\n            this.jqDom.find('#' + comp + '-zero').on('click', () => {this.burn[comp] = 0;this.update()});\r\n        }\r\n\r\n        this.jqDom.find('#remove-burn').on('click', () => {\r\n            let traj = this.trajectory;\r\n            this.trajectory.removeFlightEvent(this.burn);\r\n            this.handleDeselect();\r\n            this.init(traj);\r\n        });\r\n\r\n        this.hide();\r\n    }\r\n\r\n    get increment() {\r\n        return this._increment;\r\n    }\r\n\r\n    set increment(val) {\r\n        this._increment = val;\r\n        this.jqDom.find('#increment').html(val);\r\n    }\r\n\r\n    handleTrajectoryUpdate() {\r\n        this.updateBurns();\r\n        if (this.burns.length > 0) {\r\n            this.show();\r\n        }\r\n        const idx = this.burns.indexOf(this.burn);\r\n        this.setBurnIdx(idx === -1 ? 0 : idx);\r\n    }\r\n\r\n    handleSelect(event) {\r\n        if (event.detail.object.trajectory instanceof TrajectoryDynamic) {\r\n            this.init(event.detail.object.trajectory);\r\n        }\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param trajectory {TrajectoryDynamic}\r\n     */\r\n    init(trajectory) {\r\n        this.trajectory = trajectory;\r\n        this.trajectory.onUpdate(this.updateHandler);\r\n        this.updateBurns();\r\n        if (this.burns.length === 0) {\r\n            this.hide();\r\n            return;\r\n        }\r\n        this.show();\r\n        this.setBurnIdx(0);\r\n    }\r\n\r\n    getOrbitPeriod() {\r\n        let orbit = this.trajectory.getComponentByEpoch(this.burn.epoch, true);\r\n        if (!orbit) {\r\n            return 0;\r\n        }\r\n        return orbit.getKeplerianObjectByEpoch(this.burn.epoch).period;\r\n    }\r\n\r\n    updateBurns() {\r\n        this.burns = this.trajectory.flightEvents.filter(event => event instanceof FlightEventImpulsiveBurn);\r\n    }\r\n\r\n    setBurnIdx(newIdx) {\r\n        if (newIdx < 0 || newIdx >= this.burns.length) {\r\n            return;\r\n        }\r\n        if (this.burn) {\r\n            this.burn.visualModel.setScale(1);\r\n        }\r\n        this.burnIdx = newIdx;\r\n        this.burn = this.burns[this.burnIdx];\r\n        this.burn.visualModel.setScale(2);\r\n\r\n        this.update();\r\n        this.jqDom.find('#burn-name').html('Burn #' + (this.burnIdx + 1));\r\n    }\r\n\r\n    handleDeselect() {\r\n        if (this.trajectory) {\r\n            this.trajectory.removeListener(this.updateHandler);\r\n            delete this.trajectory;\r\n            delete this.burn;\r\n            this.hide();\r\n        }\r\n    }\r\n\r\n    update() {\r\n        this.jqDom.find('#burn-date')    .html(sim.time.formatDateFull(sim.time.getDateByEpoch(this.burn.epoch)));\r\n        this.jqDom.find('#burn-epoch')   .html(this.burn.epoch.toFixed(2));\r\n        this.jqDom.find('#burn-prograde').html((this.burn.prograde * 1000).toFixed(2));\r\n        this.jqDom.find('#burn-normal')  .html((this.burn.normal * 1000).toFixed(2));\r\n        this.jqDom.find('#burn-radial')  .html((this.burn.radial * 1000).toFixed(2));\r\n        this.jqDom.find('#burn-total')   .html((this.burn.deltaV * 1000).toFixed(2));\r\n    }\r\n}","import UIPanel from \"../Panel\";\r\nimport Events from \"../../core/Events\";\r\nimport EphemerisObject from \"../../core/EphemerisObject\";\r\nimport TrajectoryKeplerianBasic from \"../../core/Trajectory/KeplerianBasic\";\r\nimport ReferenceFrameFactory, {ReferenceFrame} from \"../../core/ReferenceFrame/Factory\";\r\nimport VisualTrajectoryModelKeplerian from \"../../core/visual/Trajectory/Keplerian\";\r\nimport KeplerianObject from \"../../core/KeplerianObject\";\r\nimport TrajectoryDynamic from \"../../core/Trajectory/Dynamic\";\r\nimport { sim } from \"../../core/Simulation\";\r\nimport VisualTrajectoryDynamic from \"../../core/visual/Trajectory/Dynamic\";\r\n\r\nexport default class UIPanelDynamicTrajectory extends UIPanel {\r\n    constructor(panelDom) {\r\n        super(panelDom);\r\n\r\n        document.addEventListener(Events.SELECT, this.handleSelect.bind(this));\r\n        document.addEventListener(Events.DESELECT, this.handleDeselect.bind(this));\r\n\r\n        this.jqDump = this.jqDom.find('#dump');\r\n        this.jqDump.click(() => {\r\n            const json = JSON.stringify(this.trajectory.dump());\r\n            prompt('Copy this text:', json);\r\n            console.log(json);\r\n        });\r\n\r\n        this.hide();\r\n    }\r\n\r\n    handleSelect(event) {\r\n        const object = event.detail.object;\r\n\r\n        if (!(object.trajectory instanceof TrajectoryDynamic)) {\r\n            return;\r\n        }\r\n\r\n        this.trajectory = object.trajectory;\r\n\r\n        this.show();\r\n    }\r\n\r\n    handleDeselect() {\r\n        delete this.trajectory;\r\n        this.hide();\r\n    }\r\n}\r\n","import $ from \"jquery\";\r\n\r\nimport UIPanelTime from \"./Panels/Time\";\r\nimport UIPanelCamera from \"./Panels/Camera\";\r\nimport UIPanelMetrics from \"./Panels/Metrics\";\r\nimport UIPanelLambert from \"./Panels/Lambert\";\r\nimport UIPanelCreation from \"./Panels/Creation\";\r\nimport UIPanelManeuver from \"./Panels/Maneuver\";\r\nimport UIPanelDynamicTrajectory from \"./Panels/DynamicTrajectory\";\r\nimport { sim } from \"../core/Simulation\";\r\n\r\nexport default class UI\r\n{\r\n    constructor() {\r\n        this.timePanel     = new UIPanelTime    ($('#timePanel'));\r\n        this.cameraPanel   = new UIPanelCamera  ($('#cameraPanel'),  sim.camera);\r\n        this.metricsPanel  = new UIPanelMetrics ($('#metricsPanel'), sim.selection);\r\n        this.creationPanel = new UIPanelCreation($('#creationPanel'));\r\n        this.lambertPanel  = new UIPanelLambert ($('#lambertPanel'));\r\n        this.maneuverPanel = new UIPanelManeuver($('#maneuverPanel'));\r\n\r\n        this.dynamicTrajectoryPanel = new UIPanelDynamicTrajectory($('#dynamicTrajectoryPanel'));\r\n    }\r\n}\r\n","import * as THREE from \"three\";\r\n\r\nimport {Quaternion, Vector} from \"../core/algebra\";\r\nimport {ReferenceFrame, RF_BASE} from \"../core/ReferenceFrame/Factory\";\r\nimport Events from \"../core/Events\";\r\nimport ReferenceFrameFactory from \"../core/ReferenceFrame/Factory\";\r\nimport { sim } from \"../core/Simulation\";\r\n\r\nexport default class Camera\r\n{\r\n    constructor(domElement) {\r\n        this.settings = {\r\n            fov: 60,\r\n            animationDuration: 200,\r\n            pixelsToObjectUnderMouse: 20\r\n        };\r\n\r\n        this.domElement = domElement;\r\n        this.threeCamera = new THREE.PerspectiveCamera(this.settings.fov, domElement.width / domElement.height, 1, 1e15);\r\n        this.threeCamera.position.fromArray([0, 0, 0]);\r\n\r\n        this.listenersAdded = false;\r\n    }\r\n\r\n    init(initialReferenceFrame, initialPosition) {\r\n        this.position = initialPosition;\r\n\r\n        this.referenceFrame = sim.starSystem.getReferenceFrame(initialReferenceFrame);\r\n        this.orbitingPoint = this.referenceFrame.originId;\r\n        this.frameType = this.referenceFrame.type;\r\n        this.quaternion = this._getQuaternionByPosition(this.position);\r\n\r\n        this.lastPosition = this.referenceFrame.transformPositionByEpoch(sim.currentEpoch, this.position, RF_BASE);\r\n\r\n        this.currentMousePos = new Vector([0, 0]);\r\n        this.accountedMousePos = new Vector([0, 0]);\r\n\r\n        this.isMouseDown = false;\r\n        this.isShiftDown = false;\r\n        this.rightButtonDown = false;\r\n        this.isLookingAside = false;\r\n        this.zoomingAside = 0;\r\n        this.isAnimnating = false;\r\n\r\n        if (!this.listenersAdded) {\r\n            sim.addEventListener('mousedown', this.onMouseDown.bind(this), 1);\r\n            sim.addEventListener('mousemove', this.onMouseMove.bind(this), 1);\r\n            sim.addEventListener('mouseup', this.onMouseUp.bind(this), 1);\r\n            sim.addEventListener('wheel', this.onMouseWheel.bind(this), 1);\r\n            this.listenersAdded = true;\r\n        }\r\n    }\r\n\r\n    _getQuaternionByPosition(position, pole) {\r\n        const defaultDirection = new Vector([0, 0, 1]); // must be unit length\r\n        const defaultUp = new Vector([0, 1, 0]);        // must be unit length\r\n\r\n        const directionQuaternion = (new Quaternion()).setAxisAngle(\r\n            defaultDirection.cross(position),\r\n            Math.acos(position.dot(defaultDirection) / position.mag)\r\n        );\r\n\r\n        const newUp = directionQuaternion.rotate(defaultUp);\r\n        const neededUp = (new Quaternion()).setAxisAngle(\r\n            position.cross(pole || new Vector([0, 0, 1])),\r\n            Math.PI / 2\r\n        ).rotate(position);\r\n\r\n        let rollQuaternion = (new Quaternion()).setAxisAngle(\r\n            newUp.cross(neededUp),\r\n            Math.acos(newUp.dot(neededUp) / neededUp.mag)\r\n        );\r\n\r\n        return rollQuaternion.mul_(directionQuaternion);\r\n    }\r\n\r\n    getAvailableFrameTypes(orbitingPoint) {\r\n        if (orbitingPoint === undefined) {\r\n            orbitingPoint = this.orbitingPoint;\r\n        }\r\n\r\n        if (orbitingPoint == 0) {\r\n            return [ReferenceFrame.INERTIAL_ECLIPTIC];\r\n        }\r\n\r\n        const isBody = sim.starSystem.isBody(orbitingPoint);\r\n\r\n        if (isBody === null) {\r\n            return [];\r\n        } else if (isBody) {\r\n            return [\r\n                ReferenceFrame.INERTIAL_ECLIPTIC,\r\n                ReferenceFrame.INERTIAL_BODY_EQUATORIAL,\r\n                ReferenceFrame.INERTIAL_BODY_FIXED\r\n            ];\r\n        } else {\r\n            return [\r\n                ReferenceFrame.INERTIAL_ECLIPTIC,\r\n                ReferenceFrame.INERTIAL_PARENT_BODY_EQUATORIAL\r\n            ];\r\n        }\r\n    }\r\n\r\n    changeReferenceFrameType(newType) {\r\n        this.changeReferenceFrame(ReferenceFrameFactory.buildId(this.orbitingPoint, newType), true);\r\n    }\r\n\r\n    changeOrigin(newObjectId) {\r\n        const newFrameTypes = this.getAvailableFrameTypes(newObjectId);\r\n        let newFrameType = (newFrameTypes.indexOf(this.frameType) !== -1)\r\n            ? this.frameType\r\n            : ReferenceFrame.INERTIAL_ECLIPTIC;\r\n        this.changeReferenceFrame(ReferenceFrameFactory.buildId(newObjectId, newFrameType), true);\r\n    }\r\n\r\n    changeReferenceFrame(newFrameId, animate) {\r\n        const newFrame = sim.starSystem.getReferenceFrame(newFrameId);\r\n\r\n        this.position = this.referenceFrame.transformPositionByEpoch(sim.currentEpoch, this.position, newFrame);\r\n        this.isLookingAside = false;\r\n        this.zoomingAside = 0;\r\n        this.orbitingPoint = newFrame.originId;\r\n        this.frameType = newFrame.type;\r\n\r\n        if (animate) {\r\n            this.startAnimation(newFrame);\r\n        } else {\r\n            this.quaternion = this._getQuaternionByPosition(this.position);\r\n        }\r\n\r\n        Events.dispatch(Events.CAMERA_RF_CHANGED, {old: this.referenceFrame, new: newFrame});\r\n\r\n        this.referenceFrame = newFrame;\r\n    }\r\n\r\n    startAnimation(newFrame) {\r\n        if (newFrame) {\r\n            let transferQuaternion = this.referenceFrame.getQuaternionByEpoch(sim.currentEpoch).invert_().mul_(newFrame.getQuaternionByEpoch(sim.currentEpoch));\r\n            this.quaternion = transferQuaternion.invert_().mul_(this.quaternion);\r\n        }\r\n\r\n        this.animationStartingTime = (new Date()).getTime();\r\n        this.animationDuration = this.settings.animationDuration;\r\n        this.animationStartingQuaternion = this.quaternion.copy();\r\n        this.isAnimnating = true;\r\n    }\r\n\r\n    animate() {\r\n        const time = (new Date()).getTime();\r\n        const percent = (time - this.animationStartingTime) / this.animationDuration;\r\n        const targetQuat = this._getQuaternionByPosition(this.position);\r\n\r\n        if (percent >= 1) {\r\n            this.quaternion = targetQuat;\r\n            this.isAnimnating = false;\r\n            this.isLookingAside = false;\r\n            return;\r\n        }\r\n\r\n        this.quaternion = Quaternion.slerp(this.animationStartingQuaternion, targetQuat, percent);\r\n    }\r\n\r\n    findObjectUnderMouse() {\r\n        let biggestRadius = 0;\r\n        let biggestObject = false;\r\n        for (const body of sim.starSystem.getBodies()) {\r\n            const dist = sim.raycaster.getPixelDistance(\r\n                body.getPositionByEpoch(sim.currentEpoch, RF_BASE)\r\n            );\r\n            if (dist < this.settings.pixelsToObjectUnderMouse) {\r\n                if (biggestObject === false) {\r\n                    biggestObject = body.id;\r\n                }\r\n                const r = body.physicalModel.radius;\r\n                if (r && r > biggestRadius) {\r\n                    biggestRadius = r;\r\n                    biggestObject = body.id;\r\n                }\r\n            }\r\n        }\r\n        return biggestObject;\r\n    }\r\n\r\n    onMouseWheel(event) {\r\n        if (!event.deltaY) {\r\n            return;\r\n        }\r\n\r\n        const defaultFactor = event.shiftKey ? (1 + (sim.settings.ui.camera.zoomFactor - 1) / 10) : sim.settings.ui.camera.zoomFactor;\r\n        const factor = event.deltaY < 0\r\n            ? 1 / defaultFactor\r\n            : defaultFactor;\r\n        let objectToZoomTo = this.findObjectUnderMouse();\r\n        let zoomingTo = this.orbitingPoint;\r\n\r\n        if (objectToZoomTo === this.orbitingPoint) {\r\n            objectToZoomTo = false;\r\n        }\r\n\r\n        if (objectToZoomTo !== false) {\r\n            this.position = this.referenceFrame.transformPositionByEpoch(sim.currentEpoch, this.position, objectToZoomTo * 100000 + 1000);\r\n            zoomingTo = objectToZoomTo;\r\n        } else {\r\n            this.zoomingAside = 0;\r\n        }\r\n\r\n        if (sim.starSystem.getObject(zoomingTo).physicalModel && sim.starSystem.getObject(zoomingTo).physicalModel.radius) {\r\n            const currentMag = this.position.mag;\r\n            this.position.mul_((sim.starSystem.getObject(zoomingTo).physicalModel.radius + (currentMag - sim.starSystem.getObject(zoomingTo).physicalModel.radius) * factor) / currentMag);\r\n        } else {\r\n            this.position.mul_(factor);\r\n        }\r\n\r\n        if (objectToZoomTo !== false) {\r\n            this.position = sim.starSystem.getReferenceFrame(objectToZoomTo * 100000 + 1000).transformPositionByEpoch(sim.currentEpoch, this.position, this.referenceFrame);\r\n            this.isLookingAside = true;\r\n            this.zoomingAside++;\r\n\r\n        } else if (this.isLookingAside) {\r\n            this.startAnimation();\r\n        }\r\n\r\n        if (this.zoomingAside === 3) {\r\n            this.changeOrigin(objectToZoomTo, true);\r\n        }\r\n    }\r\n\r\n    onMouseDown(event) {\r\n        this.accountedMousePos = new Vector([event.clientX, event.clientY]);\r\n        this.currentMousePos = this.accountedMousePos.copy();\r\n        this.isMouseDown = true;\r\n        switch (event.button) {\r\n            case 0: //left\r\n                break;\r\n            case 1: // middle\r\n                break;\r\n            case 2:\r\n                this.rightButtonDown = true;\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n\r\n    onMouseMove(event) {\r\n        if (this.isMouseDown) {\r\n            this.isShiftDown = !!event.shiftKey;\r\n            this.currentMousePos.set(event.clientX, event.clientY);\r\n        }\r\n    }\r\n\r\n    onMouseUp(event) {\r\n        this.isMouseDown = false;\r\n        this.rightButtonDown = false;\r\n    }\r\n\r\n    onResize() {\r\n        this.threeCamera.aspect = this.domElement.width / this.domElement.height;\r\n        this.threeCamera.updateProjectionMatrix();\r\n    }\r\n\r\n    getTopDirection(epoch) {\r\n        return this.referenceFrame.getQuaternionByEpoch(epoch).mul_(this.quaternion).rotate_(new Vector([0,1,0]));\r\n    }\r\n\r\n    update(epoch) {\r\n        const rfQuaternion = this.referenceFrame.getQuaternionByEpoch(epoch);\r\n        let mouseShift = this.currentMousePos.sub(this.accountedMousePos);\r\n\r\n        if (this.isAnimnating) {\r\n            this.animate();\r\n        }\r\n\r\n        if (mouseShift[0] || mouseShift[1]) {\r\n            const polarConstraint = 0.00001;\r\n            const sensitivity = (this.isShiftDown ? 0.1 : 1) * sim.settings.ui.camera.mouseSensitivity;\r\n            const pole = new Vector([0, 0, 1]);\r\n            let poleAngle = this.position.angle(pole);\r\n            let verticalRotationAxis = this.rightButtonDown\r\n                ? this.quaternion.rotate(new Vector([0, 0, 1])).cross(pole)\r\n                : this.position.cross(pole);\r\n\r\n            let verticalQuaternion = new Quaternion(verticalRotationAxis, Math.min(Math.max(mouseShift[1] * sensitivity, poleAngle - Math.PI + polarConstraint), poleAngle - polarConstraint));\r\n            let mainQuaternion = (new Quaternion(pole, -mouseShift[0] * sensitivity)).mul_(verticalQuaternion);\r\n\r\n            if (!this.rightButtonDown) {\r\n                mainQuaternion.rotate_(this.position);\r\n            }\r\n            this.quaternion = mainQuaternion.mul_(this.quaternion);\r\n\r\n            this.accountedMousePos = this.currentMousePos.copy();\r\n        }\r\n        this.threeCamera.quaternion.copy(rfQuaternion.mul_(this.quaternion).toThreejs());\r\n        this.lastPosition = this.referenceFrame.transformPositionByEpoch(epoch, this.position, RF_BASE);\r\n    }\r\n}\r\n","import { sim } from \"../core/Simulation\";\r\n\r\nexport default class StarSystemEntry\r\n{\r\n    constructor(idx, alias, label, moduleName) {\r\n        this.idx = idx;\r\n        this.alias = alias;\r\n        this.label = label;\r\n        this.moduleName = moduleName;\r\n    }\r\n\r\n    // used in UI\r\n    get value() {\r\n        return this.alias;\r\n    }\r\n\r\n    load(callback) {\r\n        if (sim.isModuleLoaded(this.moduleName)) {\r\n            sim.getModule(this.moduleName).loadStarSystem(this.alias, callback);\r\n        } else {\r\n            sim.loadModule(this.moduleName, module => module.loadStarSystem(this.alias, callback));\r\n        }\r\n    }\r\n}\r\n","import StarSystemEntry from \"./StarSystemEntry\";\r\n\r\nexport default class StarSystemManager {\r\n    constructor() {\r\n        this._starSystems = [];\r\n        this._loadedIdx = null;\r\n\r\n        // The first one loads by default\r\n        this.add(\"solar_system\", \"SolarSystem\", \"Solar System\");\r\n        this.add(\"ksp\", \"KSP\", \"KSP System\");\r\n    }\r\n\r\n    get starSystems() {\r\n        return this._starSystems;\r\n    }\r\n\r\n    get defaultStarSystemIdx() {\r\n        return 0;\r\n    }\r\n\r\n    get defaultStarSystem() {\r\n        return this._starSystems[this.defaultStarSystemIdx];\r\n    }\r\n\r\n    add(alias, module, label) {\r\n        const idx = this._starSystems.length;\r\n\r\n        this._starSystems.push(new StarSystemEntry(idx, alias, label, module));\r\n    }\r\n\r\n    loadDefault(callback) {\r\n        this.loadByIdx(this.defaultStarSystemIdx, callback);\r\n    }\r\n\r\n    loadByIdx(idx, callback) {\r\n        if (idx === this._loadedIdx) {\r\n            return;\r\n        }\r\n\r\n        const starSystem = this._findStarSystemByIdx(idx);\r\n\r\n        if (!starSystem) {\r\n            return;\r\n        }\r\n\r\n        starSystem.load(callback);\r\n        this._loadedIdx = idx;\r\n    }\r\n\r\n    getCurrentStarSystem() {\r\n        if (this._loadedIdx === null) {\r\n            return undefined;\r\n        }\r\n\r\n        return this._starSystems[this._loadedIdx];\r\n    }\r\n\r\n    _findStarSystemByIdx(idx) {\r\n        // TODO: Add idx validation\r\n\r\n        return this._starSystems[idx];\r\n    }\r\n}\r\n","import * as THREE from \"three\";\r\nimport $ from \"jquery\";\r\nimport EventHandler from \"./EventHandler\";\r\nimport {Vector} from \"./algebra\";\r\nimport Events from \"./Events\";\r\nimport {ReferenceFrame} from \"./ReferenceFrame/Factory\";\r\nimport TimeLine from \"../ui-legacy/TimeLine\";\r\nimport StarSystemLoader from \"../interface/StarSystemLoader\";\r\nimport VisualRaycaster from \"./visual/Raycaster\";\r\nimport SelectionHandler from \"../ui-legacy/SelectionHandler\";\r\nimport UI from \"../ui-legacy/UI\";\r\nimport StarSystem from \"./StarSystem\";\r\nimport Camera from \"../ui-legacy/Camera\";\r\nimport ReferenceFrameFactory from \"./ReferenceFrame/Factory\";\r\nimport StarSystemManager from \"../interface/StarSystemManager\";\r\nimport VisualFlightEventImpulsiveBurn from \"./visual/FlightEvent/ImpulsiveBurn\";\r\nimport VisualMarkerApocenter from \"./visual/Marker/Apocenter\";\r\nimport VisualMarkerPericenter from \"./visual/Marker/Pericenter\";\r\n\r\nclass Simulation\r\n{\r\n    constructor() {\r\n        this.modules = {};\r\n        this.propagators = {};\r\n        this.renderLoopActive = false;\r\n        this.starSystemManager = new StarSystemManager();\r\n\r\n        this._initSettings();\r\n    }\r\n\r\n    init(viewPortDomElement, renderLoopFunction) {\r\n        this.renderLoopFunction = renderLoopFunction;\r\n\r\n        this.scene = new THREE.Scene();\r\n        this.scene.add(new THREE.AmbientLight(0xFFEFD5, 0.15));\r\n\r\n        this.textureLoader = new THREE.TextureLoader();\r\n\r\n        this.renderer = new THREE.WebGLRenderer({antialias: true, logarithmicDepthBuffer: true});\r\n\r\n        this.domElement = viewPortDomElement;\r\n        this._setRenderSize();\r\n        this.domElement.appendChild(this.renderer.domElement);\r\n        window.addEventListener(\"resize\", this.onWindowResize.bind(this));\r\n\r\n        this.rendererEvents = new EventHandler(this.renderer.domElement);\r\n\r\n        this.selection = new SelectionHandler();\r\n\r\n        this.time = new TimeLine(0, 1, true);\r\n\r\n        this.camera = new Camera(this.renderer.domElement);\r\n\r\n        this.raycaster = new VisualRaycaster(this.renderer.domElement, this.camera.threeCamera, 7);\r\n\r\n        this.ui = new UI();\r\n\r\n        this.starSystemManager.loadDefault(() => requestAnimationFrame(renderLoopFunction));\r\n\r\n        VisualFlightEventImpulsiveBurn.preloadTexture();\r\n        VisualMarkerPericenter.preloadTexture();\r\n        VisualMarkerApocenter.preloadTexture();\r\n\r\n        Events.dispatch(Events.INIT_DONE);\r\n    }\r\n\r\n    loadStarSystem(jsonFile, onLoadFinish) {\r\n        return Promise.resolve($.getJSON(\"./star_systems/\" + jsonFile, starSystemConfig => {\r\n            this.selection.deselect();\r\n            this.starSystem && this.starSystem.unload();\r\n            this.starSystem = new StarSystem(starSystemConfig.id);\r\n\r\n            StarSystemLoader.loadFromConfig(this.starSystem, starSystemConfig);\r\n\r\n            this.camera.init(\r\n                ReferenceFrameFactory.buildId(\r\n                    this.starSystem.mainObject,\r\n                    ReferenceFrame.INERTIAL_BODY_EQUATORIAL\r\n                ),\r\n                new Vector([30000, 30000, 20000])\r\n            );\r\n\r\n            onLoadFinish && onLoadFinish(this.starSystem);\r\n            Events.dispatch(Events.STAR_SYSTEM_LOADED, {starSystem: this.starSystem});\r\n\r\n            this.startRendering();\r\n        }));\r\n    }\r\n\r\n    startRendering() {\r\n        this.renderLoopActive = true;\r\n    }\r\n\r\n    stopRendering() {\r\n        this.renderLoopActive = false;\r\n    }\r\n\r\n    get currentEpoch() {\r\n        return this.time.epoch;\r\n    }\r\n\r\n    get currentDate() {\r\n        return this.time.getDateByEpoch(this.time.epoch);\r\n    }\r\n\r\n    forceEpoch(epoch) {\r\n        return this.time.forceEpoch(epoch);\r\n    }\r\n\r\n    _initSettings() {\r\n        this.settings = {\r\n            ui: {\r\n                showBodyLabels: true,\r\n                showAnglesOfSelectedOrbit: true,\r\n                camera: {\r\n                    mouseSensitivity: 0.007,\r\n                    zoomFactor: 1.5\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    addEventListener(eventName, listener, priority) {\r\n        this.rendererEvents.addListener(eventName, listener, priority);\r\n    }\r\n\r\n    removeEventListener(eventName, listener) {\r\n        this.rendererEvents.removeListener(eventName, listener);\r\n    }\r\n\r\n    onWindowResize() {\r\n        this._setRenderSize();\r\n        this.camera.onResize();\r\n    }\r\n\r\n    tick(timeDelta) {\r\n        this.time.tick(timeDelta);\r\n\r\n        this.camera.update(this.time.epoch);\r\n\r\n        Events.dispatch(Events.RENDER, {epoch: this.time.epoch});\r\n\r\n        if (this.renderLoopActive) {\r\n            this.renderer.render(this.scene, this.camera.threeCamera);\r\n        }\r\n    }\r\n\r\n    getVisualCoords(simCoords) {\r\n        return (new THREE.Vector3()).fromArray(simCoords.sub(this.camera.lastPosition));\r\n    }\r\n\r\n    getSimCoords(visualCoords) {\r\n        return (new Vector(visualCoords.toArray())).add_(this.camera.lastPosition);\r\n    }\r\n\r\n    loadModule(alias, callback) {\r\n        const className = 'Module' + alias;\r\n\r\n        return import('../modules/' + alias + '/' + className).then((module) => {\r\n            this.modules[alias] = new module.default();\r\n            this.modules[alias].init();\r\n            callback && callback(this.modules[alias]);\r\n        });\r\n    }\r\n\r\n    getModule(alias) {\r\n        if (this.modules[alias] === undefined) {\r\n            throw new Error('Unknown module: ' + alias);\r\n        }\r\n\r\n        return this.modules[alias];\r\n    }\r\n\r\n    isModuleLoaded(alias) {\r\n        return this.modules[alias] !== undefined;\r\n    }\r\n\r\n    getClass(alias) {\r\n        const periodPos = alias.indexOf(\".\");\r\n        if (periodPos === -1) {\r\n            throw new Error('Incorrect class alias! Period expected in ' + alias);\r\n        }\r\n        return this.getModule(alias.substr(0, periodPos)).getClass(alias.substr(periodPos + 1));\r\n    }\r\n\r\n    addPropagator(alias, propagatorClass) {\r\n        this.propagators[alias] = propagatorClass;\r\n    }\r\n\r\n    getPropagator(alias) {\r\n        return this.propagators[alias];\r\n    }\r\n\r\n    _setRenderSize() {\r\n        if(!this._footerDomElement) {\r\n            this._footerDomElement = document.getElementById(\"app-footer\");\r\n        }\r\n\r\n        const footerHeight = (this._footerDomElement ? this._footerDomElement.clientHeight : 0);\r\n        const height = window.innerHeight - footerHeight;\r\n\r\n        this.renderer.setSize(this.domElement.clientWidth, height);\r\n    }\r\n}\r\n\r\nexport const sim = new Simulation();\r\n","import FunctionOfEpochAbstract from \"./Abstract\";\r\nimport { sim } from \"../Simulation\";\r\n\r\nexport default class FunctionOfEpochObjectState extends FunctionOfEpochAbstract\r\n{\r\n    constructor(objectId, referenceFrame) {\r\n        super();\r\n        this.objectId = objectId;\r\n        this.referenceFrame = referenceFrame;\r\n    }\r\n\r\n    evaluate(epoch) {\r\n        return sim.starSystem.getObject(this.objectId).trajectory.getStateByEpoch(epoch, this.referenceFrame);\r\n    }\r\n}\r\n","import ReferenceFrameAbstract from \"./Abstract\";\r\nimport {RF_BASE} from \"./Factory\";\r\nimport {Vector} from \"../algebra\";\r\nimport StateVector from \"../StateVector\";\r\nimport { sim } from \"../Simulation\";\r\n\r\nexport default class ReferenceFrameBodyFixed extends ReferenceFrameAbstract\r\n{\r\n    constructor(origin, isInertial) {\r\n        super();\r\n        this.origin = origin;\r\n        this.isInertial = isInertial;\r\n        this.body = sim.starSystem.getObject(this.origin);\r\n    }\r\n\r\n    getQuaternionByEpoch(epoch) {\r\n        return this.body.orientation.getQuaternionByEpoch(epoch);\r\n    }\r\n\r\n    getOriginStateByEpoch(epoch) {\r\n        return sim.starSystem.getObject(this.origin).trajectory.getStateByEpoch(epoch, RF_BASE);\r\n    }\r\n\r\n    getOriginPositionByEpoch(epoch) {\r\n        return this.getOriginStateByEpoch(epoch).position;\r\n    }\r\n\r\n    getRotationVelocityByEpoch(epoch) {\r\n        return new Vector([0, 0, this.body.orientation.angularVel]);\r\n    }\r\n\r\n    stateVectorFromBaseReferenceFrameByEpoch(epoch, state) {\r\n        const originState = this.getOriginStateByEpoch(epoch);\r\n        const rotation = this.getQuaternionByEpoch(epoch).invert_();\r\n\r\n        const destPos = rotation.rotate(state.position.sub_(originState.position));\r\n        let destVel = rotation.rotate(state.velocity.sub_(originState.velocity));\r\n\r\n        if (!this.isInertial) {\r\n            const rfVel = destPos.cross(this.getRotationVelocityByEpoch(epoch));\r\n            destVel.add_(rfVel);\r\n        }\r\n\r\n        return new StateVector(\r\n            destPos,\r\n            destVel\r\n        );\r\n    }\r\n\r\n    stateVectorToBaseReferenceFrameByEpoch(epoch, state) {\r\n        const originState = this.getOriginStateByEpoch(epoch);\r\n        const rotation = this.getQuaternionByEpoch(epoch);\r\n\r\n        const destPos = rotation.rotate(state.position).add_(originState.position);\r\n        let destVel;\r\n\r\n        if (!this.isInertial) {\r\n            const rfVel = state.position.cross(this.getRotationVelocityByEpoch(epoch));\r\n            destVel = rotation.rotate(state.velocity.sub_(rfVel)).add_(originState.velocity);\r\n        } else {\r\n            destVel = rotation.rotate(state.velocity).add_(originState.velocity);\r\n        }\r\n\r\n        return new StateVector(\r\n            destPos,\r\n            destVel\r\n        );\r\n    }\r\n}\r\n","import ReferenceFrameAbstract from \"./Abstract\";\r\nimport {RF_BASE} from \"./Factory\";\r\n\r\nexport default class ReferenceFrameBase extends ReferenceFrameAbstract\r\n{\r\n    constructor() {\r\n        super();\r\n        this.setId(RF_BASE);\r\n    }\r\n}","import ReferenceFrameBodyFixed from \"./BodyFixed\";\r\nimport {Quaternion, Vector} from \"../algebra\";\r\nimport {RF_BASE} from \"./Factory\";\r\nimport StateVector from \"../StateVector\";\r\nimport { sim } from \"../Simulation\";\r\n\r\nexport default class ReferenceFrameTopocentric extends ReferenceFrameBodyFixed\r\n{\r\n    constructor(origin, lat, lon, height, isInertial) {\r\n        super(origin, isInertial);\r\n        this.bodyFixedQuaternion = new Quaternion().setFromEuler(0, -lat, lon, 'ZYX');\r\n        this.bodyFixedPosition = (new Vector([this.body.physicalModel.radius + height, 0, 0])).rotateY(-lat).rotateZ(lon);\r\n    }\r\n\r\n    getQuaternionByEpoch(epoch) {\r\n        return this.body.orientation.getQuaternionByEpoch(epoch).mul_(this.bodyFixedQuaternion)\r\n    }\r\n\r\n    getRotationVelocityByEpoch(epoch) {\r\n        return this.bodyFixedQuaternion.invert().rotate(\r\n            new Vector([0, 0, this.body.orientation.angularVel])\r\n        );\r\n    }\r\n\r\n    getOriginStateByEpoch(epoch) {\r\n        const bodyState = sim.starSystem.getObject(this.origin).trajectory.getStateByEpoch(epoch, RF_BASE);\r\n        const bodyQuaternion = this.body.orientation.getQuaternionByEpoch(epoch);\r\n\r\n        let rfVel = this.bodyFixedPosition.cross(\r\n            new Vector([0, 0, this.body.orientation.angularVel])\r\n        );\r\n\r\n        const destPos = bodyQuaternion.rotate(this.bodyFixedPosition).add_(bodyState.position);\r\n        const destVel = bodyQuaternion.rotate_(rfVel.mul_(-1)).add_(bodyState.velocity);\r\n\r\n        return new StateVector(\r\n            destPos,\r\n            destVel\r\n        );\r\n    }\r\n}\r\n","import FunctionOfEpochObjectState from \"../FunctionOfEpoch/ObjectState\";\r\nimport {Quaternion, Vector} from \"../algebra\";\r\nimport FunctionOfEpochCustom from \"../FunctionOfEpoch/Custom\";\r\nimport ReferenceFrameBodyFixed from \"./BodyFixed\";\r\nimport ReferenceFrameBase from \"./Base\";\r\nimport ReferenceFrameInertial from \"./Inertial\";\r\nimport ReferenceFrameInertialDynamic from \"./InertialDynamic\";\r\nimport Body from \"../Body\";\r\nimport ReferenceFrameTopocentric from \"./Topocentric\";\r\nimport { sim } from \"../Simulation\";\r\n\r\nexport default class ReferenceFrameFactory\r\n{\r\n    static create(id, type, config) {\r\n        let res = null;\r\n\r\n        if (type == ReferenceFrame.INERTIAL_ECLIPTIC) {\r\n            res = new ReferenceFrameInertial(\r\n                new FunctionOfEpochObjectState(config.origin, RF_BASE),\r\n                new Quaternion()\r\n            );\r\n        } else if (type == ReferenceFrame.INERTIAL_BODY_EQUATORIAL) {\r\n            if (sim.starSystem.getObject(config.origin) instanceof Body) {\r\n                res = new ReferenceFrameInertialDynamic(\r\n                    new FunctionOfEpochObjectState(config.origin, RF_BASE),\r\n                    new FunctionOfEpochCustom((epoch) => {\r\n                        const z = sim.starSystem.getObject(config.origin).orientation.getQuaternionByEpoch(epoch).rotate_(new Vector([0, 0, 1]));\r\n                        const equinox = z.cross(new Vector([0, 0, 1]));\r\n                        if (equinox.mag === 0) {\r\n                            return new Quaternion();\r\n                        }\r\n                        return Quaternion.transfer(new Vector([0, 0, 1]), z).mul_(\r\n                            Quaternion.transfer(new Vector([1, 0, 0]), equinox)\r\n                        );\r\n                    })\r\n                );\r\n            } else {\r\n                res = null;\r\n            }\r\n        } else if (type == ReferenceFrame.INERTIAL_PARENT_BODY_EQUATORIAL) {\r\n            res = new ReferenceFrameInertialDynamic(\r\n                new FunctionOfEpochObjectState(config.origin, RF_BASE),\r\n                new FunctionOfEpochCustom((epoch) => {\r\n                    const parentId = sim.starSystem.getObject(config.origin).getParentObjectIdByEpoch(epoch);\r\n                    const parent = sim.starSystem.getObject(parentId);\r\n\r\n                    if (parent instanceof Body) {\r\n                        const z = parent.orientation.getQuaternionByEpoch(epoch).rotate_(new Vector([0, 0, 1]));\r\n                        const equinox = z.cross(new Vector([0, 0, 1]));\r\n                        return Quaternion.transfer(new Vector([0, 0, 1]), z).mul_(\r\n                            Quaternion.transfer(new Vector([1, 0, 0]), equinox)\r\n                        );\r\n                    } else {\r\n                        return new Quaternion();\r\n                    }\r\n                })\r\n            );\r\n        } else if (type == ReferenceFrame.INERTIAL_BODY_FIXED) {\r\n            if (sim.starSystem.getObject(config.origin) instanceof Body) {\r\n                res = new ReferenceFrameBodyFixed(\r\n                    config.origin,\r\n                    true\r\n                );\r\n            } else {\r\n                res = null;\r\n            }\r\n        } else if (type == ReferenceFrame.INERTIAL_TOPOCENTRIC) {\r\n            if (sim.starSystem.getObject(config.origin) instanceof Body) {\r\n                res = new ReferenceFrameTopocentric(\r\n                    config.origin,\r\n                    config.lat,\r\n                    config.lon,\r\n                    config.height,\r\n                    true\r\n                );\r\n            } else {\r\n                res = null;\r\n            }\r\n        } else if (type == ReferenceFrame.BODY_FIXED) {\r\n            if (sim.starSystem.getObject(config.origin) instanceof Body) {\r\n                res = new ReferenceFrameBodyFixed(\r\n                    config.origin,\r\n                    false\r\n                );\r\n            } else {\r\n                res = null;\r\n            }\r\n        } else if (type == ReferenceFrame.TOPOCENTRIC) {\r\n            if (sim.starSystem.getObject(config.origin) instanceof Body) {\r\n                res = new ReferenceFrameTopocentric(\r\n                    config.origin,\r\n                    config.lat,\r\n                    config.lon,\r\n                    /* height */ undefined, // TODO: We need to investigate why\r\n                    false\r\n                );\r\n            } else {\r\n                res = null;\r\n            }\r\n        } else if (type == ReferenceFrame.BASE) {\r\n            res = new ReferenceFrameBase();\r\n        }\r\n\r\n        return res ? res.setId(id) : null;\r\n    }\r\n\r\n    static getOriginIdByReferenceFrameId(referenceFrameId) {\r\n        return Math.sign(referenceFrameId) * Math.floor(Math.abs(referenceFrameId) / 100000);\r\n    }\r\n\r\n    static getTypeByReferenceFrameId(referenceFrameId) {\r\n        return Math.floor((Math.abs(referenceFrameId) % 100000) / 1000);\r\n    }\r\n\r\n    static createById(id) {\r\n        const type = this.getTypeByReferenceFrameId(id);\r\n\r\n        if ((type === ReferenceFrame.INERTIAL_ECLIPTIC)\r\n            || (type === ReferenceFrame.INERTIAL_BODY_EQUATORIAL)\r\n            || (type === ReferenceFrame.INERTIAL_BODY_FIXED)\r\n            || (type === ReferenceFrame.BODY_FIXED)\r\n            || (type === ReferenceFrame.INERTIAL_PARENT_BODY_EQUATORIAL)\r\n        ) {\r\n            return this.create(id, type, {origin: this.getOriginIdByReferenceFrameId(id)});\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    static buildId(origin, type) {\r\n        if ((type === ReferenceFrame.INERTIAL_ECLIPTIC)\r\n            || (type === ReferenceFrame.INERTIAL_BODY_EQUATORIAL)\r\n            || (type === ReferenceFrame.INERTIAL_BODY_FIXED)\r\n            || (type === ReferenceFrame.BODY_FIXED)\r\n            || (type === ReferenceFrame.INERTIAL_PARENT_BODY_EQUATORIAL)\r\n        ) {\r\n            return (origin ? Math.sign(origin) : 1) * (Math.abs(origin) * 100000 + type * 1000);\r\n        }\r\n\r\n        return null;\r\n    }\r\n}\r\n\r\nexport const RF_BASE = 1000;\r\n\r\nexport let RF_BASE_OBJ = new ReferenceFrameBase();\r\n\r\nexport const ReferenceFrame = {\r\n    BASE: 0,\r\n    INERTIAL_ECLIPTIC: 1,\r\n    INERTIAL_BODY_EQUATORIAL: 2,\r\n    INERTIAL_BODY_FIXED: 3,\r\n    INERTIAL_TOPOCENTRIC: 4,\r\n    // : 5, vacant\r\n    BODY_FIXED: 6,\r\n    TOPOCENTRIC: 7,\r\n    INERTIAL_PARENT_BODY_EQUATORIAL: 8,\r\n};\r\n","export default class Events\r\n{\r\n    static dispatch(event, detail) {\r\n        let eventObj;\r\n        if (detail) {\r\n            eventObj = new CustomEvent(\r\n                event,\r\n                {detail: detail}\r\n            );\r\n        } else {\r\n            eventObj = new CustomEvent(event);\r\n        }\r\n        document.dispatchEvent(eventObj);\r\n    }\r\n\r\n    static addListener(event, handler) {\r\n        return document.addEventListener(event, handler);\r\n    }\r\n\r\n    static removeListener(event, handler) {\r\n        return document.removeEventListener(event, handler);\r\n    }\r\n\r\n    static LOADING_BODIES_DONE = 'urb_load_bodies_done';\r\n    static LOADING_FRAMES_DONE = 'urb_load_frames_done';\r\n    static LOADING_TRAJECTORIES_DONE = 'urb_load_traj_done';\r\n\r\n    static RENDER = 'urb_render';\r\n    static INIT_DONE = 'urb_init_done';\r\n    static STAR_SYSTEM_LOADED = 'urb_star_system_loading_done';\r\n    static SELECT = 'urb_select';\r\n    static DESELECT = 'urb_deselect';\r\n    static SHOW_ORBIT_ANGLES_CHANGED = 'urb_show_orbit_angles_change';\r\n    static CAMERA_RF_CHANGED = 'urb_camera_rf_change';\r\n    static OBJECT_ADDED = 'urb_object_added';\r\n    static TIME_SCALE_CHANGED = 'urb_time_scale_change';\r\n    static TIME_PAUSED = 'urb_time_paused';\r\n    static TIME_UNPAUSED = 'urb_time_unpaused';\r\n    static EPOCH_CHANGED = 'urb_epoch_change';\r\n}\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport cn from \"classnames\";\r\n\r\nimport \"./index.scss\";\r\n\r\nconst Button = ({ id, className, children, small = false, disabled = false, onClick = () => {} }) => (\r\n    <button\r\n        id={id}\r\n        type=\"button\"\r\n        className={cn(\r\n            \"button\",\r\n            {\r\n                \"button--disabled\": disabled,\r\n                \"button--small\": small,\r\n            },\r\n            className,\r\n        )}\r\n        onClick={onClick}\r\n        disabled={disabled}\r\n    >\r\n        {children}\r\n    </button>\r\n);\r\n\r\nButton.propTypes = {\r\n    id: PropTypes.string,\r\n    className: PropTypes.string,\r\n    disabled: PropTypes.bool,\r\n    small: PropTypes.bool,\r\n    onClick: PropTypes.func,\r\n    children: PropTypes.node,\r\n};\r\n\r\nexport default Button;\r\n","import { RF_BASE } from \"./ReferenceFrame/Factory\";\r\n\r\nexport default class EphemerisObject\r\n{\r\n    constructor(bodyId, type, name, data) {\r\n        this.id   = bodyId;\r\n        this.type = type;\r\n        this.name = name;\r\n        this.data = data || {};\r\n    }\r\n\r\n    setTrajectory(trajectory) {\r\n        this.trajectory = trajectory;\r\n        this.trajectory.setObject(this);\r\n    }\r\n\r\n    getParentObjectIdByEpoch(epoch) {\r\n        if (!this.trajectory) {\r\n            return null;\r\n        }\r\n\r\n        const rf = this.trajectory.getReferenceFrameByEpoch(epoch);\r\n        if (!rf) {\r\n            return null;\r\n        }\r\n\r\n        return rf.originId;\r\n    }\r\n\r\n    getStateByEpoch(epoch, referenceFrame) {\r\n        return this.trajectory.getStateByEpoch(epoch, referenceFrame || RF_BASE);\r\n    }\r\n\r\n    getPositionByEpoch(epoch, referenceFrame) {\r\n        return this.trajectory.getPositionByEpoch(epoch, referenceFrame || RF_BASE);\r\n    }\r\n\r\n    select() {\r\n        this.trajectory && this.trajectory.select();\r\n    }\r\n\r\n    deselect() {\r\n        this.trajectory && this.trajectory.deselect();\r\n    }\r\n\r\n    drop() {\r\n        if (this.trajectory) {\r\n            this.trajectory.drop();\r\n            delete this.trajectory;\r\n        }\r\n    }\r\n}\r\n\r\nEphemerisObject.TYPE_UNKNOWN    = 0;\r\nEphemerisObject.TYPE_STAR       = 1;\r\nEphemerisObject.TYPE_PLANET     = 2;\r\nEphemerisObject.TYPE_PLANETOID  = 3;\r\nEphemerisObject.TYPE_SATELLITE  = 4;\r\nEphemerisObject.TYPE_ASTEROID   = 5;\r\nEphemerisObject.TYPE_COMET      = 6;\r\nEphemerisObject.TYPE_SPACECRAFT = 7;\r\nEphemerisObject.TYPE_POINT      = 8;\r\n","import {Vector} from \"./algebra\";\r\n\r\nexport default class StateVector\r\n{\r\n    constructor(position, velocity) {\r\n        this._position = position ? position.copy() : new Vector();\r\n        this._velocity = velocity ? velocity.copy() : new Vector();\r\n    }\r\n\r\n    get position() {\r\n        return this._position.copy();\r\n    }\r\n\r\n    get velocity() {\r\n        return this._velocity.copy();\r\n    }\r\n\r\n    static create(x, y, z, vx, vy, vz) {\r\n        return new this(\r\n            new Vector([ x || 0,  y || 0,  z || 0]),\r\n            new Vector([vx || 0, vy || 0, vz || 0])\r\n        );\r\n    }\r\n\r\n    copy() {\r\n        return new StateVector(this._position, this._velocity);\r\n    }\r\n\r\n    rotate_(quaternion) {\r\n        quaternion.rotate_(this._position);\r\n        quaternion.rotate_(this._velocity);\r\n        return this;\r\n    }\r\n\r\n    rotate(quaternion) {\r\n        return this.copy().rotate_(quaternion);\r\n    }\r\n}\r\n","import Events from \"../Events\";\r\nimport { sim } from \"../Simulation\";\r\n\r\nexport default class VisualModelAbstract\r\n{\r\n    constructor() {\r\n        this.threeObj = null;\r\n        this.scene = sim.scene;\r\n        this._isHidden = false;\r\n    }\r\n\r\n    setThreeObj(obj) {\r\n        this.threeObj = obj;\r\n        this.scene.add(this.threeObj);\r\n        this.renderListener = this._onRender.bind(this);\r\n        if (this._isHidden) {\r\n            this.threeObj.visible = false;\r\n        } else {\r\n            document.addEventListener(Events.RENDER, this.renderListener);\r\n        }\r\n    }\r\n\r\n    setPosition(simCoords) {\r\n        if (simCoords) {\r\n            this.threeObj.visible = true;\r\n            this.threeObj.position.copy(sim.getVisualCoords(simCoords));\r\n        } else {\r\n            this.threeObj.visible = false;\r\n        }\r\n    }\r\n\r\n    get pixelAngleSize() {\r\n        return sim.raycaster.getPixelAngleSize();\r\n    }\r\n\r\n    _onRender(event) {\r\n        try {\r\n            this.render(event.detail.epoch);\r\n        } catch (e) {\r\n            // console.log('Error', e);\r\n            this.threeObj.visible = false;\r\n        }\r\n    }\r\n\r\n    hide() {\r\n        this._isHidden = true;\r\n        this.renderListener && document.removeEventListener(Events.RENDER, this.renderListener);\r\n        if (this.threeObj)\r\n            this.threeObj.visible = false;\r\n    }\r\n\r\n    show() {\r\n        this._isHidden = false;\r\n        this.renderListener && document.addEventListener(Events.RENDER, this.renderListener);\r\n        if (this.threeObj)\r\n            this.threeObj.visible = true;\r\n    }\r\n\r\n    render(epoch) {}\r\n\r\n    drop() {\r\n        if (this.threeObj) {\r\n            this.scene.remove(this.threeObj);\r\n            this.threeObj.traverse(object => {\r\n                if (object.geometry) object.geometry.dispose();\r\n                if (object.material) object.material.dispose();\r\n            });\r\n            delete this.threeObj;\r\n        }\r\n        this.renderListener && document.removeEventListener(Events.RENDER, this.renderListener);\r\n    }\r\n}\r\n\r\nVisualModelAbstract.texturePath = 'texture/';\r\n","import FunctionOfEpochAbstract from \"./Abstract\";\r\n\r\nexport default class FunctionOfEpochCustom extends FunctionOfEpochAbstract\r\n{\r\n    constructor(func) {\r\n        super();\r\n        this.func = func;\r\n    }\r\n\r\n    evaluate(epoch) {\r\n        return this.func(epoch);\r\n    }\r\n}","export const TOP_MENU_ITEMS = {\r\n    SIMULATION: \"Simulation\",\r\n    EDIT: \"Edit\",\r\n    VIEW: \"View\",\r\n    SETTINGS: \"Settings\",\r\n    HELP: \"Help\",\r\n};\r\n\r\nexport const HELP_PAGE_URL =\r\n    \"https://github.com/tossha/urbain/wiki/%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5-Urbain\";\r\n","const MenuItemType = {\r\n    NONE: 0,\r\n    LINK: 1,\r\n    DROPDOWN: 2,\r\n};\r\n\r\nexport default MenuItemType;\r\n","import { showWizard, wizardIds } from \"../components/tutorials\";\r\nimport { openLinkInNewTab } from \"../utils\";\r\nimport { HELP_PAGE_URL, TOP_MENU_ITEMS } from \"./constants\";\r\nimport MenuItemType from \"./menu-item-type\";\r\n\r\nclass MenuItem {\r\n    constructor({ label, type = MenuItemType.NONE, onClick = () => {} }) {\r\n        this.label = label;\r\n        this.type = type;\r\n    }\r\n\r\n    get isClickable() {\r\n        return true;\r\n    }\r\n}\r\n\r\nclass LinkMenuItem extends MenuItem {\r\n    constructor(label, { href = \"\", target = \"_self\" } = {}) {\r\n        super({ label, type: MenuItemType.LINK });\r\n\r\n        this.href = href;\r\n        this.target = target;\r\n    }\r\n\r\n    get isClickable() {\r\n        return Boolean(this.href);\r\n    }\r\n}\r\n\r\nclass DropDownMenuItem extends MenuItem {\r\n    constructor(label, options = []) {\r\n        super({ label, type: MenuItemType.DROPDOWN });\r\n\r\n        this.options = options;\r\n    }\r\n\r\n    onSelect = selectedLabel => {\r\n        this.options = this.options.map(option => {\r\n            const newOption = {\r\n                ...option,\r\n                selected: selectedLabel === option.label ? !option.selected : option.selected,\r\n            };\r\n\r\n            if (selectedLabel === option.label && option.onUpdate) {\r\n                option.onUpdate(newOption);\r\n            }\r\n\r\n            return newOption;\r\n        });\r\n    };\r\n}\r\n\r\nclass Store {\r\n    constructor(simulation, loadTLE) {\r\n        this._simulation = simulation;\r\n        this._loadTLE = loadTLE;\r\n    }\r\n\r\n    viewSettings = {\r\n        showStatistics: false,\r\n        showBodyLabels: true,\r\n        showOrbitCreationPanel: false,\r\n        showTransferCalculationPanel: false,\r\n        satelliteSearchPanel: {\r\n            isVisible: false,\r\n            toggle() {\r\n                this.isVisible = !this.isVisible;\r\n            },\r\n        },\r\n    };\r\n\r\n    topMenu = [\r\n        new DropDownMenuItem(TOP_MENU_ITEMS.SIMULATION, [\r\n            {\r\n                label: \"Orbit creation panel\",\r\n                selected: this.viewSettings.showOrbitCreationPanel,\r\n                onUpdate: ({ selected }) => {\r\n                    this.viewSettings.showOrbitCreationPanel = selected;\r\n                },\r\n            },\r\n            {\r\n                label: \"Transfer calculation panel\",\r\n                selected: this.viewSettings.showTransferCalculationPanel,\r\n                onUpdate: ({ selected }) => {\r\n                    this.viewSettings.showTransferCalculationPanel = selected;\r\n                },\r\n            },\r\n        ]),\r\n        new LinkMenuItem(TOP_MENU_ITEMS.EDIT),\r\n        new DropDownMenuItem(TOP_MENU_ITEMS.VIEW, [\r\n            {\r\n                label: \"Body Labels\",\r\n                selected: this.viewSettings.showBodyLabels,\r\n                onUpdate: ({ selected }) => {\r\n                    this._simulation.settings.ui.showBodyLabels = selected;\r\n                    this.viewSettings.showBodyLabels = selected;\r\n                },\r\n            },\r\n            {\r\n                label: \"Statistics badge\",\r\n                selected: false,\r\n                onUpdate: ({ selected }) => {\r\n                    this.viewSettings.showStatistics = selected;\r\n                },\r\n            },\r\n            {\r\n                label: \"Satellite search panel\",\r\n                selected: this.viewSettings.satelliteSearchPanel.isVisible,\r\n                onUpdate: () => {\r\n                    this.viewSettings.satelliteSearchPanel.toggle();\r\n                },\r\n            },\r\n        ]),\r\n        new DropDownMenuItem(TOP_MENU_ITEMS.HELP, [\r\n            new MenuItem({\r\n                label: \"Urbain Wiki\",\r\n                onClick: () => {\r\n                    openLinkInNewTab(HELP_PAGE_URL);\r\n                },\r\n            }),\r\n            new MenuItem({\r\n                label: \"Show tutorial\",\r\n                onClick: () => {\r\n                    showWizard({ wizardId: wizardIds.GETTING_STARTED_WIZARD, ignoreWatchStatusCheck: true });\r\n                },\r\n            }),\r\n        ]),\r\n    ];\r\n\r\n    get starSystemSelectorSettings() {\r\n        const { starSystemManager } = this._simulation;\r\n\r\n        return {\r\n            options: starSystemManager.starSystems,\r\n            defaultValue: starSystemManager.defaultStarSystem,\r\n            onSelect: item => starSystemManager.loadByIdx(item.idx),\r\n        };\r\n    }\r\n\r\n    loadSatellite = noradId => {\r\n        return this._loadTLE(noradId);\r\n    };\r\n\r\n    unloadSatellite = noradId => {\r\n        return this._simulation.starSystem.deleteObject(-(100000 + (0 | noradId)));\r\n    };\r\n}\r\n\r\nexport default Store;\r\n","export function openLinkInNewTab(url) {\r\n    if (url) {\r\n        window.open(url, \"_blank\");\r\n    }\r\n}\r\n","import React from \"react\";\r\n\r\nimport Store from \"./store\";\r\n\r\nexport default React.createContext({\r\n    stats: {},\r\n    store: new Store(),\r\n    updateStore() {},\r\n    webApiServices: {\r\n        satelliteFinder: {},\r\n    },\r\n});\r\n","import { TOP_MENU_ITEMS } from \"./constants\";\r\nimport RootContext from \"./root-context\";\r\nimport MenuItemType from \"./menu-item-type\";\r\nimport Store from \"./store\";\r\n\r\nexport { RootContext, Store, TOP_MENU_ITEMS, MenuItemType };\r\n","import { sim } from \"./Simulation\";\r\nimport Events from \"./Events\";\r\n\r\nfunction init(statistics, viewPortId = \"viewport-id\") {\r\n    let globalTime;\r\n\r\n    function render(curTime) {\r\n        if (!sim.renderLoopActive) {\r\n            return;\r\n        }\r\n\r\n        sim.tick((curTime - globalTime) / 1000);\r\n\r\n        globalTime = curTime;\r\n        statistics.update();\r\n        requestAnimationFrame(render);\r\n    }\r\n\r\n    function firstRender(curTime) {\r\n        globalTime = curTime;\r\n        requestAnimationFrame(render);\r\n    }\r\n\r\n    sim.init(document.getElementById(viewPortId), firstRender);\r\n    sim.loadModule('PatchedConics');\r\n}\r\n\r\nexport {\r\n    init,\r\n    sim,\r\n    Events,\r\n}\r\n","import {Quaternion, TWO_PI, Vector} from \"./algebra\";\r\nimport StateVector from \"./StateVector\";\r\n\r\nexport default class KeplerianObject\r\n{\r\n    constructor(ecc, sma, aop, inc, raan, anomaly, epoch, mu, isAnomalyTrue) {\r\n        this._mu    = mu;\r\n        this._sma   = sma;\r\n        this._ecc   = ecc;\r\n        this._inc   = inc;\r\n        this._raan  = raan;\r\n        this._aop   = aop;\r\n        this._epoch = epoch;\r\n\r\n        if ((isAnomalyTrue === undefined) || (isAnomalyTrue === true)) {\r\n            this.ta = anomaly;\r\n        } else {\r\n            this.m0 = anomaly;\r\n        }\r\n\r\n        this.updateMeanMotion();\r\n    }\r\n\r\n    setUpdateCallback(callback) {\r\n        this._updateCallback = callback;\r\n    }\r\n\r\n    copy() {\r\n        return new KeplerianObject(this._ecc, this._sma, this._aop, this._inc, this._raan, this.m0, this._epoch, this._mu, false);\r\n    }\r\n\r\n    dump() {\r\n        return {\r\n            ecc: this._ecc,\r\n            sma: this._sma,\r\n            aop: this._aop,\r\n            inc: this._inc,\r\n            loan: this._raan,\r\n            m0: this.m0,\r\n            epoch: this._epoch,\r\n            mu: this._mu\r\n        }\r\n    }\r\n\r\n    updateMeanMotion() {\r\n        this.meanMotion = Math.sqrt(this._mu / Math.abs(this._sma)) / Math.abs(this._sma);\r\n    }\r\n\r\n    get isHyperbolic() {\r\n        return this._ecc > 1;\r\n    }\r\n\r\n    get isElliptic() {\r\n        return this._ecc < 1;\r\n    }\r\n\r\n    get mu() {\r\n        return this._mu;\r\n    }\r\n\r\n    set mu(value) {\r\n        this._mu = value;\r\n        this.updateMeanMotion();\r\n        this._updateCallback && this._updateCallback();\r\n    }\r\n\r\n    get sma() {\r\n        return this._sma;\r\n    }\r\n\r\n    set sma(value) {\r\n        this._sma = value;\r\n        this.updateMeanMotion();\r\n        this._updateCallback && this._updateCallback();\r\n    }\r\n\r\n    get ecc() {\r\n        return this._ecc;\r\n    }\r\n\r\n    set ecc(value) {\r\n        this._ecc = value;\r\n        this._updateCallback && this._updateCallback();\r\n    }\r\n\r\n    get inc() {\r\n        return this._inc;\r\n    }\r\n\r\n    set inc(value) {\r\n        this._inc = value;\r\n        this._updateCallback && this._updateCallback();\r\n    }\r\n\r\n    get raan() {\r\n        return this._raan;\r\n    }\r\n\r\n    set raan(value) {\r\n        this._raan = value;\r\n        this._updateCallback && this._updateCallback();\r\n    }\r\n\r\n    get aop() {\r\n        return this._aop;\r\n    }\r\n\r\n    set aop(value) {\r\n        this._aop = value;\r\n        this._updateCallback && this._updateCallback();\r\n    }\r\n\r\n    get ta() {\r\n        return this.getTrueAnomalyByEpoch(this._epoch);\r\n    }\r\n\r\n    set ta(value) {\r\n        this.m0 = this.getMeanAnomalyByTrueAnomaly(value);\r\n        this._updateCallback && this._updateCallback();\r\n    }\r\n\r\n    get epoch() {\r\n        return this._epoch;\r\n    }\r\n\r\n    set epoch(value) {\r\n        this._epoch = value;\r\n        this._updateCallback && this._updateCallback();\r\n    }\r\n\r\n    get period() {\r\n        if (!this.isElliptic) {\r\n            return 0;\r\n        }\r\n        return TWO_PI * Math.sqrt(this._sma * this._sma * this._sma / this._mu);\r\n    }\r\n\r\n    getNodalPrecessionRate(r, j2) {\r\n        return -3/2 * r * r * j2 * Math.cos(this._inc) * this.meanMotion / Math.pow(this._sma * (1 - this._ecc * this._ecc), 2);\r\n    }\r\n\r\n    getNodalPrecessionByEpoch(r, j2, epoch) {\r\n        return (epoch - this._epoch) * this.getNodalPrecessionRate(r, j2);\r\n    }\r\n\r\n    addPrecession(r, j2, epoch) {\r\n        this.m0 = this.getMeanAnomalyByEpoch(epoch);\r\n        this._raan += this.getNodalPrecessionByEpoch(r, j2, epoch);\r\n        this._epoch = epoch;\r\n        return this;\r\n    }\r\n\r\n    getMeanAnomalyByEpoch(epoch) {\r\n        return this.m0 + this.meanMotion * (epoch - this._epoch);\r\n    }\r\n\r\n    getEccentricAnomalyByEpoch(epoch) {\r\n        return this.getEccentricAnomalyByMeanAnomaly(\r\n            this.getMeanAnomalyByEpoch(epoch)\r\n        );\r\n    }\r\n\r\n    getTrueAnomalyByEpoch(epoch) {\r\n        return this.getTrueAnomalyByMeanAnomaly(\r\n            this.getMeanAnomalyByEpoch(epoch)\r\n        );\r\n    }\r\n\r\n    getMeanAnomalyByEccentricAnomaly(ea) {\r\n        if (this.isElliptic) {\r\n            return ea - this._ecc * Math.sin(ea);\r\n        } else {\r\n            return this._ecc * Math.sinh(ea) - ea;\r\n        }\r\n    }\r\n\r\n    getMeanAnomalyByTrueAnomaly(ta) {\r\n        return this.getMeanAnomalyByEccentricAnomaly(\r\n            this.getEccentricAnomalyByTrueAnomaly(ta)\r\n        );\r\n    }\r\n\r\n    getEccentricAnomalyByMeanAnomaly(ma) {\r\n        const maxIter = 30;\r\n        const delta = 0.00000001;\r\n        let M = ma;\r\n        let E, F, i = 0;\r\n\r\n        if (this.isElliptic) {\r\n            M = M / (2.0 * Math.PI);\r\n            M = 2.0 * Math.PI * (M - Math.floor(M));\r\n\r\n            E = (this._ecc < 0.8) ? M : Math.PI;\r\n\r\n            F = E - this._ecc * Math.sin(E) - M;\r\n\r\n            while ((Math.abs(F) > delta) && (i < maxIter)) {\r\n                E = E - F / (1.0 - this._ecc * Math.cos(E));\r\n                F = E - this._ecc * Math.sin(E) - M;\r\n                i = i + 1;\r\n            }\r\n        } else {\r\n            E = (Math.log(2 * (Math.abs(M) + 1/3)) + 1) / this._ecc + (1 - 1 / this._ecc) * Math.asinh(Math.abs(M) / this._ecc);\r\n            E *= Math.sign(M);\r\n\r\n            F = this._ecc * Math.sinh(E) - E - M;\r\n\r\n            while ((Math.abs(F) > delta) && (i < maxIter)) {\r\n                E = E - F / (this._ecc * Math.cosh(E) - 1);\r\n                F = this._ecc * Math.sinh(E) - E - M;\r\n                i = i + 1;\r\n            }\r\n        }\r\n\r\n        return E;\r\n    }\r\n\r\n    getEccentricAnomalyByTrueAnomaly(ta) {\r\n        if (this.isElliptic) {\r\n            const cos = Math.cos(ta);\r\n            const cosE = (this._ecc + cos) / (1 + this._ecc * cos);\r\n            return ((ta + TWO_PI) % TWO_PI <= Math.PI)\r\n                ? Math.acos(cosE)\r\n                : TWO_PI - Math.acos(cosE);\r\n        } else {\r\n            return 2 * Math.atanh(Math.tan(ta / 2) / Math.sqrt((this._ecc + 1) / (this._ecc - 1)));\r\n        }\r\n    }\r\n\r\n    getTrueAnomalyByMeanAnomaly(ma) {\r\n        return this.getTrueAnomalyByEccentricAnomaly(\r\n            this.getEccentricAnomalyByMeanAnomaly(ma)\r\n        );\r\n    }\r\n\r\n    getTrueAnomalyByEccentricAnomaly(ea) {\r\n        if (this.isElliptic) {\r\n            const phi = Math.atan2(Math.sqrt(1.0 - this._ecc * this._ecc) * Math.sin(ea), Math.cos(ea) - this._ecc);\r\n            return (phi >= 0) ? phi : (phi + 2 * Math.PI);\r\n        } else {\r\n            return 2 * Math.atan(Math.sqrt((this._ecc + 1) / (this._ecc - 1)) * Math.tanh(ea / 2));\r\n        }\r\n    }\r\n\r\n    getOwnCoordsByTrueAnomaly(ta) {\r\n        const r = this._sma * (1.0 - this._ecc * this._ecc) / (1 + this._ecc * Math.cos(ta));\r\n        return new Vector([r * Math.cos(ta), r * Math.sin(ta), 0]);\r\n    }\r\n\r\n    getAsymptoteTa() {\r\n        if (this.isElliptic) {\r\n            return false;\r\n        }\r\n        return Math.acos(-1 / this._ecc);\r\n    }\r\n\r\n    getPeriapsisRadius() {\r\n        return this._sma * (1 - this._ecc);\r\n    }\r\n\r\n    getApoapsisRadius() {\r\n        return this._sma * (1 + this._ecc);\r\n    }\r\n\r\n    getPeriapsisSpeed() {\r\n        return Math.sqrt(this._mu * (2 / this.getPeriapsisRadius() - 1 / this._sma));\r\n    }\r\n\r\n    getApoapsisSpeed() {\r\n        return Math.sqrt(this._mu * (2 / this.getApoapsisRadius() - 1 / this._sma));\r\n    }\r\n\r\n    getEpochByTrueAnomaly(ta) {\r\n        if (ta === null) {\r\n            return null;\r\n        }\r\n        let diff = this.getMeanAnomalyByTrueAnomaly(ta) - this.m0;\r\n        if (diff < 0 && this.isElliptic) {\r\n            diff += TWO_PI;\r\n        }\r\n        return this._epoch + diff / this.meanMotion;\r\n    }\r\n\r\n    getSphereCrossingTrueAnomaly(radius) {\r\n        const apoR = this.getApoapsisRadius();\r\n        if ((apoR > 0 && radius > apoR) || radius < this.getPeriapsisRadius()) {\r\n            return false;\r\n        }\r\n        const ta = Math.acos((this._sma * (1.0 - this._ecc * this._ecc) / radius - 1) / this._ecc);\r\n        return [ta, TWO_PI - ta];\r\n    }\r\n\r\n    getPlaneCrossingTrueAnomaly(distanceToPlane) {\r\n        const a = this._sma * (1 - this._ecc * this._ecc) * Math.sin(this._inc) / distanceToPlane;\r\n        const b = this._ecc;\r\n        const c = Math.cos(this._aop);\r\n        const d = Math.sin(this._aop);\r\n        let taHigh = this._planeCrossingHelper( a * c,  a * d - b);  // top boundary\r\n        let taLow  = this._planeCrossingHelper(-a * c, -a * d - b);  // bottom boundary\r\n        let range1 = null;\r\n        let range2 = null;\r\n\r\n        if (taHigh === false && taLow === false) {\r\n            return false;\r\n        }\r\n\r\n        if (this.isHyperbolic) {\r\n            if (taHigh instanceof Array) {\r\n                if (!taLow instanceof Array) {\r\n                    return [taHigh];\r\n                }\r\n                return [\r\n                    [Math.min(taHigh[0], taLow[0]), Math.max(taHigh[0], taLow[0])],\r\n                    [Math.min(taHigh[1], taLow[1]), Math.max(taHigh[1], taLow[1])]\r\n                ];\r\n            }\r\n            if (taLow instanceof Array) {\r\n                return [taLow];\r\n            }\r\n            if (taHigh !== false && taLow !== false) {\r\n                return [[Math.min(taLow, taHigh), Math.max(taLow, taHigh)]];\r\n            }\r\n            // TODO implement\r\n            // this is a rare case where either taHigh or taLow is a number,\r\n            // which means that hyperbola asymptote is parallel to the horizontal plane\r\n            console.log('Error! getPlaneCrossingTrueAnomaly() not implemented!');\r\n            return false;\r\n        }\r\n\r\n        if (taHigh !== false) {\r\n            if (((this._aop + taHigh[0]) % TWO_PI) < ((this._aop + taHigh[1]) % TWO_PI)) {\r\n                range1 = [taHigh[1], taHigh[0]];\r\n            } else {\r\n                range1 = [taHigh[0], taHigh[1]];\r\n            }\r\n        }\r\n\r\n        if (taLow !== false) {\r\n            if (((this._aop + taLow[0]) % TWO_PI) < ((this._aop + taLow[1]) % TWO_PI)) {\r\n                range2 = [taLow[1], taLow[0]];\r\n            } else {\r\n                range2 = [taLow[0], taLow[1]];\r\n            }\r\n            return range1\r\n                ? [\r\n                    [range1[0], range2[1]],\r\n                    [range2[0], range1[1]]\r\n                ]\r\n                : [range2];\r\n        }\r\n\r\n        return [range1];\r\n    }\r\n\r\n    _planeCrossingHelper(a, b) {\r\n        const temp1 = a*a + b*b;\r\n        const temp2 = Math.sqrt(a*a * (temp1 - 1));\r\n        let ta1 = Math.atan2(\r\n            ((b * temp2 - b*b) / temp1 + 1) / a,\r\n            (b - temp2) / temp1\r\n        );\r\n\r\n        if (isNaN(ta1)) {\r\n            return false;\r\n        }\r\n\r\n        let ta2 = Math.atan2(\r\n            ((-b * temp2 - b*b) / temp1 + 1) / a,\r\n            (b + temp2) / temp1\r\n        );\r\n        if (this.isElliptic) {\r\n            return [\r\n                ta1 < 0 ? ta1 + TWO_PI : ta1,\r\n                ta2 < 0 ? ta2 + TWO_PI : ta2\r\n            ];\r\n        } else {\r\n            const asymptote = this.getAsymptoteTa();\r\n            ta1 = this._validateHyperbolicTa(asymptote, ta1);\r\n            ta2 = this._validateHyperbolicTa(asymptote, ta2);\r\n            if (ta1 !== false && ta2 !== false && ta1 !== ta2) {\r\n                return [Math.min(ta1, ta2), Math.max(ta1, ta2)];\r\n            } else if (ta1 !== false) {\r\n                return ta1;\r\n            } else if (ta2 !== false) {\r\n                return ta2;\r\n            } else {\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n\r\n    _validateHyperbolicTa(asymptote, ta) {\r\n        if (ta > Math.PI) {\r\n            ta -= TWO_PI;\r\n        }\r\n        if (ta > asymptote || ta < -asymptote) {\r\n            return false;\r\n        }\r\n        if (Math.abs(ta - Math.sign(ta) * asymptote) < 1e-14) {\r\n            return false;\r\n        }\r\n        return ta;\r\n    }\r\n\r\n    /**\r\n     *  @see http://microsat.sm.bmstu.ru/e-library/Ballistics/kepler.pdf\r\n     */\r\n    getStateByEpoch(epoch) {\r\n        if (this.isElliptic) {\r\n            const ea = this.getEccentricAnomalyByEpoch(epoch);\r\n            const cos = Math.cos(ea);\r\n            const sin = Math.sin(ea);\r\n            const koeff = Math.sqrt(this._mu / this._sma) / (1 - this._ecc * cos);\r\n\r\n            let pos = new Vector([\r\n                this._sma * (cos - this._ecc),\r\n                this._sma * Math.sqrt(1 - this._ecc * this._ecc) * sin,\r\n                0\r\n            ]);\r\n\r\n            let vel = new Vector([\r\n                -koeff * sin,\r\n                koeff * Math.sqrt(1 - this._ecc * this._ecc) * cos,\r\n                0\r\n            ]);\r\n\r\n            return new StateVector(\r\n                pos.rotateZ(this._aop).rotateX(this._inc).rotateZ(this._raan),\r\n                vel.rotateZ(this._aop).rotateX(this._inc).rotateZ(this._raan)\r\n            );\r\n        } else {\r\n            const ta = this.getTrueAnomalyByEpoch(epoch);\r\n            const orbitalQuat = this.getOrbitalFrameQuaternion();\r\n            const pos = this.getOwnCoordsByTrueAnomaly(ta);\r\n            const flightPathAngle = Math.atan(this._ecc * Math.sin(ta) / (1 + this._ecc * Math.cos(ta)));\r\n            let vel = new Vector([Math.sqrt(this._mu * (2 / pos.mag - 1 / this._sma)), 0, 0]);\r\n\r\n            return new StateVector(\r\n                orbitalQuat.rotate_(pos),\r\n                orbitalQuat.rotate_(vel.rotateZ(ta + Math.PI / 2 - flightPathAngle)),\r\n            );\r\n        }\r\n    }\r\n\r\n    getNormalVector() {\r\n        const nodeQuaternion = new Quaternion(new Vector([0, 0, 1]), this._raan);\r\n        const normalQuaternion = new Quaternion(nodeQuaternion.rotate_(new Vector([1, 0, 0])), this._inc);\r\n\r\n        return normalQuaternion.rotate_(new Vector([0, 0, 1]));\r\n    }\r\n\r\n    getPeriapsisVector() {\r\n        return this.getOrbitalFrameQuaternion().rotate_(new Vector([1, 0, 0]));\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @returns {Quaternion}\r\n     */\r\n    getOrbitalFrameQuaternion() {\r\n        return (new Quaternion(new Vector([0, 0, 1]), this._raan))\r\n            .mul_(new Quaternion(new Vector([1, 0, 0]), this._inc))\r\n            .mul_(new Quaternion(new Vector([0, 0, 1]), this._aop))\r\n        ;\r\n    }\r\n\r\n    /**\r\n     *  @see http://microsat.sm.bmstu.ru/e-library/Ballistics/kepler.pdf\r\n     */\r\n    static createFromState(state, mu, epoch) {\r\n        epoch = epoch || 0;\r\n\r\n        if (!state) {\r\n            return null;\r\n        }\r\n\r\n        const pos = state.position;\r\n        const vel = state.velocity;\r\n\r\n        const angMomentum = pos.cross(vel);\r\n\r\n        const raan = Math.atan2(angMomentum.x, -angMomentum.y);\r\n        const inc = Math.atan2((Math.sqrt(Math.pow(angMomentum.x, 2) + Math.pow(angMomentum.y, 2))) , angMomentum.z);\r\n        const sma = (mu * pos.mag) / (2.0 * mu - pos.mag * Math.pow(vel.mag, 2));\r\n        const e = Math.sqrt(1.0 - Math.min(1, Math.pow(angMomentum.mag, 2) / (mu * sma)));\r\n\r\n        const p = pos.rotateZ(-raan).rotateX(-inc);\r\n        const u = Math.atan2(p.y , p.x);\r\n\r\n        const radVel = pos.dot(vel);\r\n        const ta = Math.acos(Math.min(1, Math.max(-1, (sma*(1 - e*e) / pos.mag - 1) / e))) * Math.sign(radVel);\r\n\r\n        const aop = ((u - ta) > 0) ? (u - ta) : 2 * Math.PI + (u - ta);\r\n\r\n        return new KeplerianObject(e, sma, aop, inc, raan, ta, epoch, mu, true);\r\n    }\r\n\r\n}\r\n","import EphemerisObject from \"./EphemerisObject\";\r\n\r\nexport default class Body extends EphemerisObject\r\n{\r\n    constructor(bodyId, type, name, data, visualModel, physicalModel, orientation) {\r\n        super(bodyId, type, name, data);\r\n\r\n        this.visualModel   = visualModel;    // class VisualBodyModelBasic\r\n        this.physicalModel = physicalModel;  // class PhysicalBodyModel\r\n        this.orientation   = orientation;    // class OrientationAbstract\r\n\r\n        if (this.visualModel) {\r\n            this.visualModel.setObject(this);\r\n        }\r\n    }\r\n\r\n    drop() {\r\n        if (this.visualModel) {\r\n            this.visualModel.drop();\r\n            delete this.visualModel;\r\n        }\r\n        super.drop();\r\n    }\r\n}\r\n","import FunctionOfEpochAbstract from \"./Abstract\";\r\n\r\nexport default class Constant extends FunctionOfEpochAbstract\r\n{\r\n    constructor(value) {\r\n        super();\r\n        this.value = value;\r\n    }\r\n\r\n    evaluate(epoch) {\r\n        return this.value;\r\n    }\r\n}","import TrajectoryKeplerianAbstract from \"./KeplerianAbstract\";\r\n\r\nexport default class TrajectoryKeplerianBasic extends TrajectoryKeplerianAbstract\r\n{\r\n    constructor(referenceFrameId, keplerianObject) {\r\n        super(referenceFrameId);\r\n        this.keplerianObject = keplerianObject;\r\n    }\r\n\r\n    dump() {\r\n        return {\r\n            referenceFrame: this.referenceFrame.id,\r\n            keplerianObject: this.keplerianObject.dump(),\r\n            visualModel: this.visualModel.config,\r\n            minEpoch: this.minEpoch,\r\n            maxEpoch: this.maxEpoch,\r\n        };\r\n    }\r\n\r\n    onUpdate(callback) {\r\n        this.keplerianObject.setUpdateCallback(() => callback(this));\r\n        return this;\r\n    }\r\n\r\n    get mu() {\r\n        return this.keplerianObject.mu;\r\n    }\r\n\r\n    set mu(value) {\r\n        this.keplerianObject.mu = value;\r\n    }\r\n\r\n    get sma() {\r\n        return this.keplerianObject.sma;\r\n    }\r\n\r\n    set sma(value) {\r\n        this.keplerianObject.sma = value;\r\n    }\r\n\r\n    get ecc() {\r\n        return this.keplerianObject.ecc;\r\n    }\r\n\r\n    set ecc(value) {\r\n        this.keplerianObject.ecc = value;\r\n    }\r\n\r\n    get inc() {\r\n        return this.keplerianObject.inc;\r\n    }\r\n\r\n    set inc(value) {\r\n        this.keplerianObject.inc = value;\r\n    }\r\n\r\n    get raan() {\r\n        return this.keplerianObject.raan;\r\n    }\r\n\r\n    set raan(value) {\r\n        this.keplerianObject.raan = value;\r\n    }\r\n\r\n    get aop() {\r\n        return this.keplerianObject.aop;\r\n    }\r\n\r\n    set aop(value) {\r\n        this.keplerianObject.aop = value;\r\n    }\r\n\r\n    get ta() {\r\n        return this.keplerianObject.ta;\r\n    }\r\n\r\n    set ta(value) {\r\n        this.keplerianObject.ta = value;\r\n    }\r\n\r\n    get epoch() {\r\n        return this.keplerianObject.epoch;\r\n    }\r\n\r\n    set epoch(value) {\r\n        this.keplerianObject.epoch = value;\r\n    }\r\n\r\n    get period() {\r\n        return this.keplerianObject.period;\r\n    }\r\n\r\n    getKeplerianObjectByEpoch(epoch, referenceFrameOrId) {\r\n        this.validateEpoch(epoch);\r\n        return this._transformKeplerianObject(this.keplerianObject, referenceFrameOrId);\r\n    }\r\n}\r\n","import * as THREE from \"three\";\r\n\r\nimport VisualTrajectoryModelAbstract from \"./Abstract\";\r\nimport {RF_BASE_OBJ} from \"../../ReferenceFrame/Factory\";\r\nimport {acosSigned, isInInterval, TWO_PI, Vector} from \"../../algebra\";\r\nimport ReferenceFrameInertial from \"../../ReferenceFrame/Inertial\";\r\nimport { sim } from \"../../Simulation\";\r\nimport Constant from \"../../FunctionOfEpoch/Constant\";\r\nimport StateVector from \"../../StateVector\";\r\nimport VisualMarkerPericenter from \"../Marker/Pericenter\";\r\nimport VisualMarkerApocenter from \"../Marker/Apocenter\";\r\n\r\nexport default class VisualTrajectoryKeplerian extends VisualTrajectoryModelAbstract\r\n{\r\n    constructor(trajectory, config) {\r\n        super(trajectory, config);\r\n        this.showFull = !!config.showFull;\r\n        this.trailPeriod = config.trailPeriod || false;\r\n        this.lastPositionEpoch = false;\r\n        this.lastFrameEpoch = false;\r\n        this._markers.per = new VisualMarkerPericenter(this.threeObj, this.config.color);\r\n        this._markers.apo = new VisualMarkerApocenter(this.threeObj, this.config.color);\r\n        this._markers.per.setScale(0.5);\r\n        this._markers.apo.setScale(0.5);\r\n    }\r\n\r\n    render(epoch) {\r\n        super.render(epoch);\r\n\r\n        const positionEpoch = this.getPositionEpoch(epoch);\r\n\r\n        if (positionEpoch === false) {\r\n            this.threeObj.visible = false;\r\n            return;\r\n        }\r\n\r\n        this.lastPositionEpoch = positionEpoch;\r\n        this.lastFrameEpoch = epoch;\r\n\r\n        const keplerianObject = this.trajectory.getKeplerianObjectByEpoch(positionEpoch);\r\n\r\n        if (keplerianObject.isElliptic) {\r\n            this.renderEllipse(keplerianObject, positionEpoch, epoch);\r\n        } else {\r\n            this.renderHyperbola(keplerianObject, positionEpoch, epoch);\r\n        }\r\n    }\r\n\r\n    getEpochByPoint(point) {\r\n        const frame = this.trajectory.getReferenceFrameByEpoch(this.lastFrameEpoch);\r\n        let framePos = frame.stateVectorFromBaseReferenceFrameByEpoch(this.lastFrameEpoch, new StateVector(point))._position;\r\n        const keplerianObject = this.trajectory.getKeplerianObjectByEpoch(this.lastPositionEpoch);\r\n        keplerianObject.getOrbitalFrameQuaternion().invert_().rotate_(framePos);\r\n        return keplerianObject.getEpochByTrueAnomaly(Math.atan2(framePos.y, framePos.x));\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param traj {KeplerianObject} - orbit to be rendered\r\n     * @param positionEpoch {float} - moment in time that specifies the position in orbit relative to its reference frame\r\n     * @param frameEpoch {float} - moment in time that specifies the position of the reference frame\r\n     */\r\n    renderHyperbola(traj, positionEpoch, frameEpoch) {\r\n        const endingBrightness = 0.35;\r\n        const pointsNum = 100;\r\n\r\n        let maxTa = traj.getAsymptoteTa() - 0.02;\r\n        let minTa = -maxTa;\r\n\r\n        if (this.trajectory.minEpoch !== false) {\r\n            minTa = traj.getTrueAnomalyByEpoch(this.trajectory.minEpoch);\r\n        }\r\n        if (this.trajectory.maxEpoch !== false) {\r\n            maxTa = traj.getTrueAnomalyByEpoch(this.trajectory.maxEpoch);\r\n        }\r\n\r\n        const orbitQuaternion = this.trajectory.pericentricReferenceFrame.getQuaternionByEpoch(positionEpoch);\r\n        const curTa = traj.getTrueAnomalyByEpoch(positionEpoch);\r\n\r\n        let points = [];\r\n        let angs = [];\r\n        let ta = minTa;\r\n        let i = 0;\r\n\r\n        if (ta > (minTa + curTa) / 2) {\r\n            ta = (minTa + curTa) / 2;\r\n        }\r\n\r\n        const taStep = (Math.max(maxTa, curTa) - ta) / (pointsNum - 1);\r\n        let extraPoints = 0;\r\n\r\n        while (i < pointsNum + extraPoints) {\r\n            let coords = traj.getOwnCoordsByTrueAnomaly(ta);\r\n            points[i] = (new THREE.Vector2()).fromArray([coords[0], coords[1]]);\r\n            angs[i] = (ta > curTa) ? 0 : ((curTa == minTa) ? 1 : (ta - minTa) / (curTa - minTa));\r\n            i  += 1;\r\n            ta += taStep;\r\n\r\n            if (ta - taStep <= curTa && curTa < ta) {\r\n                coords = traj.getOwnCoordsByTrueAnomaly(curTa);\r\n                points[i] = (new THREE.Vector2()).fromArray([coords[0], coords[1]]);\r\n                angs[i] = 1;\r\n                i  += 1;\r\n                points[i] = (new THREE.Vector2()).fromArray([coords[0], coords[1]]);\r\n                angs[i] = 0;\r\n                i  += 1;\r\n                extraPoints += 2;\r\n            }\r\n        }\r\n\r\n        this.updateGeometry(points, angs, endingBrightness);\r\n\r\n        this.threeObj.quaternion.copy(orbitQuaternion.toThreejs());\r\n        this.setPosition(this.trajectory.getReferenceFrameByEpoch(frameEpoch).getOriginPositionByEpoch(frameEpoch));\r\n\r\n        this._markers.apo.disable();\r\n        if (curTa > 0 && curTa < Math.PI) {\r\n            this._markers.per.disable();\r\n        } else {\r\n            this._markers.per.enable();\r\n            this._markers.per.setPosition(new THREE.Vector3(traj.getPeriapsisRadius(), 0, 0));\r\n        }\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param traj {KeplerianObject} - orbit to be rendered\r\n     * @param positionEpoch {float} - moment in time that specifies the position in orbit relative to its reference frame\r\n     * @param frameEpoch {float} - moment in time that specifies the position of the reference frame\r\n     */\r\n    renderEllipse(traj, positionEpoch, frameEpoch) {\r\n        const endingBrightness = 0.35;\r\n        const pointsNum = 100;\r\n\r\n        const orbitQuaternion = this.trajectory.pericentricReferenceFrame.getQuaternionByEpoch(positionEpoch);\r\n\r\n        // Main working RF. We take reference frame of the object\r\n        // at epoch and look at its position at locationEpoch\r\n        const referenceFrame = new ReferenceFrameInertial(\r\n            new Constant(this.trajectory.getReferenceFrameByEpoch(positionEpoch).getOriginStateByEpoch(frameEpoch)),\r\n            orbitQuaternion\r\n        );\r\n\r\n        // Camera position relative to main reference frame\r\n        const relativeCameraPosition = RF_BASE_OBJ.transformPositionByEpoch(frameEpoch, sim.camera.lastPosition, referenceFrame);\r\n\r\n        // Camera position projected onto the plane of the orbit, relative to main reference frame\r\n        const projectedRelativeCameraPosition = new Vector([relativeCameraPosition.x, relativeCameraPosition.y, 0]);\r\n\r\n        // Camera position projected onto the plane of the orbit, in global coordinates\r\n        const projectedCameraPosition = referenceFrame.transformPositionByEpoch(frameEpoch, projectedRelativeCameraPosition, RF_BASE_OBJ);\r\n\r\n        // True anomaly of the camera\r\n        const cameraTrueAnomaly = acosSigned(\r\n            projectedRelativeCameraPosition.x / projectedRelativeCameraPosition.mag,\r\n            projectedRelativeCameraPosition.y\r\n        );\r\n\r\n        const toClosestPoint = traj.getOwnCoordsByTrueAnomaly(cameraTrueAnomaly)                // not really closest\r\n            .sub_(relativeCameraPosition).mag;\r\n        const toFarthestPoint = traj.getOwnCoordsByTrueAnomaly(cameraTrueAnomaly + Math.PI)     // not really farthest\r\n            .sub_(relativeCameraPosition).mag;\r\n\r\n        let cameraAngle = traj.getEccentricAnomalyByTrueAnomaly(cameraTrueAnomaly);\r\n        let ang = traj.getEccentricAnomalyByEpoch(positionEpoch);\r\n        let minAnglePart = 0;\r\n        let maxAnglePart = 1;\r\n\r\n        if (!this.trailPeriod) {\r\n            this._markers.per.enable();\r\n            this._markers.per.setPosition(new THREE.Vector3(traj.getPeriapsisRadius() - projectedRelativeCameraPosition.x, -projectedRelativeCameraPosition.y, 0));\r\n            this._markers.apo.enable();\r\n            this._markers.apo.setPosition(new THREE.Vector3(-traj.getApoapsisRadius() - projectedRelativeCameraPosition.x, -projectedRelativeCameraPosition.y, 0));\r\n        }\r\n\r\n        // if there's less then one orbit left\r\n        if (this.trailPeriod) {\r\n            let minEpoch = positionEpoch - this.trailPeriod;\r\n            if (this.trajectory.minEpoch !== false && this.trajectory.minEpoch > minEpoch) {\r\n                minEpoch = this.trajectory.minEpoch;\r\n            }\r\n            this._markers.per.disable();\r\n            this._markers.apo.disable();\r\n            minAnglePart = 1 - (((ang - traj.getEccentricAnomalyByEpoch(minEpoch)) + TWO_PI) % TWO_PI) / TWO_PI;\r\n            maxAnglePart = 1;\r\n        } else if (!this.showFull\r\n            && this.trajectory.maxEpoch !== false\r\n            && (this.trajectory.maxEpoch - positionEpoch) < traj.period\r\n        ) {\r\n            // rendering a part of ellipse\r\n            const maxAng = traj.getEccentricAnomalyByEpoch(this.trajectory.maxEpoch);\r\n            maxAnglePart = (((maxAng - ang) + TWO_PI) % TWO_PI) / TWO_PI;\r\n\r\n            const maxMa = traj.getMeanAnomalyByEpoch(this.trajectory.maxEpoch);\r\n            const curMa = traj.getMeanAnomalyByEpoch(positionEpoch);\r\n            if (!isInInterval(0, [curMa, maxMa])) {\r\n                this._markers.per.disable();\r\n            }\r\n            if (!isInInterval(Math.PI, [curMa, maxMa])) {\r\n                this._markers.apo.disable();\r\n            }\r\n        }\r\n\r\n        const ellipsePoints = this.getEllipsePoints(\r\n            new THREE.EllipseCurve(\r\n                -traj.sma * traj.ecc - projectedRelativeCameraPosition.x,\r\n                -projectedRelativeCameraPosition.y,\r\n                traj.sma,\r\n                traj.sma * Math.sqrt(1 - traj.ecc * traj.ecc),\r\n                ang,\r\n                TWO_PI + ang - 1e-13,  // protection from rounding errors\r\n                false,\r\n                0\r\n            ),\r\n            pointsNum,\r\n            ((cameraAngle - ang) / TWO_PI + 1) % 1,\r\n            toFarthestPoint / toClosestPoint,\r\n            minAnglePart,\r\n            maxAnglePart\r\n        );\r\n\r\n        this.updateGeometry(ellipsePoints.coords, ellipsePoints.angs, endingBrightness);\r\n\r\n        this.threeObj.quaternion.copy(orbitQuaternion.toThreejs());\r\n        this.setPosition(projectedCameraPosition);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param curve {EllipseCurve} - instance of THREE.EllipseCurve\r\n     * @param pointsNum {int} - number of points to get (or less, if maxAnglePart is less than 1)\r\n     * @param densityCenter {number} - part of the angle (from 0 to 1) closest to the camera,\r\n     *                                which means this area should have more points\r\n     * @param proportion {number} - point density difference between densityCenter and\r\n     *                              the opposite side of the ellipse\r\n     * @param minAnglePart {number} - must be between 0 and 1, where 1 means two pi.\r\n     * @param maxAnglePart {number} - must be between 0 and 1, where 1 means two pi.\r\n     * @returns {{coords: Array, angs: Array}}\r\n     */\r\n    getEllipsePoints(curve, pointsNum, densityCenter, proportion, minAnglePart, maxAnglePart) {\r\n        let nearSegmentSize = 0.25;\r\n        if (proportion > 30) {\r\n            nearSegmentSize = 1 / Math.min(proportion / 60 + 3.5, 12);\r\n            proportion = 30;\r\n        }\r\n\r\n        let coords = [];\r\n        let angs = [];\r\n        const segments = pointsNum - 3;\r\n        const otherSegmentsSize = (1 - nearSegmentSize) / 3;\r\n        const segmentsFar    = Math.floor(segments / (proportion + 2 * Math.sqrt(proportion) + 1));\r\n        const segmentsMedium = Math.floor(Math.sqrt(proportion) * segmentsFar);\r\n        const segmentsNear   = segments - segmentsFar - 2 * segmentsMedium;\r\n        let segmentBounds = [0,0,0,0,0];\r\n        let segmentSteps = [\r\n            nearSegmentSize/segmentsNear,\r\n            otherSegmentsSize/segmentsMedium,\r\n            otherSegmentsSize/segmentsFar,\r\n            otherSegmentsSize/segmentsMedium\r\n        ];\r\n        let curPos = minAnglePart;\r\n\r\n        segmentBounds[0] = densityCenter - nearSegmentSize / 2;\r\n        if (segmentBounds[0] < 0)\r\n            segmentBounds[0] += 1;\r\n        segmentBounds[1] = segmentBounds[0] + nearSegmentSize;\r\n        if (segmentBounds[1] > 1)\r\n            segmentBounds[1] -= 1;\r\n        for (let i = 2; i <= 4; ++i) {\r\n            segmentBounds[i] = segmentBounds[i - 1] + otherSegmentsSize;\r\n            if (segmentBounds[i] > 1)\r\n                segmentBounds[i] -= 1;\r\n        }\r\n\r\n        while (curPos < maxAnglePart) {\r\n            if (curPos >= minAnglePart) {\r\n                coords.push(curve.getPoint(curPos));\r\n                angs.push((curPos - minAnglePart) / (maxAnglePart - minAnglePart));\r\n            }\r\n            let i = 0;\r\n            while (i < 4) {\r\n                if ((segmentBounds[i+1] > segmentBounds[i]\r\n                    && (segmentBounds[i] <= curPos && curPos < segmentBounds[i+1]))\r\n                    || (segmentBounds[i+1] < segmentBounds[i]\r\n                        && (segmentBounds[i] <= curPos || curPos < segmentBounds[i+1]))\r\n                ) {\r\n                    break;\r\n                }\r\n                ++i;\r\n            }\r\n            curPos += segmentSteps[i];\r\n        }\r\n        coords.push(curve.getPoint(maxAnglePart));\r\n        angs.push(maxAnglePart);\r\n\r\n        return {\r\n            coords: coords,\r\n            angs: angs\r\n        }\r\n    }\r\n}\r\n","import {Quaternion, Vector} from \"../algebra\";\r\nimport StateVector from \"../StateVector\";\r\nimport {RF_BASE} from \"./Factory\";\r\nimport ReferenceFrameFactory from \"./Factory\";\r\nimport { sim } from \"../Simulation\";\r\n\r\nexport default class ReferenceFrameAbstract\r\n{\r\n    setId(id) {\r\n        this.id = id;\r\n        this.originId = ReferenceFrameFactory.getOriginIdByReferenceFrameId(id);\r\n        this.type = ReferenceFrameFactory.getTypeByReferenceFrameId(id);\r\n        return this;\r\n    }\r\n\r\n    get mu() {\r\n        if (this._mu === undefined) {\r\n            const obj = sim.starSystem.getObject(this.originId);\r\n            this._mu = obj.physicalModel\r\n                ? obj.physicalModel.mu\r\n                : null;\r\n        }\r\n        return this._mu;\r\n    }\r\n\r\n    getQuaternionByEpoch(epoch) {\r\n        return new Quaternion();\r\n    }\r\n\r\n    getOriginPositionByEpoch(epoch) {\r\n        return new Vector(3);\r\n    }\r\n\r\n    getOriginStateByEpoch(epoch) {\r\n        return new StateVector();\r\n    }\r\n\r\n    transformStateVectorByEpoch(epoch, state, destinationFrameOrId) {\r\n        let destinationFrame = (destinationFrameOrId instanceof ReferenceFrameAbstract)\r\n            ? destinationFrameOrId\r\n            : sim.starSystem.getReferenceFrame(destinationFrameOrId);\r\n\r\n        if (this === destinationFrame) {\r\n            return state;\r\n        }\r\n\r\n        if (this.id === RF_BASE) {\r\n            return destinationFrame.stateVectorFromBaseReferenceFrameByEpoch(\r\n                epoch,\r\n                state\r\n            );\r\n        }\r\n\r\n        if (destinationFrame.id === RF_BASE) {\r\n            return this.stateVectorToBaseReferenceFrameByEpoch(epoch, state);\r\n        }\r\n\r\n        return destinationFrame.stateVectorFromBaseReferenceFrameByEpoch(\r\n            epoch,\r\n            this.stateVectorToBaseReferenceFrameByEpoch(epoch, state)\r\n        );\r\n    }\r\n\r\n    transformPositionByEpoch(epoch, pos, destinationFrameOrId) {\r\n        return this.transformStateVectorByEpoch(\r\n            epoch,\r\n            new StateVector(pos),\r\n            destinationFrameOrId\r\n        ).position;\r\n    }\r\n\r\n    rotateVectorByEpoch(epoch, vec, destinationFrameOrId) {\r\n        let destinationFrame = (destinationFrameOrId instanceof ReferenceFrameAbstract)\r\n            ? destinationFrameOrId\r\n            : sim.starSystem.getReferenceFrame(destinationFrameOrId);\r\n\r\n        if (this === destinationFrame) {\r\n            return vec.copy();\r\n        }\r\n\r\n        return destinationFrame.getQuaternionByEpoch(epoch).invert_().mul_(this.getQuaternionByEpoch(epoch)).rotate(vec);\r\n    }\r\n\r\n    stateVectorFromBaseReferenceFrameByEpoch(epoch, state) {}\r\n    stateVectorToBaseReferenceFrameByEpoch(epoch, state) {}\r\n}\r\n","\r\nimport FlightEventAbstract from \"./Abstract\";\r\nimport VisualFlightEventImpulsiveBurn from \"../visual/FlightEvent/ImpulsiveBurn\";\r\n\r\n/**\r\n * Public fields:\r\n *      vector {Vector} - [prograde, normal, radial]\r\n *      prograde {Number}\r\n *      normal {Number}\r\n *      radial {Number}\r\n */\r\nexport default class FlightEventImpulsiveBurn extends FlightEventAbstract\r\n{\r\n    static VISUAL_CLASS = VisualFlightEventImpulsiveBurn;\r\n\r\n    constructor(epoch, vector) {\r\n        super(epoch);\r\n        this._vector = vector || false;\r\n        this.deltaV = vector ? vector.mag : 0;\r\n    }\r\n\r\n    _update(old) {\r\n        this.deltaV = this._vector.mag;\r\n        this._updateCallback && this._updateCallback(this, old);\r\n    }\r\n\r\n    set(flightEvent) {\r\n        super.set(flightEvent);\r\n        this._vector = flightEvent.vector;\r\n        this.deltaV = this._vector.mag;\r\n        return this;\r\n    }\r\n\r\n    set vector(vector) {\r\n        const old = this.copy();\r\n        this._vector = vector;\r\n        this._update(old);\r\n    }\r\n\r\n    get vector() {\r\n        return this._vector.copy();\r\n    }\r\n\r\n    set prograde(value) {\r\n        const old = this.copy();\r\n        this._vector[0] = value;\r\n        this._update(old);\r\n    }\r\n\r\n    get prograde() {\r\n        return this._vector[0];\r\n    }\r\n\r\n    set normal(value) {\r\n        const old = this.copy();\r\n        this._vector[1] = value;\r\n        this._update(old);\r\n    }\r\n\r\n    get normal() {\r\n        return this._vector[1];\r\n    }\r\n\r\n    set radial(value) {\r\n        const old = this.copy();\r\n        this._vector[2] = value;\r\n        this._update(old);\r\n    }\r\n\r\n    get radial() {\r\n        return this._vector[2];\r\n    }\r\n}\r\n","export default class FunctionOfEpochAbstract\r\n{\r\n    evaluate(epoch) {\r\n        return null;\r\n    }\r\n}\r\n","\r\nimport TrajectoryComposite from \"./Composite\";\r\nimport FlightEventImpulsiveBurn from \"../FlightEvent/ImpulsiveBurn\";\r\nimport {Vector} from \"../algebra\";\r\n\r\nexport default class TrajectoryDynamic extends TrajectoryComposite\r\n{\r\n    /**\r\n     *\r\n     * @param propagator {PropagatorAbstract}\r\n     */\r\n    constructor(propagator) {\r\n        super();\r\n        this.propagator = propagator;\r\n        this.updateHandlers = [];\r\n    }\r\n\r\n    dump() {\r\n        let dumpObj = {\r\n            components: [],\r\n            events: [],\r\n            visualModel: this.visualModel.config,\r\n            minEpoch: this.minEpoch,\r\n            maxEpoch: this.maxEpoch,\r\n        };\r\n        for (let component of this.components) {\r\n            dumpObj.components.push(component.dump());\r\n        }\r\n        for (let flightEvent of this.flightEvents) {\r\n            if (flightEvent instanceof FlightEventImpulsiveBurn) {\r\n                dumpObj.events.push({\r\n                    epoch: flightEvent._epoch,\r\n                    x: flightEvent._vector[0],\r\n                    y: flightEvent._vector[1],\r\n                    z: flightEvent._vector[2],\r\n                });\r\n            }\r\n        }\r\n        return dumpObj;\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param trajectory {TrajectoryAbstract}\r\n     */\r\n    addComponent(trajectory) {\r\n        if (this.components.length === 0) {\r\n            trajectory.isEditable = true;\r\n            trajectory.onUpdate(traj => this.propagate(traj.epoch));\r\n        }\r\n\r\n        super.addComponent(trajectory);\r\n\r\n        trajectory.onClick((pointEpoch) => {\r\n            this.addFlightEvent((new FlightEventImpulsiveBurn(\r\n                pointEpoch,\r\n                new Vector([0, 0, 0])\r\n            )).onUpdate((newEvent, oldEvent) => {\r\n                this.sortFlightEvents();\r\n                this.propagate(Math.min(oldEvent.epoch, newEvent.epoch));\r\n            }));\r\n            this.updateHandlers.map(h => h(this));\r\n        });\r\n    }\r\n\r\n    removeFlightEvent(flightEvent) {\r\n        super.removeFlightEvent(flightEvent);\r\n        if (flightEvent instanceof FlightEventImpulsiveBurn) {\r\n            this.propagator.propagate(this, flightEvent.epoch);\r\n        }\r\n    }\r\n\r\n    propagate(startEpoch) {\r\n        this.propagator.propagate(this, startEpoch);\r\n        this.updateHandlers.map(h => h(this));\r\n    }\r\n\r\n    onUpdate(handler) {\r\n        this.updateHandlers.push(handler);\r\n    }\r\n\r\n    removeListener(handler) {\r\n        for (let i in this.updateHandlers) {\r\n            if (this.updateHandlers[i] === handler) {\r\n                this.updateHandlers = this.updateHandlers.splice(i, 1);\r\n                break;\r\n            }\r\n        }\r\n    }\r\n}\r\n","\r\nimport VisualFlightEventSOIDeparture from \"../visual/FlightEvent/SOIDeparture\";\r\nimport FlightEventSOIChangeAbstract from \"./SOIChangeAbstract\";\r\n\r\nexport default class FlightEventSOIDeparture extends FlightEventSOIChangeAbstract\r\n{\r\n    static VISUAL_CLASS = VisualFlightEventSOIDeparture;\r\n}\r\n","\r\nimport VisualFlightEventSOIArrival from \"../visual/FlightEvent/SOIArrival\";\r\nimport FlightEventSOIChangeAbstract from \"./SOIChangeAbstract\";\r\n\r\nexport default class FlightEventSOIArrival extends FlightEventSOIChangeAbstract\r\n{\r\n    static VISUAL_CLASS = VisualFlightEventSOIArrival;\r\n}\r\n","import TrajectoryAbstract from \"./Abstract\";\r\nimport ExceptionOutOfRange from \"./ExceptionOutOfRange\";\r\n\r\nexport default class TrajectoryComposite extends TrajectoryAbstract\r\n{\r\n    constructor() {\r\n        super();\r\n        this.components = [];\r\n        this.lastUsedTrajectory = null;\r\n    }\r\n\r\n    select() {\r\n        this.isSelected = true;\r\n        if (this.selectedVisualModel) {\r\n            this.visualModel.hide();\r\n            this.selectedVisualModel.show();\r\n            this.selectedVisualModel.select();\r\n        } else {\r\n            this.visualModel && this.visualModel.select();\r\n        }\r\n        this.components.map(traj => traj.select());\r\n    }\r\n\r\n    deselect() {\r\n        super.deselect();\r\n        this.components.map(traj => traj.deselect());\r\n    }\r\n\r\n    drop() {\r\n        super.drop();\r\n        this.components.map(traj => traj.drop());\r\n    }\r\n\r\n    setObject(object) {\r\n        super.setObject(object);\r\n        this.components.map(traj => traj.setObject(object));\r\n    }\r\n\r\n    getReferenceFrameByEpoch(epoch) {\r\n        return this.getComponentByEpoch(epoch).getReferenceFrameByEpoch(epoch);\r\n    }\r\n\r\n    getStateInOwnFrameByEpoch(epoch) {\r\n        return this.getComponentByEpoch(epoch).getStateInOwnFrameByEpoch(epoch);\r\n    }\r\n\r\n    getKeplerianObjectByEpoch(epoch) {\r\n        return this.getComponentByEpoch(epoch).getKeplerianObjectByEpoch(epoch);\r\n    }\r\n\r\n    getStateByEpoch(epoch, referenceFrameOrId, frameEpoch = null) {\r\n        return this.getComponentByEpoch(epoch).getStateByEpoch(epoch, referenceFrameOrId, frameEpoch);\r\n    }\r\n\r\n    getComponentByEpoch(epoch, noCache) {\r\n        if (!noCache && this.lastUsedTrajectory\r\n            && (this.lastUsedTrajectory.minEpoch === false || this.lastUsedTrajectory.minEpoch <= epoch)\r\n            && (this.lastUsedTrajectory.maxEpoch === false || this.lastUsedTrajectory.maxEpoch >= epoch)\r\n        ) {\r\n            return this.lastUsedTrajectory;\r\n        }\r\n\r\n        for (let trajectory of this.components) {\r\n            if (trajectory.isValidAtEpoch(epoch)) {\r\n                this.lastUsedTrajectory = trajectory;\r\n                return trajectory;\r\n            }\r\n        }\r\n\r\n        throw new ExceptionOutOfRange(this.object, this, epoch, this.minEpoch, this.maxEpoch);\r\n    }\r\n\r\n    addComponent(trajectory) {\r\n        this.components.push(trajectory);\r\n        trajectory.setParent(this);\r\n        trajectory.setObject(this.object);\r\n\r\n        if (this.isSelected) {\r\n            trajectory.select();\r\n        }\r\n\r\n        if (this.minEpoch === false\r\n            || (trajectory.minEpoch !== false\r\n                && this.minEpoch > trajectory.minEpoch\r\n            )\r\n        ) {\r\n            this.minEpoch = trajectory.minEpoch;\r\n        }\r\n        if (this.maxEpoch === false\r\n            || (trajectory.maxEpoch !== false\r\n                && this.maxEpoch < trajectory.maxEpoch\r\n            )\r\n        ) {\r\n            this.maxEpoch = trajectory.maxEpoch;\r\n        }\r\n    }\r\n\r\n    clearAfterEpoch(epoch) {\r\n        while (this.components[this.components.length - 1].minEpoch >= epoch) {\r\n            this.components[this.components.length - 1].drop();\r\n            this.components.pop();\r\n        }\r\n        for (let component of this.components) {\r\n            if (component.maxEpoch === false || component.maxEpoch > epoch) {\r\n                component.clearAfterEpoch(epoch);\r\n            }\r\n        }\r\n        this.lastUsedTrajectory = null;\r\n    }\r\n}\r\n","\r\nimport FlightEventAbstract from \"../../../core/FlightEvent/Abstract\";\r\n\r\nexport default class FlightEventSOIChangeAbstract extends FlightEventAbstract\r\n{\r\n    constructor(epoch, oldSoi, newSoi) {\r\n        super(epoch);\r\n        this.oldSoi = oldSoi || false;\r\n        this.newSoi = newSoi || false;\r\n    }\r\n\r\n    set(flightEvent) {\r\n        super.set(flightEvent);\r\n        this.oldSoi = flightEvent.oldSoi;\r\n        this.newSoi = flightEvent.newSoi;\r\n        return this;\r\n    }\r\n}\r\n","\r\nimport VisualSpriteStatic from \"../SpriteStatic\";\r\nimport FunctionOfEpochCustom from \"../../FunctionOfEpoch/Custom\";\r\nimport {RF_BASE_OBJ} from \"../../ReferenceFrame/Factory\";\r\n\r\nexport default class VisualFlightEventAbstract extends VisualSpriteStatic\r\n{\r\n    constructor(trajectory, flightEvent, color) {\r\n        super(color);\r\n\r\n        this._flightEvent = flightEvent;\r\n        this._trajectory = trajectory;\r\n\r\n        this.setPositionOfEpoch(new FunctionOfEpochCustom(epoch => {\r\n            if (epoch > this._flightEvent.epoch) {\r\n                return false;\r\n            }\r\n            return this._trajectory.getPositionByEpoch(this._flightEvent.epoch, RF_BASE_OBJ, epoch)\r\n        }));\r\n    }\r\n}\r\n","import * as THREE from \"three\";\r\n\r\nimport VisualModelAbstract from \"../ModelAbstract\";\r\nimport LineObject from \"../LineObject\";\r\nimport { sim } from \"../../Simulation\";\r\n\r\nexport default class VisualTrajectoryAbstract extends VisualModelAbstract\r\n{\r\n    /**\r\n     * @param trajectory {TrajectoryAbstract}\r\n     * @param config {Object} Fields:\r\n     *      color            - base color of the trajectory\r\n     *      selectedColor    - color when selected\r\n     *      minEpoch/        - (float)   epoch, trajectory is not rendered before/after this moment.\r\n     *      maxEpoch           (false)   there's no limit. for times before/after\r\n     *                                   minEpoch/maxEpoch of the trajectory, minEpoch/maxEpoch\r\n     *                                   of the trajectory is used.\r\n     *                         ('copy')  minEpoch/maxEpoch of the trajectory is used\r\n     */\r\n    constructor(trajectory, config) {\r\n        super();\r\n\r\n        this.trajectory = trajectory;\r\n        this.color = config.color;\r\n        this.config = config;\r\n\r\n        this._isSelected = false;\r\n\r\n        this.initFlightEvents();\r\n\r\n        this._markers = {};\r\n        this._defaultMarkerScale  = 0.5;\r\n        this._selectedMarkerScale = 1;\r\n\r\n        this._minEpoch = (config.minEpoch !== undefined) ? config.minEpoch : (trajectory.minEpoch || false);\r\n        this._maxEpoch = (config.maxEpoch !== undefined) ? config.maxEpoch : (trajectory.maxEpoch || false);\r\n\r\n        if (this.constructor.NO_THREE_OBJ) {\r\n            return;\r\n        }\r\n\r\n        this.setThreeObj(new LineObject(\r\n            new THREE.Geometry(),\r\n            new THREE.LineBasicMaterial({vertexColors: THREE.VertexColors})\r\n        ));\r\n\r\n        this.point = new THREE.Mesh(\r\n            new THREE.SphereGeometry(1, 8, 8),\r\n            new THREE.MeshBasicMaterial({color: this.color})\r\n        );\r\n        this.scene.add(this.point);\r\n        this.pointSize = 4;\r\n\r\n        this.threeObj.userData = {selectionObject: () => this.trajectory.object};\r\n        sim.selection.addSelectableObject(this.threeObj);\r\n    }\r\n\r\n    get minEpoch() {\r\n        return (this._minEpoch === 'copy')\r\n            ? this.trajectory.minEpoch\r\n            : this._minEpoch;\r\n    }\r\n\r\n    get maxEpoch() {\r\n        return (this._maxEpoch === 'copy')\r\n            ? this.trajectory.maxEpoch\r\n            : this._maxEpoch;\r\n    }\r\n\r\n    getEpochByPoint(point) {\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param handler {Function} - this function is called when user clicks on the trajectory.\r\n     *                             Epoch that corresponds to the point under the mouse is passed\r\n     *                             as the only argument.\r\n     */\r\n    onClick(handler) {\r\n        this.threeObj.userData.onClick = (intersection) => handler(\r\n            this.getEpochByPoint(sim.getSimCoords(intersection.point))\r\n        );\r\n    }\r\n\r\n    initFlightEvents() {\r\n        this.flightEvents = [];\r\n        for (let event of this.trajectory.flightEvents) {\r\n            this.addFlightEvent(event);\r\n        }\r\n    }\r\n\r\n    addFlightEvent(flightEvent) {\r\n        const className = flightEvent.getVisualClass();\r\n        if (!className) {\r\n            return;\r\n        }\r\n        \r\n        let model = new className(this.trajectory, flightEvent, this.color);\r\n        if (!this.trajectory.isSelected) {\r\n            model.setScale(0.5);\r\n        }\r\n        flightEvent.visualModel = model;\r\n        this.flightEvents.push({\r\n            event: flightEvent,\r\n            model: model\r\n        });\r\n    }\r\n\r\n    removeFlightEvent(flightEvent) {\r\n        for (let i in this.flightEvents) {\r\n            if (this.flightEvents[i].event === flightEvent) {\r\n                this.flightEvents[i].model.drop();\r\n                this.flightEvents.splice(i, 1);\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    updateGeometry(points, colorMults, endingBrightness) {\r\n        const mainColor = new THREE.Color(this.color);\r\n        this.threeObj.geometry.dispose();\r\n        this.threeObj.geometry = (new THREE.Geometry()).setFromPoints(points);\r\n\r\n        for (let i = 0; i < colorMults.length; i++) {\r\n            let curColor = (new THREE.Color()).copy(mainColor);\r\n            const mult = endingBrightness + (1 - endingBrightness) * colorMults[i];\r\n\r\n            this.threeObj.geometry.colors.push(\r\n                curColor.multiplyScalar(mult)\r\n            );\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Returns moment in time to use to calculate position\r\n     * of the spacecraft relative to its reference frame.\r\n     * false means the trajectory is not rendered.\r\n     * @param epoch\r\n     * @returns {*}\r\n     */\r\n    getPositionEpoch(epoch) {\r\n        if ((this.minEpoch !== false && epoch < this.minEpoch)\r\n            || (this.maxEpoch !== false && epoch > this.maxEpoch)\r\n        ) {\r\n            return false;\r\n        }\r\n\r\n        if (this.trajectory.minEpoch !== false && epoch < this.trajectory.minEpoch) {\r\n            return this.trajectory.minEpoch;\r\n        }\r\n        if (this.trajectory.maxEpoch !== false && epoch > this.trajectory.maxEpoch) {\r\n            return this.trajectory.maxEpoch;\r\n        }\r\n\r\n        return epoch;\r\n    }\r\n\r\n    render(epoch) {\r\n        if (!this.trajectory.isValidAtEpoch(epoch) || this._isHidden) {\r\n            this.point.visible = false;\r\n            return;\r\n        }\r\n\r\n        this.point.position.copy(sim.getVisualCoords(this.trajectory.getPositionByEpoch(epoch)));\r\n        let scaleKoeff = this.pointSize * this.point.position.length() * this.pixelAngleSize;\r\n        const ko = this.trajectory.getKeplerianObjectByEpoch(epoch);\r\n\r\n        if (ko.isElliptic && ko.sma < scaleKoeff) {\r\n            this._updateMarkerScales(0);\r\n            this.point.visible = false;\r\n            return;\r\n        }\r\n\r\n        if (ko.isElliptic && scaleKoeff > ko.sma / 5) {\r\n            this._updateMarkerScales(ko.sma / 5 / scaleKoeff);\r\n            scaleKoeff = ko.sma / 5;\r\n        } else {\r\n            this._updateMarkerScales();\r\n        }\r\n\r\n        this.point.visible = true;\r\n        this.point.scale.x = scaleKoeff;\r\n        this.point.scale.y = scaleKoeff;\r\n        this.point.scale.z = scaleKoeff;\r\n    }\r\n\r\n    select() {\r\n        this._isSelected = true;\r\n        this.setColor(this.config.selectedColor || 0xFFFFFF);\r\n        this._updateScales();\r\n    }\r\n\r\n    deselect() {\r\n        this._isSelected = false;\r\n        this.setColor(this.config.color);\r\n        this._updateScales();\r\n    }\r\n\r\n    hide() {\r\n        super.hide();\r\n        this.point.visible = false;\r\n    }\r\n\r\n    _updateScales() {\r\n        for (let event of this.flightEvents) {\r\n            event.model.setScale(this._isSelected ? 1 : 0.5);\r\n        }\r\n        this._updateMarkerScales();\r\n    }\r\n\r\n    _updateMarkerScales(multiplier) {\r\n        if (multiplier === undefined)\r\n            multiplier = 1;\r\n        for (let k in this._markers) {\r\n            if (multiplier < 0.1) {\r\n                this._markers[k].hide();\r\n            } else {\r\n                this._markers[k].show();\r\n                this._markers[k].setScale(\r\n                    (this._isSelected ? this._selectedMarkerScale : this._defaultMarkerScale)\r\n                    * multiplier\r\n                );\r\n            }\r\n        }\r\n    }\r\n\r\n    setColor(color) {\r\n        this.color = color;\r\n        if (this.point) {\r\n            this.point.material.color.set(this.color);\r\n            this.point.material.needsUpdate = true;\r\n        }\r\n        for (let event of this.flightEvents) {\r\n            event.model.setColor(color);\r\n        }\r\n        for (let k in this._markers) {\r\n            this._markers[k].setColor(color);\r\n        }\r\n    }\r\n\r\n    drop() {\r\n        this.threeObj && sim.selection.removeSelectableObject(this.threeObj);\r\n\r\n        for (let k in this._markers) {\r\n            this._markers[k].drop();\r\n        }\r\n        for (let event of this.flightEvents) {\r\n            event.model.drop();\r\n        }\r\n        delete this.flightEvents;\r\n\r\n        if (this.point) {\r\n            this.scene.remove(this.point);\r\n            if (this.point.geometry) {\r\n                this.point.geometry.dispose();\r\n            }\r\n            if (this.point.material) {\r\n                this.point.material.dispose();\r\n            }\r\n            delete this.point;\r\n        }\r\n\r\n        super.drop();\r\n    }\r\n}\r\n","import * as THREE from \"three\";\r\n\r\nexport default class VirtualPlane extends THREE.Plane\r\n{\r\n    raycast(raycaster, intersects) {\r\n\r\n        this.visible = true; //it's actually not. Visibility is true only to satisfy raycaster.\r\n\r\n        const d = this.constant / raycaster.ray.direction.dot(this.normal);\r\n\r\n        if (d < 0) {\r\n            return;\r\n        }\r\n\r\n        let intersectionPoint = raycaster.ray.direction.clone().multiplyScalar(d);\r\n\r\n        intersects.push({\r\n            distance  : intersectionPoint.length(),\r\n            point     : intersectionPoint,\r\n            index     : 0,\r\n            face      : null,\r\n            faceIndex : null,\r\n            object    : this\r\n        });\r\n    }\r\n}\r\n","import * as THREE from \"three\";\r\n\r\nimport LineObject from \"./LineObject\";\r\n\r\nexport default class ArrowObject extends THREE.ArrowHelper\r\n{\r\n    constructor(dir, origin, length, color, headLength, headWidth) {\r\n        super(dir, origin, length, color, headLength, headWidth);\r\n        this.remove(this.line);\r\n        this.line = new LineObject(this.line.geometry, this.line.material);\r\n        this.add(this.line);\r\n    }\r\n}\r\n","import * as THREE from \"three\";\r\n\r\nimport Constant from \"../FunctionOfEpoch/Constant\";\r\nimport VisualModelAbstract from \"./ModelAbstract\";\r\nimport {RF_BASE} from \"../ReferenceFrame/Factory\";\r\nimport VirtualPlane from \"./VirtualPlane\";\r\nimport {TWO_PI, rad2deg, deg2rad} from \"../algebra\";\r\nimport ArrowObject from \"./Arrow\";\r\nimport { sim } from \"../Simulation\";\r\n\r\nexport default class VisualAngle extends VisualModelAbstract\r\n{\r\n    constructor(referenceFrame, position, orientation, value, color, size, type, editingCallback) {\r\n        super();\r\n\r\n        this._referenceFrame = referenceFrame;\r\n        this._position = position;\r\n        this._orientation = orientation;\r\n        this._value = value;\r\n        this.color = color;\r\n        this.type = type;\r\n        this.arcSize = size;\r\n        this.editingCallback = editingCallback;\r\n        this.isEditMode = !!editingCallback;\r\n        this.bounds = [0, TWO_PI];\r\n        this.customPriority = 0;\r\n\r\n        this.orientationUpdated = false;\r\n        this.valueUpdated = false;\r\n        this.sizeNeedsUpdate = false;\r\n\r\n        this.init();\r\n    }\r\n\r\n    setBounds(minValue, maxValue) {\r\n        this.bounds = [minValue, maxValue];\r\n    }\r\n\r\n    getReferenceFrame(epoch) {\r\n        return this._referenceFrame.evaluate(epoch);\r\n    }\r\n\r\n    getPosition(epoch) {\r\n        return this._position.evaluate(epoch);\r\n    }\r\n\r\n    getOrientation(epoch) {\r\n        return this._orientation.evaluate(epoch);\r\n    }\r\n\r\n    getValue(epoch) {\r\n        return this._value.evaluate(epoch);\r\n    }\r\n\r\n    init() {\r\n        this.onWheelListener = this.onMouseWheel.bind(this);\r\n        document.addEventListener('wheel', this.onWheelListener);\r\n\r\n        if (this.isEditMode) {\r\n            this.mouseDownListener = this.onMouseDown.bind(this);\r\n            sim.addEventListener('mousedown', this.mouseDownListener, 2);\r\n\r\n            if (!(this._value instanceof Constant)) {\r\n                throw Error('Editable angle requires Constant instance as a value');\r\n            }\r\n        }\r\n\r\n        this.sizeNeedsUpdate = true;\r\n\r\n        if (this.type === VisualAngle.TYPE_ARC) {\r\n            this.createArcObject();\r\n        } else {\r\n            this.createSectorObject();\r\n        }\r\n        this.valueUpdated = true;\r\n        this.orientationUpdated = true;\r\n    }\r\n\r\n    onMouseWheel() {\r\n        this.sizeNeedsUpdate = true;\r\n    }\r\n\r\n    onMouseDown(event) {\r\n        let intersection;\r\n        if (this.type === VisualAngle.TYPE_ARC) {\r\n            intersection = sim.raycaster.intersectObjects([this.threeAngle.line])[0];\r\n        } else {\r\n            intersection = sim.raycaster.intersectObjects(\r\n                [this.threeAngle.children[0].line, this.threeAngle.children[0].cone]\r\n            )[0];\r\n        }\r\n\r\n        if (intersection && (event.button == 0)) { //check if the mouse button pressed is left\r\n            this.mouseUpListener = this.onMouseUp.bind(this);\r\n            document.addEventListener('mouseup', this.mouseUpListener);\r\n            this.mouseMoveListener = this.onMouseMove.bind(this);\r\n            sim.addEventListener('mousemove', this.mouseMoveListener, 2 + this.customPriority / 100);\r\n            this.mouseMoved = false;\r\n        } else {\r\n            return true;\r\n        }\r\n    }\r\n\r\n    onMouseUp(event) {\r\n        document.removeEventListener('mouseup', this.mouseUpListener);\r\n        sim.removeEventListener('mousemove', this.mouseMoveListener);\r\n\r\n        if (!this.mouseMoved) {\r\n            let input = prompt('Enter angle value in degrees', rad2deg(this._value.value));\r\n            if (input !== null && input !== '' && !isNaN(Number(input))) {\r\n                let newAngleValue = deg2rad(Number(input));\r\n\r\n                if (newAngleValue < this.bounds[0] || newAngleValue > this.bounds[1]) {\r\n                    const lowDiff  = (this.bounds[0] - newAngleValue + TWO_PI) % TWO_PI;\r\n                    const highDiff = (newAngleValue - this.bounds[1] + TWO_PI) % TWO_PI;\r\n                    if (lowDiff <= highDiff) {\r\n                        newAngleValue = this.bounds[0];\r\n                    } else {\r\n                        newAngleValue = this.bounds[1];\r\n                    }\r\n                }\r\n\r\n                if (newAngleValue !== this._value.value) {\r\n                    this._value.value = newAngleValue;\r\n                    this.valueUpdated = true;\r\n                    if (this.editingCallback) {\r\n                        this.editingCallback(this._value.value);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    onMouseMove() {\r\n        this.mouseMoved = true;\r\n\r\n        const plane = this.getVirtualPlane();\r\n        let intersection = sim.raycaster.intersectObjects([plane])[0];\r\n        if (intersection) {\r\n            const direction = intersection.point\r\n                .clone()\r\n                .sub(this.threeObj.position)\r\n                .normalize();\r\n            let mainAxis = new THREE.Vector3(1, 0, 0);\r\n            mainAxis.applyQuaternion(this.threeObj.quaternion);\r\n\r\n            const oldAngleValue = this._value.value;\r\n            let newAngleValue = Math.acos(mainAxis.dot(direction) / mainAxis.length() / direction.length()); // no division by lengths because direction and mainAxis are normalized (length = 1)\r\n            mainAxis.cross(direction);\r\n\r\n            newAngleValue = (mainAxis.dot(plane.normal) > 0) ? newAngleValue : TWO_PI - newAngleValue;\r\n\r\n            if (newAngleValue < this.bounds[0] || newAngleValue > this.bounds[1]) {\r\n                const lowDiff  = (this.bounds[0] - newAngleValue + TWO_PI) % TWO_PI;\r\n                const highDiff = (newAngleValue - this.bounds[1] + TWO_PI) % TWO_PI;\r\n                if (lowDiff <= highDiff) {\r\n                    newAngleValue = this.bounds[0];\r\n                } else {\r\n                    newAngleValue = this.bounds[1];\r\n                }\r\n            }\r\n\r\n            if (newAngleValue !== oldAngleValue) {\r\n                this._value.value = newAngleValue;\r\n                this.valueUpdated = true;\r\n                if (this.editingCallback) {\r\n                    this.editingCallback(this._value.value);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    getVirtualPlane() {\r\n        let normal = new THREE.Vector3(0, 0, 1);\r\n        normal.applyQuaternion(this.threeObj.quaternion);\r\n        const angle = Math.acos(normal.dot(this.threeObj.position) / this.threeObj.position.length() / normal.length());\r\n        const distance = this.threeObj.position.length() * Math.cos(angle);\r\n\r\n        if (this.virtualPlane) {\r\n            this.virtualPlane.normal.copy(normal);\r\n            this.virtualPlane.constant = distance;\r\n        } else {\r\n            this.virtualPlane = new VirtualPlane(normal, distance);\r\n        }\r\n\r\n        return this.virtualPlane;\r\n    }\r\n\r\n    createArcObject() {\r\n        let material = new THREE.LineBasicMaterial({color: this.color});\r\n        let threeObj = new THREE.Object3D();\r\n\r\n        this.threeArc = new THREE.Line(new THREE.Geometry(), material);\r\n        this.threeMainAxis = new THREE.Line(new THREE.Geometry(), material);\r\n        this.threeAngle = new THREE.Line(new THREE.Geometry(), material);\r\n\r\n        this.threeMainAxis.geometry.vertices.push(\r\n            new THREE.Vector3(0, 0, 0),\r\n            new THREE.Vector3(1, 0, 0),\r\n        );\r\n        this.threeAngle.geometry.vertices.push(\r\n            new THREE.Vector3(0, 0, 0),\r\n            new THREE.Vector3(1, 0, 0),\r\n        );\r\n\r\n        threeObj.add(this.threeArc);\r\n        threeObj.add(this.threeMainAxis);\r\n        threeObj.add(this.threeAngle);\r\n        threeObj.scale.set(this.size, this.size, this.size);\r\n\r\n        this.setThreeObj(threeObj);\r\n    }\r\n\r\n    updateArcObject(value) {\r\n        if (value < 0) {\r\n            value -= 2 * Math.PI * Math.floor(value / 2 / Math.PI);\r\n        }\r\n        // todo: optimize this\r\n        this.threeArc.geometry.dispose();\r\n        this.threeArc.geometry = new THREE.Geometry();\r\n        this.threeArc.geometry.setFromPoints(\r\n            (new THREE.EllipseCurve(\r\n                0, 0,\r\n                1 / 3,\r\n                1 / 3,\r\n                0, value,\r\n                false,\r\n                0\r\n            )).getPoints(Math.ceil(value * 30))\r\n        );\r\n    }\r\n\r\n    createSectorObject() {\r\n        let material = new THREE.MeshBasicMaterial({\r\n            color: this.color,\r\n            opacity: 0.175,\r\n            transparent: true,\r\n            side: THREE.DoubleSide\r\n        });\r\n        let threeObj = new THREE.Object3D();\r\n\r\n        this.threeArc = new THREE.Mesh(new THREE.Geometry(), material);\r\n        this.threeMainAxis = new ArrowObject(\r\n            new THREE.Vector3(1, 0, 0),\r\n            new THREE.Vector3(0, 0, 0),\r\n            1,\r\n            this.color\r\n        );\r\n        this.threeAngle = new THREE.Object3D();\r\n        this.threeAngle.add(new ArrowObject(\r\n            new THREE.Vector3(1, 0, 0),\r\n            new THREE.Vector3(0, 0, 0),\r\n            1,\r\n            this.isEditMode ? 0xc2f442 : this.color\r\n        ));\r\n\r\n        threeObj.add(this.threeArc);\r\n        threeObj.add(this.threeMainAxis);\r\n        threeObj.add(this.threeAngle);\r\n        threeObj.scale.set(this.size, this.size, this.size);\r\n\r\n        this.setThreeObj(threeObj);\r\n    }\r\n\r\n    updateSectorObject(value) {\r\n        if (value < 0) {\r\n            value -= 2 * Math.PI * Math.floor(value / 2 / Math.PI);\r\n        }\r\n        // todo: optimize this\r\n        this.threeArc.geometry.dispose();\r\n        this.threeArc.geometry = new THREE.CircleGeometry(\r\n            1,\r\n            Math.ceil(value * 30),\r\n            0,\r\n            value\r\n        );\r\n    }\r\n\r\n    drop() {\r\n        super.drop();\r\n        delete this.threeMainAxis;\r\n        delete this.threeAngle;\r\n        delete this.threeArc;\r\n        document.removeEventListener('wheel', this.onWheelListener);\r\n        if (this.mouseDownListener) {\r\n            sim.removeEventListener('mousedown', this.mouseDownListener);\r\n        }\r\n    }\r\n\r\n    render(epoch) {\r\n        const referenceFrame = this.getReferenceFrame(epoch);\r\n        const pos = referenceFrame.transformPositionByEpoch(\r\n            epoch,\r\n            this.getPosition(epoch),\r\n            RF_BASE\r\n        );\r\n        this.setPosition(pos);\r\n\r\n        if (this.valueUpdated || !(this._value instanceof Constant)) {\r\n            const value = this.getValue(epoch);\r\n            if (this.type === VisualAngle.TYPE_ARC) {\r\n                this.updateArcObject(value);\r\n            } else {\r\n                this.updateSectorObject(value);\r\n            }\r\n            this.threeAngle.rotation.z = value;\r\n            this.valueUpdated = false;\r\n        }\r\n\r\n        if (this.orientationUpdated || !(this._orientation instanceof Constant)) {\r\n            this.threeObj.quaternion.copy(referenceFrame.getQuaternionByEpoch(epoch).mul_(this.getOrientation(epoch)).toThreejs());\r\n            this.orientationUpdated = false;\r\n        }\r\n\r\n        if (this.sizeNeedsUpdate) {\r\n            this.size = this.threeObj.position.length() / 6 * this.arcSize;\r\n            this.threeObj.scale.set(this.size, this.size, this.size);\r\n            this.sizeNeedsUpdate = false;\r\n        }\r\n    }\r\n}\r\n\r\nVisualAngle.TYPE_ARC    = 'arc';\r\nVisualAngle.TYPE_SECTOR = 'sector';\r\n","import * as THREE from \"three\";\r\nimport VisualModelAbstract from \"./ModelAbstract\";\r\nimport {RF_BASE, RF_BASE_OBJ} from \"../ReferenceFrame/Factory\";\r\nimport VirtualPlane from \"./VirtualPlane\";\r\nimport {Vector} from \"../algebra\";\r\nimport { sim } from \"../Simulation\";\r\n\r\nexport default class VisualPlanePoint extends VisualModelAbstract\r\n{\r\n    constructor(referenceFrame, value, color, size, editingCallback, minBound, maxBound) {\r\n        super();\r\n\r\n        this._referenceFrame = referenceFrame;\r\n        this._value = value;\r\n        this.color = color;\r\n        this.size = size;\r\n        this.editingCallback = editingCallback;\r\n        this.minBound = minBound;\r\n        this.maxBound = maxBound;\r\n\r\n        this.isEditMode = !!editingCallback;\r\n\r\n        this.lastEpoch = 0;\r\n\r\n        this.init();\r\n    }\r\n\r\n    getReferenceFrame(epoch) {\r\n        return this._referenceFrame.evaluate(epoch);\r\n    }\r\n\r\n    init() {\r\n        this.setThreeObj(new THREE.Mesh(\r\n            new THREE.SphereGeometry(1, 8, 8),\r\n            new THREE.MeshBasicMaterial({color: this.color})\r\n        ));\r\n\r\n        if (this.isEditMode) {\r\n            this.mouseDownListener = this.onMouseDown.bind(this);\r\n            document.addEventListener('mousedown', this.mouseDownListener);\r\n        }\r\n    }\r\n\r\n    drop() {\r\n        super.drop();\r\n        if (this.mouseDownListener) {\r\n            document.removeEventListener('mousedown', this.mouseDownListener);\r\n        }\r\n    }\r\n\r\n    onMouseDown(event) {\r\n        if (event.button != 0) {\r\n            return;\r\n        }\r\n\r\n        let intersection = sim.raycaster.intersectObjects([this.threeObj])[0];\r\n        if (intersection && (event.button == 0)) { //check if the mouse button pressed is left\r\n            this.mouseUpListener = this.onMouseUp.bind(this);\r\n            document.addEventListener('mouseup', this.mouseUpListener);\r\n            this.mouseMoveListener = this.onMouseMove.bind(this);\r\n            sim.addEventListener('mousemove', this.mouseMoveListener, 3);\r\n        }\r\n    }\r\n\r\n    onMouseUp(event) {\r\n        document.removeEventListener('mouseup', this.mouseUpListener);\r\n        sim.removeEventListener('mousemove', this.mouseMoveListener);\r\n    }\r\n\r\n    onMouseMove() {\r\n        this.updateValue(this.lastEpoch);\r\n    }\r\n\r\n    updateValue(epoch) {\r\n        const plane = this.getVirtualPlane(epoch);\r\n        let intersection = sim.raycaster.intersectObjects([plane])[0];\r\n        if (intersection) {\r\n            const minBound = this.minBound(epoch);\r\n            const maxBound = this.maxBound(epoch);\r\n            this._value = RF_BASE_OBJ.transformPositionByEpoch(epoch, sim.getSimCoords(intersection.point), this.getReferenceFrame(epoch));\r\n\r\n            for (let idx of [0,1,2]) {\r\n                if (minBound[idx] !== false && this._value[idx] < minBound[idx]) {\r\n                    this._value[idx] = minBound[idx];\r\n                } else if (maxBound[idx] !== false && this._value[idx] > maxBound[idx]) {\r\n                    this._value[idx] = maxBound[idx];\r\n                }\r\n            }\r\n\r\n            if (this.editingCallback) {\r\n                this.editingCallback(this._value);\r\n            }\r\n        }\r\n    }\r\n\r\n    getVirtualPlane(epoch) {\r\n        const normal = (new THREE.Vector3()).fromArray(this.getReferenceFrame(epoch).getQuaternionByEpoch(epoch).rotate_(new Vector([0,0,1])));\r\n        const position = sim.getVisualCoords(this.getReferenceFrame(epoch).getOriginPositionByEpoch(epoch));\r\n        const angle = Math.acos(normal.dot(position) / position.length() / normal.length());\r\n        const distance = position.length() * Math.cos(angle);\r\n\r\n        if (this.virtualPlane) {\r\n            this.virtualPlane.normal.copy(normal);\r\n            this.virtualPlane.constant = distance;\r\n        } else {\r\n            this.virtualPlane = new VirtualPlane(normal, distance);\r\n        }\r\n\r\n        return this.virtualPlane;\r\n    }\r\n\r\n    render(epoch) {\r\n        this.lastEpoch = epoch;\r\n\r\n        this.setPosition(this.getReferenceFrame(epoch).transformPositionByEpoch(\r\n            epoch,\r\n            this._value,\r\n            RF_BASE\r\n        ));\r\n\r\n        const scaleKoeff = this.size * this.threeObj.position.length() * this.pixelAngleSize;\r\n        this.threeObj.scale.x = scaleKoeff;\r\n        this.threeObj.scale.y = scaleKoeff;\r\n        this.threeObj.scale.z = scaleKoeff;\r\n    }\r\n}","import FunctionOfEpochCustom from \"./FunctionOfEpoch/Custom\";\r\nimport {Quaternion, Vector} from \"./algebra\";\r\nimport VisualAngle from \"./visual/Angle\";\r\nimport Constant from \"./FunctionOfEpoch/Constant\";\r\nimport VisualPlanePoint from \"./visual/PlanePoint\";\r\nimport { sim } from \"./Simulation\";\r\n\r\nexport default class KeplerianEditor\r\n{\r\n    constructor(trajectory) {\r\n        this.isEditMode = trajectory.isEditable;\r\n        this.trajectory = trajectory;\r\n\r\n        this.colorRaan = 0x7FFFD4; //lightblue\r\n        this.colorAop  = 0x9966CC; //violet\r\n        this.colorInc  = 0xB00000; //red\r\n        this.colorTa   = 0xFC0FC0; //pink\r\n\r\n        if (sim.settings.ui.showAnglesOfSelectedOrbit) {\r\n            this.init();\r\n        }\r\n    }\r\n\r\n    init() {\r\n        let referenceFrame = new FunctionOfEpochCustom(epoch => this.trajectory.getReferenceFrameByEpoch(epoch));\r\n        let position = new Constant(new Vector(3));\r\n\r\n        this.angleRaan = new VisualAngle(\r\n            referenceFrame,\r\n            position,\r\n            new Constant(new Quaternion()),\r\n            this.isEditMode\r\n                ? new Constant(this.trajectory.raan)\r\n                : new FunctionOfEpochCustom(epoch => this.trajectory.getKeplerianObjectByEpoch(epoch).raan),\r\n            this.colorRaan,\r\n            1.5,\r\n            this.isEditMode ? VisualAngle.TYPE_SECTOR : VisualAngle.TYPE_ARC,\r\n            this.isEditMode ? value => { this.trajectory.raan = value; } : null\r\n        );\r\n        this.angleRaan.customPriority = 4;\r\n\r\n        this.angleInc = new VisualAngle(\r\n            referenceFrame,\r\n            position,\r\n            new FunctionOfEpochCustom(epoch => {\r\n                const ko = this.trajectory.getKeplerianObjectByEpoch(epoch);\r\n                return (new Quaternion(new Vector([0,0,1]), ko.raan + Math.PI / 2))\r\n                    .mul_(new Quaternion(new Vector([1,0,0]), Math.PI / 2));\r\n            }),\r\n            this.isEditMode\r\n                ? new Constant(this.trajectory.inc)\r\n                : new FunctionOfEpochCustom(epoch => this.trajectory.getKeplerianObjectByEpoch(epoch).inc),\r\n            this.colorInc,\r\n            2,\r\n            this.isEditMode ? VisualAngle.TYPE_SECTOR : VisualAngle.TYPE_ARC,\r\n            this.isEditMode ? value => { this.trajectory.inc = value; } : null\r\n        );\r\n        this.angleInc.setBounds(0, Math.PI);\r\n        this.angleInc.customPriority = 3;\r\n\r\n        this.angleAop = new VisualAngle(\r\n            referenceFrame,\r\n            position,\r\n            new FunctionOfEpochCustom(epoch => {\r\n                const ko = this.trajectory.getKeplerianObjectByEpoch(epoch);\r\n                return (new Quaternion(new Vector([0,0,1]), ko.raan))\r\n                    .mul_(new Quaternion(new Vector([1,0,0]), ko.inc));\r\n            }),\r\n            this.isEditMode\r\n                ? new Constant(this.trajectory.aop)\r\n                : new FunctionOfEpochCustom(epoch => this.trajectory.getKeplerianObjectByEpoch(epoch).aop),\r\n            this.colorAop,\r\n            2.5,\r\n            this.isEditMode ? VisualAngle.TYPE_SECTOR : VisualAngle.TYPE_ARC,\r\n            this.isEditMode ? value => { this.trajectory.aop = value; } : null\r\n        );\r\n        this.angleAop.customPriority = 2;\r\n\r\n        this.angleTa = new VisualAngle(\r\n            referenceFrame,\r\n            position,\r\n            new FunctionOfEpochCustom(epoch => {\r\n                const ko = this.trajectory.getKeplerianObjectByEpoch(epoch);\r\n                return (new Quaternion(new Vector([0,0,1]), ko.raan))\r\n                    .mul_(new Quaternion(new Vector([1,0,0]), ko.inc))\r\n                    .mul_(new Quaternion(new Vector([0,0,1]), ko.aop));\r\n            }),\r\n            new FunctionOfEpochCustom(epoch => this.trajectory.getKeplerianObjectByEpoch(epoch).getTrueAnomalyByEpoch(epoch)),\r\n            this.colorTa,\r\n            3,\r\n            VisualAngle.TYPE_ARC\r\n        );\r\n\r\n        if (this.isEditMode) {\r\n            this.pointApoapsis = new VisualPlanePoint(\r\n                new Constant(this.trajectory.pericentricReferenceFrame),\r\n                new Vector([-this.trajectory.sma * (1 + this.trajectory.ecc), 0, 0]),\r\n                'red',\r\n                8,\r\n                value => {\r\n                    const periapsis = this.trajectory.sma * (1 - this.trajectory.ecc);\r\n                    const sma = (-value.x + periapsis) / 2;\r\n                    this.trajectory.sma = sma;\r\n                    this.trajectory.ecc = 1 - periapsis / sma;\r\n                },\r\n                () => [false, 0, 0],\r\n                () => [-this.trajectory.sma * (1 - this.trajectory.ecc), 0, 0]\r\n            );\r\n            this.pointPeriapsis = new VisualPlanePoint(\r\n                new Constant(this.trajectory.pericentricReferenceFrame),\r\n                new Vector([this.trajectory.sma * (1 - this.trajectory.ecc), 0, 0]),\r\n                'blue',\r\n                8,\r\n                value => {\r\n                    const apoapsis = this.trajectory.sma * (1 + this.trajectory.ecc);\r\n                    const sma = (value.x + apoapsis) / 2;\r\n                    this.trajectory.sma = sma;\r\n                    this.trajectory.ecc = apoapsis / sma - 1;\r\n                },\r\n                () => [0, 0, 0],\r\n                () => [this.trajectory.sma * (1 + this.trajectory.ecc), 0, 0]\r\n            );\r\n            this.angleTaEditing = new VisualAngle(\r\n                referenceFrame,\r\n                position,\r\n                new FunctionOfEpochCustom((epoch) => (new Quaternion(new Vector([0,0,1]), this.trajectory.raan))\r\n                        .mul_(new Quaternion(new Vector([1,0,0]), this.trajectory.inc))\r\n                        .mul_(new Quaternion(new Vector([0,0,1]), this.trajectory.aop))),\r\n                new Constant(this.trajectory.ta),\r\n                this.colorTa,\r\n                3,\r\n                VisualAngle.TYPE_SECTOR,\r\n                value => { this.trajectory.ta = value; }\r\n            );\r\n            this.angleTaEditing.customPriority = 1;\r\n\r\n        }\r\n    }\r\n\r\n    remove() {\r\n        this.angleRaan && this.angleRaan.drop();\r\n        this.angleAop && this.angleAop.drop();\r\n        this.angleInc && this.angleInc.drop();\r\n        this.angleTa && this.angleTa.drop();\r\n        this.angleTaEditing && this.angleTaEditing.drop();\r\n\r\n        this.pointApoapsis && this.pointApoapsis.drop();\r\n        this.pointPeriapsis && this.pointPeriapsis.drop();\r\n    }\r\n}\r\n","import StateVector from \"../StateVector\";\r\nimport {RF_BASE} from \"../ReferenceFrame/Factory\";\r\nimport KeplerianObject from \"../KeplerianObject\";\r\nimport ExceptionOutOfRange from \"./ExceptionOutOfRange\";\r\nimport FunctionOfEpochCustom from \"../FunctionOfEpoch/Custom\";\r\nimport ReferenceFrameInertialDynamic from \"../ReferenceFrame/InertialDynamic\";\r\nimport KeplerianEditor from \"../KeplerianEditor\";\r\nimport {Quaternion} from \"../algebra\";\r\nimport ReferenceFrameAbstract from \"../ReferenceFrame/Abstract\";\r\nimport { sim } from \"../Simulation\";\r\nimport Events from \"../Events\";\r\nimport FlightEventSOIDeparture from \"../../modules/PatchedConics/FlightEvent/SOIDeparture\";\r\nimport FlightEventSOIArrival from \"../../modules/PatchedConics/FlightEvent/SOIArrival\";\r\n\r\n/**\r\n * Fields:\r\n *  minEpoch/  - (float) time limits where the trajectory is defined\r\n *  maxEpoch     (false) there is no limit\r\n */\r\nexport default class TrajectoryAbstract\r\n{\r\n    constructor() {\r\n        this.minEpoch = false;\r\n        this.maxEpoch = false;\r\n\r\n        this.cachedEpoch = null;\r\n        this.cachedState = null;\r\n\r\n        this.visualModel = null;\r\n        this.selectedVisualModel = null;\r\n        this.object = null;\r\n\r\n        this.parent = null;\r\n\r\n        this.referenceFrame = null;\r\n\r\n        this.isEditable = false;\r\n        this.isSelected = false;\r\n        this.clickHandler = null;\r\n\r\n        this.flightEvents = [];\r\n\r\n        this.showOrbitAnglesListener = this._onShowOrbitAnglesChange.bind(this);\r\n\r\n        this.orbitalReferenceFrame = new ReferenceFrameInertialDynamic(\r\n            new FunctionOfEpochCustom(epoch => this.getStateByEpoch(epoch)),\r\n            new FunctionOfEpochCustom(epoch => {\r\n                const quat = this.getReferenceFrameByEpoch(epoch).getQuaternionByEpoch(epoch);\r\n                const state = this.getStateInOwnFrameByEpoch(epoch);\r\n                return quat.mul_(Quaternion.twoAxis(state._velocity, null, state._position));\r\n            }),\r\n        );\r\n\r\n        this.pericentricReferenceFrame = new ReferenceFrameInertialDynamic(\r\n            new FunctionOfEpochCustom((epoch) => {\r\n                return this.getReferenceFrameByEpoch(epoch).getOriginStateByEpoch(epoch);\r\n            }),\r\n            new FunctionOfEpochCustom((epoch) => {\r\n                const quat = this.getReferenceFrameByEpoch(epoch).getQuaternionByEpoch(epoch);\r\n                const ko = this.getKeplerianObjectByEpoch(epoch);\r\n                return quat.mul_(ko.getOrbitalFrameQuaternion());\r\n            })\r\n        );\r\n    }\r\n\r\n    onClick(handler) {\r\n        this.clickHandler = handler;\r\n        this.visualModel && this.visualModel.onClick(handler);\r\n    }\r\n\r\n    onUpdate(handler) {\r\n        return null;\r\n    }\r\n\r\n    addFlightEvent(flightEvent) {\r\n        if (flightEvent instanceof FlightEventSOIDeparture || flightEvent instanceof FlightEventSOIArrival) {\r\n            for (let event of this.flightEvents) {\r\n                if (event.constructor === flightEvent.constructor) {\r\n                    event.set(flightEvent);\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n        let found = false;\r\n        for (let i in this.flightEvents) {\r\n            if (this.flightEvents[i].epoch > flightEvent.epoch) {\r\n                this.flightEvents.splice(i, 0, flightEvent);\r\n                found = true;\r\n                break;\r\n            }\r\n        }\r\n        if (!found) {\r\n            this.flightEvents.push(flightEvent);\r\n        }\r\n        this.visualModel && this.visualModel.addFlightEvent(flightEvent);\r\n    }\r\n\r\n    removeFlightEvent(flightEvent) {\r\n        let idx = this.flightEvents.indexOf(flightEvent);\r\n        if (idx !== -1) {\r\n            this.flightEvents.splice(idx, 1);\r\n        }\r\n        this.visualModel && this.visualModel.removeFlightEvent(flightEvent);\r\n    }\r\n\r\n    sortFlightEvents() {\r\n        this.flightEvents.sort((e1, e2) => (e1.epoch < e2.epoch) ? -1 : (e1.epoch > e2.epoch ? 1 : 0));\r\n    }\r\n\r\n    clearAfterEpoch(epoch) {\r\n        let newEvents = [];\r\n        for (let event of this.flightEvents) {\r\n            if (event.epoch <= epoch) {\r\n                newEvents.push(event);\r\n            } else {\r\n                this.visualModel && this.visualModel.removeFlightEvent(event);\r\n            }\r\n        }\r\n        this.flightEvents = newEvents;\r\n    }\r\n\r\n    setReferenceFrame(referenceFrameId) {\r\n        this.referenceFrame = sim.starSystem.getReferenceFrame(referenceFrameId);\r\n    }\r\n\r\n    getReferenceFrameByEpoch(epoch) {\r\n        return this.referenceFrame;\r\n    }\r\n\r\n    _transformKeplerianObject(keplerianObject, destinationFrameOrId, epoch) {\r\n        if (destinationFrameOrId === undefined) {\r\n            return keplerianObject;\r\n        }\r\n\r\n        let destinationFrame = (destinationFrameOrId instanceof ReferenceFrameAbstract)\r\n            ? destinationFrameOrId\r\n            : sim.starSystem.getReferenceFrame(destinationFrameOrId);\r\n        if (epoch === undefined) {\r\n            epoch = keplerianObject.epoch;\r\n        }\r\n        return KeplerianObject.createFromState(\r\n            this.referenceFrame.transformStateVectorByEpoch(\r\n                epoch,\r\n                keplerianObject.getStateByEpoch(epoch),\r\n                destinationFrame\r\n            ),\r\n            destinationFrame.mu,\r\n            epoch\r\n        );\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param epoch\r\n     * @param referenceFrameOrId\r\n     * @return {KeplerianObject}\r\n     */\r\n    getKeplerianObjectByEpoch(epoch, referenceFrameOrId) {\r\n        let destinationFrame = (referenceFrameOrId instanceof ReferenceFrameAbstract)\r\n            ? referenceFrameOrId\r\n            : referenceFrameOrId !== undefined\r\n                ? sim.starSystem.getReferenceFrame(referenceFrameOrId)\r\n                : this.getReferenceFrameByEpoch(epoch);\r\n        return KeplerianObject.createFromState(\r\n            this.getStateByEpoch(epoch, destinationFrame),\r\n            destinationFrame.mu,\r\n            epoch\r\n        );\r\n    }\r\n\r\n    setVisualModel(visualModel) {\r\n        this.visualModel = visualModel;\r\n        this.clickHandler && this.visualModel.onClick(this.clickHandler);\r\n        for (let event of this.flightEvents) {\r\n            this.visualModel.addFlightEvent(event);\r\n        }\r\n    }\r\n\r\n    setSelectedVisualModel(visualModel) {\r\n        this.selectedVisualModel = visualModel;\r\n        if (this.isSelected) {\r\n            this.visualModel.hide();\r\n        } else {\r\n            visualModel.hide();\r\n        }\r\n        this.clickHandler && visualModel.onClick(this.clickHandler);\r\n        for (let event of this.flightEvents) {\r\n            visualModel.addFlightEvent(event);\r\n        }\r\n    }\r\n\r\n    setParent(parent) {\r\n        this.parent = parent;\r\n    }\r\n\r\n    setObject(object) {\r\n        this.object = object;\r\n    }\r\n\r\n    drop() {\r\n        if (this.isSelected) {\r\n            this.deselect();\r\n        }\r\n        if (this.visualModel) {\r\n            this.visualModel.drop();\r\n        }\r\n        if (this.selectedVisualModel) {\r\n            this.selectedVisualModel.drop();\r\n        }\r\n    }\r\n\r\n    select() {\r\n        this.isSelected = true;\r\n        if (this.selectedVisualModel) {\r\n            this.visualModel.hide();\r\n            this.selectedVisualModel.show();\r\n            this.selectedVisualModel.select();\r\n        } else {\r\n            this.visualModel && this.visualModel.select();\r\n        }\r\n        this.keplerianEditor = new KeplerianEditor(this);\r\n        Events.addListener(Events.SHOW_ORBIT_ANGLES_CHANGED, this.showOrbitAnglesListener);\r\n    }\r\n\r\n    deselect() {\r\n        this.isSelected = false;\r\n        if (this.selectedVisualModel) {\r\n            this.selectedVisualModel.deselect();\r\n            this.selectedVisualModel.hide();\r\n            this.visualModel.show();\r\n        } else {\r\n            this.visualModel && this.visualModel.deselect();\r\n        }\r\n        if (this.keplerianEditor) {\r\n            this.keplerianEditor.remove();\r\n            delete this.keplerianEditor;\r\n            Events.removeListener(Events.SHOW_ORBIT_ANGLES_CHANGED, this.showOrbitAnglesListener);\r\n        }\r\n    }\r\n\r\n    _onShowOrbitAnglesChange(event) {\r\n        if (event.detail.value) {\r\n            this.keplerianEditor.init();\r\n        } else {\r\n            this.keplerianEditor.remove();\r\n        }\r\n    }\r\n\r\n    isValidAtEpoch(epoch) {\r\n        return (this.minEpoch === false || epoch >= this.minEpoch)\r\n            && (this.maxEpoch === false || epoch <= this.maxEpoch);\r\n    }\r\n\r\n    validateEpoch(epoch) {\r\n        if (!this.isValidAtEpoch(epoch)) {\r\n            throw new ExceptionOutOfRange(this.object, this, epoch, this.minEpoch, this.maxEpoch);\r\n        }\r\n    }\r\n\r\n    getStateInOwnFrameByEpoch(epoch) {\r\n        this.validateEpoch(epoch);\r\n        return new StateVector();\r\n    }\r\n\r\n    getStateByEpoch(epoch, referenceFrameOrId, frameEpoch = null) {\r\n        let state;\r\n\r\n        if (this.referenceFrame === null) {\r\n            return null;\r\n        }\r\n\r\n        if (referenceFrameOrId === undefined) {\r\n            referenceFrameOrId = RF_BASE;\r\n        }\r\n\r\n        if (referenceFrameOrId === RF_BASE && epoch === this.cachedEpoch) {\r\n            state = this.cachedState;\r\n        } else {\r\n            state = this.getStateInOwnFrameByEpoch(epoch);\r\n            if (referenceFrameOrId === RF_BASE && epoch === sim.currentEpoch) {\r\n                this.cachedState = state;\r\n                this.cachedEpoch = epoch;\r\n            }\r\n        }\r\n\r\n        if (state === null) {\r\n            return null;\r\n        }\r\n\r\n        return this.referenceFrame.transformStateVectorByEpoch((frameEpoch === null) ? epoch : frameEpoch, state, referenceFrameOrId);\r\n    }\r\n\r\n    getPositionByEpoch(epoch, referenceFrameOrId, frameEpoch = null) {\r\n        return this.getStateByEpoch(epoch, referenceFrameOrId, frameEpoch).position;\r\n    }\r\n}\r\n","import ReferenceFrameInertialAbstract from \"./InertialAbstract\";\r\n\r\nexport default class ReferenceFrameInertialDynamic extends ReferenceFrameInertialAbstract\r\n{\r\n    constructor(stateOfEpoch, quaternionOfEpoch) {\r\n        super(stateOfEpoch);\r\n\r\n        this.quaternionOfEpoch = quaternionOfEpoch;\r\n    }\r\n\r\n    /**\r\n     * @param epoch\r\n     * @return {Quaternion}\r\n     */\r\n    getQuaternionByEpoch(epoch) {\r\n        return this.quaternionOfEpoch.evaluate(epoch);\r\n    }\r\n}","class LocalStorageWatchStatusService {\r\n    static KEY = \"urbain-watched-wizards\";\r\n\r\n    constructor(storage) {\r\n        this._storage = storage;\r\n    }\r\n\r\n    canWatch(wizardId) {\r\n        return !this._getWatchedWizards().some(id => id === wizardId);\r\n    }\r\n\r\n    markAsWatched(wizardId) {\r\n        if (!this.canWatch(wizardId)) {\r\n            return;\r\n        }\r\n        const wizards = this._getWatchedWizards();\r\n\r\n        wizards.push(wizardId);\r\n\r\n        this._saveStatuses(wizards);\r\n    }\r\n\r\n    _getWatchedWizards() {\r\n        const wizardIdsRawString = this._storage.getItem(LocalStorageWatchStatusService.KEY);\r\n\r\n        if (!wizardIdsRawString) {\r\n            return [];\r\n        }\r\n\r\n        return JSON.parse(wizardIdsRawString);\r\n    }\r\n\r\n    _saveStatuses(wizardIds) {\r\n        this._storage.setItem(LocalStorageWatchStatusService.KEY, JSON.stringify(wizardIds));\r\n    }\r\n}\r\n\r\nexport default LocalStorageWatchStatusService;\r\n","import React from \"react\";\r\nimport { render, unmountComponentAtNode } from \"react-dom\";\r\n\r\nimport \"./index.scss\";\r\n\r\nexport function showLangSelectorDialog(langs) {\r\n    let rootNode = document.createElement(\"div\");\r\n    document.body.appendChild(rootNode);\r\n\r\n    const removeDialog = () => {\r\n        if (rootNode) {\r\n            unmountComponentAtNode(rootNode);\r\n            rootNode.parentNode.removeChild(rootNode);\r\n            rootNode = null;\r\n        }\r\n    };\r\n\r\n    return new Promise(resolve => {\r\n        render(\r\n            <div className=\"language-selector-wrapper\">\r\n                <div className=\"language-selector\">\r\n                    {langs.map(({ id, description, buttonLabel }) => {\r\n                        const handleNext = () => {\r\n                            removeDialog();\r\n                            resolve(id);\r\n                        };\r\n\r\n                        return (\r\n                            <div key={id} className=\"language-selector__row\">\r\n                                <span className=\"language-selector__content\">{description}</span>\r\n\r\n                                <button className=\"language-selector__button\" onClick={handleNext}>\r\n                                    {buttonLabel}\r\n                                </button>\r\n                            </div>\r\n                        );\r\n                    })}\r\n                </div>\r\n            </div>,\r\n            rootNode,\r\n        );\r\n    });\r\n}\r\n","class StepHandlerService {\r\n    constructor(goalPrefix, durationPrefix) {\r\n        this._goalPrefix = goalPrefix;\r\n        this._durationPrefix = durationPrefix;\r\n\r\n        this._stepStartTimes = {};\r\n        this._metrika = window.yaCounter47040543;\r\n    }\r\n\r\n    handleStep(nextStepIdx) {\r\n        if (!this._metrika || this._stepStartTimes[nextStepIdx] !== undefined) {\r\n            return;\r\n        }\r\n\r\n        const stepName = this._goalPrefix + nextStepIdx;\r\n\r\n        this._stepStartTimes[nextStepIdx] = +new Date();\r\n\r\n        if (nextStepIdx === 0) {\r\n            this._metrika.reachGoal(stepName);\r\n            return;\r\n        }\r\n\r\n        const durationName = this._durationPrefix + (nextStepIdx - 1);\r\n        this._metrika.reachGoal(stepName, {\r\n            [durationName]: this._stepStartTimes[nextStepIdx] - this._stepStartTimes[nextStepIdx - 1],\r\n        });\r\n    }\r\n}\r\n\r\nexport default StepHandlerService;\r\n","import * as wizardIds from \"./wizards/wizard-ids\";\r\nimport LocalStorageWatchStatusService from \"./services/local-storage-watch-status-service\";\r\nimport { showLangSelectorDialog } from \"./language-selector\";\r\nimport StepHandlerService from \"./services/step-handler-service\";\r\n\r\nlet isAnyTutorialVisible = false;\r\n\r\nasync function showWizard({\r\n    wizardId,\r\n    ignoreWatchStatusCheck = false,\r\n    watchStatusService = new LocalStorageWatchStatusService(window.localStorage),\r\n    stepHandlerService = new StepHandlerService(\"tutorial_\", \"duration_tut_\"),\r\n} = {}) {\r\n    if (isAnyTutorialVisible || (!watchStatusService.canWatch(wizardId) && !ignoreWatchStatusCheck)) {\r\n        return;\r\n    }\r\n\r\n    const { default: wizard } = await import(/* webpackChunkName: \"[request]\" */ `./wizards/${wizardId}/index`);\r\n    isAnyTutorialVisible = true;\r\n\r\n    stepHandlerService.handleStep(0);\r\n    const selectedId = await showLangSelectorDialog(wizard.langs);\r\n\r\n    Promise.all([\r\n        import(/* webpackChunkName: \"[request]\" */ `./wizards/${wizardId}/${selectedId}`),\r\n        import(/* webpackChunkName: \"createIntroJs\" */ `./create-intro-js`),\r\n        import(/* webpackChunkName: \"introjsStyles\" */ \"./introjs.scss\"),\r\n    ])\r\n        .then(([{ default: wizardConfig }, { createIntroJs }]) => {\r\n            const intro = createIntroJs(wizardConfig, {\r\n                onStep() {\r\n                    stepHandlerService.handleStep(this._currentStep + 1);\r\n                },\r\n                onComplete() {\r\n                    stepHandlerService.handleStep(this._currentStep + 2);\r\n                    watchStatusService.markAsWatched(wizardId);\r\n                    isAnyTutorialVisible = false;\r\n                },\r\n            });\r\n            intro.start();\r\n        })\r\n        .catch(error => {\r\n            console.error(error.message);\r\n            isAnyTutorialVisible = false;\r\n        });\r\n}\r\n\r\nexport { showWizard, wizardIds };\r\n","import ReferenceFrameFactory from \"./ReferenceFrame/Factory\";\r\nimport Body from \"./Body\";\r\nimport Events from \"./Events\";\r\n\r\nexport const STAR_SYSTEM_BARYCENTER = 0;\r\n\r\nexport default class StarSystem\r\n{\r\n    constructor(id) {\r\n        this.id = id;\r\n        this.name = null;\r\n        this.stars = null;\r\n        this.mainObject = null;\r\n        this.referenceFrames = {};\r\n        this.objects = {};\r\n        this.created = 0;\r\n    }\r\n\r\n    unload() {\r\n        Object.entries(this.objects).map(entry => entry[1].drop());\r\n        this.stars && this.stars.drop();\r\n    }\r\n\r\n    addStars(stars) {\r\n        this.stars = stars;\r\n        return this;\r\n    }\r\n\r\n    addReferenceFrame(frame) {\r\n        this.referenceFrames[frame.id] = frame;\r\n    }\r\n\r\n    getReferenceFrame(id) {\r\n        if (this.referenceFrames[id] === undefined) {\r\n            this.referenceFrames[id] = ReferenceFrameFactory.createById(id);\r\n        }\r\n        return this.referenceFrames[id];\r\n    }\r\n\r\n    addObject(id, body) {\r\n        this.objects[id] = body;\r\n        Events.dispatch(Events.OBJECT_ADDED, {object: body});\r\n    }\r\n\r\n    getObject(id) {\r\n        if (this.objects[id] === undefined) {\r\n            return null;\r\n        }\r\n        return this.objects[id];\r\n    }\r\n\r\n    deleteObject(id) {\r\n        return new Promise(resolve => {\r\n            this.objects[id].drop();\r\n            delete this.objects[id];\r\n\r\n            resolve();\r\n        })\r\n    }\r\n\r\n    isBody(objectId) {\r\n        if (this.objects[objectId] === undefined) {\r\n            return null;\r\n        }\r\n        return this.objects[objectId] instanceof Body;\r\n    }\r\n\r\n    getObjectNames() {\r\n        let names = {};\r\n        for (const object of Object.values(this.objects)) {\r\n            names[object.id] = object.name;\r\n        }\r\n        return names;\r\n    }\r\n\r\n    getBodies() {\r\n        let bodies = [];\r\n        for (const object of Object.values(this.objects)) {\r\n            if (object instanceof Body) {\r\n                bodies.push(object);\r\n            }\r\n        }\r\n        return bodies;\r\n    }\r\n}\r\n","export const GETTING_STARTED_WIZARD = \"getting-started-wizard\";\r\n\r\nexport function getRus(id) {\r\n    return `${id}-ru`;\r\n}\r\n\r\nexport function getEng(id) {\r\n    return `${id}-eng`;\r\n}\r\n","import TrajectoryAbstract from \"./Abstract\";\r\n\r\nexport default class TrajectoryKeplerianAbstract extends TrajectoryAbstract\r\n{\r\n    constructor(referenceFrameId) {\r\n        super();\r\n        this.setReferenceFrame(referenceFrameId);\r\n    }\r\n\r\n    getStateInOwnFrameByEpoch(epoch) {\r\n        return this.getKeplerianObjectByEpoch(epoch).getStateByEpoch(epoch);\r\n    }\r\n}\r\n","\r\nimport VisualFlightEventAbstract from \"../../../../core/visual/FlightEvent/Abstract\";\r\n\r\nexport default class VisualFlightEventSOIDeparture extends VisualFlightEventAbstract\r\n{\r\n    static _textureName = 'soi_out.png';\r\n}\r\n","\r\nimport VisualFlightEventAbstract from \"../../../../core/visual/FlightEvent/Abstract\";\r\n\r\nexport default class VisualFlightEventSOIArrival extends VisualFlightEventAbstract\r\n{\r\n    static _textureName = 'soi_in.png';\r\n}\r\n","import ReferenceFrameInertialAbstract from \"./InertialAbstract\";\r\nimport {Quaternion} from \"../algebra\";\r\n\r\nexport default class ReferenceFrameInertial extends ReferenceFrameInertialAbstract\r\n{\r\n    constructor(stateOfEpoch, quaternion) {\r\n        super(stateOfEpoch);\r\n\r\n        this.quaternion = quaternion;\r\n    }\r\n\r\n    getQuaternionByEpoch(epoch) {\r\n        return Quaternion.copy(this.quaternion);\r\n    }\r\n}\r\n","import ReferenceFrameAbstract from \"./Abstract\";\r\nimport StateVector from \"../StateVector\";\r\n\r\nexport default class ReferenceFrameInertialAbstract extends ReferenceFrameAbstract\r\n{\r\n    constructor(stateOfEpoch) {\r\n        super();\r\n        this.stateOfEpoch = stateOfEpoch;\r\n    }\r\n\r\n    getOriginPositionByEpoch(epoch) {\r\n        return this.stateOfEpoch.evaluate(epoch).position;\r\n    }\r\n\r\n    getOriginStateByEpoch(epoch) {\r\n        return this.stateOfEpoch.evaluate(epoch);\r\n    }\r\n\r\n    stateVectorFromBaseReferenceFrameByEpoch(epoch, state) {\r\n        const originState = this.stateOfEpoch.evaluate(epoch);\r\n        const rotation = this.getQuaternionByEpoch(epoch).invert_();\r\n\r\n        return new StateVector(\r\n            rotation.rotate(state.position.sub_(originState.position)),\r\n            rotation.rotate(state.velocity.sub_(originState.velocity))\r\n        );\r\n    }\r\n\r\n    stateVectorToBaseReferenceFrameByEpoch(epoch, state) {\r\n        const originState = this.stateOfEpoch.evaluate(epoch);\r\n        const rotation = this.getQuaternionByEpoch(epoch);\r\n\r\n        return new StateVector(\r\n            rotation.rotate(state.position).add_(originState.position),\r\n            rotation.rotate(state.velocity).add_(originState.velocity)\r\n        );\r\n    }\r\n}","export default class ExceptionOutOfRange\r\n{\r\n    constructor(object, trajectory, epoch, minEpoch, maxEpoch) {\r\n        this.object = object;\r\n        this.trajectory = trajectory;\r\n        this.epoch = epoch;\r\n        this.minEpoch = minEpoch;\r\n        this.maxEpoch = maxEpoch;\r\n    }\r\n}","import * as THREE from \"three\";\r\n\r\nexport default class LineObject extends THREE.Line {\r\n    raycast(raycaster, intersects) {\r\n        const isBuffer = this.geometry.isBufferGeometry;\r\n        const verticesCount = isBuffer ? this.geometry.attributes.position.count : this.geometry.vertices.length;\r\n        let bestIntersection;\r\n\r\n        const ray = (new THREE.Ray())\r\n            .copy(raycaster.ray)\r\n            .applyMatrix4(\r\n                (new THREE.Matrix4())\r\n                .getInverse(this.matrixWorld)\r\n            );\r\n\r\n        for (let i = 0; i < verticesCount - 1; i++) {\r\n            let vertex1;\r\n            let vertex2;\r\n            if (isBuffer) {\r\n                const i1 = i * 3;\r\n                const i2 = ((i + 1) % verticesCount) * 3;\r\n                let positions = this.geometry.attributes.position.array;\r\n                vertex1 = new THREE.Vector3(positions[i1], positions[i1+1], positions[i1+2]);\r\n                vertex2 = new THREE.Vector3(positions[i2], positions[i2+1], positions[i2+2]);\r\n            } else {\r\n                vertex1 = (new THREE.Vector3())\r\n                    .copy(this.geometry.vertices[i]);\r\n                vertex2 = (new THREE.Vector3())\r\n                    .copy(this.geometry.vertices[(i + 1) % verticesCount]);\r\n            }\r\n\r\n            const currentLineDirection = (new THREE.Vector3()).subVectors(\r\n                vertex1,\r\n                vertex2\r\n            );\r\n\r\n            if (currentLineDirection.length() === 0) {\r\n                continue;\r\n            }\r\n\r\n            const commonPerpendicularDirection = (new THREE.Vector3()).crossVectors(\r\n                currentLineDirection,\r\n                ray.direction\r\n            );\r\n\r\n            const planeNormalVector = (new THREE.Vector3()).crossVectors(\r\n                ray.direction,\r\n                commonPerpendicularDirection\r\n            );\r\n\r\n            let distanceCoeff = (new THREE.Vector3()).subVectors(\r\n                ray.origin,\r\n                vertex1\r\n            ).dot(planeNormalVector);\r\n\r\n            distanceCoeff /= planeNormalVector.clone().dot(currentLineDirection);\r\n\r\n            let intersectionPoint = (new THREE.Vector3()).addVectors(\r\n                vertex1,\r\n                currentLineDirection.multiplyScalar(distanceCoeff)\r\n            );\r\n\r\n            if ((new THREE.Vector3()).subVectors(\r\n                    vertex1, intersectionPoint\r\n                ).dot(\r\n                    (new THREE.Vector3()).subVectors(\r\n                        intersectionPoint, vertex2\r\n                    )\r\n                ) < 0\r\n            ) {\r\n                // вне отркзка\r\n                intersectionPoint =\r\n                    (intersectionPoint.distanceTo(vertex1) < intersectionPoint.distanceTo(vertex2))\r\n                        ? vertex1\r\n                        : vertex2;\r\n            }\r\n\r\n            const currentDistance = (new THREE.Vector3()).crossVectors(\r\n                (new THREE.Vector3()).subVectors(\r\n                    intersectionPoint,\r\n                    ray.origin\r\n                ),\r\n                ray.direction\r\n            ).length();\r\n\r\n            if (!bestIntersection || (bestIntersection.distance > currentDistance)) {\r\n                bestIntersection = {\r\n                    distance: currentDistance,\r\n                    point: intersectionPoint,\r\n                    index: i,\r\n                    face: null,\r\n                    faceIndex: null,\r\n                    object: this\r\n                }\r\n            }\r\n        }\r\n\r\n        if (bestIntersection\r\n            && (bestIntersection.distance / ray.origin.distanceTo(bestIntersection.point)\r\n                < raycaster.pixelPrecision * raycaster.pixelAngleSize\r\n            )\r\n        ) {\r\n            bestIntersection.point.applyMatrix4(this.matrixWorld);\r\n            intersects.push(bestIntersection);\r\n        }\r\n    }\r\n}\r\n","\r\nexport default class FlightEventAbstract\r\n{\r\n    static VISUAL_CLASS = null;\r\n\r\n    constructor(epoch) {\r\n        this._epoch = epoch || false;\r\n        this._updateCallback = false;\r\n        this._visualModel = null;\r\n    }\r\n\r\n    onUpdate(callback) {\r\n        this._updateCallback = callback;\r\n        return this;\r\n    }\r\n\r\n    set(flightEvent) {\r\n        this._epoch = flightEvent._epoch;\r\n        return this;\r\n    }\r\n\r\n    copy() {\r\n        return (new this.constructor()).set(this);\r\n    }\r\n\r\n    set epoch(epoch) {\r\n        const old = this.copy();\r\n        this._epoch = epoch;\r\n        this._updateCallback && this._updateCallback(this, old);\r\n    }\r\n\r\n    get epoch() {\r\n        return this._epoch;\r\n    }\r\n\r\n    set visualModel(model) {\r\n        this._visualModel = model;\r\n    }\r\n\r\n    get visualModel() {\r\n        return this._visualModel;\r\n    }\r\n\r\n    getVisualClass() {\r\n        return this.constructor.VISUAL_CLASS;\r\n    }\r\n}\r\n","\r\nimport VisualMarkerAbstract from \"./Abstract\";\r\n\r\nexport default class VisualMarkerPericenter extends VisualMarkerAbstract\r\n{\r\n    static _textureName = 'pe.png';\r\n    static _alignVertical = 'top';\r\n    static _alignHorizontal = 'center';\r\n}","\r\nimport VisualSpriteStatic from \"../SpriteStatic\";\r\n\r\nexport default class VisualMarkerAbstract extends VisualSpriteStatic\r\n{\r\n    constructor(parentThreeObj, color) {\r\n        super(color);\r\n        this._parent = parentThreeObj;\r\n        this.threeObj && this._parent.add(this.threeObj);\r\n        this._isEnabled = false;\r\n        this.hide();\r\n    }\r\n\r\n    /**\r\n     * Redefining base method and not subscribing to RENDER event\r\n     * because this object is intended to be controlled by parent\r\n     * @param threeObj\r\n     */\r\n    setThreeObj(threeObj) {\r\n        this.threeObj = threeObj;\r\n        this._parent && this._parent.add(this.threeObj);\r\n        if (this._isHidden || !this._isEnabled)\r\n            this.threeObj.visible = false;\r\n    }\r\n\r\n    setPosition(pos) {\r\n        this.threeObj && this.threeObj.position.copy(pos);\r\n    }\r\n\r\n    enable() {\r\n        this._isEnabled = true;\r\n        if (!this._isHidden) {\r\n            this.threeObj.visible = true;\r\n        }\r\n    }\r\n\r\n    disable() {\r\n        this._isEnabled = false;\r\n        this.threeObj.visible = false;\r\n    }\r\n\r\n    show() {\r\n        super.show();\r\n        if (!this._isEnabled) {\r\n            this.threeObj.visible = false;\r\n        }\r\n    }\r\n}","\r\nimport VisualMarkerAbstract from \"./Abstract\";\r\n\r\nexport default class VisualMarkerApocenter extends VisualMarkerAbstract\r\n{\r\n    static _textureName = 'ap.png';\r\n    static _alignVertical = 'bottom';\r\n    static _alignHorizontal = 'center';\r\n}","\r\nimport VisualFlightEventAbstract from \"./Abstract\";\r\n\r\nexport default class VisualFlightEventImpulsiveBurn extends VisualFlightEventAbstract\r\n{\r\n    static _textureName = 'burn.png';\r\n}\r\n","import * as THREE from \"three\";\r\n\r\nimport VisualModelAbstract from \"./ModelAbstract\";\r\nimport { sim } from '../Simulation';\r\n\r\nexport default class VisualSprite extends VisualModelAbstract\r\n{\r\n    constructor(positionOfEpoch, texturePath, color, verticalAlign, horizontalAlign, scale) {\r\n        super();\r\n        this.positionOfEpoch = positionOfEpoch;\r\n        this.verticalAlign = verticalAlign || 'center';\r\n        this.horizontalAlign = horizontalAlign || 'center';\r\n        this.scale = scale || 1;\r\n        this.color = color || 0xFFFFFF;\r\n        this.loadTexture(texturePath);\r\n    }\r\n\r\n    loadTexture(texturePath) {\r\n        texturePath && sim.textureLoader.load(texturePath, texture => {\r\n            this.setTexture(texture);\r\n        });\r\n    }\r\n\r\n    setTexture(textureObj) {\r\n        if (this._dropped)\r\n            return;\r\n\r\n        this.setThreeObj(new THREE.Sprite(new THREE.SpriteMaterial(\r\n            {map: textureObj, sizeAttenuation: false, color: this.color}\r\n        )));\r\n        this.setScale(this.scale);\r\n        this.updateCenter();\r\n    }\r\n\r\n    updateCenter() {\r\n        this.threeObj && this.threeObj.center.set(\r\n            this.horizontalAlign === 'right'\r\n                ? 0\r\n                : this.horizontalAlign === 'left'\r\n                ? 1\r\n                : 0.5,\r\n            this.verticalAlign === 'top'\r\n                ? 0\r\n                : this.verticalAlign === 'bottom'\r\n                ? 1\r\n                : 0.5\r\n        );\r\n    }\r\n\r\n    setScale(scale) {\r\n        this.scale = scale;\r\n        this.threeObj.scale.set(\r\n            this.threeObj.material.map.image.width / 800 * this.scale, // god knows why 800, but it works...\r\n            this.threeObj.material.map.image.height / 800 * this.scale,\r\n            1\r\n        );\r\n    }\r\n\r\n    setColor(color) {\r\n        this.color = color;\r\n        this.threeObj.material.color.set(this.color);\r\n        this.threeObj.material.needsUpdate = true;\r\n    }\r\n\r\n    setAlign(vertical, horizontal) {\r\n        this.verticalAlign = vertical;\r\n        this.horizontalAlign = horizontal;\r\n        this.updateCenter();\r\n    }\r\n\r\n    setPositionOfEpoch(positionOfEpoch) {\r\n        this.positionOfEpoch = positionOfEpoch;\r\n    }\r\n\r\n    render(epoch) {\r\n        this.positionOfEpoch && this.setPosition(this.positionOfEpoch.evaluate(epoch));\r\n    }\r\n\r\n    drop() {\r\n        super.drop();\r\n        this._dropped = true;\r\n    }\r\n}\r\n","\r\nimport VisualSprite from \"./Sprite\";\r\nimport { sim } from '../Simulation';\r\n\r\nexport default class VisualSpriteStatic extends VisualSprite\r\n{\r\n    static _texture = null;\r\n    static _textureName = null;\r\n    static _alignVertical = 'center';\r\n    static _alignHorizontal = 'center';\r\n\r\n    static preloadTexture() {\r\n        sim.textureLoader.load('images/' + this._textureName, texture => {this._texture = texture});\r\n    }\r\n\r\n    constructor(color) {\r\n        super(null, null, color);\r\n\r\n        this.setAlign(this.constructor._alignVertical, this.constructor._alignHorizontal);\r\n\r\n        if (this.constructor._texture) {\r\n            this.setTexture(this.constructor._texture);\r\n        } else {\r\n            this.loadTexture('images/' + this.constructor._textureName);\r\n        }\r\n    }\r\n}","export default class OrientationAbstract\r\n{\r\n    getQuaternionByEpoch(epoch) {}\r\n}\r\n","import OrientationAbstract from \"./Abstract\";\r\nimport {Quaternion, Vector} from \"../algebra\";\r\n\r\nexport default class OrientationConstantAxis extends OrientationAbstract\r\n{\r\n    constructor(config) {\r\n        super();\r\n        const angularVelocity = new Vector(config.vector);\r\n        this.axisQuaternion = Quaternion.transfer(new Vector([0, 0, 1]), angularVelocity);\r\n        this.angularSpeed = angularVelocity.mag;\r\n        this.initialAngle = config.angle || 0;\r\n        this.initialEpoch = config.epoch || 0;\r\n    }\r\n\r\n    getQuaternionByEpoch(epoch) {\r\n        return this.axisQuaternion.mul(\r\n            new Quaternion(\r\n                [0, 0, 1],\r\n                this.initialAngle + (epoch - this.initialEpoch) * this.angularSpeed\r\n            )\r\n        );\r\n    }\r\n}\r\n","export default class PhysicalBodyModel\r\n{\r\n    constructor(config) {\r\n        this.mu       = config.mu;     // gravitational parameter\r\n        this.radius   = config.radius;\r\n        this.eqRadius = config.eqRadius;\r\n        this.j2       = config.j2 || 0;\r\n    }\r\n}","import TrajectoryKeplerianAbstract from \"./KeplerianAbstract\";\r\nimport {approximateAngle, approximateNumber} from \"../algebra\";\r\nimport KeplerianObject from \"../KeplerianObject\";\r\nimport StateVector from \"../StateVector\";\r\n\r\nexport default class TrajectoryKeplerianArray extends TrajectoryKeplerianAbstract\r\n{\r\n    constructor(referenceFrameId) {\r\n        super(referenceFrameId);\r\n        this.keplerianObjects = []; // array of class KeplerianObject\r\n    }\r\n\r\n    addState(keplerianObject) {\r\n        this.keplerianObjects.push(keplerianObject);\r\n    }\r\n\r\n    getKeplerianObjectByEpoch(epoch, referenceFrameOrId) {\r\n        this.validateEpoch(epoch);\r\n\r\n        let nextIdx = Math.ceil(\r\n            (epoch - this.keplerianObjects[0].epoch)\r\n            / (this.keplerianObjects[this.keplerianObjects.length - 1].epoch\r\n                - this.keplerianObjects[0].epoch\r\n            )\r\n            * (this.keplerianObjects.length - 1)\r\n        );\r\n        if (nextIdx < 0)\r\n            nextIdx = 0;\r\n        if (nextIdx > this.keplerianObjects.length - 1)\r\n            nextIdx = this.keplerianObjects.length - 1;\r\n        let searchDirection = this.keplerianObjects[nextIdx].epoch > epoch ? -1 : 1;\r\n\r\n        while ((nextIdx < this.keplerianObjects.length) && (nextIdx >= 0)) {\r\n            if (this.keplerianObjects[nextIdx].epoch == epoch) {\r\n                return this.keplerianObjects[nextIdx];\r\n            }\r\n            if ((this.keplerianObjects[nextIdx].epoch > epoch)\r\n                && (nextIdx === 0 || this.keplerianObjects[nextIdx - 1].epoch < epoch)\r\n            ) {\r\n                break;\r\n            }\r\n            nextIdx += searchDirection;\r\n        }\r\n\r\n        if ((nextIdx === this.keplerianObjects.length) || (nextIdx === 0)) {\r\n            nextIdx -= searchDirection;\r\n        }\r\n\r\n        return this._transformKeplerianObject(this.approximateKeplerianObject(\r\n            this.keplerianObjects[nextIdx - 1],\r\n            this.keplerianObjects[nextIdx],\r\n            epoch\r\n        ), referenceFrameOrId);\r\n    }\r\n\r\n    approximateKeplerianObject(object1, object2, epoch) {\r\n        const proportion = (epoch - object1.epoch) / (object2.epoch - object1.epoch);\r\n\r\n        if ((0.95 < object1.ecc && object1.ecc < 1.05)\r\n            || (0.95 < object2.ecc && object2.ecc < 1.05)\r\n            || (object1.isElliptic !== object2.isElliptic)\r\n        ) {\r\n            const state1 = object1.getStateByEpoch(epoch);\r\n            const state2 = object2.getStateByEpoch(epoch);\r\n            return KeplerianObject.createFromState(\r\n                new StateVector(\r\n                    state1.position.mul_(1 - proportion).add_(state2.position.mul_(proportion)),\r\n                    state1.velocity.mul_(1 - proportion).add_(state2.velocity.mul_(proportion)),\r\n                ),\r\n                approximateNumber(object1.mu, object2.mu, proportion),\r\n                epoch\r\n            );\r\n        }\r\n\r\n        const ma = object1.isElliptic\r\n            ? approximateAngle(object1.getMeanAnomalyByEpoch(epoch), object2.getMeanAnomalyByEpoch(epoch), proportion)\r\n            : approximateNumber(object1.getMeanAnomalyByEpoch(epoch), object2.getMeanAnomalyByEpoch(epoch), proportion);\r\n\r\n        return new KeplerianObject(\r\n            approximateNumber(object1.ecc, object2.ecc, proportion),\r\n            approximateNumber(object1.sma, object2.sma, proportion),\r\n            approximateAngle(object1.aop, object2.aop, proportion),\r\n            approximateAngle(object1.inc, object2.inc, proportion),\r\n            approximateAngle(object1.raan, object2.raan, proportion),\r\n            ma,\r\n            epoch,\r\n            approximateNumber(object1.mu, object2.mu, proportion),\r\n            false\r\n        );\r\n    }\r\n}\r\n","import TrajectoryKeplerianArray from \"./KeplerianArray\";\r\n\r\nexport default class TrajectoryKeplerianPrecessingArray extends TrajectoryKeplerianArray\r\n{\r\n    constructor(referenceFrameId, r, j2) {\r\n        super(referenceFrameId);\r\n        this.r = r;\r\n        this.j2 = j2;\r\n    }\r\n\r\n    approximateKeplerianObject(object1, object2, epoch) {\r\n        let obj1 = object1.copy();\r\n        let obj2 = object2.copy();\r\n        obj1.raan += obj1.getNodalPrecessionByEpoch(this.r, this.j2, epoch);\r\n        obj2.raan += obj2.getNodalPrecessionByEpoch(this.r, this.j2, epoch);\r\n        return super.approximateKeplerianObject(\r\n            obj1,\r\n            obj2,\r\n            epoch\r\n        );\r\n    }\r\n}","import TrajectoryKeplerianBasic from \"./KeplerianBasic\";\r\nimport KeplerianObject from \"../KeplerianObject\";\r\n\r\nexport default class TrajectoryKeplerianPrecessing extends TrajectoryKeplerianBasic\r\n{\r\n    constructor(referenceFrameId, keplerianObject, r, j2) {\r\n        super(referenceFrameId, keplerianObject);\r\n\r\n        this.r = r;\r\n        this.j2 = j2;\r\n    }\r\n\r\n    getKeplerianObjectByEpoch(epoch, referenceFrameOrId) {\r\n        this.validateEpoch(epoch);\r\n        return this._transformKeplerianObject(\r\n            this.keplerianObject.addPrecession(this.r, this.j2, epoch),\r\n            referenceFrameOrId\r\n        );\r\n    }\r\n\r\n    static createFromState(referenceFrame, state, mu, r, j2, epoch, color) {\r\n        return new TrajectoryKeplerianPrecessing(\r\n            referenceFrame,\r\n            KeplerianObject.createFromState(state, mu, epoch),\r\n            r,\r\n            j2,\r\n            color\r\n        );\r\n    }\r\n}\r\n","import VisualTrajectoryModelAbstract from \"./Abstract\";\r\nimport {deg2rad} from \"../../algebra\";\r\nimport { sim } from \"../../Simulation\";\r\n\r\nexport default class VisualTrajectoryPointArray extends VisualTrajectoryModelAbstract\r\n{\r\n    constructor(trajectory, config) {\r\n        super(trajectory, config);\r\n\r\n        this.referenceFrame = sim.starSystem.getReferenceFrame(config.referenceFrame);\r\n        this.showAhead = config.showAhead;\r\n        this.showBehind = config.showBehind;\r\n        this.trailPeriod = config.trailPeriod;\r\n\r\n        this.minCos = Math.cos(deg2rad(config.maxAngle || 2));\r\n        this.minStep = config.minStep || 180;\r\n        this.threeObj.position.set(0, 0, 0);\r\n\r\n        this.initVertices();\r\n    }\r\n\r\n    select() {\r\n        super.select();\r\n        this.showAhead = true;\r\n        this.showBehind = true;\r\n    }\r\n\r\n    deselect() {\r\n        super.deselect();\r\n        this.showAhead = this.config.showAhead;\r\n        this.showBehind = this.config.showBehind;\r\n    }\r\n\r\n    render(epoch) {\r\n        super.render(epoch);\r\n\r\n        const positionEpoch = this.getPositionEpoch(epoch);\r\n\r\n        if (positionEpoch === false) {\r\n            this.threeObj.visible = false;\r\n            return;\r\n        }\r\n\r\n        const endingBrightness = this.showBehind ? 0.4 : 0;\r\n        const originPos = this.referenceFrame.getOriginPositionByEpoch(epoch);\r\n        let points = [];\r\n        let colors = [];\r\n\r\n        for (let i = 0; i < this.positions.length; ++i) {\r\n            if (this.epochs[i] < positionEpoch - this.trailPeriod) {\r\n                if (this.showBehind) {\r\n                    points.push(this.positions[i]);\r\n                    colors.push(0);\r\n                }\r\n                if (this.epochs[i+1] > positionEpoch - this.trailPeriod) {\r\n                    points.push(\r\n                        this.trajectory.getPositionByEpoch(positionEpoch - this.trailPeriod, this.referenceFrame)\r\n                    );\r\n                    colors.push(0);\r\n                }\r\n            } else if (this.epochs[i] < positionEpoch) {\r\n                points.push(this.positions[i]);\r\n                colors.push(1 - (positionEpoch - this.epochs[i]) / this.trailPeriod);\r\n            } else if (this.epochs[i] > positionEpoch && this.showAhead) {\r\n                points.push(this.positions[i]);\r\n                colors.push(0);\r\n            }\r\n\r\n            if ((this.epochs[i] < positionEpoch)\r\n                && (this.epochs[i+1] >= positionEpoch)\r\n            ) {\r\n                const pos = this.trajectory.getPositionByEpoch(positionEpoch, this.referenceFrame);\r\n                points.push(pos);\r\n                points.push(pos);\r\n                colors.push(1);\r\n                colors.push(0);\r\n            }\r\n        }\r\n\r\n        this.updateGeometry(points, colors, endingBrightness);\r\n\r\n        this.threeObj.quaternion.copy(this.referenceFrame.getQuaternionByEpoch(epoch).toThreejs());\r\n        this.setPosition(originPos);\r\n    }\r\n\r\n    findPointByEpoch(epoch) {\r\n        let low  = 0;\r\n        let high = this.epochs.length - 1;\r\n        let idx = Math.floor((low + high) / 2);\r\n\r\n        do {\r\n            if (this.epochs[idx] < epoch) {\r\n                low = idx;\r\n            } else if (this.epochs[idx] > epoch) {\r\n                high = idx;\r\n            } else {\r\n                return idx;\r\n            }\r\n            idx = Math.floor((low + high) / 2)\r\n        } while (idx != low);\r\n\r\n        return (epoch - this.epochs[idx] > this.epochs[idx + 1] - epoch)\r\n            ? idx + 1\r\n            : idx;\r\n    }\r\n\r\n    initVertices() {\r\n        const traj = this.trajectory;\r\n        let step = this.minStep;\r\n        let curEpoch = traj.minEpoch;\r\n        let curState = traj.getStateByEpoch(curEpoch, this.referenceFrame);\r\n        let curVelocity = curState.velocity.unit_();\r\n\r\n        this.positions = [curState.position];\r\n        this.epochs = [curEpoch];\r\n        let i = 1;\r\n\r\n        while (curEpoch < traj.maxEpoch) {\r\n            let lastState;\r\n            let lastEpoch;\r\n            let lastDrMag;\r\n            let isIncreasing = null;\r\n            let stepsLeft = 20;\r\n            while (true) {\r\n                const nextEpoch = (curEpoch + step > traj.maxEpoch)\r\n                    ? traj.maxEpoch\r\n                    : curEpoch + step;\r\n                step = nextEpoch - curEpoch;\r\n                const newState = traj.getStateByEpoch(nextEpoch, this.referenceFrame);\r\n                const dr = newState._position.sub(curState._position);\r\n                const drMag = dr.mag;\r\n                let angleCos = dr.dot(curVelocity) / drMag;\r\n\r\n                if (nextEpoch != traj.maxEpoch) {\r\n                    const nextNextEpoch = (nextEpoch + step > traj.maxEpoch)\r\n                        ? traj.maxEpoch\r\n                        : nextEpoch + step;\r\n                    const nextNewState = traj.getStateByEpoch(nextNextEpoch, this.referenceFrame);\r\n                    const nextDr = nextNewState._position.sub(newState._position);\r\n                    angleCos = Math.min(angleCos, dr.dot(nextDr) / drMag / nextDr.mag);\r\n                }\r\n\r\n                // angle is too big\r\n                if (angleCos < this.minCos) {\r\n                    if (isIncreasing === true) {\r\n                        break;\r\n                    }\r\n                    step /= 2;\r\n                    isIncreasing = false;\r\n                // angle is acceptable\r\n                } else {\r\n                    lastState = newState;\r\n                    lastEpoch = nextEpoch;\r\n                    lastDrMag = drMag;\r\n                    if (isIncreasing === false || nextEpoch === traj.maxEpoch) {\r\n                        break;\r\n                    }\r\n                    step *= 2;\r\n                    isIncreasing = true;\r\n                }\r\n\r\n                --stepsLeft;\r\n                if (stepsLeft === 0 || Math.abs(step) < this.minStep) {\r\n                    step = this.minStep * Math.sign(step);\r\n                    if (lastState === undefined) {\r\n                        lastState = newState;\r\n                        lastEpoch = nextEpoch;\r\n                        lastDrMag = drMag;\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n\r\n            this.epochs[i] = lastEpoch;\r\n            this.positions[i] = lastState.position;\r\n\r\n            curState = lastState;\r\n            curVelocity = curState.velocity.unit_();\r\n            curEpoch = lastEpoch;\r\n            i++;\r\n        }\r\n    }\r\n}\r\n","import TrajectoryAbstract from \"./Abstract\";\r\nimport StateVector from \"../StateVector\";\r\n\r\nexport default class TrajectoryStaticPosition extends TrajectoryAbstract\r\n{\r\n    constructor(referenceFrameId, pos) {\r\n        super();\r\n        this.setReferenceFrame(referenceFrameId);\r\n        this.pos = pos;\r\n    }\r\n\r\n    getStateInOwnFrameByEpoch(epoch) {\r\n        this.validateEpoch(epoch);\r\n        return new StateVector(this.pos);\r\n    }\r\n}\r\n","import TrajectoryKeplerianArray from \"../core/Trajectory/KeplerianArray\";\r\nimport TrajectoryKeplerianPrecessingArray from \"../core/Trajectory/KeplerianPrecessingArray\";\r\nimport TrajectoryKeplerianBasic from \"../core/Trajectory/KeplerianBasic\";\r\nimport TrajectoryKeplerianPrecessing from \"../core/Trajectory/KeplerianPrecessing\";\r\nimport KeplerianObject from \"../core/KeplerianObject\";\r\nimport TrajectoryComposite from \"../core/Trajectory/Composite\";\r\nimport VisualTrajectoryModelPointArray from \"../core/visual/Trajectory/PointArray\";\r\nimport VisualTrajectoryModelKeplerian from \"../core/visual/Trajectory/Keplerian\";\r\nimport TrajectoryStaticPosition from \"../core/Trajectory/StaticPosition\";\r\nimport {Vector} from \"../core/algebra\";\r\nimport { sim } from \"../core/Simulation\";\r\n\r\nexport default class TrajectoryLoader\r\n{\r\n    static create(config) {\r\n        let type = config.type;\r\n        let trajectory;\r\n        let visualModel;\r\n        let selectedVisualModel;\r\n\r\n        if (type === 'keplerian') {\r\n            trajectory = this.createKeplerianBasic(config);\r\n        } else if (type === 'keplerian_precessing') {\r\n            trajectory = this.createKeplerianPrecessing(config);\r\n        } else if (type === 'keplerian_array') {\r\n            trajectory = this.createKeplerianArray(config);\r\n        } else if (type === 'keplerian_precessing_array') {\r\n            trajectory = this.createKeplerianPrecessingArray(config);\r\n        } else if (type === 'composite') {\r\n            trajectory = this.createComposite(config);\r\n        } else if (type === 'static') {\r\n            trajectory = this.createStatic(config);\r\n        } else {\r\n            const className = sim.getClass(type);\r\n            trajectory = new className(config.data);\r\n        }\r\n\r\n        if (config.periodStart !== undefined) {\r\n            trajectory.minEpoch = config.periodStart;\r\n        }\r\n        if (config.periodEnd !== undefined) {\r\n            trajectory.maxEpoch = config.periodEnd;\r\n        }\r\n\r\n        // temporary\r\n        if (config.rendering) {\r\n            config.visual = config.rendering;\r\n        }\r\n\r\n        if (config.visual !== undefined) {\r\n            if (config.visual.regular !== undefined) {\r\n                visualModel = this.createVisualModel(trajectory, config.visual.regular);\r\n                selectedVisualModel = this.createVisualModel(trajectory, config.visual.selected);\r\n            } else {\r\n                visualModel = this.createVisualModel(trajectory, config.visual);\r\n            }\r\n        }\r\n\r\n        if (visualModel) {\r\n            trajectory.setVisualModel(visualModel);\r\n        }\r\n        if (selectedVisualModel) {\r\n            trajectory.setSelectedVisualModel(selectedVisualModel);\r\n        }\r\n\r\n        return trajectory;\r\n    }\r\n\r\n    static createVisualModel(trajectory, config) {\r\n        // legacy format, will be removed\r\n        if (config.keplerianModel) {\r\n            return new VisualTrajectoryModelKeplerian(trajectory, config);\r\n        } else if (config.pointArrayModel) {\r\n            return new VisualTrajectoryModelPointArray(trajectory, config);\r\n        }\r\n\r\n        let className;\r\n        if (config.model === 'keplerian') {\r\n            className = VisualTrajectoryModelKeplerian;\r\n        } else if (config.model === 'pointArray') {\r\n            className = VisualTrajectoryModelPointArray;\r\n        } else {\r\n            className = sim.getClass(config.model);\r\n        }\r\n        return new className(trajectory, config.config);\r\n    }\r\n\r\n    static createComposite(config) {\r\n        let traj = new TrajectoryComposite();\r\n        for (const partConfig of config.data) {\r\n            traj.addComponent(this.create(partConfig));\r\n        }\r\n        return traj;\r\n    }\r\n\r\n    static createKeplerianArray(config) {\r\n        let traj = new TrajectoryKeplerianArray(\r\n            config.data.referenceFrame\r\n        );\r\n\r\n        for (const entry of config.data.elementsArray) {\r\n            traj.addState(this.createKeplerianObject(entry, config.data.mu));\r\n        }\r\n        return traj;\r\n    }\r\n\r\n    static createKeplerianPrecessingArray(config) {\r\n        let traj = new TrajectoryKeplerianPrecessingArray(\r\n            config.data.referenceFrame,\r\n            config.data.radius,\r\n            config.data.j2\r\n        );\r\n\r\n        for (const entry of config.data.elementsArray) {\r\n            traj.addState(this.createKeplerianObject(entry, config.data.mu));\r\n        }\r\n        return traj;\r\n    }\r\n\r\n    static createKeplerianBasic(config) {\r\n        return new TrajectoryKeplerianBasic(\r\n            config.data.referenceFrame,\r\n            this.createKeplerianObject(config.data.elements)\r\n        );\r\n    }\r\n\r\n    static createKeplerianPrecessing(config) {\r\n        return new TrajectoryKeplerianPrecessing(\r\n            config.data.referenceFrame,\r\n            this.createKeplerianObject(config.data.elements),\r\n            config.data.radius,\r\n            config.data.j2\r\n        );\r\n    }\r\n\r\n    static createStatic(config) {\r\n        return new TrajectoryStaticPosition(\r\n            config.data.referenceFrame,\r\n            new Vector(config.data.position)\r\n        );\r\n    }\r\n\r\n    static createKeplerianObject(elements, mu) {\r\n        return new KeplerianObject(\r\n            elements[0], // ecc\r\n            elements[1] / (1 - elements[0]), // sma = Rper / (1 - ecc)\r\n            elements[2], // aop\r\n            elements[3], // inc\r\n            elements[4], // raan\r\n            elements[5], // mean anomaly\r\n            elements[6], // epoch\r\n            mu ? mu : elements[7], // mu\r\n            false\r\n        );\r\n    }\r\n}\r\n","import * as THREE from \"three\";\r\n\r\nimport { deg2rad, Quaternion } from \"../algebra\";\r\nimport VisualModelAbstract from \"./ModelAbstract\";\r\n\r\nexport default class VisualStarsModel extends VisualModelAbstract\r\n{\r\n    constructor(data) {\r\n        super();\r\n\r\n        let threeGeometry = new THREE.Geometry();\r\n\r\n        const starDist = 1e12;\r\n\r\n        for(let params of data) {\r\n\r\n            threeGeometry.vertices.push(new THREE.Vector3(\r\n                starDist * Math.cos(deg2rad(params[0])) * Math.cos(deg2rad(params[1])),\r\n                starDist * Math.sin(deg2rad(params[0])) * Math.cos(deg2rad(params[1])),\r\n                starDist * Math.sin(deg2rad(params[1]))\r\n            ));\r\n\r\n            threeGeometry.colors.push(new THREE.Color(\r\n                params[2] / 50,\r\n                params[2] / 50,\r\n                params[2] / 50\r\n            ));\r\n        }\r\n\r\n        this.setThreeObj(new THREE.Points(\r\n            threeGeometry,\r\n            new THREE.PointsMaterial({\r\n                vertexColors: THREE.VertexColors,\r\n                size: 2,\r\n                sizeAttenuation: false\r\n            })\r\n        ));\r\n\r\n        this.threeObj.quaternion.copy(new Quaternion([-1, 0, 0], deg2rad(23.4)).toThreejs());\r\n    }\r\n}\r\n","import * as THREE from \"three\";\r\n\r\nimport VisualModelAbstract from \"./ModelAbstract\";\r\nimport { sim } from \"../Simulation\";\r\n\r\nexport default class VisualLabel extends VisualModelAbstract {\r\n    constructor(positionOfEpoch, parameters) {\r\n        super();\r\n\r\n        this.visible = true;\r\n\r\n        this.parameters = Object.assign({}, VisualLabel.DEFAULT_SETTINGS, parameters);\r\n        this.positionOfEpoch = positionOfEpoch;\r\n\r\n        this.canvas = document.createElement('canvas');\r\n\r\n        this.setThreeObj(new THREE.Sprite(new THREE.SpriteMaterial(\r\n            {map: new THREE.CanvasTexture(this.canvas)}\r\n        )));\r\n\r\n        this.threeObj.renderOrder = 1;\r\n\r\n        this.setText(this.parameters.text);\r\n    }\r\n\r\n    setText(text) {\r\n        let context = this.canvas.getContext('2d');\r\n        context.font = this.parameters.fontSize + 'px ' + this.parameters.font;\r\n\r\n        let canvasWidth = context.measureText(text).width;\r\n        let canvasHeight = this.parameters.fontSize * (1 + this.parameters.margin) * 2;\r\n        this.canvas.width = THREE.Math.ceilPowerOfTwo(canvasWidth);\r\n        this.canvas.height = THREE.Math.ceilPowerOfTwo(canvasHeight);\r\n\r\n        context.font = this.parameters.fontSize + 'px ' + this.parameters.font;\r\n        context.fillStyle = this.parameters.color;\r\n        context.textAlign = 'center';\r\n        context.textBaseline = 'bottom';\r\n        context.fillText(\r\n            text,\r\n            this.canvas.width / 2,\r\n            this.parameters.fontSize + (this.canvas.height - canvasHeight) / 2\r\n        );\r\n\r\n        this.threeObj.material.map.needsUpdate = true;\r\n    }\r\n\r\n    render(epoch) {\r\n        if (!this.visible) {\r\n            this.threeObj.visible = false;\r\n            return;\r\n        }\r\n\r\n        this.setPosition(this.positionOfEpoch.evaluate(epoch));\r\n\r\n        const distance = this.threeObj.position.length();\r\n\r\n        const scaleCoeff = this.calculateScaleCoeff(distance, this.parameters.scaling) / 2;\r\n        this.threeObj.scale.x = this.canvas.width  * scaleCoeff;\r\n        this.threeObj.scale.y = this.canvas.height * scaleCoeff;\r\n\r\n        this.threeObj.visible = 1 < Math.max(this.threeObj.scale.x, this.threeObj.scale.y) /\r\n            (distance * this.pixelAngleSize) / 2;\r\n    }\r\n\r\n    calculateScaleCoeff(distance, scaling) {\r\n        if (typeof scaling.callback === 'string') {\r\n            return VisualLabel.scalingFunctions[scaling.callback](distance, scaling.range);\r\n        }\r\n        return scaling.callback(distance, scaling.range);\r\n    }\r\n}\r\n\r\nVisualLabel.DEFAULT_SETTINGS = {\r\n    text: '',\r\n    font: 'Arial',\r\n    color: 'white',\r\n    fontSize: 32,\r\n    margin: 0,\r\n    scaling: {\r\n        range: {\r\n            from: 30000,\r\n            to: 700000,\r\n        },\r\n        callback: 'range'\r\n    }\r\n};\r\n\r\nVisualLabel.scalingFunctions = {\r\n    alwaysVisible: (distance) => distance * sim.raycaster.getPixelAngleSize(),\r\n    range: (distance, range) => {\r\n        if (distance < range.from) {\r\n            return range.from * sim.raycaster.getPixelAngleSize();\r\n        }\r\n        if (distance > range.to) {\r\n            return range.to * sim.raycaster.getPixelAngleSize();\r\n        }\r\n        return distance * sim.raycaster.getPixelAngleSize();\r\n    }\r\n};\r\n","import * as THREE from \"three\";\r\n\r\nimport VisualModelAbstract from \"../ModelAbstract\";\r\nimport VisualLabel from \"../Label\";\r\nimport EphemerisObject from \"../../EphemerisObject\";\r\nimport FunctionOfEpochCustom from \"../../FunctionOfEpoch/Custom\";\r\nimport { sim } from \"../../Simulation\";\r\n\r\nexport default class VisualBodyModelAbstract extends VisualModelAbstract\r\n{\r\n    constructor(shape, config) {\r\n        super();\r\n\r\n        this.shape = shape;   // class VisualShapeAbstract\r\n        this.color = config.color;\r\n        this.body = null; // class Body\r\n\r\n        this.setThreeObj(this.getThreeObj());\r\n        this.threeObj.add(new THREE.AxesHelper(shape.radius * 2));\r\n    }\r\n\r\n    getThreeObj() {\r\n        return new THREE.Mesh(\r\n            this.shape.getThreeGeometry(),\r\n            this.getMaterial({color: this.color, wireframe: true})\r\n        );\r\n    }\r\n\r\n    setObject(obj) {\r\n        this.body = obj;\r\n        this.label = new VisualLabel(\r\n            new FunctionOfEpochCustom((epoch) => {\r\n                return obj.getPositionByEpoch(epoch).add_(sim.camera.getTopDirection(epoch).mul_(this.shape.getMaxDimension() / 2));\r\n            }),\r\n            {\r\n                text: this.body.name,\r\n                margin: 0.3,\r\n                scaling: (this.body.type === EphemerisObject.TYPE_STAR\r\n                        || this.body.type === EphemerisObject.TYPE_PLANET)\r\n                    ? {callback: 'alwaysVisible'}\r\n                    : (this.body.type === EphemerisObject.TYPE_PLANETOID\r\n                        || this.body.type === EphemerisObject.TYPE_SATELLITE)\r\n                        ? {\r\n                            callback: 'range',\r\n                            range: {\r\n                                from: 5 * this.shape.getMaxDimension(),\r\n                                to: 1000 * this.shape.getMaxDimension()\r\n                            }\r\n                        }\r\n                        : VisualLabel.DEFAULT_SETTINGS.scaling\r\n            }\r\n        );\r\n        this.threeObj.userData = {selectionObject: obj};\r\n        sim.selection.addSelectableObject(this.threeObj);\r\n    }\r\n\r\n    getMaterial(parameters) {\r\n        return new THREE.MeshStandardMaterial(parameters);\r\n    }\r\n\r\n    drop() {\r\n        if (this.label) {\r\n            this.label.drop();\r\n        }\r\n\r\n        sim.selection.removeSelectableObject(this.threeObj);\r\n\r\n        super.drop();\r\n    }\r\n\r\n    render(epoch) {\r\n        if (this.label) {\r\n            this.label.visible = sim.settings.ui.showBodyLabels;\r\n        }\r\n        this.setPosition(this.body.getPositionByEpoch(epoch));\r\n        this.threeObj.quaternion.copy(\r\n            this.body.orientation.getQuaternionByEpoch(epoch).toThreejs()\r\n        );\r\n    }\r\n}\r\n","import * as THREE from \"three\";\r\n\r\nimport VisualBodyModelAbstract from \"./Abstract\";\r\nimport VisualModelAbstract from \"../ModelAbstract\"\r\nimport { sim } from \"../../Simulation\";\r\n\r\nexport default class VisualBodyModelBasic extends VisualBodyModelAbstract\r\n{\r\n    constructor(shape, config) {\r\n        super(shape, config);\r\n\r\n        this.texturePath = config.texturePath;\r\n        this.isTextureRequested = false;\r\n    }\r\n\r\n    getMaterial(parameters) {\r\n        parameters.metalness = 0;\r\n        parameters.roughness = 1;\r\n        return new THREE.MeshStandardMaterial(parameters);\r\n    }\r\n\r\n    render(epoch) {\r\n        super.render(epoch);\r\n        if (!this.isTextureRequested\r\n            && this.texturePath\r\n            && this.shape.getMaxDimension() / this.threeObj.position.length() > this.pixelAngleSize\r\n        ) {\r\n            this.isTextureRequested = true;\r\n            sim.textureLoader.load(\r\n                VisualModelAbstract.texturePath + this.texturePath,\r\n                (txt) => {\r\n                    if (this.threeObj) {\r\n                        this.threeObj.material.dispose();\r\n                        this.threeObj.material = this.getMaterial({map: txt});\r\n                    }\r\n                },\r\n                undefined,\r\n                function(err) {\r\n                    console.log(err);\r\n                }\r\n            );\r\n        }\r\n    }\r\n}\r\n","import * as THREE from \"three\";\r\n\r\nimport VisualBodyModelBasic from \"./Basic\";\r\nimport { sim } from \"../../Simulation\";\r\n\r\nexport default class VisualBodyModelLight extends VisualBodyModelBasic\r\n{\r\n    constructor(shape, config) {\r\n        super(shape, config);\r\n        this.light = new THREE.PointLight(\r\n            config.lightColor,\r\n            config.lightIntensity,\r\n            config.lightDistance || null,\r\n            config.lightDecay || null\r\n        );\r\n        this.scene.add(this.light);\r\n    }\r\n\r\n    render(epoch) {\r\n        super.render(epoch);\r\n        this.light.position.copy(sim.getVisualCoords(this.body.getPositionByEpoch(epoch)));\r\n    }\r\n\r\n    getMaterial(parameters) {\r\n        return new THREE.MeshBasicMaterial(parameters);\r\n    }\r\n\r\n    drop() {\r\n        this.scene.remove(this.light);\r\n        super.drop();\r\n    }\r\n}\r\n","import * as THREE from \"three\";\r\n\r\nimport VisualBodyModelAbstract from \"./Abstract\";\r\nimport VisualModelAbstract from \"../ModelAbstract\"\r\nimport { sim } from \"../../Simulation\";\r\n\r\nexport default class VisualBodyModelRings extends VisualBodyModelAbstract\r\n{\r\n    constructor(shape, config) {\r\n        super(shape, config);\r\n\r\n        this.texturePath = config.texturePath;\r\n        this.ringsRadius = config.ringsRadius;\r\n        this.ringsColorMapPath = config.ringsColorMapPath;\r\n        this.ringsAlphaMapPath = config.ringsAlphaMapPath;\r\n        this.isTextureRequested = false;\r\n    }\r\n\r\n    getThreeObj() {\r\n        let container = new THREE.Object3D();\r\n\r\n        this.bodyThreeObj = new THREE.Mesh(\r\n            this.shape.getThreeGeometry(),\r\n            this.getMaterial({color: this.color, wireframe: true})\r\n        );\r\n\r\n        this.ringsThreeObj = new THREE.Mesh(\r\n            new THREE.CircleGeometry(140220, 64),\r\n            this.getMaterial({color: this.color, wireframe: true})\r\n        );\r\n\r\n        container.add(this.bodyThreeObj);\r\n        container.add(this.ringsThreeObj);\r\n\r\n        return container;\r\n    }\r\n\r\n    updateRingsMaterial() {\r\n        if (this.ringsColorMap && this.ringsAlphaMap) {\r\n            this.ringsThreeObj.material.dispose();\r\n            this.ringsThreeObj.material = this.getMaterial({\r\n                map: this.ringsColorMap,\r\n                alphaMap: this.ringsAlphaMap,\r\n                side: THREE.DoubleSide,\r\n                transparent: true\r\n            });\r\n        }\r\n    }\r\n\r\n    getMaterial(parameters) {\r\n        parameters.metalness = 0;\r\n        parameters.roughness = 1;\r\n        return new THREE.MeshStandardMaterial(parameters);\r\n    }\r\n\r\n    render(epoch) {\r\n        super.render(epoch);\r\n        if (!this.isTextureRequested\r\n            && this.texturePath\r\n            && this.shape.getMaxDimension() / this.threeObj.position.length() > this.pixelAngleSize\r\n        ) {\r\n            this.isTextureRequested = true;\r\n            sim.textureLoader.load(\r\n                VisualModelAbstract.texturePath + this.texturePath,\r\n                (txt) => {\r\n                    this.bodyThreeObj.material.dispose();\r\n                    this.bodyThreeObj.material = this.getMaterial({map: txt});\r\n                },\r\n                undefined,\r\n                function(err) {\r\n                    console.log(err);\r\n                }\r\n            );\r\n            sim.textureLoader.load(\r\n                VisualModelAbstract.texturePath + this.ringsColorMapPath,\r\n                (txt) => {\r\n                    this.ringsColorMap = txt;\r\n                    this.updateRingsMaterial();\r\n                },\r\n                undefined,\r\n                function(err) {\r\n                    console.log(err);\r\n                }\r\n            );\r\n            sim.textureLoader.load(\r\n                VisualModelAbstract.texturePath + this.ringsAlphaMapPath,\r\n                (txt) => {\r\n                    this.ringsAlphaMap = txt;\r\n                    this.updateRingsMaterial();\r\n                },\r\n                undefined,\r\n                function(err) {\r\n                    console.log(err);\r\n                }\r\n            );\r\n        }\r\n    }\r\n}\r\n","import * as THREE from \"three\";\r\n\r\nimport VisualShapeAbstract from \"./Abstract\";\r\n\r\nexport default class VisualShapeSphere extends VisualShapeAbstract\r\n{\r\n    constructor(radius, segments) {\r\n        super();\r\n        this.radius = radius;\r\n        this.segments = segments;\r\n    }\r\n\r\n    getThreeGeometry() {\r\n        if (!this.threeGeometry) {\r\n            this.threeGeometry = new THREE.SphereGeometry(this.radius, this.segments * 2, this.segments);\r\n            this.threeGeometry.rotateX(Math.PI / 2);\r\n        }\r\n\r\n        return this.threeGeometry;\r\n    }\r\n\r\n    getMaxDimension() {\r\n        return this.radius * 2;\r\n    }\r\n}\r\n","import $ from \"jquery\";\r\n\r\nimport ReferenceFrameFactory, {RF_BASE_OBJ} from \"../core/ReferenceFrame/Factory\";\r\nimport Body from \"../core/Body\";\r\nimport OrientationConstantAxis from \"../core/Orientation/ConstantAxis\";\r\nimport PhysicalBodyModel from \"../core/PhysicalBodyModel\";\r\nimport EphemerisObject from \"../core/EphemerisObject\";\r\nimport TrajectoryLoader from \"./TrajectoryLoader\";\r\nimport VisualStarsModel from \"../core/visual/StarsModel\";\r\nimport VisualBodyModelLight from \"../core/visual/BodyModel/Light\";\r\nimport VisualBodyModelRings from \"../core/visual/BodyModel/Rings\";\r\nimport VisualBodyModelBasic from \"../core/visual/BodyModel/Basic\";\r\nimport VisualShapeSphere from \"../core/visual/Shape/Sphere\";\r\nimport Events from \"../core/Events\";\r\nimport { sim } from \"../core/Simulation\";\r\nimport {STAR_SYSTEM_BARYCENTER} from \"../core/StarSystem\";\r\n\r\nexport default class StarSystemLoader\r\n{\r\n    static loadFromConfig(starSystem, config) {\r\n        // Loading name\r\n        starSystem.name = config.name;\r\n\r\n        // Loading main object\r\n        starSystem.mainObject = config.mainObject;\r\n\r\n        starSystem.addObject(\r\n            STAR_SYSTEM_BARYCENTER,\r\n            new EphemerisObject(STAR_SYSTEM_BARYCENTER, EphemerisObject.TYPE_POINT, 'Star system barycenter')\r\n        );\r\n\r\n        // Loading objects\r\n        for (const objectConfig of config.objects) {\r\n            this._loadObject(starSystem, objectConfig);\r\n        }\r\n\r\n        Events.dispatch(Events.LOADING_BODIES_DONE);\r\n\r\n        // Loading reference frames\r\n        starSystem.addReferenceFrame(RF_BASE_OBJ);\r\n\r\n        for (const frame of config.referenceFrames) {\r\n            starSystem.addReferenceFrame(\r\n                ReferenceFrameFactory.create(frame.id, frame.type, frame.config)\r\n            );\r\n        }\r\n\r\n        Events.dispatch(Events.LOADING_FRAMES_DONE);\r\n\r\n        // Loading trajectories\r\n        for (const objectConfig of config.objects) {\r\n            starSystem.getObject(objectConfig.id).setTrajectory(TrajectoryLoader.create(objectConfig.trajectory));\r\n        }\r\n\r\n        Events.dispatch(Events.LOADING_TRAJECTORIES_DONE);\r\n\r\n        // Loading stars\r\n        starSystem.addStars(new VisualStarsModel(config.stars));\r\n    }\r\n\r\n    static loadObjectByUrl(starSystem, url) {\r\n        return Promise.resolve($.getJSON(url, (objectConfig) => {\r\n            this._loadObject(starSystem, objectConfig);\r\n            starSystem.getObject(objectConfig.id).setTrajectory(TrajectoryLoader.create(objectConfig.trajectory));\r\n        }));\r\n    }\r\n\r\n    static _loadObject(starSystem, config) {\r\n        let object;\r\n        let visualModel = null;\r\n        let physicalModel = null;\r\n        let orientation = null;\r\n\r\n        if (config.visual) {\r\n            const visualShape = new VisualShapeSphere(\r\n                config.visual.config.radius,\r\n                config.visual.config.texturePath ? 32 : 12\r\n            );\r\n            const visualModelClass = {\r\n                'basic': VisualBodyModelBasic,\r\n                'light': VisualBodyModelLight,\r\n                'rings': VisualBodyModelRings,\r\n            }[config.visual.model];\r\n\r\n            if (visualModelClass !== undefined) {\r\n                visualModel = new visualModelClass(visualShape, config.visual.config);\r\n            }\r\n        }\r\n\r\n        if (config.physical || config.orientation) {\r\n            if (!config.orientation) {\r\n                config.orientation = {\r\n                    type: 'constantAxis',\r\n                    config: {\r\n                        vector: [0, 0, 1e-11]\r\n                    }\r\n                };\r\n            }\r\n            let className;\r\n            if (config.orientation.type === 'constantAxis') {\r\n                className = OrientationConstantAxis;\r\n            } else {\r\n                className = sim.getClass(config.orientation.type);\r\n            }\r\n            orientation = new className(config.orientation.config);\r\n        }\r\n\r\n        if (config.physical) {\r\n            physicalModel = new PhysicalBodyModel(\r\n                config.physical\r\n            );\r\n        }\r\n\r\n        if (visualModel || physicalModel || orientation) {\r\n            object = new Body(\r\n                config.id,\r\n                config.type || EphemerisObject.TYPE_UNKNOWN,\r\n                config.name,\r\n                config.data,\r\n                visualModel,\r\n                physicalModel,\r\n                orientation\r\n            );\r\n        } else {\r\n            object = new EphemerisObject(\r\n                config.id,\r\n                config.type || EphemerisObject.TYPE_UNKNOWN,\r\n                config.name,\r\n                config.data\r\n            );\r\n        }\r\n\r\n        starSystem.addObject(\r\n            config.id,\r\n            object\r\n        );\r\n    }\r\n}\r\n","import { satelliteTransformer } from \"./transformers/satellite-transformer\";\r\n\r\nclass Satellite {\r\n    constructor(satelliteRawData) {\r\n        Object.assign(this, satelliteTransformer(satelliteRawData), {});\r\n    }\r\n}\r\n\r\nexport default Satellite;\r\n","export function satelliteTransformer(data) {\r\n    return {\r\n        noradId: data[\"norad_id\"],\r\n        objectType: data[\"object_type\"],\r\n        intlDes: data[\"intl_des\"],\r\n        name: data[\"name\"],\r\n        country: data[\"country\"],\r\n        launchDate: data[\"launch_date\"],\r\n        decayDate: data[\"decay_date\"],\r\n        launchSite: data[\"launch_site\"],\r\n        period: data[\"period\"],\r\n        inc: data[\"inc\"],\r\n        apogee: data[\"apogee\"],\r\n        perigee: data[\"perigee\"],\r\n        launchYear: data[\"launch_year\"],\r\n        launchNum: data[\"launch_num\"],\r\n        launchPiece: data[\"launch_piece\"],\r\n        objectName: data[\"object_name\"],\r\n        objectId: data[\"object_id\"],\r\n        objectNumber: data[\"object_number\"],\r\n    };\r\n}\r\n","var map = {\n\t\"./KSP/ModuleKSP\": [\n\t\t99,\n\t\t2\n\t],\n\t\"./KSP/ModuleKSP.js\": [\n\t\t99,\n\t\t2\n\t],\n\t\"./PatchedConics/FlightEvent/SOIArrival\": [\n\t\t42\n\t],\n\t\"./PatchedConics/FlightEvent/SOIArrival.js\": [\n\t\t42\n\t],\n\t\"./PatchedConics/FlightEvent/SOIChangeAbstract\": [\n\t\t44\n\t],\n\t\"./PatchedConics/FlightEvent/SOIChangeAbstract.js\": [\n\t\t44\n\t],\n\t\"./PatchedConics/FlightEvent/SOIDeparture\": [\n\t\t41\n\t],\n\t\"./PatchedConics/FlightEvent/SOIDeparture.js\": [\n\t\t41\n\t],\n\t\"./PatchedConics/ModulePatchedConics\": [\n\t\t100,\n\t\t3\n\t],\n\t\"./PatchedConics/ModulePatchedConics.js\": [\n\t\t100,\n\t\t3\n\t],\n\t\"./PatchedConics/PropagatorPatchedConics\": [\n\t\t96,\n\t\t4\n\t],\n\t\"./PatchedConics/PropagatorPatchedConics.js\": [\n\t\t96,\n\t\t4\n\t],\n\t\"./PatchedConics/visual/FlightEvent/SOIArrival\": [\n\t\t58\n\t],\n\t\"./PatchedConics/visual/FlightEvent/SOIArrival.js\": [\n\t\t58\n\t],\n\t\"./PatchedConics/visual/FlightEvent/SOIDeparture\": [\n\t\t57\n\t],\n\t\"./PatchedConics/visual/FlightEvent/SOIDeparture.js\": [\n\t\t57\n\t],\n\t\"./SolarSystem/ModuleSolarSystem\": [\n\t\t94,\n\t\t0\n\t],\n\t\"./SolarSystem/ModuleSolarSystem.js\": [\n\t\t94,\n\t\t0\n\t],\n\t\"./SolarSystem/Orientation/IAUModel\": [\n\t\t95,\n\t\t5\n\t],\n\t\"./SolarSystem/Orientation/IAUModel.js\": [\n\t\t95,\n\t\t5\n\t],\n\t\"./SolarSystem/Trajectory/ELP2000\": [\n\t\t97,\n\t\t0\n\t],\n\t\"./SolarSystem/Trajectory/ELP2000.js\": [\n\t\t97,\n\t\t0\n\t],\n\t\"./SolarSystem/Trajectory/VSOP87\": [\n\t\t98,\n\t\t0\n\t],\n\t\"./SolarSystem/Trajectory/VSOP87.js\": [\n\t\t98,\n\t\t0\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tvar ids = map[req];\n\tif(!ids) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\treturn Promise.all(ids.slice(1).map(__webpack_require__.e)).then(function() {\n\t\tvar id = ids[0];\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 104;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./getting-started-wizard/index\": [\n\t\t55,\n\t\t1\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tvar ids = map[req];\n\tif(!ids) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\treturn __webpack_require__.e(ids[1]).then(function() {\n\t\tvar id = ids[0];\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 113;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./getting-started-wizard\": [\n\t\t55,\n\t\t1\n\t],\n\t\"./getting-started-wizard/\": [\n\t\t55,\n\t\t1\n\t],\n\t\"./getting-started-wizard/getting-started-wizard-eng\": [\n\t\t101,\n\t\t6\n\t],\n\t\"./getting-started-wizard/getting-started-wizard-eng.js\": [\n\t\t101,\n\t\t6\n\t],\n\t\"./getting-started-wizard/getting-started-wizard-ru\": [\n\t\t102,\n\t\t7\n\t],\n\t\"./getting-started-wizard/getting-started-wizard-ru.js\": [\n\t\t102,\n\t\t7\n\t],\n\t\"./getting-started-wizard/index\": [\n\t\t55,\n\t\t1\n\t],\n\t\"./getting-started-wizard/index.js\": [\n\t\t55,\n\t\t1\n\t],\n\t\"./wizard-ids\": [\n\t\t54\n\t],\n\t\"./wizard-ids.js\": [\n\t\t54\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tvar ids = map[req];\n\tif(!ids) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\treturn Promise.all(ids.slice(1).map(__webpack_require__.e)).then(function() {\n\t\tvar id = ids[0];\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function webpackAsyncContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackAsyncContext.id = 114;\nmodule.exports = webpackAsyncContext;","import React, { Component } from \"react\";\r\nimport Stats from \"stats.js\";\r\n\r\nimport { RootContext } from \"../../store/index\";\r\nimport \"./index.scss\";\r\n\r\nclass StatisticsBadge extends Component {\r\n    elementRef = React.createRef();\r\n\r\n    componentDidMount() {\r\n        this.elementRef.current.appendChild(this.props.stats.dom);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        this.elementRef = null;\r\n    }\r\n\r\n    render() {\r\n        return <div ref={this.elementRef} className=\"statistics-badge\" />;\r\n    }\r\n}\r\n\r\nexport default () => (\r\n    <RootContext.Consumer>\r\n        {({ store, stats }) => (store.viewSettings.showStatistics ? <StatisticsBadge stats={stats} /> : null)}\r\n    </RootContext.Consumer>\r\n);\r\n\r\nexport function createStatsBadge() {\r\n    const statsBadge = new Stats();\r\n    statsBadge.dom.classList.add(\"stats-badge\");\r\n\r\n    return statsBadge;\r\n}\r\n","class SearchApiParamsBuilder {\r\n    _params = {};\r\n\r\n    /**\r\n     * @param {ServerFieldName} param\r\n     * @param {string} value\r\n     */\r\n    addWithValue(param, value) {\r\n        this._params[`fields[${param}][value]`] = value;\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {ServerFieldName} paramName\r\n     * @param {NumberFieldRelationType|DateFieldRelationType|StringFieldRelationType} relation\r\n     * @param {string} valueToCompare\r\n     */\r\n    addWithRelation(paramName, relation, valueToCompare) {\r\n        this.addWithValue(paramName, valueToCompare);\r\n        this._params[`fields[${paramName}][relation]`] = relation;\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {ServerFieldName} paramName\r\n     */\r\n    orderBy(paramName) {\r\n        this._params[\"order\"] = paramName;\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {number=50} limit\r\n     */\r\n    limit(limit = 50) {\r\n        this._params[\"limit\"] = limit;\r\n\r\n        return this;\r\n    }\r\n\r\n    build() {\r\n        return this._params;\r\n    }\r\n}\r\n\r\nexport default SearchApiParamsBuilder;\r\n","export const FieldType = {\r\n    Number: \"Number\",\r\n    String: \"String\",\r\n    Date: \"Date\",\r\n};\r\n\r\n/**\r\n * @readonly\r\n * @enum {string}\r\n */\r\nexport const NumberFieldRelationType = {\r\n    GreaterThan: \">\",\r\n    LessThan: \"<\",\r\n    Equal: \"=\",\r\n};\r\n\r\nNumberFieldRelationType.allValues = Object.values(NumberFieldRelationType);\r\n\r\n/**\r\n * @readonly\r\n * @enum {string}\r\n */\r\nexport const DateFieldRelationType = {\r\n    GreaterThan: \">\",\r\n    LessThan: \"<\",\r\n    Equal: \"=\",\r\n};\r\n\r\nDateFieldRelationType.allValues = Object.values(DateFieldRelationType);\r\n\r\n/**\r\n * @readonly\r\n * @enum {string}\r\n */\r\nexport const StringFieldRelationType = {\r\n    Equal: \"=\",\r\n    Like: \"like\",\r\n};\r\n\r\nStringFieldRelationType.allValues = Object.values(StringFieldRelationType);\r\n\r\n/**\r\n * @readonly\r\n * @enum {string}\r\n */\r\nexport const ServerFieldName = {\r\n    name: \"name\",\r\n    noradId: \"norad_id\",\r\n    launchDate: \"launch_date\",\r\n\r\n    // TODO: Uncomment lines below in final version\r\n    // intlDes: \"intl_des\",\r\n    // objectType: \"object_type\",\r\n    // country: \"country\",\r\n    // decayDate: \"decay_date\",\r\n    // launchSite: \"launch_site\",\r\n    // period: \"period\",\r\n    // inc: \"inc\",\r\n    // apogee: \"apogee\",\r\n    // perigee: \"perigee\",\r\n    // launchYear: \"launch_year\",\r\n    // launchNum: \"launch_num\",\r\n    // launchPiece: \"launch_piece\",\r\n    // objectName: \"object_name\",\r\n    // objectId: \"object_id\",\r\n    // objectNumber: \"object_number\",\r\n};\r\n\r\nServerFieldName.allValues = Object.values(ServerFieldName);\r\nServerFieldName.allKeys = Object.keys(ServerFieldName);\r\n\r\nexport const SERVER_FIELDS_TYPE = new Map([\r\n    [ServerFieldName.noradId, { type: FieldType.Number }],\r\n    [ServerFieldName.objectType, { type: FieldType.Number }],\r\n    [ServerFieldName.intlDes, { type: FieldType.String }],\r\n    [ServerFieldName.name, { type: FieldType.String }],\r\n    [ServerFieldName.country, { type: FieldType.String }],\r\n    [ServerFieldName.launchDate, { type: FieldType.Date }],\r\n    [ServerFieldName.decayDate, { type: FieldType.Date }],\r\n    [ServerFieldName.launchSite, { type: FieldType.String }],\r\n    [ServerFieldName.period, { type: FieldType.Number }],\r\n    [ServerFieldName.inc, { type: FieldType.Number }],\r\n    [ServerFieldName.apogee, { type: FieldType.Number }],\r\n    [ServerFieldName.launchYear, { type: FieldType.Number }],\r\n    [ServerFieldName.launchNum, { type: FieldType.Number }],\r\n    [ServerFieldName.launchPiece, { type: FieldType.String }],\r\n    [ServerFieldName.objectName, { type: FieldType.String }],\r\n    [ServerFieldName.objectId, { type: FieldType.String }],\r\n    [ServerFieldName.objectNumber, { type: FieldType.Number }],\r\n]);\r\n\r\nexport class FieldParameter {\r\n    static AllFields = SERVER_FIELDS_TYPE;\r\n\r\n    /**\r\n     * @param {ServerFieldName} fieldName\r\n     */\r\n    constructor(fieldName) {\r\n        this._fieldName = fieldName;\r\n    }\r\n\r\n    get fieldName() {\r\n        return this._fieldName;\r\n    }\r\n    get fieldType() {\r\n        const { type } = FieldParameter.AllFields.get(this._fieldName);\r\n\r\n        return type;\r\n    }\r\n\r\n    get relations() {\r\n        const { type } = FieldParameter.AllFields.get(this._fieldName);\r\n\r\n        switch (type) {\r\n            case FieldType.Number: {\r\n                return NumberFieldRelationType.allValues;\r\n            }\r\n            case FieldType.String: {\r\n                return StringFieldRelationType.allValues;\r\n            }\r\n            case FieldType.Date: {\r\n                return DateFieldRelationType.allValues;\r\n            }\r\n            default:\r\n                return [];\r\n        }\r\n    }\r\n}\r\n","import axios from \"axios\";\r\nimport SearchApiParamsBuilder from \"./search-api-params-builder\";\r\nimport { FieldParameter, NumberFieldRelationType, ServerFieldName, StringFieldRelationType } from \"./api-config\";\r\nimport Satellite from \"./satelite\";\r\n\r\nclass SatelliteFinder {\r\n    constructor(apiEndpoint) {\r\n        this._apiUrl = apiEndpoint;\r\n    }\r\n\r\n    async findSatellites({ noradId, name, launchDate }) {\r\n        try {\r\n            const urlParams = this._createParams({ noradId, name, launchDate });\r\n            const { data } = await axios.get(this._apiUrl, {\r\n                params: urlParams,\r\n            });\r\n\r\n            return this._prepareResult(data);\r\n        } catch (error) {\r\n            console.error(error);\r\n        }\r\n    }\r\n\r\n    async getSearchSettings() {\r\n        return Promise.resolve(ServerFieldName.allValues.map(fieldName => new FieldParameter(fieldName)));\r\n    }\r\n\r\n    _prepareResult(serverResponseData) {\r\n        if (this._isOk(serverResponseData)) {\r\n            const { result } = serverResponseData;\r\n\r\n            return {\r\n                totalRows: result[\"total_rows\"],\r\n                satellites: result.satellites.map(s => new Satellite(s)),\r\n            };\r\n        } else if (this._isError(serverResponseData)) {\r\n            console.error(serverResponseData.message);\r\n\r\n            return {\r\n                totalRows: 1,\r\n                satellites: [],\r\n            };\r\n        }\r\n\r\n        throw new Error(\"Unknown status code\");\r\n    }\r\n\r\n    _createParams(config) {\r\n        // TODO: Rewrite to more generic way\r\n        const { noradId, launchDate, name } = config;\r\n        const paramsBuilder = new SearchApiParamsBuilder();\r\n\r\n        if (noradId) {\r\n            paramsBuilder.addWithRelation(ServerFieldName.noradId, NumberFieldRelationType.Equal, noradId);\r\n        }\r\n\r\n        if (launchDate) {\r\n            paramsBuilder.addWithRelation(ServerFieldName.launchDate, NumberFieldRelationType.Equal, launchDate);\r\n        }\r\n\r\n        if (name) {\r\n            paramsBuilder.addWithRelation(ServerFieldName.name, StringFieldRelationType.Like, name);\r\n        }\r\n\r\n        paramsBuilder.limit(100);\r\n\r\n        return paramsBuilder.build();\r\n    }\r\n\r\n    _isOk(resp) {\r\n        return resp.status === \"ok\";\r\n    }\r\n\r\n    _isError(resp) {\r\n        return resp.status === \"error\";\r\n    }\r\n}\r\n\r\nexport default SatelliteFinder;\r\n","import React from \"react\";\r\n\r\nconst Logo = ({ className }) => <div className={className} />;\r\n\r\nexport default Logo;\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport ReactSelect, { components } from \"react-select\";\r\n\r\nconst DEFAULT = {\r\n    background: \"var(--black)\",\r\n    color: \"var(--white-text)\",\r\n    containerHeight: 24,\r\n};\r\n\r\nconst customSelectStyles = {\r\n    container: base => ({\r\n        ...base,\r\n        background: DEFAULT.background,\r\n        color: DEFAULT.color,\r\n        minHeight: DEFAULT.containerHeight,\r\n        height: DEFAULT.containerHeight,\r\n        minWidth: 50,\r\n    }),\r\n\r\n    control: base => ({\r\n        ...base,\r\n        background: DEFAULT.background,\r\n        borderRadius: 0,\r\n        borderStyle: \"none\",\r\n        minHeight: DEFAULT.containerHeight,\r\n        height: DEFAULT.containerHeight,\r\n    }),\r\n\r\n    menu: base => ({\r\n        ...base,\r\n        borderRadius: 0,\r\n        marginTop: 0,\r\n        marginBottom: 0,\r\n    }),\r\n\r\n    menuList: base => ({\r\n        ...base,\r\n        background: \"var(--dark-gray)\",\r\n    }),\r\n\r\n    option: (base, state) => ({\r\n        ...base,\r\n        backgroundColor: state.isFocused ? \"var(--gray)\" : \"transparent\",\r\n    }),\r\n\r\n    singleValue: (base, state) => {\r\n        const opacity = state.isDisabled ? 0.5 : 1;\r\n        const transition = \"opacity 300ms\";\r\n\r\n        return {\r\n            ...base,\r\n            color: DEFAULT.color,\r\n            opacity,\r\n            transition,\r\n        };\r\n    },\r\n\r\n    dropdownIndicator: () => ({\r\n        padding: 0,\r\n        background: `url(\"/images/chevron-down-solid.svg\") 0 0 no-repeat`,\r\n        marginRight: 5,\r\n        height: 10,\r\n        width: 10,\r\n    }),\r\n\r\n    indicatorSeparator: () => ({\r\n        display: \"none\",\r\n    }),\r\n};\r\n\r\nconst IndicatorsContainer = props => {\r\n    return components.IndicatorsContainer && <components.IndicatorsContainer {...props} />;\r\n};\r\n\r\nconst DropdownIndicator = props => {\r\n    return (\r\n        components.DropdownIndicator && (\r\n            <components.DropdownIndicator {...props}>\r\n                <span />\r\n            </components.DropdownIndicator>\r\n        )\r\n    );\r\n};\r\n\r\nconst Select = ({ id, className, options, value, onSelect = () => {} }) => {\r\n    return (\r\n        <ReactSelect\r\n            id={id}\r\n            className={className}\r\n            classNamePrefix=\"select\"\r\n            placeholder=\"\"\r\n            styles={customSelectStyles}\r\n            isSearchable={false}\r\n            options={options}\r\n            defaultValue={value}\r\n            components={{ IndicatorsContainer, DropdownIndicator }}\r\n            onChange={onSelect}\r\n        />\r\n    );\r\n};\r\n\r\nexport const optionPropTypes = PropTypes.shape({\r\n    label: PropTypes.string,\r\n    value: PropTypes.string,\r\n});\r\n\r\nSelect.propTypes = {\r\n    id: PropTypes.string,\r\n    className: PropTypes.string,\r\n    options: PropTypes.arrayOf(optionPropTypes).isRequired,\r\n    value: optionPropTypes,\r\n    onSelect: PropTypes.func,\r\n};\r\n\r\nexport default Select;\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\n\r\nimport { RootContext } from \"../../../../store\";\r\nimport Select, { optionPropTypes } from \"../../../common/select/select\";\r\nimport \"./star-system-selector.scss\";\r\n\r\nfunction StarSystemSelector({ options, defaultValue, onSelect }) {\r\n    return (\r\n        <div className=\"star-system-selector\">\r\n            <div className=\"star-system-selector__label\">Star system</div>\r\n            <Select\r\n                className=\"star-system-selector__selector\"\r\n                options={options}\r\n                value={defaultValue || options[0]}\r\n                onSelect={onSelect}\r\n            />\r\n        </div>\r\n    );\r\n}\r\n\r\nStarSystemSelector.propTypes = {\r\n    options: PropTypes.arrayOf(optionPropTypes).isRequired,\r\n    defaultValue: optionPropTypes,\r\n    onSelect: PropTypes.func,\r\n};\r\n\r\nexport default () => (\r\n    <RootContext.Consumer>\r\n        {({ store }) => {\r\n            const { options, defaultValue, onSelect } = store.starSystemSelectorSettings;\r\n\r\n            return <StarSystemSelector options={options} defaultValue={defaultValue} onSelect={onSelect} />;\r\n        }}\r\n    </RootContext.Consumer>\r\n);\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\n\r\nclass DropdownMenuItem extends Component {\r\n    static propTypes = {\r\n        text: PropTypes.string.isRequired,\r\n        selected: PropTypes.bool,\r\n        onClick: PropTypes.func,\r\n    };\r\n\r\n    handleClick = () => {\r\n        this.props.onClick(this.props.text);\r\n    };\r\n\r\n    render() {\r\n        const { text, selected } = this.props;\r\n\r\n        return (\r\n            <li className=\"drop-down-menu__menu-item\" onClick={this.handleClick}>\r\n                <span className=\"drop-down-menu__menu-item-icon\">{selected && <FontAwesomeIcon icon=\"check\" />}</span>\r\n                {text}\r\n            </li>\r\n        );\r\n    }\r\n}\r\n\r\nexport default DropdownMenuItem;\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\n\r\nimport { RootContext } from \"../../../../../store\";\r\nimport DropDownMenuItem from \"./drop-down-menu-item\";\r\nimport \"./drop-down-menu.scss\";\r\n\r\nclass DropDownMenu extends Component {\r\n    static contextType = RootContext;\r\n\r\n    static propTypes = {\r\n        text: PropTypes.string.isRequired,\r\n        options: PropTypes.arrayOf(\r\n            PropTypes.shape({\r\n                label: PropTypes.string.isRequired,\r\n                selected: PropTypes.bool,\r\n                onUpdate: PropTypes.func,\r\n                onClick: PropTypes.func,\r\n            }),\r\n        ).isRequired,\r\n        onSelect: PropTypes.func,\r\n    };\r\n\r\n    handleSelect = selectedItem => {\r\n        const { store, updateStore } = this.context;\r\n        const dropDownMenuData = store.topMenu.find(item => item.label === this.props.text);\r\n\r\n        dropDownMenuData.onSelect(selectedItem);\r\n        updateStore(store);\r\n    };\r\n\r\n    render() {\r\n        const { text } = this.props;\r\n        const dropDownMenuData = this.context.store.topMenu.find(item => item.label === text);\r\n        const options = dropDownMenuData ? dropDownMenuData.options : [];\r\n\r\n        const hasOptionsToShow = options.length > 0;\r\n\r\n        return (\r\n            <ul className=\"drop-down-menu\">\r\n                <li>\r\n                    <span className=\"drop-down-menu__toggler\">\r\n                        {text}\r\n                        {hasOptionsToShow && <FontAwesomeIcon className=\"drop-down-menu__caret\" icon=\"chevron-down\" />}\r\n                    </span>\r\n                    {hasOptionsToShow && (\r\n                        <ul className=\"drop-down-menu__menu\">\r\n                            {options.map(({ label, selected, onClick }) => {\r\n                                return (\r\n                                    <DropDownMenuItem\r\n                                        key={label}\r\n                                        selected={selected}\r\n                                        text={label}\r\n                                        onClick={onClick || this.handleSelect}\r\n                                    />\r\n                                );\r\n                            })}\r\n                        </ul>\r\n                    )}\r\n                </li>\r\n            </ul>\r\n        );\r\n    }\r\n}\r\n\r\nexport default DropDownMenu;\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\n\r\nconst MenuLink = ({ text, href, className = \"\", target = \"_self\" }) => (\r\n    <a className={`main-menu__link ${className}`} href={href} target={target}>\r\n        {text}\r\n    </a>\r\n);\r\n\r\nMenuLink.propTypes = {\r\n    text: PropTypes.string.isRequired,\r\n    href: PropTypes.string.isRequired,\r\n    className: PropTypes.string,\r\n    target: PropTypes.string,\r\n};\r\n\r\nexport default MenuLink;\r\n","import React from \"react\";\r\nimport cn from \"classnames\";\r\n\r\nimport \"./main-menu.scss\";\r\nimport DropDownMenu from \"./components/drop-down-menu\";\r\nimport MenuLink from \"./components/menu-link\";\r\nimport { RootContext, MenuItemType } from \"../../../../store\";\r\n\r\nfunction MainMenuItem({ menuItem, clickable }) {\r\n    return (\r\n        <div className=\"main-menu__item\">\r\n            <div className={cn(clickable && \"main-menu__clickable-zone\")}>\r\n                {menuItem.type === MenuItemType.LINK && <MenuLink text={menuItem.label} {...menuItem} />}\r\n                {menuItem.type === MenuItemType.DROPDOWN && <DropDownMenu text={menuItem.label} {...menuItem} />}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction MainMenu() {\r\n    return (\r\n        <nav className=\"main-menu\">\r\n            <RootContext.Consumer>\r\n                {({ store }) =>\r\n                    store.topMenu.map(menuItem => (\r\n                        <MainMenuItem key={menuItem.label} menuItem={menuItem} clickable={menuItem.isClickable} />\r\n                    ))\r\n                }\r\n            </RootContext.Consumer>\r\n        </nav>\r\n    );\r\n}\r\n\r\nexport default MainMenu;\r\n","import React from \"react\";\r\nimport cn from \"classnames\";\r\n\r\nimport Logo from \"./components/logo\";\r\nimport StarSystemSelector from \"./components/star-system-selector/star-system-selector\";\r\nimport MainMenu from \"./components/main-menu/main-menu\";\r\nimport \"./header.scss\";\r\n\r\nconst Header = ({ className }) => (\r\n    <header className={cn(className, \"header\", \"noselect\")}>\r\n        <div className=\"header__logo-wrapper\">\r\n            <Logo className=\"header__logo\" />\r\n        </div>\r\n        <div className=\"header__top-menu\">\r\n            <MainMenu />\r\n        </div>\r\n        <div className=\"header__star-system-selector\">\r\n            <StarSystemSelector />\r\n        </div>\r\n    </header>\r\n);\r\n\r\nexport default Header;\r\n","import React from \"react\";\r\nimport cn from \"classnames\";\r\nimport \"./index.scss\";\r\n\r\nconst SideBar = ({ className, right, children }) => {\r\n    return <aside className={cn(className, \"side-bar\")}>{children}</aside>;\r\n};\r\n\r\nexport default SideBar;\r\n","import React from \"react\";\r\nimport cn from \"classnames\";\r\n\r\nimport \"./arrow-logo.scss\";\r\n\r\nexport default function ArrowLogo({ direction }) {\r\n    const classNames = cn(\"arrow-logo\", `arrow-logo--to-${direction}`);\r\n\r\n    return (\r\n        <svg\r\n            className={classNames}\r\n            role=\"img\"\r\n            width=\"10\"\r\n            height=\"8\"\r\n            viewBox=\"0 0 10 8\"\r\n            fill=\"none\"\r\n            xmlns=\"http://www.w3.org/2000/svg\"\r\n        >\r\n            <path\r\n                d=\"M1.50359 3.64645C1.30833 3.84171 1.30833 4.15829 1.50359 4.35355L4.68557 7.53553C4.88083 7.7308 5.19741 7.7308 5.39268 7.53553C5.58794 7.34027 5.58794 7.02369 5.39268 6.82843L2.56425 4L5.39268 1.17157C5.58794 0.97631 5.58794 0.659728 5.39268 0.464466C5.19741 0.269204 4.88083 0.269203 4.68557 0.464466L1.50359 3.64645ZM1.5 8V0H0.5V8H1.5ZM10 3.5L1.85714 3.5L1.85714 4.5L10 4.5L10 3.5Z\"\r\n                fill=\"#8F9193\"\r\n            />\r\n        </svg>\r\n    );\r\n}\r\n","import React from \"react\";\r\n\r\nconst MaximizeLogo = () => {\r\n    return (\r\n        <svg role=\"img\" width=\"10\" height=\"8\" viewBox=\"0 0 10 8\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n            <path d=\"M3 3V1H9V5H7M7 5V7H1V3H7V5Z\" stroke=\"#8F9193\" strokeWidth=\"0.5\" />\r\n        </svg>\r\n    );\r\n};\r\n\r\nexport default MaximizeLogo;\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\n\r\nimport Button from \"../../button\";\r\nimport ArrowLogo from \"../../logos/arrow-logo\";\r\nimport MaximizeLogo from \"../../logos/maximize-logo\";\r\n\r\nconst CollapseButton = ({ isCollapsed, onClick, isToRight = false, className = \"\", collapseDirection = \"left\" }) => (\r\n    <Button className={className} onClick={onClick} small>\r\n        {isCollapsed ? <MaximizeLogo /> : <ArrowLogo direction={collapseDirection} />}\r\n    </Button>\r\n);\r\n\r\nCollapseButton.propTypes = {\r\n    className: PropTypes.string,\r\n    isCollapsed: PropTypes.bool.isRequired,\r\n    onClick: PropTypes.func.isRequired,\r\n    collapseDirection: PropTypes.oneOf([\"right\", \"left\"]),\r\n};\r\n\r\nexport default CollapseButton;\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport cn from \"classnames\";\r\n\r\nconst Field = ({ className, leftAligned = false, centered = false, children }) => {\r\n    return (\r\n        <div\r\n            className={cn(\r\n                \"panel__field\",\r\n                {\r\n                    \"panel__field--left-aligned\": leftAligned,\r\n                    \"panel__field--centered\": centered,\r\n                },\r\n                className,\r\n            )}\r\n        >\r\n            {children}\r\n        </div>\r\n    );\r\n};\r\n\r\nField.propTypes = {\r\n    className: PropTypes.string,\r\n    leftAligned: PropTypes.bool,\r\n    centered: PropTypes.bool,\r\n    children: PropTypes.node,\r\n};\r\n\r\nexport default Field;\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport cn from \"classnames\";\r\n\r\nconst FieldLabel = ({\r\n    id,\r\n    className,\r\n    tag: ComponentType = \"span\",\r\n    normal = true,\r\n    middle = false,\r\n    small = false,\r\n    children,\r\n}) => {\r\n    return (\r\n        <ComponentType\r\n            id={id}\r\n            className={cn(\r\n                \"panel__field-label\",\r\n                {\r\n                    \"panel__field-label--normal\": normal,\r\n                    \"panel__field-label--middle\": middle,\r\n                    \"panel__field-label--small\": small,\r\n                },\r\n                className,\r\n            )}\r\n        >\r\n            {children}\r\n        </ComponentType>\r\n    );\r\n};\r\n\r\nFieldLabel.propTypes = {\r\n    id: PropTypes.string,\r\n    className: PropTypes.string,\r\n    tag: PropTypes.string,\r\n    normal: PropTypes.bool,\r\n    middle: PropTypes.bool,\r\n    small: PropTypes.bool,\r\n    children: PropTypes.node,\r\n};\r\n\r\nexport default FieldLabel;\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport cn from \"classnames\";\r\n\r\nconst FieldControl = ({ id, className, fullSize = false, children }) => {\r\n    return (\r\n        <span\r\n            id={id}\r\n            className={cn(\"panel__field-control\", { \"panel__field-control--full-size\": fullSize }, className)}\r\n        >\r\n            {children}\r\n        </span>\r\n    );\r\n};\r\n\r\nFieldControl.propTypes = {\r\n    id: PropTypes.string,\r\n    className: PropTypes.string,\r\n    fullSize: PropTypes.bool,\r\n    children: PropTypes.node,\r\n};\r\n\r\nexport default FieldControl;\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport cn from \"classnames\";\r\n\r\nimport Button from \"../../button\";\r\n\r\nconst PanelButton = ({ id, className, children }) => (\r\n    <Button className={cn(\"panel__button\", className)} id={id}>\r\n        {children}\r\n    </Button>\r\n);\r\n\r\nPanelButton.propTypes = {\r\n    id: PropTypes.string,\r\n    className: PropTypes.string,\r\n    children: PropTypes.string,\r\n};\r\n\r\nexport default PanelButton;\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport cn from \"classnames\";\r\n\r\nconst FieldSet = ({ className, children }) => {\r\n    return <span className={cn(\"panel__field-set\", className)}>{children}</span>;\r\n};\r\n\r\nFieldSet.propTypes = {\r\n    className: PropTypes.string,\r\n    children: PropTypes.node,\r\n};\r\n\r\nexport default FieldSet;\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport cn from \"classnames\";\r\n\r\nconst Dimension = ({ id, className, children }) => {\r\n    return (\r\n        <span id={id} className={cn(\"panel__dimension\", className)}>\r\n            {children}\r\n        </span>\r\n    );\r\n};\r\n\r\nDimension.propTypes = {\r\n    id: PropTypes.string,\r\n    className: PropTypes.string,\r\n    children: PropTypes.node,\r\n};\r\n\r\nexport default Dimension;\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport cn from \"classnames\";\r\n\r\nimport CollapseButton from \"./components/collapse-button\";\r\nimport Field from \"./components/field\";\r\nimport FieldLabel from \"./components/field-label\";\r\nimport FieldControl from \"./components/field-control\";\r\nimport PanelButton from \"./components/button\";\r\nimport FieldSet from \"./components/field-set\";\r\nimport Dimension from \"./components/dimension\";\r\nimport \"./index.scss\";\r\n\r\nclass Panel extends Component {\r\n    static propTypes = {\r\n        id: PropTypes.string,\r\n        className: PropTypes.string,\r\n        children: PropTypes.node,\r\n        caption: PropTypes.string,\r\n        hideCollapseButton: PropTypes.bool,\r\n        titleIcon: PropTypes.node,\r\n        collapsedByDefault: PropTypes.bool,\r\n        hidden: PropTypes.bool,\r\n        collapseDirection: PropTypes.oneOf([\"right\", \"left\"]),\r\n    };\r\n\r\n    static defaultProps = {\r\n        caption: \"\",\r\n        hideCollapseButton: false,\r\n        className: \"\",\r\n        id: \"\",\r\n        collapsedByDefault: false,\r\n        hidden: false,\r\n        collapseDirection: \"left\",\r\n    };\r\n\r\n    state = {\r\n        isCollapsed: this.props.collapsedByDefault,\r\n    };\r\n\r\n    handleToggle = () => {\r\n        this.setState(prevState => ({\r\n            isCollapsed: !prevState.isCollapsed,\r\n        }));\r\n    };\r\n\r\n    render() {\r\n        const {\r\n            id,\r\n            className,\r\n            caption,\r\n            hideCollapseButton,\r\n            children,\r\n            titleIcon,\r\n            hidden,\r\n            collapseDirection,\r\n        } = this.props;\r\n        const { isCollapsed } = this.state;\r\n        const classNames = cn(\r\n            \"panel\",\r\n            \"noselect\",\r\n            {\r\n                \"panel--hidden\": hidden,\r\n                \"panel--collapsed\": isCollapsed,\r\n            },\r\n            className,\r\n        );\r\n\r\n        return (\r\n            <div id={id} className={classNames}>\r\n                <div className=\"panel__header\">\r\n                    <div className=\"panel__caption\">\r\n                        {titleIcon && <span className=\"panel__caption-icon\">{titleIcon}</span>}\r\n                        <span className=\"panel__caption-text\">{caption}</span>\r\n                    </div>\r\n                    {!hideCollapseButton && (\r\n                        <CollapseButton\r\n                            className=\"panel__collapse-button\"\r\n                            onClick={this.handleToggle}\r\n                            isCollapsed={isCollapsed}\r\n                            collapseDirection={collapseDirection}\r\n                        />\r\n                    )}\r\n                </div>\r\n                <div style={{ display: isCollapsed ? \"none\" : \"block\" }} className=\"panel__content\">\r\n                    {children}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport { Panel as default, Field, FieldSet, FieldLabel, FieldControl, PanelButton, Dimension };\r\n","import React from \"react\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\n\r\nimport Panel, { Field, FieldLabel, FieldControl } from \"../../../../../common/panel\";\r\nimport \"./camera-panel.scss\";\r\n\r\nconst CameraPanel = ({ className }) => (\r\n    <Panel\r\n        id=\"cameraPanel\"\r\n        className={`camera-panel ${className}`}\r\n        caption=\"Camera\"\r\n        titleIcon={<FontAwesomeIcon icon=\"expand\" />}\r\n        collapseDirection=\"right\"\r\n    >\r\n        <Field className=\"camera-panel__field\">\r\n            <FieldLabel>Target</FieldLabel>\r\n            <FieldControl>\r\n                <select className=\"camera-panel__field-control\" id=\"targetSelect\" />\r\n            </FieldControl>\r\n        </Field>\r\n        <Field className=\"camera-panel__field\">\r\n            <FieldLabel>Frame type</FieldLabel>\r\n            <FieldControl>\r\n                <select className=\"camera-panel__field-control\" id=\"rfTypeSelect\" />\r\n            </FieldControl>\r\n        </Field>\r\n    </Panel>\r\n);\r\n\r\nexport default CameraPanel;\r\n","import React from \"react\";\r\nimport \"./index.scss\";\r\n\r\nfunction TimeLine({ className }) {\r\n    return <canvas className={`time-line ${className}`} id=\"timeLineCanvas\" />;\r\n}\r\n\r\nexport default TimeLine;\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport cn from \"classnames\";\r\n\r\nimport { sim, Events } from \"../../../../../../../core/index\";\r\nimport \"./index.scss\";\r\n\r\nclass PauseButton extends Component {\r\n    static propTypes = {\r\n        className: PropTypes.string,\r\n    };\r\n\r\n    state = {\r\n        isTimeRunning: true,\r\n    };\r\n\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        document.addEventListener(Events.TIME_PAUSED, () => {\r\n            this.setState({ isTimeRunning: false });\r\n        });\r\n        document.addEventListener(Events.TIME_UNPAUSED, () => {\r\n            this.setState({ isTimeRunning: true });\r\n        });\r\n    }\r\n\r\n    handleClick = () => {\r\n        const timeLine = sim.time;\r\n\r\n        if (timeLine) {\r\n            timeLine.togglePause();\r\n        }\r\n    };\r\n\r\n    render() {\r\n        const { isTimeRunning } = this.state;\r\n\r\n        return (\r\n            <div\r\n                role=\"button\"\r\n                className={cn(\r\n                    \"pause-button\",\r\n                    \"noselect\",\r\n                    {\r\n                        \"pause-button--paused\": !isTimeRunning,\r\n                    },\r\n                    this.props.className,\r\n                )}\r\n                onClick={this.handleClick}\r\n            >\r\n                <div>\r\n                    <FontAwesomeIcon className=\"pause-button__icon\" icon={isTimeRunning ? \"pause\" : \"play\"} />\r\n                </div>\r\n                <div>{isTimeRunning ? \"Pause\" : \"Resume\"}</div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default PauseButton;\r\n","import React from \"react\";\r\n\r\nexport default function({ className }) {\r\n    return (\r\n        <svg\r\n            className={className}\r\n            role=\"img\"\r\n            width=\"4\"\r\n            height=\"9\"\r\n            viewBox=\"0 0 4 9\"\r\n            fill=\"none\"\r\n            xmlns=\"http://www.w3.org/2000/svg\"\r\n        >\r\n            <path\r\n                d=\"M3.71197 2.33602L3.58397 3.42402H2.35197L1.96797 6.14402C1.92531 6.38936 1.92531 6.57069 1.96797 6.68802C2.01064 6.80536 2.11731 6.86402 2.28797 6.86402C2.46931 6.86402 2.62397 6.84269 2.75197 6.80002C2.87997 6.74669 2.96531 6.71469 3.00797 6.70402V7.76002C2.96531 7.77069 2.90131 7.79736 2.81597 7.84002C2.73064 7.88269 2.63464 7.92536 2.52797 7.96802C2.26131 8.08536 1.96264 8.14402 1.63197 8.14402C1.11997 8.14402 0.773306 8.01069 0.591973 7.74402C0.410639 7.46669 0.362639 7.00269 0.447973 6.35202L0.879973 3.42402H0.271973L0.415973 2.33602H1.02397L1.21597 0.976023L2.73597 0.736023L2.49597 2.33602H3.71197Z\"\r\n                fill=\"#A1A1A3\"\r\n            />\r\n        </svg>\r\n    );\r\n}\r\n","import React from \"react\";\r\n\r\nimport Panel, { Field, FieldLabel, FieldControl, PanelButton } from \"../../../../../common/panel\";\r\nimport Logo from \"./logo\";\r\nimport \"./index.scss\";\r\n\r\nfunction TimeSettingsPanel({ className }) {\r\n    return (\r\n        <Panel\r\n            className={`time-settings-panel ${className}`}\r\n            id=\"timePanel\"\r\n            caption=\"Time\"\r\n            titleIcon={<Logo className=\"time-settings-panel__logo\" />}\r\n        >\r\n            <Field>\r\n                <FieldLabel middle>Current</FieldLabel>\r\n                <FieldControl>\r\n                    <time id=\"currentDateValue\">01.01.2000 12:00:00</time>\r\n                </FieldControl>\r\n                <PanelButton id=\"useCurrentTime\">Now</PanelButton>\r\n            </Field>\r\n            <Field>\r\n                <FieldLabel middle>Rate</FieldLabel>\r\n                <FieldControl id=\"timeScaleValue\" />\r\n                <PanelButton id=\"setRealTimeScale\">Real</PanelButton>\r\n            </Field>\r\n            <Field centered>\r\n                <FieldControl fullSize>\r\n                    <input\r\n                        id=\"timeScaleSlider\"\r\n                        type=\"range\"\r\n                        className=\"time-settings-panel__scale-slider\"\r\n                        min=\"-1\"\r\n                        max=\"1\"\r\n                        step=\"0.001\"\r\n                        defaultValue=\"0.001\"\r\n                        style={{ width: \"100%\" }}\r\n                    />\r\n                </FieldControl>\r\n            </Field>\r\n        </Panel>\r\n    );\r\n}\r\n\r\nexport default TimeSettingsPanel;\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport cn from \"classnames\";\r\n\r\nimport CameraPanel from \"./components/camera-panel/camera-panel\";\r\nimport TimeLine from \"./components/time-line\";\r\nimport PauseButton from \"./components/pause-button\";\r\nimport TimeSettingsPanel from \"./components/time-settings-panel\";\r\nimport StatisticsBadge from \"../../../statistics-badge\";\r\n\r\nimport \"./index.scss\";\r\n\r\nfunction BottomPanel({ className }) {\r\n    return (\r\n        <div className={cn(className, \"bottom-panel\")}>\r\n            <TimeSettingsPanel className=\"bottom-panel__time-settings-panel\" />\r\n            <PauseButton className=\"bottom-panel__pause-button\" />\r\n            <div className=\"bottom-panel__time-line-container\">\r\n                <TimeLine className=\"bottom-panel__time-line\" />\r\n            </div>\r\n            <CameraPanel className=\"bottom-panel__camera-panel\" />\r\n            <StatisticsBadge />\r\n        </div>\r\n    );\r\n}\r\n\r\nBottomPanel.propTypes = {\r\n    className: PropTypes.string,\r\n};\r\n\r\nexport default BottomPanel;\r\n","import React from \"react\";\n\nimport Panel, { Field, FieldLabel, PanelButton } from \"../../common/panel\";\nimport { RootContext } from \"../../../store\";\n\nconst CreationPanel = ({ className }) => (\n    <RootContext.Consumer>\n        {({ store }) => (\n            <Panel\n                className={className}\n                id=\"creationPanel\"\n                caption=\"Orbit creation\"\n                hidden={!store.viewSettings.showOrbitCreationPanel}\n            >\n                <Field>\n                    <FieldLabel>Create orbit</FieldLabel>\n                    <PanelButton id=\"createOrbit\">Create</PanelButton>\n                </Field>\n                <Field>\n                    <FieldLabel>Import</FieldLabel>\n                    <input type=\"text\" id=\"dump\" style={{ width: \"150px\" }} />\n                    <PanelButton id=\"importOrbit\">Load</PanelButton>\n                </Field>\n            </Panel>\n        )}\n    </RootContext.Consumer>\n);\n\nexport default CreationPanel;\n","import React from \"react\";\r\nimport cn from \"classnames\";\r\n\r\nimport { RootContext } from \"../../../../store\";\r\nimport Panel, { Field, FieldSet, FieldLabel, FieldControl, PanelButton, Dimension } from \"../../../common/panel\";\r\nimport \"./index.scss\";\r\n\r\nconst TransferCalculationPanel = ({ className }) => (\r\n    <RootContext.Consumer>\r\n        {({ store }) => (\r\n            <Panel\r\n                className={cn(className, \"transfer-calculation-panel\")}\r\n                id=\"lambertPanel\"\r\n                caption=\"Transfer calculation\"\r\n                hidden={!store.viewSettings.showTransferCalculationPanel}\r\n            >\r\n                <FieldSet>\r\n                    <Field>\r\n                        <FieldLabel>Origin</FieldLabel>\r\n                        <FieldControl>\r\n                            <select className=\"transfer-calculation-panel__select\" id=\"originSelect\" />\r\n                        </FieldControl>\r\n                    </Field>\r\n                    <Field>\r\n                        <FieldLabel>Target</FieldLabel>\r\n                        <FieldControl>\r\n                            <select className=\"transfer-calculation-panel__select\" id=\"targetSelect\" />\r\n                        </FieldControl>\r\n                    </Field>\r\n                    <Field>\r\n                        <FieldLabel>Transfer type</FieldLabel>\r\n                        <FieldControl>Ballistic</FieldControl>\r\n                    </Field>\r\n                    <Field>\r\n                        <FieldLabel>Departure</FieldLabel>\r\n                        <FieldControl>\r\n                            <time id=\"departureDateValue\">01.01.2000 12:00:00</time>\r\n                        </FieldControl>\r\n                        <PanelButton id=\"useCurrentTime\">Now</PanelButton>\r\n                    </Field>\r\n                    <Field>\r\n                        <FieldLabel>Transfer time</FieldLabel>\r\n                        <FieldControl id=\"transferTimeValue\" />\r\n                        {/*<PanelButton id=\"optimalTransferTime\">*/}\r\n                        {/*Optimal*/}\r\n                        {/*</PanelButton>*/}\r\n                    </Field>\r\n                    <Field>\r\n                        <FieldControl fullSize>\r\n                            <input\r\n                                id=\"transferTimeSlider\"\r\n                                type=\"range\"\r\n                                min=\"0\"\r\n                                max=\"1\"\r\n                                step=\"0.001\"\r\n                                defaultValue={\"0.5\"}\r\n                                style={{ width: \"100%\" }}\r\n                            />\r\n                        </FieldControl>\r\n                    </Field>\r\n                </FieldSet>\r\n                <FieldSet className=\"transfer-calculation-panel__delta-v-calc \" data-panel-name=\"lambert\">\r\n                    <Field className=\"panel__field-header\">Delta-V</Field>\r\n                    <Field>\r\n                        <FieldLabel>Ejection</FieldLabel>\r\n                        <FieldControl id=\"deltaVEjection\">0</FieldControl>\r\n                        <Dimension>km/s</Dimension>\r\n                    </Field>\r\n                    <Field>\r\n                        <FieldLabel>Insertion</FieldLabel>\r\n                        <FieldControl id=\"deltaVInsertion\">0</FieldControl>\r\n                        <Dimension>km/s</Dimension>\r\n                    </Field>\r\n                    <Field>\r\n                        <FieldLabel>Total</FieldLabel>\r\n                        <FieldControl id=\"deltaVTotal\">0</FieldControl>\r\n                        <Dimension>km/s</Dimension>\r\n                    </Field>\r\n                </FieldSet>\r\n            </Panel>\r\n        )}\r\n    </RootContext.Consumer>\r\n);\r\n\r\nexport default TransferCalculationPanel;\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport cn from \"classnames\";\r\n\r\nimport { FieldLabel, FieldControl, Dimension } from \"../../../../common/panel\";\r\nimport \"./keplerian-view.scss\";\r\n\r\nexport default function KeplerianView({ className = \"\" }) {\r\n    return (\r\n        <div className={cn(className, \"keplerian-view\")}>\r\n            <div className=\"keplerian-view__column\">\r\n                <div className=\"keplerian-view__field\">\r\n                    <FieldLabel className=\"keplerian-view__field-label\">Ecc</FieldLabel>\r\n                    <FieldControl id=\"elements-ecc\" />\r\n                    <Dimension />\r\n                </div>\r\n                <div className=\"keplerian-view__field\">\r\n                    <FieldLabel className=\"keplerian-view__field-label\">SMA</FieldLabel>\r\n                    <FieldControl id=\"elements-sma\" />\r\n                    <Dimension>km</Dimension>\r\n                </div>\r\n                <div className=\"keplerian-view__field\">\r\n                    <FieldLabel className=\"keplerian-view__field-label\">Inc</FieldLabel>\r\n                    <FieldControl id=\"elements-inc\" />\r\n                    <Dimension>deg.</Dimension>\r\n                </div>\r\n                <div className=\"keplerian-view__field\">\r\n                    <FieldLabel className=\"keplerian-view__field-label\">AoP</FieldLabel>\r\n                    <FieldControl id=\"elements-aop\" />\r\n                    <Dimension>deg.</Dimension>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"keplerian-view__column\">\r\n                <div className=\"keplerian-view__field\">\r\n                    <FieldLabel className=\"keplerian-view__field-label\">RAAN</FieldLabel>\r\n                    <FieldControl id=\"elements-raan\" />\r\n                    <Dimension>deg.</Dimension>\r\n                </div>\r\n                <div className=\"keplerian-view__field\">\r\n                    <FieldLabel className=\"keplerian-view__field-label\">TA</FieldLabel>\r\n                    <FieldControl id=\"elements-ta\" />\r\n                    <Dimension>deg.</Dimension>\r\n                </div>\r\n                <div className=\"keplerian-view__field\">\r\n                    <FieldLabel className=\"keplerian-view__field-label\">Period</FieldLabel>\r\n                    <FieldControl id=\"elements-period\" />\r\n                    <Dimension>days</Dimension>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nKeplerianView.propTypes = { className: PropTypes.string };\r\n","import React from \"react\";\r\nimport cn from \"classnames\";\r\n\r\nimport { FieldLabel, FieldControl, Dimension } from \"../../../../common/panel\";\r\nimport \"./vector-component-view.scss\";\r\n\r\nfunction VectorComponentView({ className, label = \"x\", valueClassName = \"vec-x\", dimension = \"km\" }) {\r\n    return (\r\n        <div className={cn(className, \"vector-component\")}>\r\n            <FieldLabel className=\"vector-component__label\">{label}</FieldLabel>\r\n            <FieldControl className={valueClassName} />\r\n            <Dimension>{dimension}</Dimension>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default VectorComponentView;\r\n","import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport cn from \"classnames\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\n\r\nimport Button from \"../button\";\r\nimport \"./index.scss\";\r\n\r\nfunction ExpandButton({ className, onClick, expanded = false }) {\r\n    return (\r\n        <Button\r\n            className={cn(className, \"expand-button\", {\r\n                \"expand-button--expanded\": expanded,\r\n            })}\r\n            onClick={onClick}\r\n        >\r\n            <FontAwesomeIcon className=\"expand-button__icon\" icon=\"chevron-down\" />\r\n        </Button>\r\n    );\r\n}\r\n\r\nExpandButton.propTypes = {\r\n    className: PropTypes.string,\r\n    expanded: PropTypes.bool,\r\n    onClick: PropTypes.func,\r\n};\r\n\r\nexport default ExpandButton;\r\n","import React, { Component } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport cn from \"classnames\";\r\n\r\nimport VectorComponentView from \"./vector-component-view\";\r\nimport ExpandButton from \"../../../../common/expand-button/index\";\r\nimport { Field } from \"../../../../common/panel\";\r\nimport \"./cartesian-vector-view.scss\";\r\n\r\nclass CartesianVectorView extends Component {\r\n    static propTypes = {\r\n        className: PropTypes.string,\r\n        isExpanded: PropTypes.bool,\r\n        vectorMagnitudeLabel: PropTypes.string.isRequired,\r\n        dimension: PropTypes.string.isRequired,\r\n    };\r\n\r\n    static defaultProps = {\r\n        isExpanded: false,\r\n    };\r\n\r\n    state = {\r\n        isExpanded: this.props.isExpanded,\r\n    };\r\n\r\n    handleToggle = () => {\r\n        this.setState(({ isExpanded }) => ({ isExpanded: !isExpanded }));\r\n    };\r\n\r\n    render() {\r\n        const { isExpanded } = this.state;\r\n        const { className, vectorMagnitudeLabel, dimension } = this.props;\r\n\r\n        return (\r\n            <Field className={cn(className, \"cartesian-vector-view\")}>\r\n                <div className=\"cartesian-vector-view__header\">\r\n                    <VectorComponentView\r\n                        label={vectorMagnitudeLabel}\r\n                        valueClassName=\"vec-magnitude\"\r\n                        dimension={dimension}\r\n                    />\r\n                    <ExpandButton\r\n                        className=\"cartesian-vector-view__expand-button\"\r\n                        expanded={isExpanded}\r\n                        onClick={this.handleToggle}\r\n                    />\r\n                </div>\r\n                <div className={cn(\"cartesian-vector-view__vector-components\", { hidden: !isExpanded })}>\r\n                    <VectorComponentView label=\"x\" valueClassName=\"vec-x\" dimension={dimension} />\r\n                    <VectorComponentView label=\"y\" valueClassName=\"vec-y\" dimension={dimension} />\r\n                    <VectorComponentView label=\"z\" valueClassName=\"vec-z\" dimension={dimension} />\r\n                </div>\r\n            </Field>\r\n        );\r\n    }\r\n}\r\n\r\nexport default CartesianVectorView;\r\n","import React from \"react\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\n\r\nimport Panel, { FieldSet, Field, FieldLabel, FieldControl, Dimension } from \"../../../common/panel\";\r\nimport KeplerianView from \"./components/keplerian-view\";\r\nimport CartesianVectorView from \"./components/cartesian-vector-view\";\r\nimport \"./index.scss\";\r\n\r\nconst MetricsPanel = () => (\r\n    <Panel\r\n        id=\"metricsPanel\"\r\n        className=\"metrics-panel\"\r\n        caption=\"Metrics\"\r\n        titleIcon={<FontAwesomeIcon icon=\"bars\" />}\r\n        collapseDirection=\"right\"\r\n    >\r\n        <div className=\"metrics-panel__content\">\r\n            <FieldSet>\r\n                <Field>\r\n                    <FieldLabel>Object</FieldLabel>\r\n                    <FieldControl id=\"metricsOf\" />\r\n                </Field>\r\n                <Field>\r\n                    <FieldLabel>Relative to</FieldLabel>\r\n                    <FieldControl id=\"relativeTo\" />\r\n                </Field>\r\n            </FieldSet>\r\n            <FieldSet>\r\n                <Field leftAligned>\r\n                    <FieldLabel tag=\"label\">\r\n                        <input\r\n                            className=\"metrics-panel__angles-checker\"\r\n                            type=\"checkbox\"\r\n                            id=\"showAnglesOfSelectedOrbit\"\r\n                            defaultChecked\r\n                        />\r\n                        Show angles\r\n                    </FieldLabel>\r\n                    <button className=\"metrics-panel__unload-object-button\" type=\"button\" id=\"unloadObject\">\r\n                        Unload object\r\n                    </button>\r\n                </Field>\r\n            </FieldSet>\r\n            <FieldSet>\r\n                <Field className=\"panel__field-header\">Main</Field>\r\n                <Field>\r\n                    <FieldLabel>Orbit</FieldLabel>\r\n                    <FieldControl id=\"elements-orbit-alt\" />\r\n                    <Dimension>km</Dimension>\r\n                </Field>\r\n                <Field>\r\n                    <FieldLabel>Avg height</FieldLabel>\r\n                    <FieldControl id=\"elements-orbit-avg\" />\r\n                    <Dimension>km</Dimension>\r\n                </Field>\r\n                <Field>\r\n                    <FieldLabel>Altitude</FieldLabel>\r\n                    <FieldControl id=\"elements-alt\" />\r\n                    <Dimension>km</Dimension>\r\n                </Field>\r\n                <Field>\r\n                    <FieldLabel>Speed</FieldLabel>\r\n                    <FieldControl id=\"elements-speed\" />\r\n                    <Dimension>m/s</Dimension>\r\n                </Field>\r\n                <Field>\r\n                    <FieldLabel>Precession</FieldLabel>\r\n                    <FieldControl id=\"elements-precession\" />\r\n                    <Dimension>deg/day</Dimension>\r\n                </Field>\r\n\r\n                <Field id=\"row-node-time\" style={{ display: \"none\" }}>\r\n                    <FieldLabel>Node local time</FieldLabel>\r\n                    <FieldControl id=\"elements-node-time\" />\r\n                    <Dimension />\r\n                </Field>\r\n            </FieldSet>\r\n\r\n            <FieldSet>\r\n                <Field className=\"panel__field-header\">Keplerian</Field>\r\n                <KeplerianView className=\"panel__field\" />\r\n            </FieldSet>\r\n\r\n            <FieldSet>\r\n                <Field className=\"panel__field-header\">Cartesian</Field>\r\n                <CartesianVectorView\r\n                    className=\"metrics-panel__cartesian-position-vector js-metrics-panel-cartesian-position-vector\"\r\n                    vectorMagnitudeLabel=\"Position\"\r\n                    dimension=\"km\"\r\n                />\r\n                <CartesianVectorView\r\n                    className=\"metrics-panel__cartesian-velocity-vector js-metrics-panel-cartesian-velocity-vector\"\r\n                    vectorMagnitudeLabel=\"Velocity\"\r\n                    dimension=\"km/s\"\r\n                />\r\n            </FieldSet>\r\n        </div>\r\n    </Panel>\r\n);\r\n\r\nexport default MetricsPanel;\r\n","import React from \"react\";\r\n\r\nimport Panel, { Field, FieldSet, FieldLabel, FieldControl, Dimension } from \"../../../common/panel\";\r\nimport Button from \"../../../common/button\";\r\nimport \"./index.scss\";\r\n\r\nconst ManeuverPanel = ({ className }) => (\r\n    <Panel id=\"maneuverPanel\" className={`maneuver-panel ${className}`} caption=\"Maneuver\" collapseDirection=\"left\">\r\n        <div className=\"maneuver-panel__content\">\r\n            <FieldSet>\r\n                <Field centered>\r\n                    <Button className=\"maneuver-panel__button\" id=\"prev-burn\">\r\n                        Prev burn\r\n                    </Button>\r\n                    <FieldLabel id=\"burn-name\" />\r\n                    <button className=\"maneuver-panel__remove-button\" type=\"button\" id=\"remove-burn\">\r\n                        remove\r\n                    </button>\r\n                    <Button className=\"maneuver-panel__button\" id=\"next-burn\">\r\n                        Next burn\r\n                    </Button>\r\n                </Field>\r\n            </FieldSet>\r\n            <FieldSet>\r\n                <Field className=\"panel__field-header\">Increment</Field>\r\n                <Field centered>\r\n                    <FieldLabel small id=\"increment\" />\r\n                    <FieldControl className=\"maneuver-panel__buttons\">\r\n                        <Button className=\"maneuver-panel__button\" id=\"incr001\">\r\n                            0.01\r\n                        </Button>\r\n                        <Button className=\"maneuver-panel__button\" id=\"incr01\">\r\n                            0.1\r\n                        </Button>\r\n                        <Button className=\"maneuver-panel__button\" id=\"incr1\">\r\n                            1\r\n                        </Button>\r\n                        <Button className=\"maneuver-panel__button\" id=\"incr10\">\r\n                            10\r\n                        </Button>\r\n                        <Button className=\"maneuver-panel__button\" id=\"incr100\">\r\n                            100\r\n                        </Button>\r\n                        <Button className=\"maneuver-panel__button\" id=\"incr1000\">\r\n                            1000\r\n                        </Button>\r\n                    </FieldControl>\r\n                </Field>\r\n            </FieldSet>\r\n\r\n            <FieldSet>\r\n                <Field className=\"panel__field-header\">Time</Field>\r\n                <Field>\r\n                    <FieldLabel>Date</FieldLabel>\r\n                    <FieldControl id=\"burn-date\" />\r\n                    <span className=\"maneuver-panel__buttons\">\r\n                        <Button className=\"maneuver-panel__button\" id=\"period-minus\">\r\n                            -P\r\n                        </Button>\r\n                        <Button className=\"maneuver-panel__button\" id=\"period-plus\">\r\n                            +P\r\n                        </Button>\r\n                    </span>\r\n                </Field>\r\n                <Field centered>\r\n                    <FieldLabel>Epoch</FieldLabel>\r\n                    <FieldControl id=\"burn-epoch\" />\r\n                    <span className=\"maneuver-panel__buttons\">\r\n                        <Button className=\"maneuver-panel__button\" id=\"epoch-minus\">\r\n                            -\r\n                        </Button>\r\n                        <Button className=\"maneuver-panel__button\" id=\"epoch-plus\">\r\n                            +\r\n                        </Button>\r\n                    </span>\r\n                </Field>\r\n            </FieldSet>\r\n\r\n            <FieldSet>\r\n                <Field className=\"panel__field-header\">Impulse</Field>\r\n                <Field centered>\r\n                    <FieldLabel>Prograde</FieldLabel>\r\n                    <FieldControl id=\"burn-prograde\" />\r\n                    <Dimension>m/s</Dimension>\r\n                    <span className=\"maneuver-panel__buttons\">\r\n                        <Button className=\"maneuver-panel__button\" id=\"prograde-zero\">\r\n                            0\r\n                        </Button>\r\n                        <Button className=\"maneuver-panel__button\" id=\"prograde-minus\">\r\n                            -\r\n                        </Button>\r\n                        <Button className=\"maneuver-panel__button\" id=\"prograde-plus\">\r\n                            +\r\n                        </Button>\r\n                    </span>\r\n                </Field>\r\n                <Field centered>\r\n                    <FieldLabel>Normal</FieldLabel>\r\n                    <FieldControl id=\"burn-normal\" />\r\n                    <Dimension>m/s</Dimension>\r\n                    <span className=\"maneuver-panel__buttons\">\r\n                        <Button className=\"maneuver-panel__button\" id=\"normal-zero\">\r\n                            0\r\n                        </Button>\r\n                        <Button className=\"maneuver-panel__button\" id=\"normal-minus\">\r\n                            -\r\n                        </Button>\r\n                        <Button className=\"maneuver-panel__button\" id=\"normal-plus\">\r\n                            +\r\n                        </Button>\r\n                    </span>\r\n                </Field>\r\n                <Field centered>\r\n                    <FieldLabel>Radial</FieldLabel>\r\n                    <FieldControl id=\"burn-radial\" />\r\n                    <Dimension>m/s</Dimension>\r\n                    <span className=\"maneuver-panel__buttons\">\r\n                        <Button className=\"maneuver-panel__button\" id=\"radial-zero\">\r\n                            0\r\n                        </Button>\r\n                        <Button className=\"maneuver-panel__button\" id=\"radial-minus\">\r\n                            -\r\n                        </Button>\r\n                        <Button className=\"maneuver-panel__button\" id=\"radial-plus\">\r\n                            +\r\n                        </Button>\r\n                    </span>\r\n                </Field>\r\n                <Field>\r\n                    <FieldLabel>Total</FieldLabel>\r\n                    <FieldControl id=\"burn-total\" />\r\n                    <Dimension>m/s</Dimension>\r\n                </Field>\r\n            </FieldSet>\r\n        </div>\r\n    </Panel>\r\n);\r\n\r\nexport default ManeuverPanel;\r\n","import React from \"react\";\n\nimport Panel, { Field, FieldLabel, PanelButton } from \"../../common/panel\";\nimport { RootContext } from \"../../../store\";\n\nconst DynamicTrajectoryPanel = () => (\n    <RootContext.Consumer>\n        {({ store }) => (\n            <Panel id=\"dynamicTrajectoryPanel\" caption=\"Dynamic trajectory\" collapseDirection=\"right\">\n                <Field>\n                    <FieldLabel>Export trajectory</FieldLabel>\n                    <PanelButton id=\"dump\">dump</PanelButton>\n                </Field>\n            </Panel>\n        )}\n    </RootContext.Consumer>\n);\n\nexport default DynamicTrajectoryPanel;\n","import React, { Suspense } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport cn from \"classnames\";\r\n\r\nimport { RootContext } from \"../../store\";\r\nimport SideBar from \"../common/side-bar\";\r\nimport BottomPanel from \"./components/bottom-panel\";\r\nimport CreationPanel from \"./components/creation-panel\";\r\nimport TransferCalculationPanel from \"./components/transfer-calculation-panel\";\r\nimport MetricsPanel from \"./components/metrics-panel\";\r\nimport ManeuverPanel from \"./components/maneuver-panel\";\r\nimport DynamicTrajectoryPanel from \"./components/dynamic-trajectory-panel\";\r\n\r\nimport \"./main-view.scss\";\r\n\r\nconst SatelliteSearchPanel = React.lazy(() => import(\"../satellite-search-panel/index\"));\r\n\r\nconst MainView = ({ className }) => {\r\n    return (\r\n        <RootContext.Consumer>\r\n            {({ store }) => (\r\n                <main className={cn(className, \"main-view\")}>\r\n                    <div id=\"viewport-id\" className=\"main-view__viewport-entry\" />\r\n                    <SideBar className=\"main-view__left-side-bar\">\r\n                        <CreationPanel className=\"main-view__creation-panel\" />\r\n                        <ManeuverPanel className=\"main-view__maneuver-panel\" />\r\n                        <TransferCalculationPanel className=\"main-view__transfer-calculation-panel\" />\r\n                    </SideBar>\r\n                    <SideBar className=\"main-view__right-side-bar\" right>\r\n                        <MetricsPanel />\r\n                        <DynamicTrajectoryPanel />\r\n                    </SideBar>\r\n                    {store.viewSettings.satelliteSearchPanel.isVisible ? (\r\n                        <Suspense fallback={<div />}>\r\n                            <SatelliteSearchPanel className=\"main-view__satellite-search-panel\" />\r\n                        </Suspense>\r\n                    ) : null}\r\n                    <BottomPanel className=\"main-view__bottom-panel\" />\r\n                </main>\r\n            )}\r\n        </RootContext.Consumer>\r\n    );\r\n};\r\n\r\nMainView.propTypes = {\r\n    className: PropTypes.string,\r\n};\r\n\r\nexport default MainView;\r\n","import React from \"react\";\r\n\r\nimport { showWizard, wizardIds } from \"./components/tutorials/index\";\r\nimport Header from \"./components/header/header\";\r\nimport MainView from \"./components/main-view/main-view\";\r\nimport Footer from \"./components/footer/footer\";\r\nimport \"./components/common/app-layout.scss\";\r\n\r\nconst IS_FOOTER_VISIBLE = process.env.REACT_APP_IS_FOOTER_VISIBLE === \"true\";\r\n\r\nclass App extends React.Component {\r\n    componentDidMount() {\r\n        showWizard({ wizardId: wizardIds.GETTING_STARTED_WIZARD });\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <>\r\n                <Header className=\"app-layout__header\" />\r\n                <MainView className=\"app-layout__main\" />\r\n                {IS_FOOTER_VISIBLE && <Footer className=\"app-layout__footer\" />}\r\n            </>\r\n        );\r\n    }\r\n}\r\n\r\nexport default App;\r\n","import { library } from \"@fortawesome/fontawesome-svg-core\";\nimport { faExpand, faPlay, faPause, faChevronDown, faCheck, faBars } from \"@fortawesome/free-solid-svg-icons\";\n\nexport function configureLibs() {\n    library.add(faExpand);\n    library.add(faPlay);\n    library.add(faPause);\n    library.add(faChevronDown);\n    library.add(faCheck);\n    library.add(faBars);\n}\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\n\r\nimport { configureLibs } from \"./libs\";\r\nimport { RootContext, Store } from \"./store\";\r\nimport { createStatsBadge } from \"./components/statistics-badge\";\r\nimport { createServices } from \"./services\";\r\nimport AppComponent from \"./app\";\r\n\r\nconfigureLibs();\r\nconst statsBadge = createStatsBadge();\r\nconst webApiServices = createServices();\r\n\r\nclass Root extends React.Component {\r\n    state = {\r\n        store: this.props.store,\r\n    };\r\n\r\n    _handleUpdateStore = updatedStore => {\r\n        this.setState({\r\n            store: updatedStore,\r\n        });\r\n    };\r\n\r\n    render() {\r\n        const { store } = this.state;\r\n\r\n        return (\r\n            <RootContext.Provider\r\n                value={{\r\n                    store,\r\n                    stats: statsBadge,\r\n                    updateStore: this._handleUpdateStore,\r\n                    webApiServices,\r\n                }}\r\n            >\r\n                <AppComponent />\r\n            </RootContext.Provider>\r\n        );\r\n    }\r\n}\r\n\r\nfunction renderUi(initialState) {\r\n    ReactDOM.render(<Root store={initialState} />, document.getElementById(\"root\"));\r\n}\r\n\r\nexport { renderUi, statsBadge, Store };\r\n","import SatelliteFinder from \"./satellite-finder/satellite-finder\";\r\n\r\nexport function createServices() {\r\n    return {\r\n        satelliteFinder: new SatelliteFinder(\"/api\"),\r\n    };\r\n}\r\n","import { sim } from \"./core/index\";\r\n\r\nexport const loadTLE = function(noradId) {\r\n    return sim.getModule(\"SolarSystem\").loadTLE(sim.starSystem, noradId);\r\n};\r\n\r\nexport const loadKSP = function() {\r\n    return sim.loadModule(\"KSP\");\r\n};\r\n","import { sim } from \"./core/index\";\r\nimport { renderUi, statsBadge } from \"./ui/index\";\r\nimport Application from \"./application\";\r\n\r\nconst app = new Application(sim);\r\nconst initialState = app.getInitialState();\r\nwindow.api = app.getApi();\r\n\r\nrenderUi(initialState);\r\n\r\napp.init(statsBadge);\r\n","import { init } from \"./core/index\";\r\nimport { loadTLE, loadKSP } from \"./api\";\r\nimport { Store } from \"./ui/index\";\r\n\r\nclass Application {\r\n    constructor(sim) {\r\n        this._store = new Store(sim, loadTLE);\r\n    }\r\n\r\n    init(statsBadge) {\r\n        init(statsBadge);\r\n    }\r\n\r\n    getInitialState() {\r\n        return this._store;\r\n    }\r\n\r\n    getApi() {\r\n        return {\r\n            loadTLE,\r\n            loadKSP,\r\n        };\r\n    }\r\n}\r\n\r\nexport default Application;\r\n"],"sourceRoot":""}