(window.webpackJsonp=window.webpackJsonp||[]).push([[8],[,,function(e,t,a){"use strict";a.d(t,"c",function(){return h}),a.d(t,"a",function(){return d}),a.d(t,"b",function(){return m}),a.d(t,"k",function(){return p}),a.d(t,"g",function(){return f}),a.d(t,"m",function(){return v}),a.d(t,"d",function(){return y}),a.d(t,"h",function(){return g}),a.d(t,"j",function(){return E}),a.d(t,"i",function(){return j}),a.d(t,"e",function(){return O}),a.d(t,"f",function(){return _}),a.d(t,"l",function(){return k});var n=a(1),i=a(3),r=a(5),s=a(4),o=a(6),c=a(14),l=a(92),u=a(7),h=function(e){function t(e){var a;if(Object(n.a)(this,t),a=Object(r.a)(this,Object(s.a)(t).call(this)),void 0===e&&(e=3),e instanceof Array)for(var i=0;i<e.length;++i)a[i]=e[i];else for(var o=0;o<e;++o)a[o]=0;return Object.setPrototypeOf(Object(c.a)(Object(c.a)(a)),t.prototype),a}return Object(o.a)(t,e),Object(i.a)(t,[{key:"copy",value:function(){return new t(this)}},{key:"set",value:function(e){var t=1===arguments.length?arguments[0]:arguments;null==t.length&&(t=[t]);for(var a=0;a<this.length;++a)this[a]=t[a];return this}},{key:"dot",value:function(e){for(var t=0,a=0;a<this.length;++a)t+=this[a]*e[a];return t}},{key:"cross",value:function(e){return new t([this[1]*e[2]-this[2]*e[1],this[2]*e[0]-this[0]*e[2],this[0]*e[1]-this[1]*e[0]])}},{key:"angle",value:function(e){var t=this.dot(e)/this.mag/e.mag;return t<=-1?Math.PI:t>=1?0:Math.acos(t)}},{key:"add_",value:function(e){for(var t=0;t<this.length;++t)this[t]+=e[t];return this}},{key:"sub_",value:function(e){for(var t=0;t<this.length;++t)this[t]-=e[t];return this}},{key:"mul_",value:function(e){for(var t=0;t<this.length;++t)this[t]*=e;return this}},{key:"div_",value:function(e){for(var t=0;t<this.length;++t)this[t]/=e;return this}},{key:"rotate_",value:function(e,t){return new d(e,t).rotate_(this)}},{key:"unit_",value:function(){return this.div_(this.mag)}},{key:"projectOn_",value:function(e){var t=e.unit();return this.set(t.mul_(this.dot(t))),this}},{key:"add",value:function(e){return this.copy().add_(e)}},{key:"sub",value:function(e){return this.copy().sub_(e)}},{key:"mul",value:function(e){return this.copy().mul_(e)}},{key:"div",value:function(e){return this.copy().div_(e)}},{key:"unit",value:function(){return this.copy().unit_()}},{key:"projectOn",value:function(e){return this.copy().projectOn_(e)}},{key:"projectionOn",value:function(e){return this.dot(e.unit())}},{key:"rotate",value:function(e,t){return this.copy().rotate_(e,t)}},{key:"rotateX",value:function(e){var a=Math.sin(e),n=Math.cos(e);return new t([this[0],this[1]*n-this[2]*a,this[1]*a+this[2]*n])}},{key:"rotateY",value:function(e){var a=Math.sin(e),n=Math.cos(e);return new t([this[0]*n+this[2]*a,this[1],-this[0]*a+this[2]*n])}},{key:"rotateZ",value:function(e){var a=Math.sin(e),n=Math.cos(e);return new t([this[0]*n-this[1]*a,this[0]*a+this[1]*n,this[2]])}},{key:"x",get:function(){return this[0]},set:function(e){this[0]=e}},{key:"y",get:function(){return this[1]},set:function(e){this[1]=e}},{key:"z",get:function(){return this[2]},set:function(e){this[2]=e}},{key:"quadrance",get:function(){for(var e=0,t=0;t<this.length;++t)e+=this[t]*this[t];return e}},{key:"mag",get:function(){return Math.sqrt(this.quadrance)}}]),t}(Object(l.a)(Array)),d=function(){function e(t,a){Object(n.a)(this,e),this.t=1,this.v=new h(3),t instanceof Array&&this.setAxisAngle(t||[1,0,0],a||0)}return Object(i.a)(e,[{key:"copy",value:function(){var t=new e;return t.t=this.t,t.v=this.v.copy(),t}},{key:"quadrance",value:function(){return this.t*this.t+this.v[0]*this.v[0]+this.v[1]*this.v[1]+this.v[2]*this.v[2]}},{key:"length",value:function(){return Math.sqrt(this.quadrance())}},{key:"invert_",value:function(){var e=this.quadrance();return this.t/=e,this.v.div_(-e),this}},{key:"invert",value:function(){return this.copy().invert_()}},{key:"normalize_",value:function(){var e=this.length();return this.t/=e,this.v.div_(e),this}},{key:"normalize",value:function(){return this.copy().normalize_()}},{key:"rotate_",value:function(e){var t=this.v.cross(e).mul_(2),a=this.v.cross(t);return e[0]+=this.t*t[0]+a[0],e[1]+=this.t*t[1]+a[1],e[2]+=this.t*t[2]+a[2],e}},{key:"rotate",value:function(e){return this.rotate_(e.copy())}},{key:"mul_",value:function(e){var t=this.t,a=this.v[0],n=this.v[1],i=this.v[2],r=e.t,s=e.v[0],o=e.v[1],c=e.v[2];return this.t=t*r-a*s-n*o-i*c,this.v[0]=t*s+a*r+n*c-i*o,this.v[1]=t*o-a*c+n*r+i*s,this.v[2]=t*c+a*o-n*s+i*r,this}},{key:"mul",value:function(e){return this.copy().mul_(e)}},{key:"setAxisAngle",value:function(e,t){return this.t=Math.cos(t/2),this.v.set(e),this.v.mul_(Math.sin(t/2)/this.v.mag),this}},{key:"setFromEuler",value:function(e,t,a,n){var i=Math.cos(e/2),r=Math.cos(t/2),s=Math.cos(a/2),o=Math.sin(e/2),c=Math.sin(t/2),l=Math.sin(a/2);return"XYZ"===(n=n||"ZYX")?(this.v.set([o*r*s+i*c*l,i*c*s-o*r*l,i*r*l+o*c*s]),this.t=i*r*s-o*c*l):"YXZ"===n?(this.v.set([o*r*s+i*c*l,i*c*s-o*r*l,i*r*l-o*c*s]),this.t=i*r*s+o*c*l):"ZXY"===n?(this.v.set([o*r*s-i*c*l,i*c*s+o*r*l,i*r*l+o*c*s]),this.t=i*r*s-o*c*l):"ZYX"===n?(this.v.set([o*r*s-i*c*l,i*c*s+o*r*l,i*r*l-o*c*s]),this.t=i*r*s+o*c*l):"YZX"===n?(this.v.set([o*r*s+i*c*l,i*c*s+o*r*l,i*r*l-o*c*s]),this.t=i*r*s-o*c*l):"XZY"===n?(this.v.set([o*r*s-i*c*l,i*c*s-o*r*l,i*r*l+o*c*s]),this.t=i*r*s+o*c*l):"ZXZ"===n&&(this.v.set([Math.cos((e-a)/2)*c,Math.sin((e-a)/2)*c,Math.sin((e+a)/2)*r]),this.t=Math.cos((e+a)/2)*r),this}},{key:"toThreejs",value:function(){return new u.w(this.v[0],this.v[1],this.v[2],this.t)}}],[{key:"copy",value:function(e){return e.copy()}},{key:"mul",value:function(e,t){return e.copy().mul_(t)}},{key:"transfer",value:function(t,a){var n=t.angle(a);return n?new e(t.cross(a),n):new e}},{key:"twoAxis",value:function(t,a,n){var i,r,s;return t&&a?(i=new h([0,0,1]),r=t.cross(a)):t&&n?(i=new h([0,1,0]),r=n.cross(t)):a&&n&&(i=new h([1,0,0]),r=a.cross(n)),s=e.transfer(i,r),t?e.transfer(s.rotate_(new h([1,0,0])),t).mul_(s):e.transfer(s.rotate_(new h([0,1,0])),a).mul_(s)}},{key:"slerp",value:function(e,t,a){if(0==a)return e.copy();if(1==a)return t.copy();var n=t.copy(),i=e.t*t.t+e.v[0]*t.v[0]+e.v[1]*t.v[1]+e.v[2]*t.v[2];if(i<0&&(n.t=-t.t,n.v[0]=-t.v[0],n.v[1]=-t.v[1],n.v[2]=-t.v[2],i=-i),i>=1)return e.copy();var r=Math.sqrt(1-i*i);if(r<.001)return n.t=(e.t+n.t)/2,n.v[0]=(e.v[0]+n.v[0])/2,n.v[1]=(e.v[1]+n.v[1])/2,n.v[2]=(e.v[2]+n.v[2])/2,n;var s=Math.atan2(r,i),o=Math.sin((1-a)*s)/r,c=Math.sin(a*s)/r;return n.t=e.t*o+n.t*c,n.v[0]=e.v[0]*o+n.v[0]*c,n.v[1]=e.v[1]*o+n.v[1]*c,n.v[2]=e.v[2]*o+n.v[2]*c,n}},{key:"invert",value:function(e){return e.invert()}}]),e}(),m=2*Math.PI;function p(e,t,a,n,i){var r,s=0,o=t;do{var c=e(o),l=e(o+a),u=(l-c)/a;if(null===c||null===l)return null;r=Math.abs(c),o-=c/u,s+=1}while(r>n&&s<i);return r>n?null:o}function f(e){return e/180*Math.PI}function v(e){return 180*e/Math.PI}function y(e,t){var a=Math.acos(e);return t>0?a:m-a}function b(e,t){return!(!e||!t)&&(e[0]<=t[0]&&t[1]<=e[1]?t:t[0]<=e[0]&&e[1]<=t[1]?e:e[0]<=t[0]&&t[0]<=e[1]?[t[0],e[1]]:e[0]<=t[1]&&t[1]<=e[1]&&[e[0],t[1]])}function g(e,t){var a=[];if(!1===e||!1===t)return!1;if(!0===e)return t;if(!0===t)return e;var n=!0,i=!1,r=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){var c=s.value,l=[c[0],c[1]>c[0]?c[1]:m],u=!(c[1]>c[0])&&[0,c[1]],h=!0,d=!1,p=void 0;try{for(var f,v=t[Symbol.iterator]();!(h=(f=v.next()).done);h=!0){var y=f.value,g=[y[0],y[1]>y[0]?y[1]:m],E=!(y[1]>y[0])&&[0,y[1]],j=void 0;(j=b(l,g))&&a.push(j),(j=b(l,E))&&a.push(j),(j=b(u,g))&&a.push(j),(j=b(u,E))&&a.push(j)}}catch(O){d=!0,p=O}finally{try{h||null==v.return||v.return()}finally{if(d)throw p}}}}catch(O){i=!0,r=O}finally{try{n||null==o.return||o.return()}finally{if(i)throw r}}return!!a.length&&a}function E(e,t){var a=(t[0]+m)%m,n=(t[1]+m)%m;return e=(e+m)%m,a<=n?a<=e&&e<=n:a<=e||e<=n}function j(e,t){var a=[];if(!1===e||!1===t)return!1;if(!0===e)return t;if(!0===t)return e;var n=!0,i=!1,r=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){var c=s.value,l=c[0],u=c[1],h=!0,d=!1,m=void 0;try{for(var p,f=t[Symbol.iterator]();!(h=(p=f.next()).done);h=!0){var v=p.value,y=v[0],b=v[1];l<=y&&y<u?a.push([y,u<b?u:b]):l<b&&b<=u?a.push([l,b]):l<y&&b<u?a.push([y,b]):y<l&&u<b&&a.push([l,u])}}catch(g){d=!0,m=g}finally{try{h||null==f.return||f.return()}finally{if(d)throw m}}}}catch(g){i=!0,r=g}finally{try{n||null==o.return||o.return()}finally{if(i)throw r}}return!!a.length&&a}function O(e,t,a){var n=(t=(t%m+m)%m)-(e=(e%m+m)%m);return Math.abs(n)>Math.PI&&(n=n>0?n-m:n+m),(e+n*a+m)%m}function _(e,t,a){return e+(t-e)*a}function k(e){return Math.abs(e)>=1e9?(e/1e9).toFixed(3)+" G":Math.abs(e)>=1e6?(e/1e6).toFixed(3)+" M":Math.abs(e)>=1e3?(e/1e3).toFixed(3)+" K":Math.abs(e)<=1e-9?(e/1e-9).toFixed(3)+" n":Math.abs(e)<=1e-6?(e/1e-6).toFixed(3)+" \xb5":Math.abs(e)<=.001?(e/.001).toFixed(3)+" m":e.toPrecision(6)+" "}},,,,,,function(e,t,a){"use strict";var n,i=a(1),r=a(3),s=a(7),o=a(19),c=a.n(o),l=function(){function e(t){Object(i.a)(this,e),this.domElement=t,this.listeners={},this.handlers={}}return Object(r.a)(e,[{key:"addListener",value:function(e,t,a){var n=this;this.handlers[e]||(this.listeners[e]=[],this.handlers[e]=function(t){return n.handleEvent(e,t)},this.domElement.addEventListener(e,this.handlers[e])),this.listeners[e].push({handler:t,priority:a})}},{key:"removeListener",value:function(e,t){for(var a=this.listeners[e],n=0;n<a.length;n++)if(a[n].handler===t){a.splice(n,1);break}0===a.length&&(this.domElement.removeEventListener(e,this.handlers[e]),delete this.handlers[e],delete this.listeners[e])}},{key:"handleEvent",value:function(e,t){var a=this.listeners[e];if(a){var n=a.reduce(function(e,t){return Math.max(e,t.priority)},a[0].priority),i=!0,r=!1,s=void 0;try{for(var o,c=a[Symbol.iterator]();!(i=(o=c.next()).done);i=!0){var l=o.value;l.priority===n&&l.handler(t)}}catch(u){r=!0,s=u}finally{try{i||null==c.return||c.return()}finally{if(r)throw s}}}}}]),e}(),u=a(2),h=a(10),d=a(9),m=function(){function e(t,a,n){var r=this;Object(i.a)(this,e),this.epoch=t,this.timeScale=a,this.isTimeRunning=n,this.mouseState={x:0,y:0,leftButton:!1,rightButton:!1},this.timeLineCanvasDomElement=document.getElementById("timeLineCanvas"),this.canvasContext=this.timeLineCanvasDomElement.getContext("2d"),this.canvasRect={},this.updateCanvasStyle(),this.initValues(),this.timeLineCanvasDomElement.addEventListener("mousedown",this.onMouseDown.bind(this)),window.addEventListener("mouseup",this.onMouseUp.bind(this)),window.addEventListener("mousemove",this.onMouseMove.bind(this)),this.timeLineCanvasDomElement.addEventListener("mousewheel",this.onMouseWheel.bind(this)),window.addEventListener("keypress",function(e){" "===e.key&&r.togglePause()}),window.addEventListener("resize",this.updateCanvasStyle.bind(this)),window.oncontextmenu=function(){return!1}}return Object(r.a)(e,[{key:"initValues",value:function(){this.scales={minute:60,fiveMinutes:300,tenMinutes:600,thirtyMinutes:1800,hour:3600,threeHours:10800,sixHours:21600,day:86400,week:604800,month:2592e3,threeMonths:7776e3,year:31557600,fiveYears:157788e3},this.span=86400*this.timeScale*5,this.markDistance=300,this.scaleType="month",this.leftEpoch=this.epoch-this.span/2,this.updateScaleType(),this.getDateByEpoch=e.getDateByEpoch,this.getEpochByDate=e.getEpochByDate,this.roundDateUp=e.roundDateUp,this.nextRenderingDate=e.nextRenderingDate,this.formatDate=e.formatDate,this.formatDateFull=e.formatDateFull}},{key:"setTimeScale",value:function(e){h.a.dispatch(h.a.TIME_SCALE_CHANGED,{old:this.timeScale,new:e}),this.timeScale=e}},{key:"togglePause",value:function(){this.isTimeRunning=!this.isTimeRunning,h.a.dispatch(this.isTimeRunning?h.a.TIME_UNPAUSED:h.a.TIME_PAUSED)}},{key:"tick",value:function(e){this.mouseState.leftButton?this.epoch=this.leftEpoch+(this.mouseState.x-this.canvasRect.left)*this.span/this.timeLineCanvasDomElement.width:this.isTimeRunning&&(this.leftEpoch<this.epoch&&this.epoch<this.leftEpoch+this.span&&(this.leftEpoch+=this.timeScale*e),this.epoch+=this.timeScale*e),h.a.dispatch(h.a.EPOCH_CHANGED,{epoch:this.epoch,date:this.getDateByEpoch(this.epoch)}),this.redraw()}},{key:"forceEpoch",value:function(e){this.leftEpoch+=e-this.epoch,this.epoch=e,this.tick(0)}},{key:"useCurrentTime",value:function(){this.forceEpoch(this.getEpochByDate(new Date))}},{key:"redraw",value:function(){this.canvasContext.fillStyle="#222",this.canvasContext.fillRect(0,0,this.timeLineCanvasDomElement.width,this.timeLineCanvasDomElement.height),this.canvasContext.fillStyle=this.isTimeRunning?"#2846ed":"#393b40",this.drawCurrentTimeMark(),this.canvasContext.strokeStyle="#fdfdfd",this.canvasContext.fillStyle="#fdfdfd",this.canvasContext.font="11px sans-serif";for(var e=this.roundDateUp(this.getDateByEpoch(this.leftEpoch),this.scaleType),t=this.getEpochByDate(e);t<this.leftEpoch+this.span;)this.drawMark(this.getCanvasPositionByEpoch(t),this.formatDate(e,this.scaleType)),e=this.nextRenderingDate(e,this.scaleType),t=this.getEpochByDate(e)}},{key:"getCanvasPositionByEpoch",value:function(e){return(e-this.leftEpoch)*this.timeLineCanvasDomElement.width/this.span}},{key:"updateCanvasStyle",value:function(){this.canvasRect=this.timeLineCanvasDomElement.getBoundingClientRect(),this.timeLineCanvasDomElement.width=this.canvasRect.right-this.canvasRect.left,this.timeLineCanvasDomElement.height=this.canvasRect.bottom-this.canvasRect.top}},{key:"updateScaleType",value:function(){var e=this.markDistance*this.span/this.timeLineCanvasDomElement.width,t=!1;for(var a in this.scales)t?Math.abs(this.scales[t]/e-1)>Math.abs(this.scales[a]/e-1)&&(t=a):t=a;this.scaleType=t}},{key:"drawMark",value:function(e,t){this.canvasContext.beginPath(),this.canvasContext.moveTo(e,0),this.canvasContext.lineTo(e,this.timeLineCanvasDomElement.height/2),this.canvasContext.stroke(),this.canvasContext.fillText(t,e-this.canvasContext.measureText(t).width/2,this.timeLineCanvasDomElement.height-2)}},{key:"drawCurrentTimeMark",value:function(){this.canvasContext.fillRect(0,0,this.getCanvasPositionByEpoch(this.epoch),this.timeLineCanvasDomElement.height)}},{key:"onMouseDown",value:function(e){return 0===e.button?this.mouseState.leftButton=!0:2===e.button&&(this.mouseState.rightButton=!0),!1}},{key:"onMouseUp",value:function(e){return 0===e.button?this.mouseState.leftButton=!1:2===e.button&&(this.mouseState.rightButton=!1),!1}},{key:"onMouseMove",value:function(e){return this.mouseState.rightButton&&(this.leftEpoch+=(this.mouseState.x-e.x)*this.span/this.timeLineCanvasDomElement.width),this.mouseState.x=e.x,this.mouseState.y=e.y,!1}},{key:"getMinScale",value:function(){var e=this;return Object.keys(this.scales).reduce(function(t,a){return e.scales[t]<e.scales[a]?t:a})}},{key:"getMaxScale",value:function(){var e=this;return Object.keys(this.scales).reduce(function(t,a){return e.scales[t]>e.scales[a]?t:a})}},{key:"onMouseWheel",value:function(e){var t=e.deltaY>0?1.3:1/1.3,a=Math.min(Math.max(this.span*t,(this.canvasRect.right-this.canvasRect.left)/this.markDistance*this.scales[this.getMinScale()]),(this.canvasRect.right-this.canvasRect.left)/this.markDistance*this.scales[this.getMaxScale()]);return this.leftEpoch+=(this.mouseState.x-this.canvasRect.left)*(this.span-a)/(this.canvasRect.right-this.canvasRect.left),this.span=a,this.updateScaleType(),!1}}],[{key:"getDateByEpoch",value:function(e){return new Date(1e3*(946728e3+e))}},{key:"getEpochByDate",value:function(e){return e/1e3-946728e3}},{key:"roundDateUp",value:function(e,t){var a=new Date(e);if("minute"===t)a.setSeconds(60,0);else if("fiveMinutes"===t)a.setMinutes(5+a.getMinutes()-a.getMinutes()%5,0,0);else if("tenMinutes"===t)a.setMinutes(10+a.getMinutes()-a.getMinutes()%10,0,0);else if("thirtyMinutes"===t)a.setMinutes(30+a.getMinutes()-a.getMinutes()%30,0,0);else if("hour"===t)a.setMinutes(60,0,0);else if("threeHours"===t)a.setHours(3+a.getHours()-a.getHours()%3,0,0,0);else if("sixHours"===t)a.setHours(6+a.getHours()-a.getHours()%6,0,0,0);else if("day"===t)a.setHours(24,0,0,0);else if("week"===t)a.setHours(0,0,0,0),a.setDate(7+a.getDate()-a.getDay());else if("month"===t)a.setHours(0,0,0,0),a.setDate(1),a.setMonth(a.getMonth()+1);else if("threeMonths"===t)a.setHours(0,0,0,0),a.setDate(1),a.setMonth(3+a.getMonth()-a.getMonth()%3);else if("year"===t)a.setHours(0,0,0,0),a.setMonth(0,1);else{if("fiveYears"!==t)return;a.setHours(0,0,0,0),a.setFullYear(5+a.getFullYear()-a.getFullYear()%5,0,1)}return a}},{key:"nextRenderingDate",value:function(e,t){var a=new Date(e);if("minute"===t)a.setMinutes(a.getMinutes()+1);else if("fiveMinutes"===t)a.setMinutes(a.getMinutes()+5);else if("tenMinutes"===t)a.setMinutes(a.getMinutes()+10);else if("thirtyMinutes"===t)a.setMinutes(a.getMinutes()+30);else if("hour"===t)a.setHours(a.getHours()+1);else if("threeHours"===t)a.setHours(a.getHours()+3);else if("sixHours"===t)a.setHours(a.getHours()+6);else if("day"===t)a.setDate(a.getDate()+1);else if("week"===t)a.setDate(a.getDate()+7);else if("month"===t)a.setMonth(a.getMonth()+1);else if("threeMonths"===t)a.setMonth(a.getMonth()+3);else if("year"===t)a.setFullYear(a.getFullYear()+1,a.getMonth(),a.getDate());else{if("fiveYears"!==t)return;a.setFullYear(a.getFullYear()+5,a.getMonth(),a.getDate())}return a}},{key:"formatDate",value:function(e,t){if("minute"===t||"fiveMinutes"===t||"tenMinutes"===t||"thirtyMinutes"===t||"hour"===t||"threeHours"===t||"sixHours"===t){var a=e.getYear()+1900;return a+="-"+(e.getMonth()+1+"").padStart(2,"0"),a+="-"+(e.getDate()+"").padStart(2,"0"),a+=" "+(e.getHours()+"").padStart(2,"0"),a+=":"+(e.getMinutes()+"").padStart(2,"0")}if("day"===t||"week"===t){var n=e.getYear()+1900;return n+="-"+(e.getMonth()+1+"").padStart(2,"0"),n+="-"+(e.getDate()+"").padStart(2,"0")}if("month"===t||"threeMonths"===t){return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e.getMonth()]+" "+(e.getYear()+1900)}return"year"===t||"fiveYears"===t?e.getYear()+1900+"":e.toString()}},{key:"formatDateFull",value:function(e){var t=e.getYear()+1900;return t+="-"+(e.getMonth()+1+"").padStart(2,"0"),t+="-"+(e.getDate()+"").padStart(2,"0"),t+=" "+(e.getHours()+"").padStart(2,"0"),t+=":"+(e.getMinutes()+"").padStart(2,"0"),t+=":"+(e.getSeconds()+"").padStart(2,"0")}}]),e}(),p=a(82),f=function(){function e(t,a,n){Object(i.a)(this,e),this.raycaster=new s.y,this.mouse=new s.E,this.camera=a,this.domElement=t,this.setPixelPrecision(n),this.updatePixelAngleSize(),this.domElement.addEventListener("mousemove",this.onMouseMove.bind(this)),this.domElement.addEventListener("resize",this.updatePixelAngleSize.bind(this))}return Object(r.a)(e,[{key:"onMouseMove",value:function(e){this.mouse.x=e.clientX/this.domElement.width*2-1,this.mouse.y=-e.clientY/this.domElement.height*2+1}},{key:"setPixelPrecision",value:function(e){this.raycaster.pixelPrecision=e}},{key:"updatePixelAngleSize",value:function(){this.raycaster.pixelAngleSize=Object(u.g)(this.camera.fov)/this.domElement.height}},{key:"getPixelAngleSize",value:function(){return this.raycaster.pixelAngleSize}},{key:"intersectObjects",value:function(e){return this.raycaster.setFromCamera(this.mouse,this.camera),this.raycaster.intersectObjects(e)}},{key:"getPixelDistance",value:function(e){this.raycaster.setFromCamera(this.mouse,this.camera);var t=(new s.F).subVectors(e,ee.camera.lastPosition);return Math.acos(this.raycaster.ray.direction.dot(t)/t.length())/this.raycaster.pixelAngleSize}}]),e}(),v=a(5),y=a(4),b=a(6),g=a(14),E=a(17),j=a(21),O=function(e){function t(){var e;return Object(i.a)(this,t),(e=Object(v.a)(this,Object(y.a)(t).call(this))).selectableObjects=[],e.selectedObject=null,e.bestIntersection=null,e.selectionMouseButton=0,e.pointSize=5,e.setThreeObj(new s.n(new s.A(1,10,10),new s.o({color:16776960}))),j.c.addEventListener("click",e.onMouseClick.bind(Object(g.a)(Object(g.a)(e))),1),j.c.addEventListener("mousedown",e.onMouseDown.bind(Object(g.a)(Object(g.a)(e))),1),e.mouseMoveListener=e.onMouseMove.bind(Object(g.a)(Object(g.a)(e))),e}return Object(b.a)(t,e),Object(r.a)(t,[{key:"addSelectableObject",value:function(e){this.selectableObjects.push(e)}},{key:"removeSelectableObject",value:function(e){for(var t in this.selectableObjects)if(this.selectableObjects[t]===e){delete this.selectableObjects[t];break}this.selectableObjects=this.selectableObjects.filter(function(e){return e})}},{key:"render",value:function(){var e=j.c.raycaster.intersectObjects(this.selectableObjects);if(e.length>0){this.bestIntersection=e[0];for(var t=1;t<e.length;t++)e[t].distance<this.bestIntersection.distance&&(this.bestIntersection=e[t]);this.threeObj.visible=!0,this.threeObj.position.copy(this.bestIntersection.point);var a=this.pointSize*this.bestIntersection.point.length()*j.c.raycaster.getPixelAngleSize();this.threeObj.scale.x=a,this.threeObj.scale.y=a,this.threeObj.scale.z=a}else this.threeObj.visible=!1,this.bestIntersection=null}},{key:"onMouseDown",value:function(e){e.button===this.selectionMouseButton&&(document.addEventListener("mousemove",this.mouseMoveListener),this.hasMouseMoved=!1,this.mouseClickStart=[e.clientX,e.clientY])}},{key:"onMouseMove",value:function(e){this.mouseClickStart[0]===e.clientX&&this.mouseClickStart[1]===e.clientY||(this.hasMouseMoved=!0)}},{key:"onMouseClick",value:function(e){var t=this.selectedObject;if(e.button===this.selectionMouseButton&&(document.removeEventListener("mousemove",this.mouseMoveListener),!this.hasMouseMoved))if(this.bestIntersection){var a=this.bestIntersection.object.userData.selectionObject;a instanceof Function&&(a=a()),a&&a!==t?(this.deselect(),this.select(a)):a&&this.bestIntersection.object.userData.onClick&&this.bestIntersection.object.userData.onClick(this.bestIntersection)}else this.deselect()}},{key:"forceSelection",value:function(e){this.deselect(),this.select(e)}},{key:"getSelectedObject",value:function(){return this.selectedObject}},{key:"select",value:function(e){this.selectedObject=e,this.selectedObject.select(),j.a.dispatch(j.a.SELECT,{object:this.selectedObject})}},{key:"deselect",value:function(){this.selectedObject&&(j.a.dispatch(j.a.DESELECT,{object:this.selectedObject}),this.selectedObject.deselect(),this.selectedObject=null)}}]),t}(E.a),_=function(){function e(t,a){var n=this;Object(i.a)(this,e),this.jqDom=c()(t),this.name=this.jqDom.data("panelName"),this.jqCollapseButton=this.jqDom.find(".collapseButton[data-panel-name='"+this.name+"']"),this.jqCollapseButton.click(function(){return n.toggleCollapse()}),this.isCollapsed=!!a,this.isCollapsed?this.collapse():this.expand()}return Object(r.a)(e,[{key:"show",value:function(){this.jqDom.show()}},{key:"hide",value:function(){this.jqDom.hide()}},{key:"toggleCollapse",value:function(){this.isCollapsed?this.expand():this.collapse()}},{key:"collapse",value:function(){this.jqCollapseButton.html("Show"),this.isCollapsed=!0,this.jqDom.find(".panelContent[data-panel-name='"+this.name+"']").hide()}},{key:"expand",value:function(){this.jqCollapseButton.html("Hide"),this.isCollapsed=!1,this.jqDom.find(".panelContent[data-panel-name='"+this.name+"']").show()}}]),e}(),k=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(v.a)(this,Object(y.a)(t).call(this,e))).maxTimeScale=15552e3,a.jqSlider=a.jqDom.find("#timeScaleSlider"),a.jqSlider.on("input change",function(){return ee.time.setTimeScale(a.getCurrentTimeScale())}),a.jqSlider.val(a.getNeededSliderValue(ee.time.timeScale)),a.jqScaleText=a.jqDom.find("#timeScaleValue"),a.jqScaleText.html(a.formatTimeScale(ee.time.timeScale)),document.addEventListener(h.a.TIME_SCALE_CHANGED,function(e){a.jqSlider.val(a.getNeededSliderValue(e.detail.new)),a.jqScaleText.html(a.formatTimeScale(e.detail.new))}),a.jqDateText=a.jqDom.find("#currentDateValue"),document.addEventListener(h.a.EPOCH_CHANGED,function(e){return a.updateTime(e.detail.date)}),a.jqDom.find("#setRealTimeScale").click(function(){return ee.time.setTimeScale(1)}),a.jqDom.find("#useCurrentTime").click(function(){return ee.time.useCurrentTime()}),a}return Object(b.a)(t,e),Object(r.a)(t,[{key:"updateTime",value:function(e){this.jqDateText.html(ee.time.formatDateFull(e))}},{key:"getCurrentTimeScale",value:function(){var e=this.jqSlider.val();return Math.sign(e)*e*e*e*e*this.maxTimeScale}},{key:"getNeededSliderValue",value:function(e){var t=Math.sqrt(Math.sqrt(Math.abs(e)/this.maxTimeScale));return Math.sign(e)*Math.min(1,t)}},{key:"formatTimeScale",value:function(e){var t=e<0?"-":"",a=Math.abs(e);return 0===a?"0":a<60?t+a.toPrecision(2)+" s/s":a<3600?t+(a/60).toPrecision(2)+" min/s":a<86400?t+(a/3600).toPrecision(2)+" h/s":a<2592e3?t+(a/86400).toPrecision(2)+" days/s":a<31557600?t+(a/2592e3).toPrecision(2)+" months/s":t+(a/31557600).toPrecision(2)+" years/s"}}]),t}(_),w=a(32),M=function(e){function t(e,a){var n;return Object(i.a)(this,t),(n=Object(v.a)(this,Object(y.a)(t).call(this,e))).camera=a,n.jqTarget=n.jqDom.find("#targetSelect"),n.jqTarget.on("change",function(){return n.camera.changeOrigin(0|n.jqTarget.val())}),n.jqFrameType=n.jqDom.find("#rfTypeSelect"),n.jqFrameType.on("change",function(){return n.camera.changeReferenceFrameType(0|n.jqFrameType.val())}),h.a.addListener(h.a.STAR_SYSTEM_LOADED,function(e){n.starSystem=e.detail.starSystem,n.jqTarget.html(""),n.updateTargetList(),n.updateTarget(n.camera.orbitingPoint),n.updateFrameTypeList(),n.updateFrameType(n.camera.frameType)}),h.a.addListener(h.a.CAMERA_RF_CHANGED,function(e){n.updateTarget(e.detail.new.originId),n.updateFrameTypeList(),n.updateFrameType(e.detail.new.type)}),h.a.addListener(h.a.OBJECT_ADDED,function(){n.updateTargetList()}),n}return Object(b.a)(t,e),Object(r.a)(t,[{key:"updateTargetList",value:function(){var e=this;this.starSystem&&c.a.each(this.starSystem.getObjectNames(),function(t,a){0===e.jqTarget.find("option[value='"+t+"']").length&&e.jqTarget.append(c()("<option>",{value:t}).text(a))})}},{key:"updateFrameTypeList",value:function(){var e=this,a=0|this.jqFrameType.val();this.jqFrameType.html(""),c.a.each(this.camera.getAvailableFrameTypes(),function(n,i){e.jqFrameType.append(c()("<option>",{value:i,selected:i==a}).text(t.frameTypeNames[i]))})}},{key:"updateTarget",value:function(e){this.jqTarget.val(e)}},{key:"updateFrameType",value:function(e){this.jqFrameType.val(e)}}]),t}(_);M.frameTypeNames=(n={},Object(w.a)(n,d.c.INERTIAL_ECLIPTIC,"Ecliptic"),Object(w.a)(n,d.c.INERTIAL_BODY_EQUATORIAL,"Equatorial"),Object(w.a)(n,d.c.INERTIAL_BODY_FIXED,"Body fixed"),Object(w.a)(n,d.c.INERTIAL_PARENT_BODY_EQUATORIAL,"Parent equatorial"),n);var S=a(35),T=function(e){function t(e,a){var n;return Object(i.a)(this,t),(n=Object(v.a)(this,Object(y.a)(t).call(this,e,!0))).vectorOfEpoch=a,n.jqMag=n.jqDom.find(".vec-magnitude"),n.jqX=n.jqDom.find(".vec-x"),n.jqY=n.jqDom.find(".vec-y"),n.jqZ=n.jqDom.find(".vec-z"),n}return Object(b.a)(t,e),Object(r.a)(t,[{key:"set",value:function(e,t){this.vectorOfEpoch=e,this.update(t)}},{key:"update",value:function(e){var t=this.vectorOfEpoch;(e||0===e)&&t instanceof S.a&&(t=t.evaluate(e)),!t instanceof u.c||(this.jqMag.html(Object(u.l)(t.mag)),this.jqX.html(Object(u.l)(t.x)),this.jqY.html(Object(u.l)(t.y)),this.jqZ.html(Object(u.l)(t.z)))}}]),t}(_),A=a(18),P=function(e){function t(e,a){var n;return Object(i.a)(this,t),(n=Object(v.a)(this,Object(y.a)(t).call(this,e))).selection=a,n.precision=5,n.renderListener=n.render.bind(Object(g.a)(Object(g.a)(n))),document.addEventListener(h.a.SELECT,n.handleSelect.bind(Object(g.a)(Object(g.a)(n)))),document.addEventListener(h.a.DESELECT,n.handleDeselect.bind(Object(g.a)(Object(g.a)(n)))),n.jqDom.find("#unloadObject").on("click",function(){var e=a.getSelectedObject();a.deselect(),ee.starSystem.deleteObject(e.id)}),n.jqDom.find("#showAnglesOfSelectedOrbit").on("change",function(){ee.settings.ui.showAnglesOfSelectedOrbit=this.checked,h.a.dispatch(h.a.SHOW_ORBIT_ANGLES_CHANGED,{value:this.checked})}),n.positionPanel=new T(n.jqDom.find(".js-metrics-panel-cartesian-position-vector"),null),n.velocityPanel=new T(n.jqDom.find(".js-metrics-panel-cartesian-velocity-vector"),null),n.hide(),n}return Object(b.a)(t,e),Object(r.a)(t,[{key:"render",value:function(e){var t=this.selection.getSelectedObject().trajectory,a=null;if(t)try{var n=t.getReferenceFrameByEpoch(e.detail.epoch);n&&(a=ee.starSystem.getObject(n.originId),this.jqDom.find("#relativeTo").html(a.name)),this.updateMain(t,e.detail.epoch,a),this.updateCartesian(t,e.detail.epoch),this.updateKeplerian(t,e.detail.epoch)}catch(i){}}},{key:"updateMain",value:function(e,t,a){var n=e.getKeplerianObjectByEpoch(t),i=n.sma,r=i*(1-n.ecc),s=i*(1+n.ecc),o=a.physicalModel?a.physicalModel.radius:0,c=e.getStateInOwnFrameByEpoch(t);this.jqDom.find("#elements-orbit-alt").html((r-o).toPrecision(this.precision)+" x "+(s-o).toPrecision(this.precision)),this.jqDom.find("#elements-orbit-avg").html(""+(i-o).toPrecision(this.precision)),this.jqDom.find("#elements-alt").html(""+(c.position.mag-o).toPrecision(this.precision)),this.jqDom.find("#elements-speed").html(""+(1e3*c.velocity.mag).toPrecision(this.precision)),a.physicalModel&&a.physicalModel.j2&&a.physicalModel.j2&&this.jqDom.find("#elements-precession").html(""+Object(u.m)(86400*n.getNodalPrecessionRate(a.physicalModel.eqRadius,a.physicalModel.j2)).toPrecision(this.precision))}},{key:"updateCartesian",value:function(e,t){var a=e.getStateInOwnFrameByEpoch(t);this.positionPanel.set(a.position),this.velocityPanel.set(a.velocity)}},{key:"updateKeplerian",value:function(e,t){var a=e.getKeplerianObjectByEpoch(t);this.jqDom.find("#elements-ecc").html(""+a.ecc.toPrecision(this.precision)),this.jqDom.find("#elements-sma").html(""+Object(u.l)(a.sma)),this.jqDom.find("#elements-inc").html(""+Object(u.m)(a.inc).toPrecision(this.precision)),this.jqDom.find("#elements-aop").html(""+Object(u.m)(a.aop).toPrecision(this.precision)),this.jqDom.find("#elements-raan").html(""+Object(u.m)(a.raan).toPrecision(this.precision)),this.jqDom.find("#elements-ta").html(""+Object(u.m)(a.getTrueAnomalyByEpoch(t)).toPrecision(this.precision)),this.jqDom.find("#elements-period").html(""+(a.period/86400).toPrecision(this.precision))}},{key:"handleSelect",value:function(){this.show();var e=this.selection.getSelectedObject();e?c()("#metricsOf").html(e.name):c()("#relativeTo,#metricsOf").html(""),e.type===A.a.TYPE_SPACECRAFT||e.type===A.a.TYPE_UNKNOWN?this.jqDom.find("#unloadObject").show():this.jqDom.find("#unloadObject").hide(),document.addEventListener(h.a.RENDER,this.renderListener)}},{key:"handleDeselect",value:function(){this.hide(),document.removeEventListener(h.a.RENDER,this.renderListener)}}]),t}(_),C=a(12),x=a(22),D=a(23),B=a(16),N=a(37),I=a(28),L=function(){function e(){Object(i.a)(this,e)}return Object(r.a)(e,null,[{key:"getPlotData",value:function(e,t,a,n,i,r,s){for(var o=(n-a)/(s-1),c=(r-i)/(s-1),l=[],u=a,h=0;u<=n;){var d=i,m=0;for(l[h]=[];d<=r;){var p=this.calcDeltaV(e.getStateByEpoch(u),t.getStateByEpoch(u+d),u,d,e.mu);l[h][m]=p,d+=c,m++}u+=o,h++}return l}},{key:"plot",value:function(e){var t=1e99,a=0,n=document.getElementById("lambertCanvas").getContext("2d");n.clearRect(0,0,300,300);var i=!0,r=!1,s=void 0;try{for(var o,c=e[Symbol.iterator]();!(i=(o=c.next()).done);i=!0){var l=o.value,u=!0,h=!1,d=void 0;try{for(var m,p=l[Symbol.iterator]();!(u=(m=p.next()).done);u=!0){var f=m.value;!1!==f&&(f<t&&(t=f),f>a&&(a=f))}}catch(E){h=!0,d=E}finally{try{u||null==p.return||p.return()}finally{if(h)throw d}}}}catch(E){r=!0,s=E}finally{try{i||null==c.return||c.return()}finally{if(r)throw s}}for(var v in e)for(var y in e[v]){var b=e[v][y];if(!1===b)n.fillStyle="rgba(255,0,0,1)";else{var g=Math.round(255*(1-(b-t)/(a-t)));n.fillStyle="rgba("+g+","+g+","+g+", 1)"}n.fillRect(0|v,0|y,1,1)}}},{key:"getDeltaV",value:function(e,t,a,n,i){return e.velocity.sub_(a.getStateByEpoch(n)._velocity).mag+t.velocity.sub_(a.getStateByEpoch(i)._velocity).mag}},{key:"calcDeltaV",value:function(e,t,a,n,i){var r=this.solve(e,t,a,n,i);return!!r&&this.getDeltaV(e,t,r,a,a+n)}},{key:"findBestTransfer",value:function(e,t,a,n,i,r,s){for(var o,c=this,l=1e-6*(s-r),h=(s-r)/49,d=1e100,m=r;m<=s;m+=h){var p=this.solveFullTransfer(e,t,a,n,i,m);if(null!==p){var f=p.totalDeltaV;f<d&&(o=m,d=f)}}return null===(o=Object(u.k)(function(o){if(o<r)return null;if(o>s)return null;var u=c.solveFullTransfer(e,t,a,n,i,o-l/2),h=c.solveFullTransfer(e,t,a,n,i,o+l/2);return null===u||null===h?null:(h.totalDeltaV-u.totalDeltaV)/l},o,.001*h,1e-6,10))?{totalDeltaV:null}:this.solveFullTransfer(e,t,a,n,i,o)}},{key:"solveFullTransfer",value:function(e,t,a,n,i,r){if(r<=0)return null;var s=ee.getModule("PatchedConics").getCommonParent(e.id,t.id);if(!(s instanceof D.a))return null;var o,c,l,h,m,p,f=d.d.buildId(s.id,s.type===A.a.TYPE_STAR?d.c.INERTIAL_ECLIPTIC:d.c.INERTIAL_BODY_EQUATORIAL),v=ee.starSystem.getReferenceFrame(f),y=s.physicalModel.mu,b=e instanceof D.a,g=t instanceof D.a;b&&(l=ee.starSystem.getReferenceFrame(d.d.buildId(e.id,d.c.INERTIAL_BODY_EQUATORIAL)),m=e.data.patchedConics.soiRadius),g&&(p=t.data.patchedConics.soiRadius,h=ee.starSystem.getReferenceFrame(d.d.buildId(t.id,d.c.INERTIAL_BODY_EQUATORIAL)));for(var E,j,O,_,k,w=0,M=0,S=new u.c(3),T=new u.c(3),P=0;;){if(_=i+w,k=i+r-M,o=e.trajectory.getStateByEpoch(_,v),b&&(o._position=l.transformPositionByEpoch(_,S,v)),c=t.trajectory.getStateByEpoch(k,v),g&&(c._position=h.transformPositionByEpoch(k,T,v)),null===(O=this.solve(o,c,_,k-_,y)))return null;P++;var C=[new u.c(3),0],L=[new u.c(3),0];if(b){E=O.getStateByEpoch(_)._velocity.sub_(o._velocity);var F=o._position.cross(E);w=(C=this.getSoiEdgePositionAndTime(v.rotateVectorByEpoch(_,E,l),v.rotateVectorByEpoch(_,F,l),a,m,e.physicalModel.mu,1))[1]}if(g){j=O.getStateByEpoch(k)._velocity.sub_(c._velocity);var R=c._position.cross(j);M=(L=this.getSoiEdgePositionAndTime(v.rotateVectorByEpoch(k,j,h),v.rotateVectorByEpoch(k,R,h),n,p,t.physicalModel.mu,-1))[1]}if(P>10||(!b||S.sub(C[0]).mag<10)&&(!g||T.sub(L[0]).mag<10)){S=C[0],T=L[0];break}S=C[0],T=L[0]}var q=0,V=0,U=new N.a,z=new I.a(f,O);if(z.minEpoch=i+w,z.maxEpoch=i+r-M,U.addComponent(z),b){var Y=x.a.createFromState(new B.a(S,v.rotateVectorByEpoch(_,E,l)),e.physicalModel.mu,i+w);q=Y.getPeriapsisSpeed()-Math.sqrt(e.physicalModel.mu/Y.getPeriapsisRadius());var H=new I.a(l.id,Y);H.minEpoch=i,H.maxEpoch=i+w,U.addComponent(H)}else q=o.velocity.sub(O.getStateByEpoch(i)._velocity).mag;if(g){var K=x.a.createFromState(new B.a(T,v.rotateVectorByEpoch(k,j,h)),t.physicalModel.mu,i+r-M);V=K.getPeriapsisSpeed()-Math.sqrt(t.physicalModel.mu/K.getPeriapsisRadius());var Q=new I.a(h.id,K);Q.minEpoch=i+r-M,Q.maxEpoch=i+r,U.addComponent(Q)}else V=c.velocity.sub(O.getStateByEpoch(i+r)._velocity).mag;return{trajectory:U,ejectionDeltaV:q,insertionDeltaV:V,totalDeltaV:q+V}}},{key:"getSoiEdgePositionAndTime",value:function(e,t,a,n,i,r){var s=1/(2/n-e.quadrance/i),o=1-a/s,c=r*Math.acos((s*(1-o*o)/n-1)/o),l=Math.atan(o*Math.sin(c)/(s*(1-o*o)/n)),h=new u.a(t,l-Math.PI/2).rotate_(e.unit().mul_(n)),d=this.getEccentricAnomalyByTrueAnomaly(c,o),m=o>1?(o*Math.sinh(d)-d)/Math.sqrt(i/s/s/Math.abs(s)):(d-o*Math.sin(d))/Math.sqrt(i/s/s/s);return[h,Math.abs(m)]}},{key:"solve",value:function(e,t,a,n,i){var r=this,s=e.position,o=t.position,c=s.cross(o),l=s.mag,h=o.mag,d=s.angle(o);c.angle(e._position.cross(e._velocity))>Math.PI/2&&(d=2*Math.PI-d,c.mul_(-1));var m,p,f,v=Math.sign(Math.sin(d)),y=c.angle(new u.c([0,0,1])),b=new u.c([0,0,1]).cross(c),g=b.angle(new u.c([1,0,0]));new u.c([1,0,0]).cross(b).angle(new u.c([0,0,1]))>Math.PI/2&&(g=2*Math.PI-g);var E=Math.sqrt(l*l+h*h-2*s.dot(o))/2,j=(Math.pow(l+h+2*E,1.5)-v*Math.pow(l+h-2*E,1.5))/(6*Math.sqrt(i));if(n>j){var O=(h-l)/2,_=E/O,k=Math.sqrt(E*E-O*O),w=Object(u.k)(function(e){return r.getTimeByY(e,O,k,_,l,h,E,d,i)-n},1e4,1,1,30);if(null===w)return null;var M=-(h+l)/2/_,S=k*Math.sqrt(M*M/O/O-1),T=O*Math.sqrt(1+w*w/k/k),A=Math.sqrt((M-T)*(M-T)+(S-w)*(S-w)),P=(M-T)/A,C=(S-w)/A;f=Object(u.d)(-((M+E)*P+S*C)/l,v*((M+E)*C-S*P)),m=A/2/(p=_*(T-M)/2)}else{if(null===(p=Object(u.k)(function(e){var t=Math.acosh(1+(l+h+2*E)/2/Math.abs(e)),a=Math.acosh(1+(l+h-2*E)/2/Math.abs(e));return Math.sqrt(Math.abs(Math.pow(e,3))/i)*(Math.sinh(t)-t-v*(Math.sinh(a)-a))-n},l,10,1,30)))return null;p>0&&(p=-p);var D=s.rotate(b,-y).mul_(-1),B=o.rotate(b,-y).add_(D),N=l-2*p,I=h-2*p,L=-Math.sign(B.y)*B.angle(new u.c([1,0,0]));D=D.rotateZ(L);var F=((B=B.rotateZ(L)).x*B.x-I*I+N*N)/2/B.x,R=Math.sqrt(N*N-F*F);(d>Math.PI?D.y<0:D.y>0)&&(R=-R);var q=p*(1-(m=-D.sub_(new u.c([F,R,0])).mag/2/p)*m);f=Math.acos((q/l-1)/m);var V=Math.acos((q/h-1)/m);(f>V||V-d<0)&&(f=-f)}var U=new u.a(c,-f).rotate(s),z=b.angle(U);return b.cross(U).angle(c)>Math.PI/2&&(z=2*Math.PI-z),new x.a(m,p,z,y,g,f,a,i,!0)}},{key:"getTimeByY",value:function(e,t,a,n,i,r,s,o,c){var l=(r+i)/2,h=-l/n,d=a*Math.sqrt(h*h/t/t-1),m=t*Math.sqrt(1+e*e/a/a),p=(l+n*m)/2,f=Math.sqrt((h-m)*(h-m)+(d-e)*(d-e)),v=f/2/p,y=(h-m)/f,b=(d-e)/f,g=-((h+s)*y+d*b)/i,E=Math.sign(Math.sin(o))*((h+s)*b-d*y),j=Object(u.d)(g,E),O=Math.sqrt(c/p/p/p),_=this.getEccentricAnomalyByTrueAnomaly(j,v),k=this.getEccentricAnomalyByTrueAnomaly(j+o,v);return j+o>2*Math.PI&&(k+=2*Math.PI),(k-_-v*(Math.sin(k)-Math.sin(_)))/O}},{key:"getEccentricAnomalyByTrueAnomaly",value:function(e,t){if(t<1){var a=Math.cos(e);return Object(u.d)((t+a)/(1+t*a),Math.sin(e))}return 2*Math.atanh(Math.tan(e/2)/Math.sqrt((t+1)/(t-1)))}}]),e}(),F=a(30),R=function(e){function t(e,a){var n;return Object(i.a)(this,t),n=Object(v.a)(this,Object(y.a)(t).call(this)),void 0===a&&(a=d.a),n.referenceFrame=ee.starSystem.getReferenceFrame(a),n.quaternion=u.a.transfer(new u.c([0,1,0]),e),n.setThreeObj(new s.b((new s.F).fromArray([1,0,0]),new s.F,e.mag)),n}return Object(b.a)(t,e),Object(r.a)(t,[{key:"render",value:function(e){this.threeObj.quaternion.copy(this.quaternion.mul(this.referenceFrame.getQuaternionByEpoch(e)).toThreejs()),this.setPosition(this.referenceFrame.getOriginPositionByEpoch(e))}}]),t}(E.a),q=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(v.a)(this,Object(y.a)(t).call(this,e,!0))).maxTransferTime=1262304e3,a.jqSlider=a.jqDom.find("#transferTimeSlider"),a.jqSlider.on("input change",function(){return a.changeTransferTime(a.getCurrentTransferTime())}),a.transferTime=a.getCurrentTransferTime(),a.jqTransferTimeText=a.jqDom.find("#transferTimeValue"),a.jqTransferTimeText.html(a.formatTransferTime(a.transferTime)),a.jqDateText=a.jqDom.find("#departureDateValue"),a.jqDom.find("#useCurrentTime").click(function(){return a.useCurrentTime()}),a.jqOrigin=a.jqDom.find("#originSelect"),a.jqOrigin.on("change",function(){return a.changeOrigin(0|a.jqOrigin.val())}),a.jqTarget=a.jqDom.find("#targetSelect"),a.jqTarget.on("change",function(){return a.changeTarget(0|a.jqTarget.val())}),a.useCurrentTime(),a.origin=399,a.jqOrigin.val(a.origin),h.a.addListener(h.a.STAR_SYSTEM_LOADED,function(){a.jqOrigin.html(""),a.jqTarget.html("");var e=a.buildListData();e&&(a.updateList(a.jqTarget,e),a.updateList(a.jqOrigin,e))}),a}return Object(b.a)(t,e),Object(r.a)(t,[{key:"solve",value:function(){if(this.origin&&this.target&&this.origin!==this.target){var e=ee.getModule("PatchedConics").getCommonParent(this.origin,this.target);if(null!==e&&e.id!=this.origin&&e.id!=this.target){var t=d.d.buildId(e.id,d.c.INERTIAL_ECLIPTIC),a=ee.starSystem.getObject(this.origin),n=ee.starSystem.getObject(this.target),i=a.trajectory.getStateByEpoch(this.departureTime,t),r=n.trajectory.getStateByEpoch(this.departureTime+this.transferTime,t),s=L.solveFullTransfer(a,n,a.physicalModel?a.physicalModel.radius+200:0,n.physicalModel?n.physicalModel.radius+200:0,this.departureTime,this.transferTime);if(s){var o=s.trajectory;o.setObject(new A.a(-1,A.a.TYPE_UNKNOWN,a.name+"->"+n.name+" transfer")),this.visualModel&&(this.visualModel.drop(),this.visualModel2&&this.visualModel2.drop(),this.visualModel3&&this.visualModel3.drop(),this.vector1.drop(),this.vector2.drop()),this.visualModel=new F.a(o.components[0],"yellow"),o.components[1]&&(this.visualModel2=new F.a(o.components[1],"red")),o.components[2]&&(this.visualModel3=new F.a(o.components[2],"red")),this.vector1=new R(i.position,t),this.vector2=new R(r.position,t),this.jqDom.find("#deltaVEjection").html(s.ejectionDeltaV.toPrecision(4)),this.jqDom.find("#deltaVInsertion").html(s.insertionDeltaV.toPrecision(4)),this.jqDom.find("#deltaVTotal").html((s.ejectionDeltaV+s.insertionDeltaV).toPrecision(4))}}}}},{key:"collapse",value:function(){this.visualModel&&(this.visualModel.drop(),this.visualModel2.drop(),this.visualModel3.drop(),this.vector1.drop(),this.vector2.drop(),this.visualModel=null),Object(C.a)(Object(y.a)(t.prototype),"collapse",this).call(this)}},{key:"useCurrentTime",value:function(){this.departureTime=ee.currentEpoch,this.updateTime(ee.currentDate),this.solve()}},{key:"changeOrigin",value:function(e){this.origin=e,this.updateSliderScale(),this.solve()}},{key:"changeTarget",value:function(e){this.target=e,this.updateSliderScale(),this.solve()}},{key:"updateSliderScale",value:function(){if(this.origin&&this.target&&this.origin!==this.target){var e=ee.getModule("PatchedConics").getRelativePeriod(this.origin,this.target,this.departureTime);null!==e&&(this.maxTransferTime=Math.max(e.period1,e.period2),this.jqSlider.val(this.getNeededSliderValue((e.period1+e.period2)/4)),this.changeTransferTime(this.getCurrentTransferTime()))}}},{key:"changeTransferTime",value:function(e){this.transferTime=e,this.jqTransferTimeText.html(this.formatTransferTime(this.transferTime)),this.solve()}},{key:"getCurrentTransferTime",value:function(){var e=this.jqSlider.val();return e*e*e*e*this.maxTransferTime}},{key:"getNeededSliderValue",value:function(e){var t=Math.sqrt(Math.sqrt(e/this.maxTransferTime));return Math.max(0,Math.min(1,t))}},{key:"buildListData",value:function(){var e=ee.getModule("PatchedConics").getRootSoi();return e?this.buildSoiTreeData(e,0):null}},{key:"buildSoiTreeData",value:function(e,t){var a=[{id:e.id,level:t,name:e.name}],n=!0,i=!1,r=void 0;try{for(var s,o=e.data.patchedConics.childSois[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){var c=s.value;a=a.concat(this.buildSoiTreeData(c,t+1))}}catch(l){i=!0,r=l}finally{try{n||null==o.return||o.return()}finally{if(i)throw r}}return a}},{key:"updateList",value:function(e,t){var a=!0,n=!1,i=void 0;try{for(var r,s=t[Symbol.iterator]();!(a=(r=s.next()).done);a=!0){var o=r.value;e.append(c()("<option>",{value:o.id}).html("&nbsp;&nbsp;&nbsp;".repeat(o.level)+o.name))}}catch(l){n=!0,i=l}finally{try{a||null==s.return||s.return()}finally{if(n)throw i}}}},{key:"updateTime",value:function(e){this.jqDateText.html(ee.time.formatDateFull(e))}},{key:"formatTransferTime",value:function(e){var t=e<0?"-":"",a=Math.abs(e);return 0===a?"0":a<60?t+a.toPrecision(3)+" s":a<3600?t+(a/60).toPrecision(3)+" min":a<86400?t+(a/3600).toPrecision(3)+" h":a<2592e3?t+(a/86400).toPrecision(3)+" days":a<31557600?t+(a/2592e3).toPrecision(3)+" months":t+(a/31557600).toPrecision(3)+" years"}}]),t}(_),V=a(54),U=function(e){function t(){return Object(i.a)(this,t),Object(v.a)(this,Object(y.a)(t).apply(this,arguments))}return Object(b.a)(t,e),t}(a(41).a);U.NO_THREE_OBJ=!0;var z=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(v.a)(this,Object(y.a)(t).call(this,e))).jqPause=a.jqDom.find("#createOrbit"),a.jqPause.click(function(){var e=ee.camera.orbitingPoint,t=ee.starSystem.getObject(e);if(t.physicalModel){var a=2*t.physicalModel.radius,n=-11e6-ee.starSystem.created;ee.starSystem.created+=1;var i=new I.a(d.d.buildId(e,d.c.INERTIAL_BODY_EQUATORIAL),new x.a(.2,a,Math.PI/6,Math.PI/3,Math.PI/6,0,ee.currentEpoch,t.physicalModel.mu));i.setVisualModel(new F.a(i,{color:"yellow"})),i.minEpoch=!1,i.maxEpoch=!1;var r=ee.getPropagator("patchedConics"),s=new V.a(new r);s.setVisualModel(new U(s,{color:"yellow"})),s.addComponent(i);var o=new A.a(n,A.a.TYPE_UNKNOWN,"Created #"+ee.starSystem.created);o.setTrajectory(s),ee.starSystem.addObject(n,o),ee.selection.forceSelection(o),s.propagate(i.epoch)}}),a}return Object(b.a)(t,e),t}(_),Y=a(55),H=function(e){function t(e){var a;Object(i.a)(this,t),(a=Object(v.a)(this,Object(y.a)(t).call(this,e))).increment=1,document.addEventListener(h.a.SELECT,a.handleSelect.bind(Object(g.a)(Object(g.a)(a)))),document.addEventListener(h.a.DESELECT,a.handleDeselect.bind(Object(g.a)(Object(g.a)(a)))),a.updateHandler=a.handleTrajectoryUpdate.bind(Object(g.a)(Object(g.a)(a))),a.jqDom.find("#incr001").on("click",function(){a.increment=.01}),a.jqDom.find("#incr01").on("click",function(){a.increment=.1}),a.jqDom.find("#incr1").on("click",function(){a.increment=1}),a.jqDom.find("#incr10").on("click",function(){a.increment=10}),a.jqDom.find("#incr100").on("click",function(){a.increment=100}),a.jqDom.find("#incr1000").on("click",function(){a.increment=1e3}),a.jqDom.find("#prev-burn").on("click",function(){return a.setBurnIdx(a.burnIdx-1)}),a.jqDom.find("#next-burn").on("click",function(){return a.setBurnIdx(a.burnIdx+1)}),a.jqDom.find("#epoch-minus").on("click",function(){a.burn.epoch-=a.increment,a.update()}),a.jqDom.find("#epoch-plus").on("click",function(){a.burn.epoch+=a.increment,a.update()});for(var n=["prograde","normal","radial"],r=function(){var e=n[s];a.jqDom.find("#"+e+"-minus").on("click",function(){a.burn[e]-=a.increment/1e3,a.update()}),a.jqDom.find("#"+e+"-plus").on("click",function(){a.burn[e]+=a.increment/1e3,a.update()}),a.jqDom.find("#"+e+"-zero").on("click",function(){a.burn[e]=0,a.update()})},s=0;s<n.length;s++)r();return a.hide(),a}return Object(b.a)(t,e),Object(r.a)(t,[{key:"handleTrajectoryUpdate",value:function(){this.updateBurns(),this.burns.length>0&&this.show();var e=this.burns.indexOf(this.burn);this.setBurnIdx(-1===e?0:e)}},{key:"handleSelect",value:function(e){e.detail.object.trajectory instanceof V.a&&this.init(e.detail.object.trajectory)}},{key:"init",value:function(e){this.trajectory=e,this.trajectory.onUpdate(this.updateHandler),this.updateBurns(),0!==this.burns.length?(this.show(),this.setBurnIdx(0)):this.hide()}},{key:"updateBurns",value:function(){this.burns=this.trajectory.flightEvents.filter(function(e){return e instanceof Y.a})}},{key:"setBurnIdx",value:function(e){e<0||e>=this.burns.length||(this.burn&&this.burn.visualModel.setScale(1),this.burnIdx=e,this.burn=this.burns[this.burnIdx],this.burn.visualModel.setScale(2),this.update(),this.jqDom.find("#burn-name").html("Burn #"+(this.burnIdx+1)))}},{key:"handleDeselect",value:function(){this.trajectory&&(this.trajectory.removeListener(this.updateHandler),delete this.trajectory,delete this.burn,this.hide())}},{key:"update",value:function(){this.jqDom.find("#burn-date").html(ee.time.formatDateFull(ee.time.getDateByEpoch(this.burn.epoch))),this.jqDom.find("#burn-epoch").html(this.burn.epoch.toFixed(2)),this.jqDom.find("#burn-prograde").html((1e3*this.burn.prograde).toFixed(2)),this.jqDom.find("#burn-normal").html((1e3*this.burn.normal).toFixed(2)),this.jqDom.find("#burn-radial").html((1e3*this.burn.radial).toFixed(2)),this.jqDom.find("#burn-total").html((1e3*this.burn.deltaV).toFixed(2))}},{key:"increment",get:function(){return this._increment},set:function(e){this._increment=e,this.jqDom.find("#increment").html(e)}}]),t}(_),K=function e(){Object(i.a)(this,e),this.timePanel=new k(c()("#timePanel")),this.cameraPanel=new M(c()("#cameraPanel"),ee.camera),this.metricsPanel=new P(c()("#metricsPanel"),ee.selection),this.creationPanel=new z(c()("#creationPanel")),this.lambertPanel=new q(c()("#lambertPanel")),this.maneuverPanel=new H(c()("#maneuverPanel"))},Q=a(46),G=function(){function e(t){Object(i.a)(this,e),this.settings={fov:60,animationDuration:200,pixelsToObjectUnderMouse:20},this.domElement=t,this.threeCamera=new s.r(this.settings.fov,t.width/t.height,1,1e15),this.threeCamera.position.fromArray([0,0,0]),this.listenersAdded=!1}return Object(r.a)(e,[{key:"init",value:function(e,t){this.position=t,this.referenceFrame=ee.starSystem.getReferenceFrame(e),this.orbitingPoint=this.referenceFrame.originId,this.frameType=this.referenceFrame.type,this.quaternion=this._getQuaternionByPosition(this.position),this.lastPosition=this.referenceFrame.transformPositionByEpoch(ee.currentEpoch,this.position,d.a),this.currentMousePos=new u.c([0,0]),this.accountedMousePos=new u.c([0,0]),this.isMouseDown=!1,this.isShiftDown=!1,this.rightButtonDown=!1,this.isLookingAside=!1,this.zoomingAside=0,this.isAnimnating=!1,this.listenersAdded||(ee.addEventListener("mousedown",this.onMouseDown.bind(this),1),ee.addEventListener("mousemove",this.onMouseMove.bind(this),1),ee.addEventListener("mouseup",this.onMouseUp.bind(this),1),ee.addEventListener("wheel",this.onMouseWheel.bind(this),1),this.listenersAdded=!0)}},{key:"_getQuaternionByPosition",value:function(e,t){var a=new u.c([0,0,1]),n=new u.c([0,1,0]),i=(new u.a).setAxisAngle(a.cross(e),Math.acos(e.dot(a)/e.mag)),r=i.rotate(n),s=(new u.a).setAxisAngle(e.cross(t||new u.c([0,0,1])),Math.PI/2).rotate(e);return(new u.a).setAxisAngle(r.cross(s),Math.acos(r.dot(s)/s.mag)).mul_(i)}},{key:"getAvailableFrameTypes",value:function(e){if(void 0===e&&(e=this.orbitingPoint),0==e)return[d.c.INERTIAL_ECLIPTIC];var t=ee.starSystem.isBody(e);return null===t?[]:t?[d.c.INERTIAL_ECLIPTIC,d.c.INERTIAL_BODY_EQUATORIAL,d.c.INERTIAL_BODY_FIXED]:[d.c.INERTIAL_ECLIPTIC,d.c.INERTIAL_PARENT_BODY_EQUATORIAL]}},{key:"changeReferenceFrameType",value:function(e){this.changeReferenceFrame(d.d.buildId(this.orbitingPoint,e),!0)}},{key:"changeOrigin",value:function(e){var t=-1!==this.getAvailableFrameTypes(e).indexOf(this.frameType)?this.frameType:d.c.INERTIAL_ECLIPTIC;this.changeReferenceFrame(d.d.buildId(e,t),!0)}},{key:"changeReferenceFrame",value:function(e,t){var a=ee.starSystem.getReferenceFrame(e);this.position=this.referenceFrame.transformPositionByEpoch(ee.currentEpoch,this.position,a),this.isLookingAside=!1,this.zoomingAside=0,this.orbitingPoint=a.originId,this.frameType=a.type,t?this.startAnimation(a):this.quaternion=this._getQuaternionByPosition(this.position),h.a.dispatch(h.a.CAMERA_RF_CHANGED,{old:this.referenceFrame,new:a}),this.referenceFrame=a}},{key:"startAnimation",value:function(e){if(e){var t=this.referenceFrame.getQuaternionByEpoch(ee.currentEpoch).invert_().mul_(e.getQuaternionByEpoch(ee.currentEpoch));this.quaternion=t.invert_().mul_(this.quaternion)}this.animationStartingTime=(new Date).getTime(),this.animationDuration=this.settings.animationDuration,this.animationStartingQuaternion=this.quaternion.copy(),this.isAnimnating=!0}},{key:"animate",value:function(){var e=((new Date).getTime()-this.animationStartingTime)/this.animationDuration,t=this._getQuaternionByPosition(this.position);if(e>=1)return this.quaternion=t,this.isAnimnating=!1,void(this.isLookingAside=!1);this.quaternion=u.a.slerp(this.animationStartingQuaternion,t,e)}},{key:"findObjectUnderMouse",value:function(){var e=0,t=!1,a=!0,n=!1,i=void 0;try{for(var r,s=ee.starSystem.getBodies()[Symbol.iterator]();!(a=(r=s.next()).done);a=!0){var o=r.value;if(ee.raycaster.getPixelDistance(o.getPositionByEpoch(ee.currentEpoch,d.a))<this.settings.pixelsToObjectUnderMouse){!1===t&&(t=o.id);var c=o.physicalModel.radius;c&&c>e&&(e=c,t=o.id)}}}catch(l){n=!0,i=l}finally{try{a||null==s.return||s.return()}finally{if(n)throw i}}return t}},{key:"onMouseWheel",value:function(e){if(e.deltaY){var t=e.shiftKey?1+(ee.settings.ui.camera.zoomFactor-1)/10:ee.settings.ui.camera.zoomFactor,a=e.deltaY<0?1/t:t,n=this.findObjectUnderMouse(),i=this.orbitingPoint;if(n===this.orbitingPoint&&(n=!1),!1!==n?(this.position=this.referenceFrame.transformPositionByEpoch(ee.currentEpoch,this.position,1e5*n+1e3),i=n):this.zoomingAside=0,ee.starSystem.getObject(i).physicalModel&&ee.starSystem.getObject(i).physicalModel.radius){var r=this.position.mag;this.position.mul_((ee.starSystem.getObject(i).physicalModel.radius+(r-ee.starSystem.getObject(i).physicalModel.radius)*a)/r)}else this.position.mul_(a);!1!==n?(this.position=ee.starSystem.getReferenceFrame(1e5*n+1e3).transformPositionByEpoch(ee.currentEpoch,this.position,this.referenceFrame),this.isLookingAside=!0,this.zoomingAside++):this.isLookingAside&&this.startAnimation(),3===this.zoomingAside&&this.changeOrigin(n,!0)}}},{key:"onMouseDown",value:function(e){switch(this.accountedMousePos=new u.c([e.clientX,e.clientY]),this.currentMousePos=this.accountedMousePos.copy(),this.isMouseDown=!0,e.button){case 0:case 1:break;case 2:this.rightButtonDown=!0}}},{key:"onMouseMove",value:function(e){this.isMouseDown&&(this.isShiftDown=!!e.shiftKey,this.currentMousePos.set(e.clientX,e.clientY))}},{key:"onMouseUp",value:function(e){this.isMouseDown=!1,this.rightButtonDown=!1}},{key:"onResize",value:function(){this.threeCamera.aspect=this.domElement.width/this.domElement.height,this.threeCamera.updateProjectionMatrix()}},{key:"getTopDirection",value:function(e){return this.referenceFrame.getQuaternionByEpoch(e).mul_(this.quaternion).rotate_(new u.c([0,1,0]))}},{key:"update",value:function(e){var t=this.referenceFrame.getQuaternionByEpoch(e),a=this.currentMousePos.sub(this.accountedMousePos);if(this.isAnimnating&&this.animate(),a[0]||a[1]){var n=(this.isShiftDown?.1:1)*ee.settings.ui.camera.mouseSensitivity,i=new u.c([0,0,1]),r=this.position.angle(i),s=this.rightButtonDown?this.quaternion.rotate(new u.c([0,0,1])).cross(i):this.position.cross(i),o=new u.a(s,Math.min(Math.max(a[1]*n,r-Math.PI+1e-5),r-1e-5)),c=new u.a(i,-a[0]*n).mul_(o);this.rightButtonDown||c.rotate_(this.position),this.quaternion=c.mul_(this.quaternion),this.accountedMousePos=this.currentMousePos.copy()}this.threeCamera.quaternion.copy(t.mul_(this.quaternion).toThreejs()),this.lastPosition=this.referenceFrame.transformPositionByEpoch(e,this.position,d.a)}}]),e}(),W=function(){function e(t,a,n,r){Object(i.a)(this,e),this.idx=t,this.alias=a,this.label=n,this.moduleName=r}return Object(r.a)(e,[{key:"load",value:function(e){var t=this;ee.isModuleLoaded(this.moduleName)?ee.getModule(this.moduleName).loadStarSystem(this.alias,e):ee.loadModule(this.moduleName,function(a){return a.loadStarSystem(t.alias,e)})}},{key:"value",get:function(){return this.alias}}]),e}(),X=function(){function e(){Object(i.a)(this,e),this._starSystems=[],this._loadedIdx=null,this.add("solar_system","SolarSystem","Solar System"),this.add("ksp","KSP","KSP System")}return Object(r.a)(e,[{key:"add",value:function(e,t,a){var n=this._starSystems.length;this._starSystems.push(new W(n,e,a,t))}},{key:"loadDefault",value:function(e){this.loadByIdx(this.defaultStarSystemIdx,e)}},{key:"loadByIdx",value:function(e,t){if(e!==this._loadedIdx){var a=this._findStarSystemByIdx(e);a&&(a.load(t),this._loadedIdx=e)}}},{key:"getCurrentStarSystem",value:function(){if(null!==this._loadedIdx)return this._starSystems[this._loadedIdx]}},{key:"_findStarSystemByIdx",value:function(e){return this._starSystems[e]}},{key:"starSystems",get:function(){return this._starSystems}},{key:"defaultStarSystemIdx",get:function(){return 0}},{key:"defaultStarSystem",get:function(){return this._starSystems[this.defaultStarSystemIdx]}}]),e}(),Z=a(64),J=a(63),$=a(61);a.d(t,"a",function(){return ee});var ee=new(function(){function e(){Object(i.a)(this,e),this.modules={},this.propagators={},this.renderLoopActive=!1,this.starSystemManager=new X,this._initSettings()}return Object(r.a)(e,[{key:"init",value:function(e,t){this.renderLoopFunction=t,this.scene=new s.z,this.scene.add(new s.a(16773077,.15)),this.textureLoader=new s.D,this.renderer=new s.H({antialias:!0,logarithmicDepthBuffer:!0}),this.domElement=e,this._setRenderSize(),this.domElement.appendChild(this.renderer.domElement),window.addEventListener("resize",this.onWindowResize.bind(this)),this.rendererEvents=new l(this.renderer.domElement),this.selection=new O,this.time=new m(0,1,!0),this.camera=new G(this.renderer.domElement),this.raycaster=new f(this.renderer.domElement,this.camera.threeCamera,7),this.ui=new K,this.starSystemManager.loadDefault(function(){return requestAnimationFrame(t)}),Z.a.preloadTexture(),$.a.preloadTexture(),J.a.preloadTexture(),h.a.dispatch(h.a.INIT_DONE)}},{key:"loadStarSystem",value:function(e,t){var a=this;c.a.getJSON("./star_systems/"+e,function(e){a.selection.deselect(),a.starSystem&&a.starSystem.unload(),a.starSystem=new Q.b(e.id),p.a.loadFromConfig(a.starSystem,e),a.camera.init(d.d.buildId(a.starSystem.mainObject,d.c.INERTIAL_BODY_EQUATORIAL),new u.c([3e4,3e4,2e4])),t&&t(a.starSystem),h.a.dispatch(h.a.STAR_SYSTEM_LOADED,{starSystem:a.starSystem}),a.startRendering()})}},{key:"startRendering",value:function(){this.renderLoopActive=!0}},{key:"stopRendering",value:function(){this.renderLoopActive=!1}},{key:"forceEpoch",value:function(e){return this.time.forceEpoch(e)}},{key:"_initSettings",value:function(){this.settings={ui:{showBodyLabels:!0,showAnglesOfSelectedOrbit:!0,camera:{mouseSensitivity:.007,zoomFactor:1.5}}}}},{key:"addEventListener",value:function(e,t,a){this.rendererEvents.addListener(e,t,a)}},{key:"removeEventListener",value:function(e,t){this.rendererEvents.removeListener(e,t)}},{key:"onWindowResize",value:function(){this._setRenderSize(),this.camera.onResize()}},{key:"tick",value:function(e){this.time.tick(e),this.camera.update(this.time.epoch),h.a.dispatch(h.a.RENDER,{epoch:this.time.epoch}),this.renderLoopActive&&this.renderer.render(this.scene,this.camera.threeCamera)}},{key:"getVisualCoords",value:function(e){return(new s.F).fromArray(e.sub(this.camera.lastPosition))}},{key:"getSimCoords",value:function(e){return new u.c(e.toArray()).add_(this.camera.lastPosition)}},{key:"loadModule",value:function(e,t){var n=this,i="Module"+e;a(103)("./"+e+"/"+i).then(function(a){n.modules[e]=new a.default,n.modules[e].init(),t&&t(n.modules[e])})}},{key:"getModule",value:function(e){if(void 0===this.modules[e])throw new Error("Unknown module: "+e);return this.modules[e]}},{key:"isModuleLoaded",value:function(e){return void 0!==this.modules[e]}},{key:"getClass",value:function(e){var t=e.indexOf(".");if(-1===t)throw new Error("Incorrect class alias! Period expected in "+e);return this.getModule(e.substr(0,t)).getClass(e.substr(t+1))}},{key:"addPropagator",value:function(e,t){this.propagators[e]=t}},{key:"getPropagator",value:function(e){return this.propagators[e]}},{key:"_setRenderSize",value:function(){this._footerDomElement||(this._footerDomElement=document.getElementById("app-footer"));var e=window.innerHeight-this._footerDomElement.clientHeight;this.renderer.setSize(this.domElement.clientWidth,e)}},{key:"currentEpoch",get:function(){return this.time.epoch}},{key:"currentDate",get:function(){return this.time.getDateByEpoch(this.time.epoch)}}]),e}())},function(e,t,a){"use strict";var n=a(1),i=a(3),r=a(5),s=a(4),o=a(6),c=a(35),l=a(8),u=function(e){function t(e,a){var i;return Object(n.a)(this,t),(i=Object(r.a)(this,Object(s.a)(t).call(this))).objectId=e,i.referenceFrame=a,i}return Object(o.a)(t,e),Object(i.a)(t,[{key:"evaluate",value:function(e){return l.a.starSystem.getObject(this.objectId).trajectory.getStateByEpoch(e,this.referenceFrame)}}]),t}(c.a),h=a(2),d=a(20),m=a(31),p=a(16),f=function(e){function t(e,a){var i;return Object(n.a)(this,t),(i=Object(r.a)(this,Object(s.a)(t).call(this))).origin=e,i.isInertial=a,i.body=l.a.starSystem.getObject(i.origin),i}return Object(o.a)(t,e),Object(i.a)(t,[{key:"getQuaternionByEpoch",value:function(e){return this.body.orientation.getQuaternionByEpoch(e)}},{key:"getOriginStateByEpoch",value:function(e){return l.a.starSystem.getObject(this.origin).trajectory.getStateByEpoch(e,O)}},{key:"getOriginPositionByEpoch",value:function(e){return this.getOriginStateByEpoch(e).position}},{key:"getRotationVelocityByEpoch",value:function(e){return new h.c([0,0,this.body.orientation.angularVel])}},{key:"stateVectorFromBaseReferenceFrameByEpoch",value:function(e,t){var a=this.getOriginStateByEpoch(e),n=this.getQuaternionByEpoch(e).invert_(),i=n.rotate(t.position.sub_(a.position)),r=n.rotate(t.velocity.sub_(a.velocity));if(!this.isInertial){var s=i.cross(this.getRotationVelocityByEpoch(e));r.add_(s)}return new p.a(i,r)}},{key:"stateVectorToBaseReferenceFrameByEpoch",value:function(e,t){var a,n=this.getOriginStateByEpoch(e),i=this.getQuaternionByEpoch(e),r=i.rotate(t.position).add_(n.position);if(this.isInertial)a=i.rotate(t.velocity).add_(n.velocity);else{var s=t.position.cross(this.getRotationVelocityByEpoch(e));a=i.rotate(t.velocity.sub_(s)).add_(n.velocity)}return new p.a(r,a)}}]),t}(m.a),v=function(e){function t(){var e;return Object(n.a)(this,t),(e=Object(r.a)(this,Object(s.a)(t).call(this))).setId(O),e}return Object(o.a)(t,e),t}(m.a),y=a(56),b=a(44),g=a(23),E=function(e){function t(e,a,i,o,c){var l;return Object(n.a)(this,t),(l=Object(r.a)(this,Object(s.a)(t).call(this,e,c))).bodyFixedQuaternion=(new h.a).setFromEuler(0,-a,i,"ZYX"),l.bodyFixedPosition=new h.c([l.body.physicalModel.radius+o,0,0]).rotateY(-a).rotateZ(i),l}return Object(o.a)(t,e),Object(i.a)(t,[{key:"getQuaternionByEpoch",value:function(e){return this.body.orientation.getQuaternionByEpoch(e).mul_(this.bodyFixedQuaternion)}},{key:"getRotationVelocityByEpoch",value:function(e){return this.bodyFixedQuaternion.invert().rotate(new h.c([0,0,this.body.orientation.angularVel]))}},{key:"getOriginStateByEpoch",value:function(e){var t=l.a.starSystem.getObject(this.origin).trajectory.getStateByEpoch(e,O),a=this.body.orientation.getQuaternionByEpoch(e),n=this.bodyFixedPosition.cross(new h.c([0,0,this.body.orientation.angularVel])),i=a.rotate(this.bodyFixedPosition).add_(t.position),r=a.rotate_(n.mul_(-1)).add_(t.velocity);return new p.a(i,r)}}]),t}(f);a.d(t,"d",function(){return j}),a.d(t,"a",function(){return O}),a.d(t,"b",function(){return _}),a.d(t,"c",function(){return k});var j=function(){function e(){Object(n.a)(this,e)}return Object(i.a)(e,null,[{key:"create",value:function(e,t,a){var n=null;return t==k.INERTIAL_ECLIPTIC?n=new y.a(new u(a.origin,O),new h.a):t==k.INERTIAL_BODY_EQUATORIAL?n=l.a.starSystem.getObject(a.origin)instanceof g.a?new b.a(new u(a.origin,O),new d.a(function(e){var t=l.a.starSystem.getObject(a.origin).orientation.getQuaternionByEpoch(e).rotate_(new h.c([0,0,1])),n=t.cross(new h.c([0,0,1]));return 0===n.mag?new h.a:h.a.transfer(new h.c([0,0,1]),t).mul_(h.a.transfer(new h.c([1,0,0]),n))})):null:t==k.INERTIAL_PARENT_BODY_EQUATORIAL?n=new b.a(new u(a.origin,O),new d.a(function(e){var t=l.a.starSystem.getObject(a.origin).getParentObjectIdByEpoch(e),n=l.a.starSystem.getObject(t);if(n instanceof g.a){var i=n.orientation.getQuaternionByEpoch(e).rotate_(new h.c([0,0,1])),r=i.cross(new h.c([0,0,1]));return h.a.transfer(new h.c([0,0,1]),i).mul_(h.a.transfer(new h.c([1,0,0]),r))}return new h.a})):t==k.INERTIAL_BODY_FIXED?n=l.a.starSystem.getObject(a.origin)instanceof g.a?new f(a.origin,!0):null:t==k.INERTIAL_TOPOCENTRIC?n=l.a.starSystem.getObject(a.origin)instanceof g.a?new E(a.origin,a.lat,a.lon,a.height,!0):null:t==k.BODY_FIXED?n=l.a.starSystem.getObject(a.origin)instanceof g.a?new f(a.origin,!1):null:t==k.TOPOCENTRIC?n=l.a.starSystem.getObject(a.origin)instanceof g.a?new E(a.origin,a.lat,a.lon,void 0,!1):null:t==k.BASE&&(n=new v),n?n.setId(e):null}},{key:"getOriginIdByReferenceFrameId",value:function(e){return Math.sign(e)*Math.floor(Math.abs(e)/1e5)}},{key:"getTypeByReferenceFrameId",value:function(e){return Math.floor(Math.abs(e)%1e5/1e3)}},{key:"createById",value:function(e){var t=this.getTypeByReferenceFrameId(e);return t===k.INERTIAL_ECLIPTIC||t===k.INERTIAL_BODY_EQUATORIAL||t===k.INERTIAL_BODY_FIXED||t===k.BODY_FIXED||t===k.INERTIAL_PARENT_BODY_EQUATORIAL?this.create(e,t,{origin:this.getOriginIdByReferenceFrameId(e)}):null}},{key:"buildId",value:function(e,t){return t===k.INERTIAL_ECLIPTIC||t===k.INERTIAL_BODY_EQUATORIAL||t===k.INERTIAL_BODY_FIXED||t===k.BODY_FIXED||t===k.INERTIAL_PARENT_BODY_EQUATORIAL?(e?Math.sign(e):1)*(1e5*Math.abs(e)+1e3*t):null}}]),e}(),O=1e3,_=new v,k={BASE:0,INERTIAL_ECLIPTIC:1,INERTIAL_BODY_EQUATORIAL:2,INERTIAL_BODY_FIXED:3,INERTIAL_TOPOCENTRIC:4,BODY_FIXED:6,TOPOCENTRIC:7,INERTIAL_PARENT_BODY_EQUATORIAL:8}},function(e,t,a){"use strict";a.d(t,"a",function(){return r});var n=a(1),i=a(3),r=function(){function e(){Object(n.a)(this,e)}return Object(i.a)(e,null,[{key:"dispatch",value:function(e,t){var a;a=t?new CustomEvent(e,{detail:t}):new CustomEvent(e),document.dispatchEvent(a)}},{key:"addListener",value:function(e,t){return document.addEventListener(e,t)}},{key:"removeListener",value:function(e,t){return document.removeEventListener(e,t)}}]),e}();r.LOADING_BODIES_DONE="urb_load_bodies_done",r.LOADING_FRAMES_DONE="urb_load_frames_done",r.LOADING_TRAJECTORIES_DONE="urb_load_traj_done",r.RENDER="urb_render",r.INIT_DONE="urb_init_done",r.STAR_SYSTEM_LOADED="urb_star_system_loading_done",r.SELECT="urb_select",r.DESELECT="urb_deselect",r.SHOW_ORBIT_ANGLES_CHANGED="urb_show_orbit_angles_change",r.CAMERA_RF_CHANGED="urb_camera_rf_change",r.OBJECT_ADDED="urb_object_added",r.TIME_SCALE_CHANGED="urb_time_scale_change",r.TIME_PAUSED="urb_time_paused",r.TIME_UNPAUSED="urb_time_unpaused",r.EPOCH_CHANGED="urb_epoch_change"},,,,,,function(e,t,a){"use strict";a.d(t,"a",function(){return s});var n=a(1),i=a(3),r=a(2),s=function(){function e(t,a){Object(n.a)(this,e),this._position=t?t.copy():new r.c,this._velocity=a?a.copy():new r.c}return Object(i.a)(e,[{key:"copy",value:function(){return new e(this._position,this._velocity)}},{key:"rotate_",value:function(e){return e.rotate_(this._position),e.rotate_(this._velocity),this}},{key:"rotate",value:function(e){return this.copy().rotate_(e)}},{key:"position",get:function(){return this._position.copy()}},{key:"velocity",get:function(){return this._velocity.copy()}}],[{key:"create",value:function(e,t,a,n,i,s){return new this(new r.c([e||0,t||0,a||0]),new r.c([n||0,i||0,s||0]))}}]),e}()},function(e,t,a){"use strict";a.d(t,"a",function(){return o});var n=a(1),i=a(3),r=a(10),s=a(8),o=function(){function e(){Object(n.a)(this,e),this.threeObj=null,this.scene=s.a.scene,this._isHidden=!1}return Object(i.a)(e,[{key:"setThreeObj",value:function(e){this.threeObj=e,this.scene.add(this.threeObj),this.renderListener=this._onRender.bind(this),this._isHidden?this.threeObj.visible=!1:document.addEventListener(r.a.RENDER,this.renderListener)}},{key:"setPosition",value:function(e){e?(this.threeObj.visible=!0,this.threeObj.position.copy(s.a.getVisualCoords(e))):this.threeObj.visible=!1}},{key:"_onRender",value:function(e){try{this.render(e.detail.epoch)}catch(t){this.threeObj.visible=!1}}},{key:"hide",value:function(){this._isHidden=!0,this.renderListener&&document.removeEventListener(r.a.RENDER,this.renderListener),this.threeObj&&(this.threeObj.visible=!1)}},{key:"show",value:function(){this._isHidden=!1,this.renderListener&&document.addEventListener(r.a.RENDER,this.renderListener),this.threeObj&&(this.threeObj.visible=!0)}},{key:"render",value:function(e){}},{key:"drop",value:function(){this.threeObj&&(this.scene.remove(this.threeObj),this.threeObj.traverse(function(e){e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()}),delete this.threeObj),this.renderListener&&document.removeEventListener(r.a.RENDER,this.renderListener)}},{key:"pixelAngleSize",get:function(){return s.a.raycaster.getPixelAngleSize()}}]),e}();o.texturePath="texture/"},function(e,t,a){"use strict";a.d(t,"a",function(){return s});var n=a(1),i=a(3),r=a(9),s=function(){function e(t,a,i,r){Object(n.a)(this,e),this.id=t,this.type=a,this.name=i,this.data=r||{}}return Object(i.a)(e,[{key:"setTrajectory",value:function(e){this.trajectory=e,this.trajectory.setObject(this)}},{key:"getParentObjectIdByEpoch",value:function(e){if(!this.trajectory)return null;var t=this.trajectory.getReferenceFrameByEpoch(e);return t?t.originId:null}},{key:"getStateByEpoch",value:function(e,t){return this.trajectory.getStateByEpoch(e,t||r.a)}},{key:"getPositionByEpoch",value:function(e,t){return this.trajectory.getPositionByEpoch(e,t||r.a)}},{key:"select",value:function(){this.trajectory&&this.trajectory.select()}},{key:"deselect",value:function(){this.trajectory&&this.trajectory.deselect()}},{key:"drop",value:function(){this.trajectory&&(this.trajectory.drop(),delete this.trajectory)}}]),e}();s.TYPE_UNKNOWN=0,s.TYPE_STAR=1,s.TYPE_PLANET=2,s.TYPE_PLANETOID=3,s.TYPE_SATELLITE=4,s.TYPE_ASTEROID=5,s.TYPE_COMET=6,s.TYPE_SPACECRAFT=7,s.TYPE_POINT=8},,function(e,t,a){"use strict";a.d(t,"a",function(){return c});var n=a(1),i=a(3),r=a(5),s=a(4),o=a(6),c=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(s.a)(t).call(this))).func=e,a}return Object(o.a)(t,e),Object(i.a)(t,[{key:"evaluate",value:function(e){return this.func(e)}}]),t}(a(35).a)},function(e,t,a){"use strict";a.d(t,"b",function(){return r});var n=a(8);a.d(t,"c",function(){return n.a});var i=a(10);function r(e){var t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"viewport-id";function i(a){n.a.renderLoopActive&&(n.a.tick((a-t)/1e3),t=a,e.update(),requestAnimationFrame(i))}n.a.init(document.getElementById(a),function(e){t=e,requestAnimationFrame(i)}),n.a.loadModule("PatchedConics")}a.d(t,"a",function(){return i.a})},function(e,t,a){"use strict";a.d(t,"a",function(){return o});var n=a(1),i=a(3),r=a(2),s=a(16),o=function(){function e(t,a,i,r,s,o,c,l,u){Object(n.a)(this,e),this._mu=l,this._sma=a,this._ecc=t,this._inc=r,this._raan=s,this._aop=i,this._epoch=c,void 0===u||!0===u?this.ta=o:this.m0=o,this.updateMeanMotion()}return Object(i.a)(e,[{key:"setUpdateCallback",value:function(e){this._updateCallback=e}},{key:"copy",value:function(){return new e(this._ecc,this._sma,this._aop,this._inc,this._raan,this.m0,this._epoch,this._mu,!1)}},{key:"updateMeanMotion",value:function(){this.meanMotion=Math.sqrt(this._mu/Math.abs(this._sma))/Math.abs(this._sma)}},{key:"getNodalPrecessionRate",value:function(e,t){return-1.5*e*e*t*Math.cos(this._inc)*this.meanMotion/Math.pow(this._sma*(1-this._ecc*this._ecc),2)}},{key:"getNodalPrecessionByEpoch",value:function(e,t,a){return(a-this._epoch)*this.getNodalPrecessionRate(e,t)}},{key:"addPrecession",value:function(e,t,a){return this.m0=this.getMeanAnomalyByEpoch(a),this._raan+=this.getNodalPrecessionByEpoch(e,t,a),this._epoch=a,this}},{key:"getMeanAnomalyByEpoch",value:function(e){return this.m0+this.meanMotion*(e-this._epoch)}},{key:"getEccentricAnomalyByEpoch",value:function(e){return this.getEccentricAnomalyByMeanAnomaly(this.getMeanAnomalyByEpoch(e))}},{key:"getTrueAnomalyByEpoch",value:function(e){return this.getTrueAnomalyByMeanAnomaly(this.getMeanAnomalyByEpoch(e))}},{key:"getMeanAnomalyByEccentricAnomaly",value:function(e){return this.isElliptic?e-this._ecc*Math.sin(e):this._ecc*Math.sinh(e)-e}},{key:"getMeanAnomalyByTrueAnomaly",value:function(e){return this.getMeanAnomalyByEccentricAnomaly(this.getEccentricAnomalyByTrueAnomaly(e))}},{key:"getEccentricAnomalyByMeanAnomaly",value:function(e){var t,a,n=e,i=0;if(this.isElliptic)for(n/=2*Math.PI,n=2*Math.PI*(n-Math.floor(n)),a=(t=this._ecc<.8?n:Math.PI)-this._ecc*Math.sin(t)-n;Math.abs(a)>1e-8&&i<30;)a=(t-=a/(1-this._ecc*Math.cos(t)))-this._ecc*Math.sin(t)-n,i+=1;else for(t=(Math.log(2*(Math.abs(n)+1/3))+1)/this._ecc+(1-1/this._ecc)*Math.asinh(Math.abs(n)/this._ecc),t*=Math.sign(n),a=this._ecc*Math.sinh(t)-t-n;Math.abs(a)>1e-8&&i<30;)t-=a/(this._ecc*Math.cosh(t)-1),a=this._ecc*Math.sinh(t)-t-n,i+=1;return t}},{key:"getEccentricAnomalyByTrueAnomaly",value:function(e){if(this.isElliptic){var t=Math.cos(e),a=(this._ecc+t)/(1+this._ecc*t);return(e+r.b)%r.b<=Math.PI?Math.acos(a):r.b-Math.acos(a)}return 2*Math.atanh(Math.tan(e/2)/Math.sqrt((this._ecc+1)/(this._ecc-1)))}},{key:"getTrueAnomalyByMeanAnomaly",value:function(e){return this.getTrueAnomalyByEccentricAnomaly(this.getEccentricAnomalyByMeanAnomaly(e))}},{key:"getTrueAnomalyByEccentricAnomaly",value:function(e){if(this.isElliptic){var t=Math.atan2(Math.sqrt(1-this._ecc*this._ecc)*Math.sin(e),Math.cos(e)-this._ecc);return t>=0?t:t+2*Math.PI}return 2*Math.atan(Math.sqrt((this._ecc+1)/(this._ecc-1))*Math.tanh(e/2))}},{key:"getOwnCoordsByTrueAnomaly",value:function(e){var t=this._sma*(1-this._ecc*this._ecc)/(1+this._ecc*Math.cos(e));return new r.c([t*Math.cos(e),t*Math.sin(e),0])}},{key:"getAsymptoteTa",value:function(){return!this.isElliptic&&Math.acos(-1/this._ecc)}},{key:"getPeriapsisRadius",value:function(){return this._sma*(1-this._ecc)}},{key:"getApoapsisRadius",value:function(){return this._sma*(1+this._ecc)}},{key:"getPeriapsisSpeed",value:function(){return Math.sqrt(this._mu*(2/this.getPeriapsisRadius()-1/this._sma))}},{key:"getApoapsisSpeed",value:function(){return Math.sqrt(this._mu*(2/this.getApoapsisRadius()-1/this._sma))}},{key:"getEpochByTrueAnomaly",value:function(e){if(null===e)return null;var t=this.getMeanAnomalyByTrueAnomaly(e)-this.m0;return t<0&&this.isElliptic&&(t+=r.b),this._epoch+t/this.meanMotion}},{key:"getSphereCrossingTrueAnomaly",value:function(e){var t=this.getApoapsisRadius();if(t>0&&e>t||e<this.getPeriapsisRadius())return!1;var a=Math.acos((this._sma*(1-this._ecc*this._ecc)/e-1)/this._ecc);return[a,r.b-a]}},{key:"getPlaneCrossingTrueAnomaly",value:function(e){var t=this._sma*(1-this._ecc*this._ecc)*Math.sin(this._inc)/e,a=this._ecc,n=Math.cos(this._aop),i=Math.sin(this._aop),s=this._planeCrossingHelper(t*n,t*i-a),o=this._planeCrossingHelper(-t*n,-t*i-a),c=null,l=null;return(!1!==s||!1!==o)&&(this.isHyperbolic?s instanceof Array?!o instanceof Array?[s]:[[Math.min(s[0],o[0]),Math.max(s[0],o[0])],[Math.min(s[1],o[1]),Math.max(s[1],o[1])]]:o instanceof Array?[o]:!1!==s&&!1!==o?[[Math.min(o,s),Math.max(o,s)]]:(console.log("Error! getPlaneCrossingTrueAnomaly() not implemented!"),!1):(!1!==s&&(c=(this._aop+s[0])%r.b<(this._aop+s[1])%r.b?[s[1],s[0]]:[s[0],s[1]]),!1!==o?(l=(this._aop+o[0])%r.b<(this._aop+o[1])%r.b?[o[1],o[0]]:[o[0],o[1]],c?[[c[0],l[1]],[l[0],c[1]]]:[l]):[c]))}},{key:"_planeCrossingHelper",value:function(e,t){var a=e*e+t*t,n=Math.sqrt(e*e*(a-1)),i=Math.atan2(((t*n-t*t)/a+1)/e,(t-n)/a);if(isNaN(i))return!1;var s=Math.atan2(((-t*n-t*t)/a+1)/e,(t+n)/a);if(this.isElliptic)return[i<0?i+r.b:i,s<0?s+r.b:s];var o=this.getAsymptoteTa();return i=this._validateHyperbolicTa(o,i),s=this._validateHyperbolicTa(o,s),!1!==i&&!1!==s&&i!==s?[Math.min(i,s),Math.max(i,s)]:!1!==i?i:!1!==s&&s}},{key:"_validateHyperbolicTa",value:function(e,t){return t>Math.PI&&(t-=r.b),!(t>e||t<-e)&&(!(Math.abs(t-Math.sign(t)*e)<1e-14)&&t)}},{key:"getStateByEpoch",value:function(e){if(this.isElliptic){var t=this.getEccentricAnomalyByEpoch(e),a=Math.cos(t),n=Math.sin(t),i=Math.sqrt(this._mu/this._sma)/(1-this._ecc*a),o=new r.c([this._sma*(a-this._ecc),this._sma*Math.sqrt(1-this._ecc*this._ecc)*n,0]),c=new r.c([-i*n,i*Math.sqrt(1-this._ecc*this._ecc)*a,0]);return new s.a(o.rotateZ(this._aop).rotateX(this._inc).rotateZ(this._raan),c.rotateZ(this._aop).rotateX(this._inc).rotateZ(this._raan))}var l=this.getTrueAnomalyByEpoch(e),u=this.getOrbitalFrameQuaternion(),h=this.getOwnCoordsByTrueAnomaly(l),d=Math.atan(this._ecc*Math.sin(l)/(1+this._ecc*Math.cos(l))),m=new r.c([Math.sqrt(this._mu*(2/h.mag-1/this._sma)),0,0]);return new s.a(u.rotate_(h),u.rotate_(m.rotateZ(l+Math.PI/2-d)))}},{key:"getNormalVector",value:function(){var e=new r.a(new r.c([0,0,1]),this._raan);return new r.a(e.rotate_(new r.c([1,0,0])),this._inc).rotate_(new r.c([0,0,1]))}},{key:"getPeriapsisVector",value:function(){return this.getOrbitalFrameQuaternion().rotate_(new r.c([1,0,0]))}},{key:"getOrbitalFrameQuaternion",value:function(){return new r.a(new r.c([0,0,1]),this._raan).mul_(new r.a(new r.c([1,0,0]),this._inc)).mul_(new r.a(new r.c([0,0,1]),this._aop))}},{key:"isHyperbolic",get:function(){return this._ecc>1}},{key:"isElliptic",get:function(){return this._ecc<1}},{key:"mu",get:function(){return this._mu},set:function(e){this._mu=e,this.updateMeanMotion(),this._updateCallback&&this._updateCallback()}},{key:"sma",get:function(){return this._sma},set:function(e){this._sma=e,this.updateMeanMotion(),this._updateCallback&&this._updateCallback()}},{key:"ecc",get:function(){return this._ecc},set:function(e){this._ecc=e,this._updateCallback&&this._updateCallback()}},{key:"inc",get:function(){return this._inc},set:function(e){this._inc=e,this._updateCallback&&this._updateCallback()}},{key:"raan",get:function(){return this._raan},set:function(e){this._raan=e,this._updateCallback&&this._updateCallback()}},{key:"aop",get:function(){return this._aop},set:function(e){this._aop=e,this._updateCallback&&this._updateCallback()}},{key:"ta",get:function(){return this.getTrueAnomalyByEpoch(this._epoch)},set:function(e){this.m0=this.getMeanAnomalyByTrueAnomaly(e),this._updateCallback&&this._updateCallback()}},{key:"epoch",get:function(){return this._epoch},set:function(e){this._epoch=e,this._updateCallback&&this._updateCallback()}},{key:"period",get:function(){return this.isElliptic?r.b*Math.sqrt(this._sma*this._sma*this._sma/this._mu):0}}],[{key:"createFromState",value:function(t,a,n){if(n=n||0,!t)return null;var i=t.position,r=t.velocity,s=i.cross(r),o=Math.atan2(s.x,-s.y),c=Math.atan2(Math.sqrt(Math.pow(s.x,2)+Math.pow(s.y,2)),s.z),l=a*i.mag/(2*a-i.mag*Math.pow(r.mag,2)),u=Math.sqrt(1-Math.min(1,Math.pow(s.mag,2)/(a*l))),h=i.rotateZ(-o).rotateX(-c),d=Math.atan2(h.y,h.x),m=i.dot(r),p=Math.acos(Math.min(1,Math.max(-1,(l*(1-u*u)/i.mag-1)/u)))*Math.sign(m);return new e(u,l,d-p>0?d-p:2*Math.PI+(d-p),c,o,p,n,a,!0)}}]),e}()},function(e,t,a){"use strict";a.d(t,"a",function(){return u});var n=a(1),i=a(3),r=a(5),s=a(4),o=a(12),c=a(6),l=a(14),u=function(e){function t(e,a,i,o,c,u,h){var d;return Object(n.a)(this,t),(d=Object(r.a)(this,Object(s.a)(t).call(this,e,a,i,o))).visualModel=c,d.physicalModel=u,d.orientation=h,d.visualModel&&d.visualModel.setObject(Object(l.a)(Object(l.a)(d))),d}return Object(c.a)(t,e),Object(i.a)(t,[{key:"drop",value:function(){this.visualModel&&(this.visualModel.drop(),delete this.visualModel),Object(o.a)(Object(s.a)(t.prototype),"drop",this).call(this)}}]),t}(a(18).a)},,,,function(e,t,a){"use strict";a.d(t,"a",function(){return c});var n=a(1),i=a(3),r=a(5),s=a(4),o=a(6),c=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(s.a)(t).call(this))).value=e,a}return Object(o.a)(t,e),Object(i.a)(t,[{key:"evaluate",value:function(e){return this.value}}]),t}(a(35).a)},function(e,t,a){"use strict";a.d(t,"a",function(){return c});var n=a(1),i=a(3),r=a(5),s=a(4),o=a(6),c=function(e){function t(e,a){var i;return Object(n.a)(this,t),(i=Object(r.a)(this,Object(s.a)(t).call(this,e))).keplerianObject=a,i}return Object(o.a)(t,e),Object(i.a)(t,[{key:"onUpdate",value:function(e){var t=this;return this.keplerianObject.setUpdateCallback(function(){return e(t)}),this}},{key:"getKeplerianObjectByEpoch",value:function(e,t){return this.validateEpoch(e),this._transformKeplerianObject(this.keplerianObject,t)}},{key:"mu",get:function(){return this.keplerianObject.mu},set:function(e){this.keplerianObject.mu=e}},{key:"sma",get:function(){return this.keplerianObject.sma},set:function(e){this.keplerianObject.sma=e}},{key:"ecc",get:function(){return this.keplerianObject.ecc},set:function(e){this.keplerianObject.ecc=e}},{key:"inc",get:function(){return this.keplerianObject.inc},set:function(e){this.keplerianObject.inc=e}},{key:"raan",get:function(){return this.keplerianObject.raan},set:function(e){this.keplerianObject.raan=e}},{key:"aop",get:function(){return this.keplerianObject.aop},set:function(e){this.keplerianObject.aop=e}},{key:"ta",get:function(){return this.keplerianObject.ta},set:function(e){this.keplerianObject.ta=e}},{key:"epoch",get:function(){return this.keplerianObject.epoch},set:function(e){this.keplerianObject.epoch=e}},{key:"period",get:function(){return this.keplerianObject.period}}]),t}(a(51).a)},,function(e,t,a){"use strict";a.d(t,"a",function(){return g});var n=a(1),i=a(3),r=a(5),s=a(4),o=a(12),c=a(6),l=a(7),u=a(41),h=a(9),d=a(2),m=a(56),p=a(8),f=a(27),v=a(16),y=a(61),b=a(63),g=function(e){function t(e,a){var i;return Object(n.a)(this,t),(i=Object(r.a)(this,Object(s.a)(t).call(this,e,a))).showFull=!!a.showFull,i.trailPeriod=a.trailPeriod||!1,i.lastPositionEpoch=!1,i.lastFrameEpoch=!1,i._markers.per=new y.a(i.threeObj,i.config.color),i._markers.apo=new b.a(i.threeObj,i.config.color),i._markers.per.setScale(.5),i._markers.apo.setScale(.5),i}return Object(c.a)(t,e),Object(i.a)(t,[{key:"render",value:function(e){Object(o.a)(Object(s.a)(t.prototype),"render",this).call(this,e);var a=this.getPositionEpoch(e);if(!1!==a){this.lastPositionEpoch=a,this.lastFrameEpoch=e;var n=this.trajectory.getKeplerianObjectByEpoch(a);n.isElliptic?this.renderEllipse(n,a,e):this.renderHyperbola(n,a,e)}else this.threeObj.visible=!1}},{key:"getEpochByPoint",value:function(e){var t=this.trajectory.getReferenceFrameByEpoch(this.lastFrameEpoch).stateVectorFromBaseReferenceFrameByEpoch(this.lastFrameEpoch,new v.a(e))._position,a=this.trajectory.getKeplerianObjectByEpoch(this.lastPositionEpoch);return a.getOrbitalFrameQuaternion().invert_().rotate_(t),a.getEpochByTrueAnomaly(Math.atan2(t.y,t.x))}},{key:"renderHyperbola",value:function(e,t,a){var n=e.getAsymptoteTa()-.02,i=-n;!1!==this.trajectory.minEpoch&&(i=e.getTrueAnomalyByEpoch(this.trajectory.minEpoch)),!1!==this.trajectory.maxEpoch&&(n=e.getTrueAnomalyByEpoch(this.trajectory.maxEpoch));var r=this.trajectory.pericentricReferenceFrame.getQuaternionByEpoch(t),s=e.getTrueAnomalyByEpoch(t),o=[],c=[],u=i,h=0;u>(i+s)/2&&(u=(i+s)/2);for(var d=(Math.max(n,s)-u)/99,m=0;h<100+m;){var p=e.getOwnCoordsByTrueAnomaly(u);o[h]=(new l.E).fromArray([p[0],p[1]]),c[h]=u>s?0:s==i?1:(u-i)/(s-i),h+=1,(u+=d)-d<=s&&s<u&&(p=e.getOwnCoordsByTrueAnomaly(s),o[h]=(new l.E).fromArray([p[0],p[1]]),c[h]=1,o[h+=1]=(new l.E).fromArray([p[0],p[1]]),c[h]=0,h+=1,m+=2)}this.updateGeometry(o,c,.35),this.threeObj.quaternion.copy(r.toThreejs()),this.setPosition(this.trajectory.getReferenceFrameByEpoch(a).getOriginPositionByEpoch(a)),this._markers.apo.disable(),s>0&&s<Math.PI?this._markers.per.disable():(this._markers.per.enable(),this._markers.per.setPosition(new l.F(e.getPeriapsisRadius(),0,0)))}},{key:"renderEllipse",value:function(e,t,a){var n=this.trajectory.pericentricReferenceFrame.getQuaternionByEpoch(t),i=new m.a(new f.a(this.trajectory.getReferenceFrameByEpoch(t).getOriginStateByEpoch(a)),n),r=h.b.transformPositionByEpoch(a,p.a.camera.lastPosition,i),s=new d.c([r.x,r.y,0]),o=i.transformPositionByEpoch(a,s,h.b),c=Object(d.d)(s.x/s.mag,s.y),u=e.getOwnCoordsByTrueAnomaly(c).sub_(r).mag,v=e.getOwnCoordsByTrueAnomaly(c+Math.PI).sub_(r).mag,y=e.getEccentricAnomalyByTrueAnomaly(c),b=e.getEccentricAnomalyByEpoch(t),g=0,E=1;if(this.trailPeriod||(this._markers.per.enable(),this._markers.per.setPosition(new l.F(e.getPeriapsisRadius()-s.x,-s.y,0)),this._markers.apo.enable(),this._markers.apo.setPosition(new l.F(-e.getApoapsisRadius()-s.x,-s.y,0))),this.trailPeriod){var j=t-this.trailPeriod;!1!==this.trajectory.minEpoch&&this.trajectory.minEpoch>j&&(j=this.trajectory.minEpoch),this._markers.per.disable(),this._markers.apo.disable(),g=1-(b-e.getEccentricAnomalyByEpoch(j)+d.b)%d.b/d.b,E=1}else if(!this.showFull&&!1!==this.trajectory.maxEpoch&&this.trajectory.maxEpoch-t<e.period){E=(e.getEccentricAnomalyByEpoch(this.trajectory.maxEpoch)-b+d.b)%d.b/d.b;var O=e.getMeanAnomalyByEpoch(this.trajectory.maxEpoch),_=e.getMeanAnomalyByEpoch(t);Object(d.j)(0,[_,O])||this._markers.per.disable(),Object(d.j)(Math.PI,[_,O])||this._markers.apo.disable()}var k=this.getEllipsePoints(new l.h(-e.sma*e.ecc-s.x,-s.y,e.sma,e.sma*Math.sqrt(1-e.ecc*e.ecc),b,d.b+b-1e-13,!1,0),100,((y-b)/d.b+1)%1,v/u,g,E);this.updateGeometry(k.coords,k.angs,.35),this.threeObj.quaternion.copy(n.toThreejs()),this.setPosition(o)}},{key:"getEllipsePoints",value:function(e,t,a,n,i,r){var s=.25;n>30&&(s=1/Math.min(n/60+3.5,12),n=30);var o=[],c=[],l=t-3,u=(1-s)/3,h=Math.floor(l/(n+2*Math.sqrt(n)+1)),d=Math.floor(Math.sqrt(n)*h),m=[0,0,0,0,0],p=[s/(l-h-2*d),u/d,u/h,u/d],f=i;m[0]=a-s/2,m[0]<0&&(m[0]+=1),m[1]=m[0]+s,m[1]>1&&(m[1]-=1);for(var v=2;v<=4;++v)m[v]=m[v-1]+u,m[v]>1&&(m[v]-=1);for(;f<r;){f>=i&&(o.push(e.getPoint(f)),c.push((f-i)/(r-i)));for(var y=0;y<4&&!(m[y+1]>m[y]&&m[y]<=f&&f<m[y+1]||m[y+1]<m[y]&&(m[y]<=f||f<m[y+1]));)++y;f+=p[y]}return o.push(e.getPoint(r)),c.push(r),{coords:o,angs:c}}}]),t}(u.a)},function(e,t,a){"use strict";a.d(t,"a",function(){return l});var n=a(1),i=a(3),r=a(2),s=a(16),o=a(9),c=a(8),l=function(){function e(){Object(n.a)(this,e)}return Object(i.a)(e,[{key:"setId",value:function(e){return this.id=e,this.originId=o.d.getOriginIdByReferenceFrameId(e),this.type=o.d.getTypeByReferenceFrameId(e),this}},{key:"getQuaternionByEpoch",value:function(e){return new r.a}},{key:"getOriginPositionByEpoch",value:function(e){return new r.c(3)}},{key:"getOriginStateByEpoch",value:function(e){return new s.a}},{key:"transformStateVectorByEpoch",value:function(t,a,n){var i=n instanceof e?n:c.a.starSystem.getReferenceFrame(n);return this===i?a:this.id===o.a?i.stateVectorFromBaseReferenceFrameByEpoch(t,a):i.id===o.a?this.stateVectorToBaseReferenceFrameByEpoch(t,a):i.stateVectorFromBaseReferenceFrameByEpoch(t,this.stateVectorToBaseReferenceFrameByEpoch(t,a))}},{key:"transformPositionByEpoch",value:function(e,t,a){return this.transformStateVectorByEpoch(e,new s.a(t),a).position}},{key:"rotateVectorByEpoch",value:function(t,a,n){var i=n instanceof e?n:c.a.starSystem.getReferenceFrame(n);return this===i?a.copy():i.getQuaternionByEpoch(t).invert_().mul_(this.getQuaternionByEpoch(t)).rotate(a)}},{key:"stateVectorFromBaseReferenceFrameByEpoch",value:function(e,t){}},{key:"stateVectorToBaseReferenceFrameByEpoch",value:function(e,t){}},{key:"mu",get:function(){if(void 0===this._mu){var e=c.a.starSystem.getObject(this.originId);this._mu=e.physicalModel?e.physicalModel.mu:null}return this._mu}}]),e}()},,,,function(e,t,a){"use strict";a.d(t,"a",function(){return r});var n=a(1),i=a(3),r=function(){function e(){Object(n.a)(this,e)}return Object(i.a)(e,[{key:"evaluate",value:function(e){return null}}]),e}()},,function(e,t,a){"use strict";a.d(t,"a",function(){return h});var n=a(1),i=a(3),r=a(5),s=a(4),o=a(12),c=a(6),l=a(43),u=a(58),h=function(e){function t(){var e;return Object(n.a)(this,t),(e=Object(r.a)(this,Object(s.a)(t).call(this))).components=[],e.lastUsedTrajectory=null,e}return Object(c.a)(t,e),Object(i.a)(t,[{key:"select",value:function(){this.isSelected=!0,this.selectedVisualModel?(this.visualModel.hide(),this.selectedVisualModel.show(),this.selectedVisualModel.select()):this.visualModel&&this.visualModel.select(),this.components.map(function(e){return e.select()})}},{key:"deselect",value:function(){Object(o.a)(Object(s.a)(t.prototype),"deselect",this).call(this),this.components.map(function(e){return e.deselect()})}},{key:"drop",value:function(){Object(o.a)(Object(s.a)(t.prototype),"drop",this).call(this),this.components.map(function(e){return e.drop()})}},{key:"setObject",value:function(e){Object(o.a)(Object(s.a)(t.prototype),"setObject",this).call(this,e),this.components.map(function(t){return t.setObject(e)})}},{key:"getReferenceFrameByEpoch",value:function(e){return this.getComponentByEpoch(e).getReferenceFrameByEpoch(e)}},{key:"getStateInOwnFrameByEpoch",value:function(e){return this.getComponentByEpoch(e).getStateInOwnFrameByEpoch(e)}},{key:"getKeplerianObjectByEpoch",value:function(e){return this.getComponentByEpoch(e).getKeplerianObjectByEpoch(e)}},{key:"getStateByEpoch",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this.getComponentByEpoch(e).getStateByEpoch(e,t,a)}},{key:"getComponentByEpoch",value:function(e){if(this.lastUsedTrajectory&&(!1===this.lastUsedTrajectory.minEpoch||this.lastUsedTrajectory.minEpoch<=e)&&(!1===this.lastUsedTrajectory.maxEpoch||this.lastUsedTrajectory.maxEpoch>=e))return this.lastUsedTrajectory;var t=!0,a=!1,n=void 0;try{for(var i,r=this.components[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){var s=i.value;if(s.isValidAtEpoch(e))return this.lastUsedTrajectory=s,s}}catch(o){a=!0,n=o}finally{try{t||null==r.return||r.return()}finally{if(a)throw n}}throw new u.a(this.object,this,e,this.minEpoch,this.maxEpoch)}},{key:"addComponent",value:function(e){this.components.push(e),e.setParent(this),e.setObject(this.object),this.isSelected&&e.select(),(!1===this.minEpoch||!1!==e.minEpoch&&this.minEpoch>e.minEpoch)&&(this.minEpoch=e.minEpoch),(!1===this.maxEpoch||!1!==e.maxEpoch&&this.maxEpoch<e.maxEpoch)&&(this.maxEpoch=e.maxEpoch)}},{key:"clearAfterEpoch",value:function(e){for(;this.components[this.components.length-1].minEpoch>=e;)this.components[this.components.length-1].drop(),this.components.pop();var t=!0,a=!1,n=void 0;try{for(var i,r=this.components[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){var s=i.value;(!1===s.maxEpoch||s.maxEpoch>e)&&s.clearAfterEpoch(e)}}catch(o){a=!0,n=o}finally{try{t||null==r.return||r.return()}finally{if(a)throw n}}this.lastUsedTrajectory=null}}]),t}(l.a)},function(e,t,a){"use strict";a.r(t),a.d(t,"default",function(){return l});var n=a(1),i=a(3),r=a(5),s=a(4),o=a(12),c=a(6),l=function(e){function t(e,a,i){var o;return Object(n.a)(this,t),(o=Object(r.a)(this,Object(s.a)(t).call(this,e))).oldSoi=a||!1,o.newSoi=i||!1,o}return Object(c.a)(t,e),Object(i.a)(t,[{key:"set",value:function(e){return Object(o.a)(Object(s.a)(t.prototype),"set",this).call(this,e),this.oldSoi=e.oldSoi,this.newSoi=e.newSoi,this}}]),t}(a(60).a)},,function(e,t,a){"use strict";a.d(t,"a",function(){return u});var n=a(1),i=a(5),r=a(4),s=a(6),o=a(65),c=a(20),l=a(9),u=function(e){function t(e,a,s){var o;return Object(n.a)(this,t),(o=Object(i.a)(this,Object(r.a)(t).call(this,s)))._flightEvent=a,o._trajectory=e,o.setPositionOfEpoch(new c.a(function(e){return!(e>o._flightEvent.epoch)&&o._trajectory.getPositionByEpoch(o._flightEvent.epoch,l.b,e)})),o}return Object(s.a)(t,e),t}(o.a)},function(e,t,a){"use strict";a.d(t,"a",function(){return m});var n=a(1),i=a(3),r=a(5),s=a(4),o=a(12),c=a(6),l=a(7),u=a(17),h=a(59),d=a(8),m=function(e){function t(e,a){var i;return Object(n.a)(this,t),(i=Object(r.a)(this,Object(s.a)(t).call(this))).trajectory=e,i.color=a.color,i.config=a,i._isSelected=!1,i.initFlightEvents(),i._markers={},i._defaultMarkerScale=.5,i._selectedMarkerScale=1,i._minEpoch=void 0!==a.minEpoch?a.minEpoch:e.minEpoch||!1,i._maxEpoch=void 0!==a.maxEpoch?a.maxEpoch:e.maxEpoch||!1,i.constructor.NO_THREE_OBJ?Object(r.a)(i):(i.setThreeObj(new h.a(new l.i,new l.k({vertexColors:l.G}))),i.point=new l.n(new l.A(1,8,8),new l.o({color:i.color})),i.scene.add(i.point),i.pointSize=4,i.threeObj.userData={selectionObject:function(){return i.trajectory.object}},d.a.selection.addSelectableObject(i.threeObj),i)}return Object(c.a)(t,e),Object(i.a)(t,[{key:"getEpochByPoint",value:function(e){return null}},{key:"onClick",value:function(e){var t=this;this.threeObj.userData.onClick=function(a){return e(t.getEpochByPoint(d.a.getSimCoords(a.point)))}}},{key:"initFlightEvents",value:function(){this.flightEvents=[];var e=!0,t=!1,a=void 0;try{for(var n,i=this.trajectory.flightEvents[Symbol.iterator]();!(e=(n=i.next()).done);e=!0){var r=n.value;this.addFlightEvent(r)}}catch(s){t=!0,a=s}finally{try{e||null==i.return||i.return()}finally{if(t)throw a}}}},{key:"addFlightEvent",value:function(e){var t=e.getVisualClass();if(t){var a=new t(this.trajectory,e,this.color);this.trajectory.isSelected||a.setScale(.5),e.visualModel=a,this.flightEvents.push({event:e,model:a})}}},{key:"removeFlightEvent",value:function(e){for(var t in this.flightEvents)if(this.flightEvents[t].event===e){this.flightEvents[t].model.drop(),this.flightEvents.splice(t,1);break}}},{key:"updateGeometry",value:function(e,t,a){var n=new l.f(this.color);this.threeObj.geometry.dispose(),this.threeObj.geometry=(new l.i).setFromPoints(e);for(var i=0;i<t.length;i++){var r=(new l.f).copy(n),s=a+(1-a)*t[i];this.threeObj.geometry.colors.push(r.multiplyScalar(s))}}},{key:"getPositionEpoch",value:function(e){return!(!1!==this.minEpoch&&e<this.minEpoch||!1!==this.maxEpoch&&e>this.maxEpoch)&&(!1!==this.trajectory.minEpoch&&e<this.trajectory.minEpoch?this.trajectory.minEpoch:!1!==this.trajectory.maxEpoch&&e>this.trajectory.maxEpoch?this.trajectory.maxEpoch:e)}},{key:"render",value:function(e){if(this.trajectory.isValidAtEpoch(e)&&!this._isHidden){this.point.position.copy(d.a.getVisualCoords(this.trajectory.getPositionByEpoch(e)));var t=this.pointSize*this.point.position.length()*this.pixelAngleSize,a=this.trajectory.getKeplerianObjectByEpoch(e);if(a.isElliptic&&a.sma<t)return this._updateMarkerScales(0),void(this.point.visible=!1);a.isElliptic&&t>a.sma/5?(this._updateMarkerScales(a.sma/5/t),t=a.sma/5):this._updateMarkerScales(),this.point.visible=!0,this.point.scale.x=t,this.point.scale.y=t,this.point.scale.z=t}else this.point.visible=!1}},{key:"select",value:function(){this._isSelected=!0,this.setColor(this.config.selectedColor||16777215),this._updateScales()}},{key:"deselect",value:function(){this._isSelected=!1,this.setColor(this.config.color),this._updateScales()}},{key:"hide",value:function(){Object(o.a)(Object(s.a)(t.prototype),"hide",this).call(this),this.point.visible=!1}},{key:"_updateScales",value:function(){var e=!0,t=!1,a=void 0;try{for(var n,i=this.flightEvents[Symbol.iterator]();!(e=(n=i.next()).done);e=!0){n.value.model.setScale(this._isSelected?1:.5)}}catch(r){t=!0,a=r}finally{try{e||null==i.return||i.return()}finally{if(t)throw a}}this._updateMarkerScales()}},{key:"_updateMarkerScales",value:function(e){for(var t in void 0===e&&(e=1),this._markers)e<.1?this._markers[t].hide():(this._markers[t].show(),this._markers[t].setScale((this._isSelected?this._selectedMarkerScale:this._defaultMarkerScale)*e))}},{key:"setColor",value:function(e){this.color=e,this.point&&(this.point.material.color.set(this.color),this.point.material.needsUpdate=!0);var t=!0,a=!1,n=void 0;try{for(var i,r=this.flightEvents[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){i.value.model.setColor(e)}}catch(o){a=!0,n=o}finally{try{t||null==r.return||r.return()}finally{if(a)throw n}}for(var s in this._markers)this._markers[s].setColor(e)}},{key:"drop",value:function(){for(var e in this.threeObj&&d.a.selection.removeSelectableObject(this.threeObj),this._markers)this._markers[e].drop();var a=!0,n=!1,i=void 0;try{for(var r,c=this.flightEvents[Symbol.iterator]();!(a=(r=c.next()).done);a=!0){r.value.model.drop()}}catch(l){n=!0,i=l}finally{try{a||null==c.return||c.return()}finally{if(n)throw i}}delete this.flightEvents,this.point&&(this.scene.remove(this.point),this.point.geometry&&this.point.geometry.dispose(),this.point.material&&this.point.material.dispose(),delete this.point),Object(o.a)(Object(s.a)(t.prototype),"drop",this).call(this)}},{key:"minEpoch",get:function(){return"copy"===this._minEpoch?this.trajectory.minEpoch:this._minEpoch}},{key:"maxEpoch",get:function(){return"copy"===this._maxEpoch?this.trajectory.maxEpoch:this._maxEpoch}}]),t}(u.a)},,function(e,t,a){"use strict";var n=a(1),i=a(3),r=a(16),s=a(9),o=a(22),c=a(58),l=a(20),u=a(44),h=a(2),d=a(5),m=a(4),p=a(12),f=a(6),v=a(7),y=a(27),b=a(17),g=function(e){function t(){return Object(n.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(i.a)(t,[{key:"raycast",value:function(e,t){this.visible=!0;var a=this.constant/e.ray.direction.dot(this.normal);if(!(a<0)){var n=e.ray.direction.clone().multiplyScalar(a);t.push({distance:n.length(),point:n,index:0,face:null,faceIndex:null,object:this})}}}]),t}(v.s),E=a(59),j=function(e){function t(e,a,i,r,s,o){var c;return Object(n.a)(this,t),(c=Object(d.a)(this,Object(m.a)(t).call(this,e,a,i,r,s,o))).remove(c.line),c.line=new E.a(c.line.geometry,c.line.material),c.add(c.line),c}return Object(f.a)(t,e),t}(v.b),O=a(8),_=function(e){function t(e,a,i,r,s,o,c,l){var u;return Object(n.a)(this,t),(u=Object(d.a)(this,Object(m.a)(t).call(this)))._referenceFrame=e,u._position=a,u._orientation=i,u._value=r,u.color=s,u.type=c,u.arcSize=o,u.editingCallback=l,u.isEditMode=!!l,u.bounds=[0,h.b],u.customPriority=0,u.orientationUpdated=!1,u.valueUpdated=!1,u.sizeNeedsUpdate=!1,u.init(),u}return Object(f.a)(t,e),Object(i.a)(t,[{key:"setBounds",value:function(e,t){this.bounds=[e,t]}},{key:"getReferenceFrame",value:function(e){return this._referenceFrame.evaluate(e)}},{key:"getPosition",value:function(e){return this._position.evaluate(e)}},{key:"getOrientation",value:function(e){return this._orientation.evaluate(e)}},{key:"getValue",value:function(e){return this._value.evaluate(e)}},{key:"init",value:function(){this.onWheelListener=this.onMouseWheel.bind(this),document.addEventListener("wheel",this.onWheelListener),this.isEditMode&&(this.mouseDownListener=this.onMouseDown.bind(this),document.addEventListener("mousedown",this.mouseDownListener)),this.sizeNeedsUpdate=!0,this.type===t.TYPE_ARC?this.createArcObject():this.createSectorObject(),this.valueUpdated=!0,this.orientationUpdated=!0}},{key:"onMouseWheel",value:function(){this.sizeNeedsUpdate=!0}},{key:"onMouseDown",value:function(e){(this.type===t.TYPE_ARC?O.a.raycaster.intersectObjects([this.threeAngle.line])[0]:O.a.raycaster.intersectObjects([this.threeAngle.children[0].line,this.threeAngle.children[0].cone])[0])&&0==e.button&&(this.mouseUpListener=this.onMouseUp.bind(this),document.addEventListener("mouseup",this.mouseUpListener),this.mouseMoveListener=this.onMouseMove.bind(this),O.a.addEventListener("mousemove",this.mouseMoveListener,2+this.customPriority/100))}},{key:"onMouseUp",value:function(e){document.removeEventListener("mouseup",this.mouseUpListener),O.a.removeEventListener("mousemove",this.mouseMoveListener)}},{key:"onMouseMove",value:function(){var e=this.getVirtualPlane(),t=O.a.raycaster.intersectObjects([e])[0];if(t){var a=t.point.clone().sub(this.threeObj.position).normalize(),n=new v.F(1,0,0);n.applyQuaternion(this.threeObj.quaternion);var i=this._value.value,r=Math.acos(n.dot(a)/n.length()/a.length());if(n.cross(a),(r=n.dot(e.normal)>0?r:h.b-r)<this.bounds[0]||r>this.bounds[1])r=(this.bounds[0]-r+h.b)%h.b<=(r-this.bounds[1]+h.b)%h.b?this.bounds[0]:this.bounds[1];r!==i&&(this._value.value=r,this.valueUpdated=!0,this.editingCallback&&this.editingCallback(this._value.value))}}},{key:"getVirtualPlane",value:function(){var e=new v.F(0,0,1);e.applyQuaternion(this.threeObj.quaternion);var t=Math.acos(e.dot(this.threeObj.position)/this.threeObj.position.length()/e.length()),a=this.threeObj.position.length()*Math.cos(t);return this.virtualPlane?(this.virtualPlane.normal.copy(e),this.virtualPlane.constant=a):this.virtualPlane=new g(e,a),this.virtualPlane}},{key:"createArcObject",value:function(){var e=new v.k({color:this.color}),t=new v.q;this.threeArc=new v.j(new v.i,e),this.threeMainAxis=new v.j(new v.i,e),this.threeAngle=new v.j(new v.i,e),this.threeMainAxis.geometry.vertices.push(new v.F(0,0,0),new v.F(1,0,0)),this.threeAngle.geometry.vertices.push(new v.F(0,0,0),new v.F(1,0,0)),t.add(this.threeArc),t.add(this.threeMainAxis),t.add(this.threeAngle),t.scale.set(this.size,this.size,this.size),this.setThreeObj(t)}},{key:"updateArcObject",value:function(e){e<0&&(e-=2*Math.PI*Math.floor(e/2/Math.PI)),this.threeArc.geometry.dispose(),this.threeArc.geometry=new v.i,this.threeArc.geometry.setFromPoints(new v.h(0,0,1/3,1/3,0,e,!1,0).getPoints(Math.ceil(30*e)))}},{key:"createSectorObject",value:function(){var e=new v.o({color:this.color,opacity:.175,transparent:!0,side:v.g}),t=new v.q;this.threeArc=new v.n(new v.i,e),this.threeMainAxis=new j(new v.F(1,0,0),new v.F(0,0,0),1,this.color),this.threeAngle=new v.q,this.threeAngle.add(new j(new v.F(1,0,0),new v.F(0,0,0),1,this.isEditMode?12776514:this.color)),t.add(this.threeArc),t.add(this.threeMainAxis),t.add(this.threeAngle),t.scale.set(this.size,this.size,this.size),this.setThreeObj(t)}},{key:"updateSectorObject",value:function(e){e<0&&(e-=2*Math.PI*Math.floor(e/2/Math.PI)),this.threeArc.geometry.dispose(),this.threeArc.geometry=new v.e(1,Math.ceil(30*e),0,e)}},{key:"drop",value:function(){Object(p.a)(Object(m.a)(t.prototype),"drop",this).call(this),delete this.threeMainAxis,delete this.threeAngle,delete this.threeArc,document.removeEventListener("wheel",this.onWheelListener),this.mouseDownListener&&document.removeEventListener("mousedown",this.mouseDownListener)}},{key:"render",value:function(e){var a=this.getReferenceFrame(e),n=a.transformPositionByEpoch(e,this.getPosition(e),s.a);if(this.setPosition(n),this.valueUpdated||!(this._value instanceof y.a)){var i=this.getValue(e);this.type===t.TYPE_ARC?this.updateArcObject(i):this.updateSectorObject(i),this.threeAngle.rotation.z=i,this.valueUpdated=!1}!this.orientationUpdated&&this._orientation instanceof y.a||(this.threeObj.quaternion.copy(a.getQuaternionByEpoch(e).mul_(this.getOrientation(e)).toThreejs()),this.orientationUpdated=!1),this.sizeNeedsUpdate&&(this.size=this.threeObj.position.length()/6*this.arcSize,this.threeObj.scale.set(this.size,this.size,this.size),this.sizeNeedsUpdate=!1)}}]),t}(b.a);_.TYPE_ARC="arc",_.TYPE_SECTOR="sector";var k=function(e){function t(e,a,i,r,s,o,c){var l;return Object(n.a)(this,t),(l=Object(d.a)(this,Object(m.a)(t).call(this)))._referenceFrame=e,l._value=a,l.color=i,l.size=r,l.editingCallback=s,l.minBound=o,l.maxBound=c,l.isEditMode=!!s,l.lastEpoch=0,l.init(),l}return Object(f.a)(t,e),Object(i.a)(t,[{key:"getReferenceFrame",value:function(e){return this._referenceFrame.evaluate(e)}},{key:"init",value:function(){this.setThreeObj(new v.n(new v.A(1,8,8),new v.o({color:this.color}))),this.isEditMode&&(this.mouseDownListener=this.onMouseDown.bind(this),document.addEventListener("mousedown",this.mouseDownListener))}},{key:"drop",value:function(){Object(p.a)(Object(m.a)(t.prototype),"drop",this).call(this),this.mouseDownListener&&document.removeEventListener("mousedown",this.mouseDownListener)}},{key:"onMouseDown",value:function(e){0==e.button&&(O.a.raycaster.intersectObjects([this.threeObj])[0]&&0==e.button&&(this.mouseUpListener=this.onMouseUp.bind(this),document.addEventListener("mouseup",this.mouseUpListener),this.mouseMoveListener=this.onMouseMove.bind(this),O.a.addEventListener("mousemove",this.mouseMoveListener,3)))}},{key:"onMouseUp",value:function(e){document.removeEventListener("mouseup",this.mouseUpListener),O.a.removeEventListener("mousemove",this.mouseMoveListener)}},{key:"onMouseMove",value:function(){this.updateValue(this.lastEpoch)}},{key:"updateValue",value:function(e){var t=this.getVirtualPlane(e),a=O.a.raycaster.intersectObjects([t])[0];if(a){var n=this.minBound(e),i=this.maxBound(e);this._value=s.b.transformPositionByEpoch(e,O.a.getSimCoords(a.point),this.getReferenceFrame(e));for(var r=[0,1,2],o=0;o<r.length;o++){var c=r[o];!1!==n[c]&&this._value[c]<n[c]?this._value[c]=n[c]:!1!==i[c]&&this._value[c]>i[c]&&(this._value[c]=i[c])}this.editingCallback&&this.editingCallback(this._value)}}},{key:"getVirtualPlane",value:function(e){var t=(new v.F).fromArray(this.getReferenceFrame(e).getQuaternionByEpoch(e).rotate_(new h.c([0,0,1]))),a=O.a.getVisualCoords(this.getReferenceFrame(e).getOriginPositionByEpoch(e)),n=Math.acos(t.dot(a)/a.length()/t.length()),i=a.length()*Math.cos(n);return this.virtualPlane?(this.virtualPlane.normal.copy(t),this.virtualPlane.constant=i):this.virtualPlane=new g(t,i),this.virtualPlane}},{key:"render",value:function(e){this.lastEpoch=e,this.setPosition(this.getReferenceFrame(e).transformPositionByEpoch(e,this._value,s.a));var t=this.size*this.threeObj.position.length()*this.pixelAngleSize;this.threeObj.scale.x=t,this.threeObj.scale.y=t,this.threeObj.scale.z=t}}]),t}(b.a),w=function(){function e(t){Object(n.a)(this,e),this.isEditMode=t.isEditable,this.trajectory=t,this.colorRaan=8388564,this.colorAop=10053324,this.colorInc=11534336,this.colorTa=16519104,O.a.settings.ui.showAnglesOfSelectedOrbit&&this.init()}return Object(i.a)(e,[{key:"init",value:function(){var e=this,t=new l.a(function(t){return e.trajectory.getReferenceFrameByEpoch(t)}),a=new y.a(new h.c(3));this.angleRaan=new _(t,a,new y.a(new h.a),new l.a(function(t){return e.trajectory.getKeplerianObjectByEpoch(t).raan}),this.colorRaan,1.5,this.isEditMode?_.TYPE_SECTOR:_.TYPE_ARC,this.isEditMode?function(t){e.trajectory.raan=t}:null),this.angleRaan.customPriority=4,this.angleInc=new _(t,a,new l.a(function(t){var a=e.trajectory.getKeplerianObjectByEpoch(t);return new h.a(new h.c([0,0,1]),a.raan+Math.PI/2).mul_(new h.a(new h.c([1,0,0]),Math.PI/2))}),new l.a(function(t){return e.trajectory.getKeplerianObjectByEpoch(t).inc}),this.colorInc,2,this.isEditMode?_.TYPE_SECTOR:_.TYPE_ARC,this.isEditMode?function(t){e.trajectory.inc=t}:null),this.angleInc.setBounds(0,Math.PI),this.angleInc.customPriority=3,this.angleAop=new _(t,a,new l.a(function(t){var a=e.trajectory.getKeplerianObjectByEpoch(t);return new h.a(new h.c([0,0,1]),a.raan).mul_(new h.a(new h.c([1,0,0]),a.inc))}),new l.a(function(t){return e.trajectory.getKeplerianObjectByEpoch(t).aop}),this.colorAop,2.5,this.isEditMode?_.TYPE_SECTOR:_.TYPE_ARC,this.isEditMode?function(t){e.trajectory.aop=t}:null),this.angleAop.customPriority=2,this.angleTa=new _(t,a,new l.a(function(t){var a=e.trajectory.getKeplerianObjectByEpoch(t);return new h.a(new h.c([0,0,1]),a.raan).mul_(new h.a(new h.c([1,0,0]),a.inc)).mul_(new h.a(new h.c([0,0,1]),a.aop))}),new l.a(function(t){return e.trajectory.getKeplerianObjectByEpoch(t).getTrueAnomalyByEpoch(t)}),this.colorTa,3,_.TYPE_ARC),this.isEditMode&&(this.pointApoapsis=new k(new y.a(this.trajectory.pericentricReferenceFrame),new h.c([-this.trajectory.sma*(1+this.trajectory.ecc),0,0]),"red",8,function(t){var a=e.trajectory.sma*(1-e.trajectory.ecc),n=(-t.x+a)/2;e.trajectory.sma=n,e.trajectory.ecc=1-a/n},function(){return[!1,0,0]},function(){return[-e.trajectory.sma*(1-e.trajectory.ecc),0,0]}),this.pointPeriapsis=new k(new y.a(this.trajectory.pericentricReferenceFrame),new h.c([this.trajectory.sma*(1-this.trajectory.ecc),0,0]),"blue",8,function(t){var a=e.trajectory.sma*(1+e.trajectory.ecc),n=(t.x+a)/2;e.trajectory.sma=n,e.trajectory.ecc=a/n-1},function(){return[0,0,0]},function(){return[e.trajectory.sma*(1+e.trajectory.ecc),0,0]}),this.angleTaEditing=new _(t,a,new l.a(function(t){return new h.a(new h.c([0,0,1]),e.trajectory.raan).mul_(new h.a(new h.c([1,0,0]),e.trajectory.inc)).mul_(new h.a(new h.c([0,0,1]),e.trajectory.aop))}),new y.a(this.trajectory.ta),this.colorTa,3,_.TYPE_SECTOR,function(t){e.trajectory.ta=t}),this.angleTaEditing.customPriority=1)}},{key:"remove",value:function(){this.angleRaan&&this.angleRaan.drop(),this.angleAop&&this.angleAop.drop(),this.angleInc&&this.angleInc.drop(),this.angleTa&&this.angleTa.drop(),this.angleTaEditing&&this.angleTaEditing.drop(),this.pointApoapsis&&this.pointApoapsis.drop(),this.pointPeriapsis&&this.pointPeriapsis.drop()}}]),e}(),M=a(31),S=a(10),T=a(48),A=a(49);a.d(t,"a",function(){return P});var P=function(){function e(){var t=this;Object(n.a)(this,e),this.minEpoch=!1,this.maxEpoch=!1,this.cachedEpoch=null,this.cachedState=null,this.visualModel=null,this.selectedVisualModel=null,this.object=null,this.parent=null,this.referenceFrame=null,this.isEditable=!1,this.isSelected=!1,this.clickHandler=null,this.flightEvents=[],this.showOrbitAnglesListener=this._onShowOrbitAnglesChange.bind(this),this.orbitalReferenceFrame=new u.a(new l.a(function(e){return t.getStateByEpoch(e)}),new l.a(function(e){var a=t.getReferenceFrameByEpoch(e).getQuaternionByEpoch(e),n=t.getStateInOwnFrameByEpoch(e);return a.mul_(h.a.twoAxis(n._velocity,null,n._position))})),this.pericentricReferenceFrame=new u.a(new l.a(function(e){return t.getReferenceFrameByEpoch(e).getOriginStateByEpoch(e)}),new l.a(function(e){var a=t.getReferenceFrameByEpoch(e).getQuaternionByEpoch(e),n=t.getKeplerianObjectByEpoch(e);return a.mul_(n.getOrbitalFrameQuaternion())}))}return Object(i.a)(e,[{key:"onClick",value:function(e){this.clickHandler=e,this.visualModel&&this.visualModel.onClick(e)}},{key:"onUpdate",value:function(e){return null}},{key:"addFlightEvent",value:function(e){if(e instanceof T.default||e instanceof A.default){var t=!0,a=!1,n=void 0;try{for(var i,r=this.flightEvents[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){var s=i.value;if(s.constructor===e.constructor)return void s.set(e)}}catch(l){a=!0,n=l}finally{try{t||null==r.return||r.return()}finally{if(a)throw n}}}var o=!1;for(var c in this.flightEvents)if(this.flightEvents[c].epoch>e.epoch){this.flightEvents.splice(c,0,e),o=!0;break}o||this.flightEvents.push(e),this.visualModel&&this.visualModel.addFlightEvent(e)}},{key:"clearAfterEpoch",value:function(e){var t=[],a=!0,n=!1,i=void 0;try{for(var r,s=this.flightEvents[Symbol.iterator]();!(a=(r=s.next()).done);a=!0){var o=r.value;o.epoch<=e?t.push(o):this.visualModel&&this.visualModel.removeFlightEvent(o)}}catch(c){n=!0,i=c}finally{try{a||null==s.return||s.return()}finally{if(n)throw i}}this.flightEvents=t}},{key:"setReferenceFrame",value:function(e){this.referenceFrame=O.a.starSystem.getReferenceFrame(e)}},{key:"getReferenceFrameByEpoch",value:function(e){return this.referenceFrame}},{key:"_transformKeplerianObject",value:function(e,t,a){if(void 0===t)return e;var n=t instanceof M.a?t:O.a.starSystem.getReferenceFrame(t);return void 0===a&&(a=e.epoch),o.a.createFromState(this.referenceFrame.transformStateVectorByEpoch(a,e.getStateByEpoch(a),n),n.mu,a)}},{key:"getKeplerianObjectByEpoch",value:function(e,t){var a=t instanceof M.a?t:void 0!==t?O.a.starSystem.getReferenceFrame(t):this.getReferenceFrameByEpoch(e);return o.a.createFromState(this.getStateByEpoch(e,a),a.mu,e)}},{key:"setVisualModel",value:function(e){this.visualModel=e,this.clickHandler&&this.visualModel.onClick(this.clickHandler);var t=!0,a=!1,n=void 0;try{for(var i,r=this.flightEvents[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){var s=i.value;this.visualModel.addFlightEvent(s)}}catch(o){a=!0,n=o}finally{try{t||null==r.return||r.return()}finally{if(a)throw n}}}},{key:"setSelectedVisualModel",value:function(e){this.selectedVisualModel=e,this.isSelected?this.visualModel.hide():e.hide(),this.clickHandler&&e.onClick(this.clickHandler);var t=!0,a=!1,n=void 0;try{for(var i,r=this.flightEvents[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){var s=i.value;e.addFlightEvent(s)}}catch(o){a=!0,n=o}finally{try{t||null==r.return||r.return()}finally{if(a)throw n}}}},{key:"setParent",value:function(e){this.parent=e}},{key:"setObject",value:function(e){this.object=e}},{key:"drop",value:function(){this.isSelected&&this.deselect(),this.visualModel&&this.visualModel.drop(),this.selectedVisualModel&&this.selectedVisualModel.drop()}},{key:"select",value:function(){this.isSelected=!0,this.selectedVisualModel?(this.visualModel.hide(),this.selectedVisualModel.show(),this.selectedVisualModel.select()):this.visualModel&&this.visualModel.select(),this.keplerianEditor=new w(this),S.a.addListener(S.a.SHOW_ORBIT_ANGLES_CHANGED,this.showOrbitAnglesListener)}},{key:"deselect",value:function(){this.isSelected=!1,this.selectedVisualModel?(this.selectedVisualModel.deselect(),this.selectedVisualModel.hide(),this.visualModel.show()):this.visualModel&&this.visualModel.deselect(),this.keplerianEditor&&(this.keplerianEditor.remove(),delete this.keplerianEditor,S.a.removeListener(S.a.SHOW_ORBIT_ANGLES_CHANGED,this.showOrbitAnglesListener))}},{key:"_onShowOrbitAnglesChange",value:function(e){e.detail.value?this.keplerianEditor.init():this.keplerianEditor.remove()}},{key:"isValidAtEpoch",value:function(e){return(!1===this.minEpoch||e>=this.minEpoch)&&(!1===this.maxEpoch||e<=this.maxEpoch)}},{key:"validateEpoch",value:function(e){if(!this.isValidAtEpoch(e))throw new c.a(this.object,this,e,this.minEpoch,this.maxEpoch)}},{key:"getStateInOwnFrameByEpoch",value:function(e){return this.validateEpoch(e),new r.a}},{key:"getStateByEpoch",value:function(e,t){var a,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return null===this.referenceFrame?null:(void 0===t&&(t=s.a),t===s.a&&e===this.cachedEpoch?a=this.cachedState:(a=this.getStateInOwnFrameByEpoch(e),t===s.a&&e===O.a.currentEpoch&&(this.cachedState=a,this.cachedEpoch=e)),null===a?null:this.referenceFrame.transformStateVectorByEpoch(null===n?e:n,a,t))}},{key:"getPositionByEpoch",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this.getStateByEpoch(e,t,a).position}}]),e}()},function(e,t,a){"use strict";a.d(t,"a",function(){return c});var n=a(1),i=a(3),r=a(5),s=a(4),o=a(6),c=function(e){function t(e,a){var i;return Object(n.a)(this,t),(i=Object(r.a)(this,Object(s.a)(t).call(this,e))).quaternionOfEpoch=a,i}return Object(o.a)(t,e),Object(i.a)(t,[{key:"getQuaternionByEpoch",value:function(e){return this.quaternionOfEpoch.evaluate(e)}}]),t}(a(57).a)},,function(e,t,a){"use strict";a.d(t,"a",function(){return c}),a.d(t,"b",function(){return l});var n=a(1),i=a(3),r=a(9),s=a(23),o=a(10),c=0,l=function(){function e(t){Object(n.a)(this,e),this.id=t,this.name=null,this.stars=null,this.mainObject=null,this.referenceFrames={},this.objects={},this.created=0}return Object(i.a)(e,[{key:"unload",value:function(){Object.entries(this.objects).map(function(e){return e[1].drop()}),this.stars&&this.stars.drop()}},{key:"addStars",value:function(e){return this.stars=e,this}},{key:"addReferenceFrame",value:function(e){this.referenceFrames[e.id]=e}},{key:"getReferenceFrame",value:function(e){return void 0===this.referenceFrames[e]&&(this.referenceFrames[e]=r.d.createById(e)),this.referenceFrames[e]}},{key:"addObject",value:function(e,t){this.objects[e]=t,o.a.dispatch(o.a.OBJECT_ADDED,{object:t})}},{key:"getObject",value:function(e){return void 0===this.objects[e]?null:this.objects[e]}},{key:"deleteObject",value:function(e){this.objects[e].drop(),delete this.objects[e]}},{key:"isBody",value:function(e){return void 0===this.objects[e]?null:this.objects[e]instanceof s.a}},{key:"getObjectNames",value:function(){for(var e={},t=Object.values(this.objects),a=0;a<t.length;a++){var n=t[a];e[n.id]=n.name}return e}},{key:"getBodies",value:function(){for(var e=[],t=Object.values(this.objects),a=0;a<t.length;a++){var n=t[a];n instanceof s.a&&e.push(n)}return e}}]),e}()},function(e,t,a){"use strict";a.r(t),a.d(t,"GETTING_STARTED_WIZARD",function(){return n}),a.d(t,"getRus",function(){return i}),a.d(t,"getEng",function(){return r});var n="getting-started-wizard";function i(e){return"".concat(e,"-ru")}function r(e){return"".concat(e,"-eng")}},function(e,t,a){"use strict";a.r(t),a.d(t,"default",function(){return c});var n=a(1),i=a(5),r=a(4),s=a(6),o=a(52),c=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(r.a)(t).apply(this,arguments))}return Object(s.a)(t,e),t}(a(38).default);c.VISUAL_CLASS=o.default},function(e,t,a){"use strict";a.r(t),a.d(t,"default",function(){return c});var n=a(1),i=a(5),r=a(4),s=a(6),o=a(53),c=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(r.a)(t).apply(this,arguments))}return Object(s.a)(t,e),t}(a(38).default);c.VISUAL_CLASS=o.default},,function(e,t,a){"use strict";a.d(t,"a",function(){return c});var n=a(1),i=a(3),r=a(5),s=a(4),o=a(6),c=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(s.a)(t).call(this))).setReferenceFrame(e),a}return Object(o.a)(t,e),Object(i.a)(t,[{key:"getStateInOwnFrameByEpoch",value:function(e){return this.getKeplerianObjectByEpoch(e).getStateByEpoch(e)}}]),t}(a(43).a)},function(e,t,a){"use strict";a.r(t),a.d(t,"default",function(){return o});var n=a(1),i=a(5),r=a(4),s=a(6),o=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(r.a)(t).apply(this,arguments))}return Object(s.a)(t,e),t}(a(40).a);o._textureName="soi_out.png"},function(e,t,a){"use strict";a.r(t),a.d(t,"default",function(){return o});var n=a(1),i=a(5),r=a(4),s=a(6),o=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(r.a)(t).apply(this,arguments))}return Object(s.a)(t,e),t}(a(40).a);o._textureName="soi_in.png"},function(e,t,a){"use strict";a.d(t,"a",function(){return d});var n=a(1),i=a(3),r=a(5),s=a(4),o=a(12),c=a(6),l=a(37),u=a(55),h=a(2),d=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(s.a)(t).call(this))).propagator=e,a.updateHandlers=[],a}return Object(c.a)(t,e),Object(i.a)(t,[{key:"addComponent",value:function(e){var a=this;0===this.components.length&&(e.isEditable=!0,e.onUpdate(function(e){return a.propagate(e.epoch)})),Object(o.a)(Object(s.a)(t.prototype),"addComponent",this).call(this,e),e.onClick(function(e){a.addFlightEvent(new u.a(e,new h.c([0,0,0])).onUpdate(function(e,t){a.sortManeuvers(),a.propagate(Math.min(t.epoch,e.epoch))})),a.updateHandlers.map(function(e){return e(a)})})}},{key:"sortManeuvers",value:function(){this.flightEvents.sort(function(e,t){return e.epoch<t.epoch?-1:e.epoch>t.epoch?1:0})}},{key:"propagate",value:function(e){var t=this;this.propagator.propagate(this,e),this.updateHandlers.map(function(e){return e(t)})}},{key:"onUpdate",value:function(e){this.updateHandlers.push(e)}},{key:"removeListener",value:function(e){for(var t in this.updateHandlers)if(this.updateHandlers[t]===e){this.updateHandlers=this.updateHandlers.splice(t,1);break}}}]),t}(l.a)},function(e,t,a){"use strict";a.d(t,"a",function(){return h});var n=a(1),i=a(3),r=a(5),s=a(4),o=a(12),c=a(6),l=a(60),u=a(64),h=function(e){function t(e,a){var i;return Object(n.a)(this,t),(i=Object(r.a)(this,Object(s.a)(t).call(this,e)))._vector=a||!1,i.deltaV=a?a.mag:0,i}return Object(c.a)(t,e),Object(i.a)(t,[{key:"_update",value:function(e){this.deltaV=this._vector.mag,this._updateCallback&&this._updateCallback(this,e)}},{key:"set",value:function(e){return Object(o.a)(Object(s.a)(t.prototype),"set",this).call(this,e),this._vector=e.vector,this.deltaV=this._vector.mag,this}},{key:"vector",set:function(e){var t=this.copy();this._vector=e,this._update(t)},get:function(){return this._vector.copy()}},{key:"prograde",set:function(e){var t=this.copy();this._vector[0]=e,this._update(t)},get:function(){return this._vector[0]}},{key:"normal",set:function(e){var t=this.copy();this._vector[1]=e,this._update(t)},get:function(){return this._vector[1]}},{key:"radial",set:function(e){var t=this.copy();this._vector[2]=e,this._update(t)},get:function(){return this._vector[2]}}]),t}(l.a);h.VISUAL_CLASS=u.a},function(e,t,a){"use strict";a.d(t,"a",function(){return u});var n=a(1),i=a(3),r=a(5),s=a(4),o=a(6),c=a(57),l=a(2),u=function(e){function t(e,a){var i;return Object(n.a)(this,t),(i=Object(r.a)(this,Object(s.a)(t).call(this,e))).quaternion=a,i}return Object(o.a)(t,e),Object(i.a)(t,[{key:"getQuaternionByEpoch",value:function(e){return l.a.copy(this.quaternion)}}]),t}(c.a)},function(e,t,a){"use strict";a.d(t,"a",function(){return u});var n=a(1),i=a(3),r=a(5),s=a(4),o=a(6),c=a(31),l=a(16),u=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(s.a)(t).call(this))).stateOfEpoch=e,a}return Object(o.a)(t,e),Object(i.a)(t,[{key:"getOriginPositionByEpoch",value:function(e){return this.stateOfEpoch.evaluate(e).position}},{key:"getOriginStateByEpoch",value:function(e){return this.stateOfEpoch.evaluate(e)}},{key:"stateVectorFromBaseReferenceFrameByEpoch",value:function(e,t){var a=this.stateOfEpoch.evaluate(e),n=this.getQuaternionByEpoch(e).invert_();return new l.a(n.rotate(t.position.sub_(a.position)),n.rotate(t.velocity.sub_(a.velocity)))}},{key:"stateVectorToBaseReferenceFrameByEpoch",value:function(e,t){var a=this.stateOfEpoch.evaluate(e),n=this.getQuaternionByEpoch(e);return new l.a(n.rotate(t.position).add_(a.position),n.rotate(t.velocity).add_(a.velocity))}}]),t}(c.a)},function(e,t,a){"use strict";a.d(t,"a",function(){return i});var n=a(1),i=function e(t,a,i,r,s){Object(n.a)(this,e),this.object=t,this.trajectory=a,this.epoch=i,this.minEpoch=r,this.maxEpoch=s}},function(e,t,a){"use strict";a.d(t,"a",function(){return l});var n=a(1),i=a(3),r=a(5),s=a(4),o=a(6),c=a(7),l=function(e){function t(){return Object(n.a)(this,t),Object(r.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(o.a)(t,e),Object(i.a)(t,[{key:"raycast",value:function(e,t){for(var a,n=this.geometry.isBufferGeometry,i=n?this.geometry.attributes.position.count:this.geometry.vertices.length,r=(new c.x).copy(e.ray).applyMatrix4((new c.m).getInverse(this.matrixWorld)),s=0;s<i-1;s++){var o=void 0,l=void 0;if(n){var u=3*s,h=(s+1)%i*3,d=this.geometry.attributes.position.array;o=new c.F(d[u],d[u+1],d[u+2]),l=new c.F(d[h],d[h+1],d[h+2])}else o=(new c.F).copy(this.geometry.vertices[s]),l=(new c.F).copy(this.geometry.vertices[(s+1)%i]);var m=(new c.F).subVectors(o,l);if(0!==m.length()){var p=(new c.F).crossVectors(m,r.direction),f=(new c.F).crossVectors(r.direction,p),v=(new c.F).subVectors(r.origin,o).dot(f);v/=f.clone().dot(m);var y=(new c.F).addVectors(o,m.multiplyScalar(v));(new c.F).subVectors(o,y).dot((new c.F).subVectors(y,l))<0&&(y=y.distanceTo(o)<y.distanceTo(l)?o:l);var b=(new c.F).crossVectors((new c.F).subVectors(y,r.origin),r.direction).length();(!a||a.distance>b)&&(a={distance:b,point:y,index:s,face:null,faceIndex:null,object:this})}}a&&a.distance/r.origin.distanceTo(a.point)<e.pixelPrecision*e.pixelAngleSize&&(a.point.applyMatrix4(this.matrixWorld),t.push(a))}}]),t}(c.j)},function(e,t,a){"use strict";a.d(t,"a",function(){return r});var n=a(1),i=a(3),r=function(){function e(t){Object(n.a)(this,e),this._epoch=t||!1,this._updateCallback=!1,this._visualModel=null}return Object(i.a)(e,[{key:"onUpdate",value:function(e){return this._updateCallback=e,this}},{key:"set",value:function(e){return this._epoch=e._epoch,this}},{key:"copy",value:function(){return(new this.constructor).set(this)}},{key:"getVisualClass",value:function(){return this.constructor.VISUAL_CLASS}},{key:"epoch",set:function(e){var t=this.copy();this._epoch=e,this._updateCallback&&this._updateCallback(this,t)},get:function(){return this._epoch}},{key:"visualModel",set:function(e){this._visualModel=e},get:function(){return this._visualModel}}]),e}();r.VISUAL_CLASS=null},function(e,t,a){"use strict";a.d(t,"a",function(){return o});var n=a(1),i=a(5),r=a(4),s=a(6),o=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(r.a)(t).apply(this,arguments))}return Object(s.a)(t,e),t}(a(62).a);o._textureName="pe.png",o._alignVertical="top",o._alignHorizontal="center"},function(e,t,a){"use strict";a.d(t,"a",function(){return l});var n=a(1),i=a(3),r=a(5),s=a(4),o=a(12),c=a(6),l=function(e){function t(e,a){var i;return Object(n.a)(this,t),(i=Object(r.a)(this,Object(s.a)(t).call(this,a)))._parent=e,i.threeObj&&i._parent.add(i.threeObj),i._isEnabled=!1,i.hide(),i}return Object(c.a)(t,e),Object(i.a)(t,[{key:"setThreeObj",value:function(e){this.threeObj=e,this._parent&&this._parent.add(this.threeObj),!this._isHidden&&this._isEnabled||(this.threeObj.visible=!1)}},{key:"setPosition",value:function(e){this.threeObj&&this.threeObj.position.copy(e)}},{key:"enable",value:function(){this._isEnabled=!0,this._isHidden||(this.threeObj.visible=!0)}},{key:"disable",value:function(){this._isEnabled=!1,this.threeObj.visible=!1}},{key:"show",value:function(){Object(o.a)(Object(s.a)(t.prototype),"show",this).call(this),this._isEnabled||(this.threeObj.visible=!1)}}]),t}(a(65).a)},function(e,t,a){"use strict";a.d(t,"a",function(){return o});var n=a(1),i=a(5),r=a(4),s=a(6),o=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(r.a)(t).apply(this,arguments))}return Object(s.a)(t,e),t}(a(62).a);o._textureName="ap.png",o._alignVertical="bottom",o._alignHorizontal="center"},function(e,t,a){"use strict";a.d(t,"a",function(){return o});var n=a(1),i=a(5),r=a(4),s=a(6),o=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(r.a)(t).apply(this,arguments))}return Object(s.a)(t,e),t}(a(40).a);o._textureName="burn.png"},function(e,t,a){"use strict";var n=a(1),i=a(5),r=a(4),s=a(3),o=a(6),c=a(12),l=a(7),u=a(17),h=a(8),d=function(e){function t(e,a,s,o,c,l){var u;return Object(n.a)(this,t),(u=Object(i.a)(this,Object(r.a)(t).call(this))).positionOfEpoch=e,u.verticalAlign=o||"center",u.horizontalAlign=c||"center",u.scale=l||1,u.color=s||16777215,u.loadTexture(a),u}return Object(o.a)(t,e),Object(s.a)(t,[{key:"loadTexture",value:function(e){var t=this;e&&h.a.textureLoader.load(e,function(e){t.setTexture(e)})}},{key:"setTexture",value:function(e){this._dropped||(this.setThreeObj(new l.B(new l.C({map:e,sizeAttenuation:!1,color:this.color}))),this.setScale(this.scale),this.updateCenter())}},{key:"updateCenter",value:function(){this.threeObj&&this.threeObj.center.set("right"===this.horizontalAlign?0:"left"===this.horizontalAlign?1:.5,"top"===this.verticalAlign?0:"bottom"===this.verticalAlign?1:.5)}},{key:"setScale",value:function(e){this.scale=e,this.threeObj.scale.set(this.threeObj.material.map.image.width/800*this.scale,this.threeObj.material.map.image.height/800*this.scale,1)}},{key:"setColor",value:function(e){this.color=e,this.threeObj.material.color.set(this.color),this.threeObj.material.needsUpdate=!0}},{key:"setAlign",value:function(e,t){this.verticalAlign=e,this.horizontalAlign=t,this.updateCenter()}},{key:"setPositionOfEpoch",value:function(e){this.positionOfEpoch=e}},{key:"render",value:function(e){this.positionOfEpoch&&this.setPosition(this.positionOfEpoch.evaluate(e))}},{key:"drop",value:function(){Object(c.a)(Object(r.a)(t.prototype),"drop",this).call(this),this._dropped=!0}}]),t}(u.a);a.d(t,"a",function(){return m});var m=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(r.a)(t).call(this,null,null,e))).setAlign(a.constructor._alignVertical,a.constructor._alignHorizontal),a.constructor._texture?a.setTexture(a.constructor._texture):a.loadTexture("images/"+a.constructor._textureName),a}return Object(o.a)(t,e),Object(s.a)(t,null,[{key:"preloadTexture",value:function(){var e=this;h.a.textureLoader.load("images/"+this._textureName,function(t){e._texture=t})}}]),t}(d);m._texture=null,m._textureName=null,m._alignVertical="center",m._alignHorizontal="center"},,,,,function(e,t,a){"use strict";a.d(t,"a",function(){return r});var n=a(1),i=a(3),r=function(){function e(){Object(n.a)(this,e)}return Object(i.a)(e,[{key:"getQuaternionByEpoch",value:function(e){}}]),e}()},,,,,,,,,,,,function(e,t,a){"use strict";var n=a(1),i=a(3),r=a(19),s=a.n(r),o=a(9),c=a(23),l=a(5),u=a(4),h=a(6),d=a(70),m=a(2),p=function(e){function t(e){var a;Object(n.a)(this,t),a=Object(l.a)(this,Object(u.a)(t).call(this));var i=new m.c(e.vector);return a.axisQuaternion=m.a.transfer(new m.c([0,0,1]),i),a.angularSpeed=i.mag,a.initialAngle=e.angle||0,a.initialEpoch=e.epoch||0,a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"getQuaternionByEpoch",value:function(e){return this.axisQuaternion.mul(new m.a([0,0,1],this.initialAngle+(e-this.initialEpoch)*this.angularSpeed))}}]),t}(d.a),f=function e(t){Object(n.a)(this,e),this.mu=t.mu,this.radius=t.radius,this.eqRadius=t.eqRadius,this.j2=t.j2||0},v=a(18),y=a(51),b=a(22),g=a(16),E=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).keplerianObjects=[],a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"addState",value:function(e){this.keplerianObjects.push(e)}},{key:"getKeplerianObjectByEpoch",value:function(e,t){this.validateEpoch(e);var a=Math.ceil((e-this.keplerianObjects[0].epoch)/(this.keplerianObjects[this.keplerianObjects.length-1].epoch-this.keplerianObjects[0].epoch)*(this.keplerianObjects.length-1));a<0&&(a=0),a>this.keplerianObjects.length-1&&(a=this.keplerianObjects.length-1);for(var n=this.keplerianObjects[a].epoch>e?-1:1;a<this.keplerianObjects.length&&a>=0;){if(this.keplerianObjects[a].epoch==e)return this.keplerianObjects[a];if(this.keplerianObjects[a].epoch>e&&(0===a||this.keplerianObjects[a-1].epoch<e))break;a+=n}return a!==this.keplerianObjects.length&&0!==a||(a-=n),this._transformKeplerianObject(this.approximateKeplerianObject(this.keplerianObjects[a-1],this.keplerianObjects[a],e),t)}},{key:"approximateKeplerianObject",value:function(e,t,a){var n=(a-e.epoch)/(t.epoch-e.epoch);if(.95<e.ecc&&e.ecc<1.05||.95<t.ecc&&t.ecc<1.05||e.isElliptic!==t.isElliptic){var i=e.getStateByEpoch(a),r=t.getStateByEpoch(a);return b.a.createFromState(new g.a(i.position.mul_(1-n).add_(r.position.mul_(n)),i.velocity.mul_(1-n).add_(r.velocity.mul_(n))),Object(m.f)(e.mu,t.mu,n),a)}var s=e.isElliptic?Object(m.e)(e.getMeanAnomalyByEpoch(a),t.getMeanAnomalyByEpoch(a),n):Object(m.f)(e.getMeanAnomalyByEpoch(a),t.getMeanAnomalyByEpoch(a),n);return new b.a(Object(m.f)(e.ecc,t.ecc,n),Object(m.f)(e.sma,t.sma,n),Object(m.e)(e.aop,t.aop,n),Object(m.e)(e.inc,t.inc,n),Object(m.e)(e.raan,t.raan,n),s,a,Object(m.f)(e.mu,t.mu,n),!1)}}]),t}(y.a),j=a(12),O=function(e){function t(e,a,i){var r;return Object(n.a)(this,t),(r=Object(l.a)(this,Object(u.a)(t).call(this,e))).r=a,r.j2=i,r}return Object(h.a)(t,e),Object(i.a)(t,[{key:"approximateKeplerianObject",value:function(e,a,n){var i=e.copy(),r=a.copy();return i.raan+=i.getNodalPrecessionByEpoch(this.r,this.j2,n),r.raan+=r.getNodalPrecessionByEpoch(this.r,this.j2,n),Object(j.a)(Object(u.a)(t.prototype),"approximateKeplerianObject",this).call(this,i,r,n)}}]),t}(E),_=a(28),k=function(e){function t(e,a,i,r){var s;return Object(n.a)(this,t),(s=Object(l.a)(this,Object(u.a)(t).call(this,e,a))).r=i,s.j2=r,s}return Object(h.a)(t,e),Object(i.a)(t,[{key:"getKeplerianObjectByEpoch",value:function(e,t){return this.validateEpoch(e),this._transformKeplerianObject(this.keplerianObject.addPrecession(this.r,this.j2,e),t)}}],[{key:"createFromState",value:function(e,a,n,i,r,s,o){return new t(e,b.a.createFromState(a,n,s),i,r,o)}}]),t}(_.a),w=a(37),M=a(41),S=a(8),T=function(e){function t(e,a){var i;return Object(n.a)(this,t),(i=Object(l.a)(this,Object(u.a)(t).call(this,e,a))).referenceFrame=S.a.starSystem.getReferenceFrame(a.referenceFrame),i.showAhead=a.showAhead,i.showBehind=a.showBehind,i.trailPeriod=a.trailPeriod,i.minCos=Math.cos(Object(m.g)(a.maxAngle||2)),i.minStep=a.minStep||180,i.threeObj.position.set(0,0,0),i.initVertices(),i}return Object(h.a)(t,e),Object(i.a)(t,[{key:"select",value:function(){Object(j.a)(Object(u.a)(t.prototype),"select",this).call(this),this.showAhead=!0,this.showBehind=!0}},{key:"deselect",value:function(){Object(j.a)(Object(u.a)(t.prototype),"deselect",this).call(this),this.showAhead=this.config.showAhead,this.showBehind=this.config.showBehind}},{key:"render",value:function(e){Object(j.a)(Object(u.a)(t.prototype),"render",this).call(this,e);var a=this.getPositionEpoch(e);if(!1!==a){for(var n=this.showBehind?.4:0,i=this.referenceFrame.getOriginPositionByEpoch(e),r=[],s=[],o=0;o<this.positions.length;++o)if(this.epochs[o]<a-this.trailPeriod?(this.showBehind&&(r.push(this.positions[o]),s.push(0)),this.epochs[o+1]>a-this.trailPeriod&&(r.push(this.trajectory.getPositionByEpoch(a-this.trailPeriod,this.referenceFrame)),s.push(0))):this.epochs[o]<a?(r.push(this.positions[o]),s.push(1-(a-this.epochs[o])/this.trailPeriod)):this.epochs[o]>a&&this.showAhead&&(r.push(this.positions[o]),s.push(0)),this.epochs[o]<a&&this.epochs[o+1]>=a){var c=this.trajectory.getPositionByEpoch(a,this.referenceFrame);r.push(c),r.push(c),s.push(1),s.push(0)}this.updateGeometry(r,s,n),this.threeObj.quaternion.copy(this.referenceFrame.getQuaternionByEpoch(e).toThreejs()),this.setPosition(i)}else this.threeObj.visible=!1}},{key:"findPointByEpoch",value:function(e){var t=0,a=this.epochs.length-1,n=Math.floor((t+a)/2);do{if(this.epochs[n]<e)t=n;else{if(!(this.epochs[n]>e))return n;a=n}n=Math.floor((t+a)/2)}while(n!=t);return e-this.epochs[n]>this.epochs[n+1]-e?n+1:n}},{key:"initVertices",value:function(){var e=this.trajectory,t=this.minStep,a=e.minEpoch,n=e.getStateByEpoch(a,this.referenceFrame),i=n.velocity.unit_();this.positions=[n.position],this.epochs=[a];for(var r=1;a<e.maxEpoch;){for(var s=void 0,o=void 0,c=null,l=20;;){var u=a+t>e.maxEpoch?e.maxEpoch:a+t;t=u-a;var h=e.getStateByEpoch(u,this.referenceFrame),d=h._position.sub(n._position),m=d.mag,p=d.dot(i)/m;if(u!=e.maxEpoch){var f=u+t>e.maxEpoch?e.maxEpoch:u+t,v=e.getStateByEpoch(f,this.referenceFrame)._position.sub(h._position);p=Math.min(p,d.dot(v)/m/v.mag)}if(p<this.minCos){if(!0===c)break;t/=2,c=!1}else{if(s=h,o=u,m,!1===c||u===e.maxEpoch)break;t*=2,c=!0}if(0===--l||Math.abs(t)<this.minStep){t=this.minStep*Math.sign(t),void 0===s&&(s=h,o=u,m);break}}this.epochs[r]=o,this.positions[r]=s.position,i=(n=s).velocity.unit_(),a=o,r++}}}]),t}(M.a),A=a(30),P=function(e){function t(e,a){var i;return Object(n.a)(this,t),(i=Object(l.a)(this,Object(u.a)(t).call(this))).setReferenceFrame(e),i.pos=a,i}return Object(h.a)(t,e),Object(i.a)(t,[{key:"getStateInOwnFrameByEpoch",value:function(e){return this.validateEpoch(e),new g.a(this.pos)}}]),t}(a(43).a),C=function(){function e(){Object(n.a)(this,e)}return Object(i.a)(e,null,[{key:"create",value:function(e){var t,a,n,i=e.type;if("keplerian"===i)t=this.createKeplerianBasic(e);else if("keplerian_precessing"===i)t=this.createKeplerianPrecessing(e);else if("keplerian_array"===i)t=this.createKeplerianArray(e);else if("keplerian_precessing_array"===i)t=this.createKeplerianPrecessingArray(e);else if("composite"===i)t=this.createComposite(e);else if("static"===i)t=this.createStatic(e);else{t=new(S.a.getClass(i))(e.data)}return void 0!==e.periodStart&&(t.minEpoch=e.periodStart),void 0!==e.periodEnd&&(t.maxEpoch=e.periodEnd),e.rendering&&(e.visual=e.rendering),void 0!==e.visual&&(void 0!==e.visual.regular?(a=this.createVisualModel(t,e.visual.regular),n=this.createVisualModel(t,e.visual.selected)):a=this.createVisualModel(t,e.visual)),a&&t.setVisualModel(a),n&&t.setSelectedVisualModel(n),t}},{key:"createVisualModel",value:function(e,t){return t.keplerianModel?new A.a(e,t):t.pointArrayModel?new T(e,t):new("keplerian"===t.model?A.a:"pointArray"===t.model?T:S.a.getClass(t.model))(e,t.config)}},{key:"createComposite",value:function(e){var t=new w.a,a=!0,n=!1,i=void 0;try{for(var r,s=e.data[Symbol.iterator]();!(a=(r=s.next()).done);a=!0){var o=r.value;t.addComponent(this.create(o))}}catch(c){n=!0,i=c}finally{try{a||null==s.return||s.return()}finally{if(n)throw i}}return t}},{key:"createKeplerianArray",value:function(e){var t=new E(e.data.referenceFrame),a=!0,n=!1,i=void 0;try{for(var r,s=e.data.elementsArray[Symbol.iterator]();!(a=(r=s.next()).done);a=!0){var o=r.value;t.addState(this.createKeplerianObject(o,e.data.mu))}}catch(c){n=!0,i=c}finally{try{a||null==s.return||s.return()}finally{if(n)throw i}}return t}},{key:"createKeplerianPrecessingArray",value:function(e){var t=new O(e.data.referenceFrame,e.data.radius,e.data.j2),a=!0,n=!1,i=void 0;try{for(var r,s=e.data.elementsArray[Symbol.iterator]();!(a=(r=s.next()).done);a=!0){var o=r.value;t.addState(this.createKeplerianObject(o,e.data.mu))}}catch(c){n=!0,i=c}finally{try{a||null==s.return||s.return()}finally{if(n)throw i}}return t}},{key:"createKeplerianBasic",value:function(e){return new _.a(e.data.referenceFrame,this.createKeplerianObject(e.data.elements))}},{key:"createKeplerianPrecessing",value:function(e){return new k(e.data.referenceFrame,this.createKeplerianObject(e.data.elements),e.data.radius,e.data.j2)}},{key:"createStatic",value:function(e){return new P(e.data.referenceFrame,new m.c(e.data.position))}},{key:"createKeplerianObject",value:function(e,t){return new b.a(e[0],e[1]/(1-e[0]),e[2],e[3],e[4],e[5],e[6],t||e[7],!1)}}]),e}(),x=a(7),D=a(17),B=function(e){function t(e){var a;Object(n.a)(this,t),a=Object(l.a)(this,Object(u.a)(t).call(this));var i=new x.i,r=!0,s=!1,o=void 0;try{for(var c,h=e[Symbol.iterator]();!(r=(c=h.next()).done);r=!0){var d=c.value;i.vertices.push(new x.F(1e12*Math.cos(Object(m.g)(d[0]))*Math.cos(Object(m.g)(d[1])),1e12*Math.sin(Object(m.g)(d[0]))*Math.cos(Object(m.g)(d[1])),1e12*Math.sin(Object(m.g)(d[1])))),i.colors.push(new x.f(d[2]/50,d[2]/50,d[2]/50))}}catch(p){s=!0,o=p}finally{try{r||null==h.return||h.return()}finally{if(s)throw o}}return a.setThreeObj(new x.u(i,new x.v({vertexColors:x.G,size:2,sizeAttenuation:!1}))),a.threeObj.quaternion.copy(new m.a([-1,0,0],Object(m.g)(23.4)).toThreejs()),a}return Object(h.a)(t,e),t}(D.a),N=function(e){function t(e,a){var i;return Object(n.a)(this,t),(i=Object(l.a)(this,Object(u.a)(t).call(this))).visible=!0,i.parameters=Object.assign({},t.DEFAULT_SETTINGS,a),i.positionOfEpoch=e,i.canvas=document.createElement("canvas"),i.setThreeObj(new x.B(new x.C({map:new x.d(i.canvas)}))),i.threeObj.renderOrder=1,i.setText(i.parameters.text),i}return Object(h.a)(t,e),Object(i.a)(t,[{key:"setText",value:function(e){var t=this.canvas.getContext("2d");t.font=this.parameters.fontSize+"px "+this.parameters.font;var a=t.measureText(e).width,n=this.parameters.fontSize*(1+this.parameters.margin)*2;this.canvas.width=x.l.ceilPowerOfTwo(a),this.canvas.height=x.l.ceilPowerOfTwo(n),t.font=this.parameters.fontSize+"px "+this.parameters.font,t.fillStyle=this.parameters.color,t.textAlign="center",t.textBaseline="bottom",t.fillText(e,this.canvas.width/2,this.parameters.fontSize+(this.canvas.height-n)/2),this.threeObj.material.map.needsUpdate=!0}},{key:"render",value:function(e){if(this.visible){this.setPosition(this.positionOfEpoch.evaluate(e));var t=this.threeObj.position.length(),a=this.calculateScaleCoeff(t,this.parameters.scaling)/2;this.threeObj.scale.x=this.canvas.width*a,this.threeObj.scale.y=this.canvas.height*a,this.threeObj.visible=1<Math.max(this.threeObj.scale.x,this.threeObj.scale.y)/(t*this.pixelAngleSize)/2}else this.threeObj.visible=!1}},{key:"calculateScaleCoeff",value:function(e,a){return"string"===typeof a.callback?t.scalingFunctions[a.callback](e,a.range):a.callback(e,a.range)}}]),t}(D.a);N.DEFAULT_SETTINGS={text:"",font:"Arial",color:"white",fontSize:32,margin:0,scaling:{range:{from:3e4,to:7e5},callback:"range"}},N.scalingFunctions={alwaysVisible:function(e){return e*S.a.raycaster.getPixelAngleSize()},range:function(e,t){return e<t.from?t.from*S.a.raycaster.getPixelAngleSize():e>t.to?t.to*S.a.raycaster.getPixelAngleSize():e*S.a.raycaster.getPixelAngleSize()}};var I=a(20),L=function(e){function t(e,a){var i;return Object(n.a)(this,t),(i=Object(l.a)(this,Object(u.a)(t).call(this))).shape=e,i.color=a.color,i.body=null,i.setThreeObj(i.getThreeObj()),i.threeObj.add(new x.c(2*e.radius)),i}return Object(h.a)(t,e),Object(i.a)(t,[{key:"getThreeObj",value:function(){return new x.n(this.shape.getThreeGeometry(),this.getMaterial({color:this.color,wireframe:!0}))}},{key:"setObject",value:function(e){var t=this;this.body=e,this.label=new N(new I.a(function(a){return e.getPositionByEpoch(a).add_(S.a.camera.getTopDirection(a).mul_(t.shape.getMaxDimension()/2))}),{text:this.body.name,margin:.3,scaling:this.body.type===v.a.TYPE_STAR||this.body.type===v.a.TYPE_PLANET?{callback:"alwaysVisible"}:this.body.type===v.a.TYPE_PLANETOID||this.body.type===v.a.TYPE_SATELLITE?{callback:"range",range:{from:5*this.shape.getMaxDimension(),to:1e3*this.shape.getMaxDimension()}}:N.DEFAULT_SETTINGS.scaling}),this.threeObj.userData={selectionObject:e},S.a.selection.addSelectableObject(this.threeObj)}},{key:"getMaterial",value:function(e){return new x.p(e)}},{key:"drop",value:function(){this.label&&this.label.drop(),S.a.selection.removeSelectableObject(this.threeObj),Object(j.a)(Object(u.a)(t.prototype),"drop",this).call(this)}},{key:"render",value:function(e){this.label&&(this.label.visible=S.a.settings.ui.showBodyLabels),this.setPosition(this.body.getPositionByEpoch(e)),this.threeObj.quaternion.copy(this.body.orientation.getQuaternionByEpoch(e).toThreejs())}}]),t}(D.a),F=function(e){function t(e,a){var i;return Object(n.a)(this,t),(i=Object(l.a)(this,Object(u.a)(t).call(this,e,a))).texturePath=a.texturePath,i.isTextureRequested=!1,i}return Object(h.a)(t,e),Object(i.a)(t,[{key:"getMaterial",value:function(e){return e.metalness=0,e.roughness=1,new x.p(e)}},{key:"render",value:function(e){var a=this;Object(j.a)(Object(u.a)(t.prototype),"render",this).call(this,e),!this.isTextureRequested&&this.texturePath&&this.shape.getMaxDimension()/this.threeObj.position.length()>this.pixelAngleSize&&(this.isTextureRequested=!0,S.a.textureLoader.load(D.a.texturePath+this.texturePath,function(e){a.threeObj&&(a.threeObj.material.dispose(),a.threeObj.material=a.getMaterial({map:e}))},void 0,function(e){console.log(e)}))}}]),t}(L),R=function(e){function t(e,a){var i;return Object(n.a)(this,t),(i=Object(l.a)(this,Object(u.a)(t).call(this,e,a))).light=new x.t(a.lightColor,a.lightIntensity,a.lightDistance||null,a.lightDecay||null),i.scene.add(i.light),i}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(e){Object(j.a)(Object(u.a)(t.prototype),"render",this).call(this,e),this.light.position.copy(S.a.getVisualCoords(this.body.getPositionByEpoch(e)))}},{key:"getMaterial",value:function(e){return new x.o(e)}},{key:"drop",value:function(){this.scene.remove(this.light),Object(j.a)(Object(u.a)(t.prototype),"drop",this).call(this)}}]),t}(F),q=function(e){function t(e,a){var i;return Object(n.a)(this,t),(i=Object(l.a)(this,Object(u.a)(t).call(this,e,a))).texturePath=a.texturePath,i.ringsRadius=a.ringsRadius,i.ringsColorMapPath=a.ringsColorMapPath,i.ringsAlphaMapPath=a.ringsAlphaMapPath,i.isTextureRequested=!1,i}return Object(h.a)(t,e),Object(i.a)(t,[{key:"getThreeObj",value:function(){var e=new x.q;return this.bodyThreeObj=new x.n(this.shape.getThreeGeometry(),this.getMaterial({color:this.color,wireframe:!0})),this.ringsThreeObj=new x.n(new x.e(140220,64),this.getMaterial({color:this.color,wireframe:!0})),e.add(this.bodyThreeObj),e.add(this.ringsThreeObj),e}},{key:"updateRingsMaterial",value:function(){this.ringsColorMap&&this.ringsAlphaMap&&(this.ringsThreeObj.material.dispose(),this.ringsThreeObj.material=this.getMaterial({map:this.ringsColorMap,alphaMap:this.ringsAlphaMap,side:x.g,transparent:!0}))}},{key:"getMaterial",value:function(e){return e.metalness=0,e.roughness=1,new x.p(e)}},{key:"render",value:function(e){var a=this;Object(j.a)(Object(u.a)(t.prototype),"render",this).call(this,e),!this.isTextureRequested&&this.texturePath&&this.shape.getMaxDimension()/this.threeObj.position.length()>this.pixelAngleSize&&(this.isTextureRequested=!0,S.a.textureLoader.load(D.a.texturePath+this.texturePath,function(e){a.bodyThreeObj.material.dispose(),a.bodyThreeObj.material=a.getMaterial({map:e})},void 0,function(e){console.log(e)}),S.a.textureLoader.load(D.a.texturePath+this.ringsColorMapPath,function(e){a.ringsColorMap=e,a.updateRingsMaterial()},void 0,function(e){console.log(e)}),S.a.textureLoader.load(D.a.texturePath+this.ringsAlphaMapPath,function(e){a.ringsAlphaMap=e,a.updateRingsMaterial()},void 0,function(e){console.log(e)}))}}]),t}(L),V=function(e){function t(e,a){var i;return Object(n.a)(this,t),(i=Object(l.a)(this,Object(u.a)(t).call(this))).radius=e,i.segments=a,i}return Object(h.a)(t,e),Object(i.a)(t,[{key:"getThreeGeometry",value:function(){return this.threeGeometry||(this.threeGeometry=new x.A(this.radius,2*this.segments,this.segments),this.threeGeometry.rotateX(Math.PI/2)),this.threeGeometry}},{key:"getMaxDimension",value:function(){return 2*this.radius}}]),t}(function(){function e(){Object(n.a)(this,e)}return Object(i.a)(e,[{key:"getThreeGeometry",value:function(){}},{key:"getMaxDimension",value:function(){}}]),e}()),U=a(10),z=a(46);a.d(t,"a",function(){return Y});var Y=function(){function e(){Object(n.a)(this,e)}return Object(i.a)(e,null,[{key:"loadFromConfig",value:function(e,t){e.name=t.name,e.mainObject=t.mainObject,e.addObject(z.a,new v.a(z.a,v.a.TYPE_POINT,"Star system barycenter"));var a=!0,n=!1,i=void 0;try{for(var r,s=t.objects[Symbol.iterator]();!(a=(r=s.next()).done);a=!0){var c=r.value;this._loadObject(e,c)}}catch(O){n=!0,i=O}finally{try{a||null==s.return||s.return()}finally{if(n)throw i}}U.a.dispatch(U.a.LOADING_BODIES_DONE),e.addReferenceFrame(o.b);var l=!0,u=!1,h=void 0;try{for(var d,m=t.referenceFrames[Symbol.iterator]();!(l=(d=m.next()).done);l=!0){var p=d.value;e.addReferenceFrame(o.d.create(p.id,p.type,p.config))}}catch(O){u=!0,h=O}finally{try{l||null==m.return||m.return()}finally{if(u)throw h}}U.a.dispatch(U.a.LOADING_FRAMES_DONE);var f=!0,y=!1,b=void 0;try{for(var g,E=t.objects[Symbol.iterator]();!(f=(g=E.next()).done);f=!0){var j=g.value;e.getObject(j.id).setTrajectory(C.create(j.trajectory))}}catch(O){y=!0,b=O}finally{try{f||null==E.return||E.return()}finally{if(y)throw b}}U.a.dispatch(U.a.LOADING_TRAJECTORIES_DONE),e.addStars(new B(t.stars))}},{key:"loadObjectByUrl",value:function(e,t){var a=this;s.a.getJSON(t,function(t){a._loadObject(e,t),e.getObject(t.id).setTrajectory(C.create(t.trajectory))})}},{key:"_loadObject",value:function(e,t){var a,n=null,i=null,r=null;if(t.visual){var s=new V(t.visual.config.radius,t.visual.config.texturePath?32:12),o={basic:F,light:R,rings:q}[t.visual.model];void 0!==o&&(n=new o(s,t.visual.config))}(t.physical||t.orientation)&&(t.orientation||(t.orientation={type:"constantAxis",config:{vector:[0,0,1e-11]}}),r=new("constantAxis"===t.orientation.type?p:S.a.getClass(t.orientation.type))(t.orientation.config));t.physical&&(i=new f(t.physical)),a=n||i||r?new c.a(t.id,t.type||v.a.TYPE_UNKNOWN,t.name,t.data,n,i,r):new v.a(t.id,t.type||v.a.TYPE_UNKNOWN,t.name,t.data),e.addObject(t.id,a)}}]),e}()},,,,,,,,,,,,,,,,,,,,function(e,t,a){e.exports=a(191)},function(e,t,a){var n={"./KSP/ModuleKSP":[98,2],"./KSP/ModuleKSP.js":[98,2],"./PatchedConics/FlightEvent/SOIArrival":[49],"./PatchedConics/FlightEvent/SOIArrival.js":[49],"./PatchedConics/FlightEvent/SOIChangeAbstract":[38],"./PatchedConics/FlightEvent/SOIChangeAbstract.js":[38],"./PatchedConics/FlightEvent/SOIDeparture":[48],"./PatchedConics/FlightEvent/SOIDeparture.js":[48],"./PatchedConics/ModulePatchedConics":[99,3],"./PatchedConics/ModulePatchedConics.js":[99,3],"./PatchedConics/PropagatorPatchedConics":[95,4],"./PatchedConics/PropagatorPatchedConics.js":[95,4],"./PatchedConics/visual/FlightEvent/SOIArrival":[53],"./PatchedConics/visual/FlightEvent/SOIArrival.js":[53],"./PatchedConics/visual/FlightEvent/SOIDeparture":[52],"./PatchedConics/visual/FlightEvent/SOIDeparture.js":[52],"./SolarSystem/ModuleSolarSystem":[93,0],"./SolarSystem/ModuleSolarSystem.js":[93,0],"./SolarSystem/Orientation/IAUModel":[94,5],"./SolarSystem/Orientation/IAUModel.js":[94,5],"./SolarSystem/Trajectory/ELP2000":[96,0],"./SolarSystem/Trajectory/ELP2000.js":[96,0],"./SolarSystem/Trajectory/VSOP87":[97,0],"./SolarSystem/Trajectory/VSOP87.js":[97,0]};function i(e){var t=n[e];return t?Promise.all(t.slice(1).map(a.e)).then(function(){var e=t[0];return a(e)}):Promise.resolve().then(function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t})}i.keys=function(){return Object.keys(n)},i.id=103,e.exports=i},,,,,function(e,t,a){},,,,function(e,t,a){},,function(e,t,a){var n={"./getting-started-wizard/index":[50,1]};function i(e){var t=n[e];return t?a.e(t[1]).then(function(){var e=t[0];return a(e)}):Promise.resolve().then(function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t})}i.keys=function(){return Object.keys(n)},i.id=114,e.exports=i},function(e,t,a){var n={"./getting-started-wizard":[50,1],"./getting-started-wizard/":[50,1],"./getting-started-wizard/getting-started-wizard-eng":[100,6],"./getting-started-wizard/getting-started-wizard-eng.js":[100,6],"./getting-started-wizard/getting-started-wizard-ru":[101,7],"./getting-started-wizard/getting-started-wizard-ru.js":[101,7],"./getting-started-wizard/index":[50,1],"./getting-started-wizard/index.js":[50,1],"./wizard-ids":[47],"./wizard-ids.js":[47]};function i(e){var t=n[e];return t?Promise.all(t.slice(1).map(a.e)).then(function(){var e=t[0];return a(e)}):Promise.resolve().then(function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t})}i.keys=function(){return Object.keys(n)},i.id=115,e.exports=i},,,,,,,,,,function(e,t,a){},,function(e,t,a){},,function(e,t,a){},,function(e,t,a){},,function(e,t,a){},,function(e,t,a){},,function(e,t,a){},,function(e,t,a){},,function(e,t,a){},,function(e,t,a){},,function(e,t,a){},,function(e,t,a){},,function(e,t,a){},,function(e,t,a){},,function(e,t,a){},,function(e,t,a){},,function(e,t,a){},,function(e,t,a){},,function(e,t,a){},,function(e,t,a){},,,,,,,,,,,,,,,,,,,,function(e,t,a){},,function(e,t,a){},,function(e,t,a){},,function(e,t,a){},,function(e,t,a){"use strict";a.r(t);var n=a(21),i=a(1),r=a(3),s=a(5),o=a(4),c=a(6),l=a(0),u=a.n(l),h=a(29),d=a.n(h),m=a(26),p=a(36),f=a(69);var v=a(34),y={SIMULATION:"Simulation",EDIT:"Edit",VIEW:"View",SETTINGS:"Settings",HELP:"Help"},b="https://github.com/tossha/urbain/wiki/%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5-Urbain";var g={NONE:0,LINK:1,DROPDOWN:2},E=function(){function e(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:g.NONE;Object(i.a)(this,e),this.label=t,this.type=a}return Object(r.a)(e,[{key:"isClickable",get:function(){return!0}}]),e}(),j=function(e){function t(e){var a,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.href,c=void 0===r?"":r,l=n.target,u=void 0===l?"_self":l;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(o.a)(t).call(this,e,g.LINK))).href=c,a.target=u,a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"isClickable",get:function(){return Boolean(this.href)}}]),t}(E),O=function(e){function t(e){var a,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return Object(i.a)(this,t),(a=Object(s.a)(this,Object(o.a)(t).call(this,e,g.DROPDOWN))).onSelect=function(e){a.options=a.options.map(function(t){var a=Object(v.a)({},t,{selected:e===t.label?!t.selected:t.selected});return e===t.label&&t.onUpdate&&t.onUpdate(a),a})},a.options=n,a}return Object(c.a)(t,e),t}(E),_=function(){function e(t,a){var n=this;Object(i.a)(this,e),this.viewSettings={showStatistics:!1,showBodyLabels:!0,showOrbitCreationPanel:!1,showTransferCalculationPanel:!1,showSatelliteSearchPanel:!1},this.topMenu=[new O(y.SIMULATION,[{label:"Orbit creation panel",selected:this.viewSettings.showOrbitCreationPanel,onUpdate:function(e){var t=e.selected;n.viewSettings.showOrbitCreationPanel=t}},{label:"Transfer calculation panel",selected:this.viewSettings.showTransferCalculationPanel,onUpdate:function(e){var t=e.selected;n.viewSettings.showTransferCalculationPanel=t}}]),new j(y.EDIT),new O(y.VIEW,[{label:"Body Labels",selected:this.viewSettings.showBodyLabels,onUpdate:function(e){var t=e.selected;n._simulation.settings.ui.showBodyLabels=t,n.viewSettings.showBodyLabels=t}},{label:"Statistics badge",selected:!1,onUpdate:function(e){var t=e.selected;n.viewSettings.showStatistics=t}},{label:"Satellite search panel",selected:this.viewSettings.showSatelliteSearchPanel,onUpdate:function(e){var t=e.selected;n.viewSettings.showSatelliteSearchPanel=t}}]),new j(y.HELP,{href:b,target:"_blank"})],this.loadSatellite=function(e){n._loadTLE(e)},this.unloadSatellite=function(e){n._simulation.starSystem.deleteObject(-(1e5+(0|e)))},this._simulation=t,this._loadTLE=a}return Object(r.a)(e,[{key:"starSystemSelectorSettings",get:function(){var e=this._simulation.starSystemManager;return{options:e.starSystems,defaultValue:e.defaultStarSystem,onSelect:function(t){return e.loadByIdx(t.idx)}}}}]),e}(),k=function(e){var t=u.a.createContext(e);return{Provider:t.Provider,Consumer:t.Consumer}}(),w=k.Provider,M=k.Consumer,S=a(83),T=a.n(S),A=(a(108),function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(s.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(r)))).elementRef=u.a.createRef(),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.elementRef.current.appendChild(this.props.stats.dom)}},{key:"componentWillUnmount",value:function(){this.elementRef=null}},{key:"render",value:function(){return u.a.createElement("div",{ref:this.elementRef,className:"statistics-badge"})}}]),t}(l.Component)),P=function(){return u.a.createElement(M,null,function(e){var t=e.store,a=e.stats;return t.viewSettings.showStatistics?u.a.createElement(A,{stats:a}):null})};var C=a(33),x=a.n(C),D=a(91),B=a(42),N=a(47),I=function(){function e(t){Object(i.a)(this,e),this._storage=t}return Object(r.a)(e,[{key:"canWatch",value:function(e){return!this._getWatchedWizards().some(function(t){return t===e})}},{key:"markAsWatched",value:function(e){if(this.canWatch(e)){var t=this._getWatchedWizards();t.push(e),this._saveStatuses(t)}}},{key:"_getWatchedWizards",value:function(){var t=this._storage.getItem(e.KEY);return t?JSON.parse(t):[]}},{key:"_saveStatuses",value:function(t){this._storage.setItem(e.KEY,JSON.stringify(t))}}]),e}();I.KEY="urbain-watched-wizards";var L=I;a(112);function F(e){var t=document.createElement("div");document.body.appendChild(t);return new Promise(function(a){Object(h.render)(u.a.createElement("div",{className:"language-selector-wrapper"},u.a.createElement("div",{className:"language-selector"},e.map(function(e){var n=e.id,i=e.description,r=e.buttonLabel;return u.a.createElement("div",{key:n,className:"language-selector__row"},u.a.createElement("span",{className:"language-selector__content"},i),u.a.createElement("button",{className:"language-selector__button",onClick:function(){t&&(Object(h.unmountComponentAtNode)(t),t.parentNode.removeChild(t),t=null),a(n)}},r))}))),t)})}var R=a(32),q=function(){function e(t,a){Object(i.a)(this,e),this._goalPrefix=t,this._durationPrefix=a,this._stepStartTimes={},this._metrika=window.yaCounter47040543}return Object(r.a)(e,[{key:"handleStep",value:function(e){if(this._metrika&&void 0===this._stepStartTimes[e]){var t=this._goalPrefix+e;if(this._stepStartTimes[e]=+new Date,0!==e){var a=this._durationPrefix+(e-1);this._metrika.reachGoal(t,Object(R.a)({},a,this._stepStartTimes[e]-this._stepStartTimes[e-1]))}else this._metrika.reachGoal(t)}}}]),e}();function V(){return(V=Object(B.a)(x.a.mark(function e(t){var n,i,r,s,o,c=arguments;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=c.length>1&&void 0!==c[1]?c[1]:new L(window.localStorage),i=c.length>2&&void 0!==c[2]?c[2]:new q("tutorial_","duration_tut_"),n.canWatch(t)){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,a(114)("./".concat(t,"/index"));case 6:return r=e.sent,s=r.default,i.handleStep(0),e.next=11,F(s.langs);case 11:o=e.sent,Promise.all([a(115)("./".concat(t,"/").concat(o)),Promise.all([a.e(12),a.e(9)]).then(a.bind(null,196)),a.e(10).then(a.t.bind(null,197,7))]).then(function(e){var a=Object(D.a)(e,2),r=a[0].default;(0,a[1].createIntroJs)(r,{onStep:function(){i.handleStep(this._currentStep+1)},onComplete:function(){i.handleStep(this._currentStep+2),n.markAsWatched(t)}}).start()}).catch(function(e){console.error(e.message)});case 13:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var U=a(11),z=a.n(U),Y=function(e){var t=e.className;return u.a.createElement("div",{className:t})},H=a(13),K=a.n(H),Q=a(45),G="var(--black)",W="var(--white-text)",X=24,Z={container:function(e){return Object(v.a)({},e,{background:G,color:W,minHeight:X,height:X,minWidth:50})},control:function(e){return Object(v.a)({},e,{background:G,borderRadius:0,borderStyle:"none",minHeight:X,height:X})},menu:function(e){return Object(v.a)({},e,{borderRadius:0,marginTop:0,marginBottom:0})},menuList:function(e){return Object(v.a)({},e,{background:"var(--dark-gray)"})},option:function(e,t){return Object(v.a)({},e,{backgroundColor:t.isFocused?"var(--gray)":"transparent"})},singleValue:function(e,t){var a=t.isDisabled?.5:1;return Object(v.a)({},e,{color:W,opacity:a,transition:"opacity 300ms"})},dropdownIndicator:function(){return{padding:0,background:'url("/images/chevron-down-solid.svg") 0 0 no-repeat',marginRight:5,height:10,width:10}},indicatorSeparator:function(){return{display:"none"}}},J=function(e){return Q.a.IndicatorsContainer&&u.a.createElement(Q.a.IndicatorsContainer,e)},$=function(e){return Q.a.DropdownIndicator&&u.a.createElement(Q.a.DropdownIndicator,e,u.a.createElement("span",null))},ee=(K.a.shape({label:K.a.string,value:K.a.string}),function(e){var t=e.id,a=e.className,n=e.options,i=e.value,r=e.onSelect,s=void 0===r?function(){}:r;return u.a.createElement(Q.b,{id:t,className:a,classNamePrefix:"select",placeholder:"",styles:Z,isSearchable:!1,options:n,defaultValue:i,components:{IndicatorsContainer:J,DropdownIndicator:$},onChange:s})});a(125);function te(e){var t=e.options,a=e.defaultValue,n=e.onSelect;return u.a.createElement("div",{className:"star-system-selector"},u.a.createElement("div",{className:"star-system-selector__label"},"Star system"),u.a.createElement(ee,{className:"star-system-selector__selector",options:t,value:a||t[0],onSelect:n}))}var ae=function(){return u.a.createElement(M,null,function(e){var t=e.store.starSystemSelectorSettings,a=t.options,n=t.defaultValue,i=t.onSelect;return u.a.createElement(te,{options:a,defaultValue:n,onSelect:i})})},ne=(a(127),a(24)),ie=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(s.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(r)))).handleClick=function(){a.props.onClick(a.props.text)},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.text,a=e.selected;return u.a.createElement("li",{className:"drop-down-menu__menu-item",onClick:this.handleClick},u.a.createElement("span",{className:"drop-down-menu__menu-item-icon"},a&&u.a.createElement(ne.a,{icon:"check"})),t)}}]),t}(l.Component),re=(a(129),function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(s.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(r)))).handleSelect=function(e){var t=a.props,n=t.store,i=t.updateStore,r=t.text;n.topMenu.find(function(e){return e.label===r}).onSelect(e),i(n)},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.text,n=t.options,i=n.length>0;return u.a.createElement("ul",{className:"drop-down-menu"},u.a.createElement("li",null,u.a.createElement("span",{className:"drop-down-menu__toggler"},a,i&&u.a.createElement(ne.a,{className:"drop-down-menu__caret",icon:"chevron-down"})),i&&u.a.createElement("ul",{className:"drop-down-menu__menu"},n.map(function(t){var a=t.label,n=t.selected,i=t.onClick;return u.a.createElement(ie,{key:a,selected:n,text:a,onClick:i||e.handleSelect})}))))}}]),t}(l.Component)),se=function(e){return u.a.createElement(M,null,function(t){var a=t.store,n=t.updateStore,i=a.topMenu.find(function(t){return t.label===e.text}),r=i?i.options:[];return u.a.createElement(re,Object.assign({},e,{store:a,updateStore:n,options:r}))})},oe=function(e){var t=e.text,a=e.href,n=e.className,i=void 0===n?"":n,r=e.target,s=void 0===r?"_self":r;return u.a.createElement("a",{className:"main-menu__link ".concat(i),href:a,target:s},t)};function ce(e){var t=e.menuItem,a=e.clickable;return u.a.createElement("div",{className:"main-menu__item"},u.a.createElement("div",{className:z()(a&&"main-menu__clickable-zone")},t.type===g.LINK&&u.a.createElement(oe,Object.assign({text:t.label},t)),t.type===g.DROPDOWN&&u.a.createElement(se,Object.assign({text:t.label},t))))}var le=function(){return u.a.createElement("nav",{className:"main-menu"},u.a.createElement(M,null,function(e){return e.store.topMenu.map(function(e){return u.a.createElement(ce,{key:e.label,menuItem:e,clickable:e.isClickable})})}))},ue=(a(131),function(e){var t=e.className;return u.a.createElement("header",{className:z()(t,"header","noselect")},u.a.createElement("div",{className:"header__logo-wrapper"},u.a.createElement(Y,{className:"header__logo"})),u.a.createElement("div",{className:"header__top-menu"},u.a.createElement(le,null)),u.a.createElement("div",{className:"header__star-system-selector"},u.a.createElement(ae,null)))}),he=(a(133),function(e){var t=e.className,a=(e.right,e.children);return u.a.createElement("aside",{className:z()(t,"side-bar")},a)}),de=(a(135),function(e){var t=e.id,a=e.className,n=e.children,i=e.small,r=void 0!==i&&i,s=e.disabled,o=void 0!==s&&s,c=e.onClick,l=void 0===c?function(){}:c;return u.a.createElement("button",{id:t,type:"button",className:z()("button",{"button--disabled":o,"button--small":r},a),onClick:l,disabled:o},n)});a(137);function me(e){var t=e.direction,a=z()("arrow-logo","arrow-logo--to-".concat(t));return u.a.createElement("svg",{className:a,role:"img",width:"10",height:"8",viewBox:"0 0 10 8",fill:"none",xmlns:"http://www.w3.org/2000/svg"},u.a.createElement("path",{d:"M1.50359 3.64645C1.30833 3.84171 1.30833 4.15829 1.50359 4.35355L4.68557 7.53553C4.88083 7.7308 5.19741 7.7308 5.39268 7.53553C5.58794 7.34027 5.58794 7.02369 5.39268 6.82843L2.56425 4L5.39268 1.17157C5.58794 0.97631 5.58794 0.659728 5.39268 0.464466C5.19741 0.269204 4.88083 0.269203 4.68557 0.464466L1.50359 3.64645ZM1.5 8V0H0.5V8H1.5ZM10 3.5L1.85714 3.5L1.85714 4.5L10 4.5L10 3.5Z",fill:"#8F9193"}))}var pe=function(){return u.a.createElement("svg",{role:"img",width:"10",height:"8",viewBox:"0 0 10 8",fill:"none",xmlns:"http://www.w3.org/2000/svg"},u.a.createElement("path",{d:"M3 3V1H9V5H7M7 5V7H1V3H7V5Z",stroke:"#8F9193",strokeWidth:"0.5"}))},fe=function(e){var t=e.isCollapsed,a=e.onClick,n=(e.isToRight,e.className),i=void 0===n?"":n,r=e.collapseDirection,s=void 0===r?"left":r;return u.a.createElement(de,{className:i,onClick:a,small:!0},t?u.a.createElement(pe,null):u.a.createElement(me,{direction:s}))},ve=function(e){var t=e.className,a=e.leftAligned,n=void 0!==a&&a,i=e.centered,r=void 0!==i&&i,s=e.children;return u.a.createElement("div",{className:z()("panel__field",{"panel__field--left-aligned":n,"panel__field--centered":r},t)},s)},ye=function(e){var t=e.id,a=e.className,n=e.tag,i=void 0===n?"span":n,r=e.normal,s=void 0===r||r,o=e.middle,c=void 0!==o&&o,l=e.small,h=void 0!==l&&l,d=e.children;return u.a.createElement(i,{id:t,className:z()("panel__field-label",{"panel__field-label--normal":s,"panel__field-label--middle":c,"panel__field-label--small":h},a)},d)},be=function(e){var t=e.id,a=e.className,n=e.fullSize,i=void 0!==n&&n,r=e.children;return u.a.createElement("span",{id:t,className:z()("panel__field-control",{"panel__field-control--full-size":i},a)},r)},ge=function(e){var t=e.id,a=e.className,n=e.children;return u.a.createElement(de,{className:z()("panel__button",a),id:t},n)},Ee=function(e){var t=e.className,a=e.children;return u.a.createElement("span",{className:z()("panel__field-set",t)},a)},je=function(e){var t=e.id,a=e.className,n=e.children;return u.a.createElement("span",{id:t,className:z()("panel__dimension",a)},n)},Oe=(a(139),function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(s.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(r)))).state={isCollapsed:a.props.collapsedByDefault},a.handleToggle=function(){a.setState(function(e){return{isCollapsed:!e.isCollapsed}})},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.props,t=e.id,a=e.className,n=e.caption,i=e.hideCollapseButton,r=e.children,s=e.titleIcon,o=e.hidden,c=e.collapseDirection,l=this.state.isCollapsed,h=z()("panel","noselect",{"panel--hidden":o,"panel--collapsed":l},a);return u.a.createElement("div",{id:t,className:h},u.a.createElement("div",{className:"panel__header"},u.a.createElement("div",{className:"panel__caption"},s&&u.a.createElement("span",{className:"panel__caption-icon"},s),u.a.createElement("span",{className:"panel__caption-text"},n)),!i&&u.a.createElement(fe,{className:"panel__collapse-button",onClick:this.handleToggle,isCollapsed:l,collapseDirection:c})),u.a.createElement("div",{style:{display:l?"none":"block"},className:"panel__content"},r))}}]),t}(l.Component));Oe.defaultProps={caption:"",hideCollapseButton:!1,className:"",id:"",collapsedByDefault:!1,hidden:!1,collapseDirection:"left"};a(141);var _e=function(e){var t=e.className;return u.a.createElement(Oe,{id:"cameraPanel",className:"camera-panel ".concat(t),caption:"Camera",titleIcon:u.a.createElement(ne.a,{icon:"expand"}),collapseDirection:"right"},u.a.createElement(ve,{className:"camera-panel__field"},u.a.createElement(ye,null,"Target"),u.a.createElement(be,null,u.a.createElement("select",{className:"camera-panel__field-control",id:"targetSelect"}))),u.a.createElement(ve,{className:"camera-panel__field"},u.a.createElement(ye,null,"Frame type"),u.a.createElement(be,null,u.a.createElement("select",{className:"camera-panel__field-control",id:"rfTypeSelect"}))))};a(143);var ke=function(e){var t=e.className;return u.a.createElement("canvas",{className:"time-line ".concat(t),id:"timeLineCanvas"})},we=(a(145),function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(s.a)(this,Object(o.a)(t).call(this,e))).state={isTimeRunning:!0},a.handleClick=function(){var e=n.c.time;e&&e.togglePause()},document.addEventListener(n.a.TIME_PAUSED,function(){a.setState({isTimeRunning:!1})}),document.addEventListener(n.a.TIME_UNPAUSED,function(){a.setState({isTimeRunning:!0})}),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.state.isTimeRunning;return u.a.createElement("div",{role:"button",className:z()("pause-button","noselect",{"pause-button--paused":!e},this.props.className),onClick:this.handleClick},u.a.createElement("div",null,u.a.createElement(ne.a,{className:"pause-button__icon",icon:e?"pause":"play"})),u.a.createElement("div",null,e?"Pause":"Resume"))}}]),t}(l.Component)),Me=function(e){var t=e.className;return u.a.createElement("svg",{className:t,role:"img",width:"4",height:"9",viewBox:"0 0 4 9",fill:"none",xmlns:"http://www.w3.org/2000/svg"},u.a.createElement("path",{d:"M3.71197 2.33602L3.58397 3.42402H2.35197L1.96797 6.14402C1.92531 6.38936 1.92531 6.57069 1.96797 6.68802C2.01064 6.80536 2.11731 6.86402 2.28797 6.86402C2.46931 6.86402 2.62397 6.84269 2.75197 6.80002C2.87997 6.74669 2.96531 6.71469 3.00797 6.70402V7.76002C2.96531 7.77069 2.90131 7.79736 2.81597 7.84002C2.73064 7.88269 2.63464 7.92536 2.52797 7.96802C2.26131 8.08536 1.96264 8.14402 1.63197 8.14402C1.11997 8.14402 0.773306 8.01069 0.591973 7.74402C0.410639 7.46669 0.362639 7.00269 0.447973 6.35202L0.879973 3.42402H0.271973L0.415973 2.33602H1.02397L1.21597 0.976023L2.73597 0.736023L2.49597 2.33602H3.71197Z",fill:"#A1A1A3"}))};a(147);var Se=function(e){var t=e.className;return u.a.createElement(Oe,{className:"time-settings-panel ".concat(t),id:"timePanel",caption:"Time",titleIcon:u.a.createElement(Me,{className:"time-settings-panel__logo"})},u.a.createElement(ve,null,u.a.createElement(ye,{middle:!0},"Current"),u.a.createElement(be,null,u.a.createElement("time",{id:"currentDateValue"},"01.01.2000 12:00:00")),u.a.createElement(ge,{id:"useCurrentTime"},"Now")),u.a.createElement(ve,null,u.a.createElement(ye,{middle:!0},"Rate"),u.a.createElement(be,{id:"timeScaleValue"}),u.a.createElement(ge,{id:"setRealTimeScale"},"Real")),u.a.createElement(ve,{centered:!0},u.a.createElement(be,{fullSize:!0},u.a.createElement("input",{id:"timeScaleSlider",type:"range",className:"time-settings-panel__scale-slider",min:"-1",max:"1",step:"0.001",defaultValue:"0.001",style:{width:"100%"}}))))};a(149);var Te=function(e){var t=e.className;return u.a.createElement("div",{className:z()(t,"bottom-panel")},u.a.createElement(Se,{className:"bottom-panel__time-settings-panel"}),u.a.createElement(we,{className:"bottom-panel__pause-button"}),u.a.createElement("div",{className:"bottom-panel__time-line-container"},u.a.createElement(ke,{className:"bottom-panel__time-line"})),u.a.createElement(_e,{className:"bottom-panel__camera-panel"}),u.a.createElement(P,null))},Ae=function(e){var t=e.className;return u.a.createElement(M,null,function(e){var a=e.store;return u.a.createElement(Oe,{className:t,id:"creationPanel",caption:"Orbit creation",hidden:!a.viewSettings.showOrbitCreationPanel},u.a.createElement(ve,null,u.a.createElement(ye,null,"Create Orbit"),u.a.createElement(ge,{id:"createOrbit"},"Create")))})},Pe=(a(151),function(e){var t=e.className;return u.a.createElement(M,null,function(e){var a=e.store;return u.a.createElement(Oe,{className:z()(t,"transfer-calculation-panel"),id:"lambertPanel",caption:"Transfer calculation",hidden:!a.viewSettings.showTransferCalculationPanel},u.a.createElement(Ee,null,u.a.createElement(ve,null,u.a.createElement(ye,null,"Origin"),u.a.createElement(be,null,u.a.createElement("select",{className:"transfer-calculation-panel__select",id:"originSelect"}))),u.a.createElement(ve,null,u.a.createElement(ye,null,"Target"),u.a.createElement(be,null,u.a.createElement("select",{className:"transfer-calculation-panel__select",id:"targetSelect"}))),u.a.createElement(ve,null,u.a.createElement(ye,null,"Transfer type"),u.a.createElement(be,null,"Ballistic")),u.a.createElement(ve,null,u.a.createElement(ye,null,"Departure"),u.a.createElement(be,null,u.a.createElement("time",{id:"departureDateValue"},"01.01.2000 12:00:00")),u.a.createElement(ge,{id:"useCurrentTime"},"Now")),u.a.createElement(ve,null,u.a.createElement(ye,null,"Transfer time"),u.a.createElement(be,{id:"transferTimeValue"})),u.a.createElement(ve,null,u.a.createElement(be,{fullSize:!0},u.a.createElement("input",{id:"transferTimeSlider",type:"range",min:"0",max:"1",step:"0.001",defaultValue:"0.5",style:{width:"100%"}})))),u.a.createElement(Ee,{className:"transfer-calculation-panel__delta-v-calc ","data-panel-name":"lambert"},u.a.createElement(ve,{className:"panel__field-header"},"Delta-V"),u.a.createElement(ve,null,u.a.createElement(ye,null,"Ejection"),u.a.createElement(be,{id:"deltaVEjection"},"0"),u.a.createElement(je,null,"km/s")),u.a.createElement(ve,null,u.a.createElement(ye,null,"Insertion"),u.a.createElement(be,{id:"deltaVInsertion"},"0"),u.a.createElement(je,null,"km/s")),u.a.createElement(ve,null,u.a.createElement(ye,null,"Total"),u.a.createElement(be,{id:"deltaVTotal"},"0"),u.a.createElement(je,null,"km/s"))))})});a(153);function Ce(e){var t=e.className,a=void 0===t?"":t;return u.a.createElement("div",{className:z()(a,"keplerian-view")},u.a.createElement("div",{className:"keplerian-view__column"},u.a.createElement("div",{className:"keplerian-view__field"},u.a.createElement(ye,{className:"keplerian-view__field-label"},"Ecc"),u.a.createElement(be,{id:"elements-ecc"}),u.a.createElement(je,null)),u.a.createElement("div",{className:"keplerian-view__field"},u.a.createElement(ye,{className:"keplerian-view__field-label"},"SMA"),u.a.createElement(be,{id:"elements-sma"}),u.a.createElement(je,null,"km")),u.a.createElement("div",{className:"keplerian-view__field"},u.a.createElement(ye,{className:"keplerian-view__field-label"},"Inc"),u.a.createElement(be,{id:"elements-inc"}),u.a.createElement(je,null,"deg.")),u.a.createElement("div",{className:"keplerian-view__field"},u.a.createElement(ye,{className:"keplerian-view__field-label"},"AoP"),u.a.createElement(be,{id:"elements-aop"}),u.a.createElement(je,null,"deg."))),u.a.createElement("div",{className:"keplerian-view__column"},u.a.createElement("div",{className:"keplerian-view__field"},u.a.createElement(ye,{className:"keplerian-view__field-label"},"RAAN"),u.a.createElement(be,{id:"elements-raan"}),u.a.createElement(je,null,"deg.")),u.a.createElement("div",{className:"keplerian-view__field"},u.a.createElement(ye,{className:"keplerian-view__field-label"},"TA"),u.a.createElement(be,{id:"elements-ta"}),u.a.createElement(je,null,"deg.")),u.a.createElement("div",{className:"keplerian-view__field"},u.a.createElement(ye,{className:"keplerian-view__field-label"},"Period"),u.a.createElement(be,{id:"elements-period"}),u.a.createElement(je,null,"days"))))}a(155);var xe=function(e){var t=e.className,a=e.label,n=void 0===a?"x":a,i=e.valueClassName,r=void 0===i?"vec-x":i,s=e.dimension,o=void 0===s?"km":s;return u.a.createElement("div",{className:z()(t,"vector-component")},u.a.createElement(ye,{className:"vector-component__label"},n),u.a.createElement(be,{className:r}),u.a.createElement(je,null,o))};a(157);var De=function(e){var t=e.className,a=e.onClick,n=e.expanded,i=void 0!==n&&n;return u.a.createElement(de,{className:z()(t,"expand-button",{"expand-button--expanded":i}),onClick:a},u.a.createElement(ne.a,{className:"expand-button__icon",icon:"chevron-down"}))},Be=(a(159),function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(s.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(r)))).state={isExpanded:a.props.isExpanded},a.handleToggle=function(){a.setState(function(e){return{isExpanded:!e.isExpanded}})},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this.state.isExpanded,t=this.props,a=t.className,n=t.vectorMagnitudeLabel,i=t.dimension;return u.a.createElement(ve,{className:z()(a,"cartesian-vector-view")},u.a.createElement("div",{className:"cartesian-vector-view__header"},u.a.createElement(xe,{label:n,valueClassName:"vec-magnitude",dimension:i}),u.a.createElement(De,{className:"cartesian-vector-view__expand-button",expanded:e,onClick:this.handleToggle})),u.a.createElement("div",{className:z()("cartesian-vector-view__vector-components",{hidden:!e})},u.a.createElement(xe,{label:"x",valueClassName:"vec-x",dimension:i}),u.a.createElement(xe,{label:"y",valueClassName:"vec-y",dimension:i}),u.a.createElement(xe,{label:"z",valueClassName:"vec-z",dimension:i})))}}]),t}(l.Component));Be.defaultProps={isExpanded:!1};var Ne=Be,Ie=(a(161),function(){return u.a.createElement(Oe,{id:"metricsPanel",className:"metrics-panel",caption:"Metrics",titleIcon:u.a.createElement(ne.a,{icon:"bars"}),collapseDirection:"right"},u.a.createElement("div",{className:"metrics-panel__content"},u.a.createElement(Ee,null,u.a.createElement(ve,null,u.a.createElement(ye,null,"Object"),u.a.createElement(be,{id:"metricsOf"})),u.a.createElement(ve,null,u.a.createElement(ye,null,"Relative to"),u.a.createElement(be,{id:"relativeTo"}))),u.a.createElement(Ee,null,u.a.createElement(ve,{leftAligned:!0},u.a.createElement(ye,{tag:"label"},u.a.createElement("input",{className:"metrics-panel__angles-checker",type:"checkbox",id:"showAnglesOfSelectedOrbit",defaultChecked:!0}),"Show angles"),u.a.createElement("button",{className:"metrics-panel__unload-object-button",type:"button",id:"unloadObject"},"Unload object"))),u.a.createElement(Ee,null,u.a.createElement(ve,{className:"panel__field-header"},"Main"),u.a.createElement(ve,null,u.a.createElement(ye,null,"Orbit"),u.a.createElement(be,{id:"elements-orbit-alt"}),u.a.createElement(je,null,"km")),u.a.createElement(ve,null,u.a.createElement(ye,null,"Avg height"),u.a.createElement(be,{id:"elements-orbit-avg"}),u.a.createElement(je,null,"km")),u.a.createElement(ve,null,u.a.createElement(ye,null,"Altitude"),u.a.createElement(be,{id:"elements-alt"}),u.a.createElement(je,null,"km")),u.a.createElement(ve,null,u.a.createElement(ye,null,"Speed"),u.a.createElement(be,{id:"elements-speed"}),u.a.createElement(je,null,"m/s")),u.a.createElement(ve,null,u.a.createElement(ye,null,"Precession"),u.a.createElement(be,{id:"elements-precession"}),u.a.createElement(je,null,"deg/day")),u.a.createElement(ve,{id:"row-node-time",style:{display:"none"}},u.a.createElement(ye,null,"Node local time"),u.a.createElement(be,{id:"elements-node-time"}),u.a.createElement(je,null))),u.a.createElement(Ee,null,u.a.createElement(ve,{className:"panel__field-header"},"Keplerian"),u.a.createElement(Ce,{className:"panel__field"})),u.a.createElement(Ee,null,u.a.createElement(ve,{className:"panel__field-header"},"Cartesian"),u.a.createElement(Ne,{className:"metrics-panel__cartesian-position-vector js-metrics-panel-cartesian-position-vector",vectorMagnitudeLabel:"Position",dimension:"km"}),u.a.createElement(Ne,{className:"metrics-panel__cartesian-velocity-vector js-metrics-panel-cartesian-velocity-vector",vectorMagnitudeLabel:"Velocity",dimension:"km/s"}))))}),Le=(a(163),function(e){var t=e.className;return u.a.createElement(Oe,{id:"maneuverPanel",className:"maneuver-panel ".concat(t),caption:"Maneuver",collapseDirection:"left"},u.a.createElement("div",{className:"maneuver-panel__content"},u.a.createElement(Ee,null,u.a.createElement(ve,{centered:!0},u.a.createElement(de,{className:"maneuver-panel__button",id:"prev-burn"},"Prev burn"),u.a.createElement(ye,{id:"burn-name"}),u.a.createElement(de,{className:"maneuver-panel__button",id:"next-burn"},"Next burn"))),u.a.createElement(Ee,null,u.a.createElement(ve,{className:"panel__field-header"},"Increment"),u.a.createElement(ve,{centered:!0},u.a.createElement(ye,{small:!0,id:"increment"}),u.a.createElement(be,{className:"maneuver-panel__buttons"},u.a.createElement(de,{className:"maneuver-panel__button",id:"incr001"},"0.01"),u.a.createElement(de,{className:"maneuver-panel__button",id:"incr01"},"0.1"),u.a.createElement(de,{className:"maneuver-panel__button",id:"incr1"},"1"),u.a.createElement(de,{className:"maneuver-panel__button",id:"incr10"},"10"),u.a.createElement(de,{className:"maneuver-panel__button",id:"incr100"},"100"),u.a.createElement(de,{className:"maneuver-panel__button",id:"incr1000"},"1000")))),u.a.createElement(Ee,null,u.a.createElement(ve,{className:"panel__field-header"},"Time"),u.a.createElement(ve,null,u.a.createElement(ye,null,"Date"),u.a.createElement(be,{id:"burn-date"})),u.a.createElement(ve,{centered:!0},u.a.createElement(ye,null,"Epoch"),u.a.createElement(be,{id:"burn-epoch"}),u.a.createElement("span",{className:"maneuver-panel__buttons"},u.a.createElement(de,{className:"maneuver-panel__button",id:"epoch-minus"},"-"),u.a.createElement(de,{className:"maneuver-panel__button",id:"epoch-plus"},"+")))),u.a.createElement(Ee,null,u.a.createElement(ve,{className:"panel__field-header"},"Impulse"),u.a.createElement(ve,{centered:!0},u.a.createElement(ye,null,"Prograde"),u.a.createElement(be,{id:"burn-prograde"}),u.a.createElement(je,null,"m/s"),u.a.createElement("span",{className:"maneuver-panel__buttons"},u.a.createElement(de,{className:"maneuver-panel__button",id:"prograde-zero"},"0"),u.a.createElement(de,{className:"maneuver-panel__button",id:"prograde-minus"},"-"),u.a.createElement(de,{className:"maneuver-panel__button",id:"prograde-plus"},"+"))),u.a.createElement(ve,{centered:!0},u.a.createElement(ye,null,"Normal"),u.a.createElement(be,{id:"burn-normal"}),u.a.createElement(je,null,"m/s"),u.a.createElement("span",{className:"maneuver-panel__buttons"},u.a.createElement(de,{className:"maneuver-panel__button",id:"normal-zero"},"0"),u.a.createElement(de,{className:"maneuver-panel__button",id:"normal-minus"},"-"),u.a.createElement(de,{className:"maneuver-panel__button",id:"normal-plus"},"+"))),u.a.createElement(ve,{centered:!0},u.a.createElement(ye,null,"Radial"),u.a.createElement(be,{id:"burn-radial"}),u.a.createElement(je,null,"m/s"),u.a.createElement("span",{className:"maneuver-panel__buttons"},u.a.createElement(de,{className:"maneuver-panel__button",id:"radial-zero"},"0"),u.a.createElement(de,{className:"maneuver-panel__button",id:"radial-minus"},"-"),u.a.createElement(de,{className:"maneuver-panel__button",id:"radial-plus"},"+"))),u.a.createElement(ve,null,u.a.createElement(ye,null,"Total"),u.a.createElement(be,{id:"burn-total"}),u.a.createElement(je,null,"m/s")))))});var Fe=function e(t){var a;Object(i.a)(this,e),Object.assign(this,{noradId:(a=t).norad_id,objectType:a.object_type,intlDes:a.intl_des,name:a.name,country:a.country,launchDate:a.launch_date,decayDate:a.decay_date,launchSite:a.launch_site,period:a.period,inc:a.inc,apogee:a.apogee,perigee:a.perigee,launchYear:a.launch_year,launchNum:a.launch_num,launchPiece:a.launch_piece,objectName:a.object_name,objectId:a.object_id,objectNumber:a.object_number},{})},Re=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(s.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(r)))).state={isLoaded:!1},a.handleLoad=function(){a.props.onLoad(a.props.satelliteId),a.setState({isLoaded:!0})},a.handleUnload=function(){a.props.onUnload(a.props.satelliteId),a.setState({isLoaded:!1})},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return this.state.isLoaded?u.a.createElement(de,{text:"Unload",onClick:this.handleUnload}):u.a.createElement(de,{text:"Load",onClick:this.handleLoad})}}]),t}(l.Component),qe=function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this;return u.a.createElement("div",{className:"satellites-grid-container"},u.a.createElement("table",{className:"satellites-grid"},u.a.createElement("thead",{className:"satellites-grid__head"},u.a.createElement("tr",null,u.a.createElement("th",{className:"satellites-grid__pos-column"},"#"),u.a.createElement("th",{className:"satellites-grid__id-column"},"ID"),u.a.createElement("th",{className:"satellites-grid__name-column"},"Name"),u.a.createElement("th",{className:"satellites-grid__designator-column"},"Designator"),u.a.createElement("th",{className:"satellites-grid__launch-date-column"},"Launch date"),u.a.createElement("th",{className:"satellites-grid__command-column"}))),u.a.createElement("tbody",null,this.props.satellites.map(function(t,a){var n=t.noradId,i=t.name,r=t.launchDate,s=t.intlDes;return u.a.createElement("tr",{key:n},u.a.createElement("td",null,a),u.a.createElement("td",null,n),u.a.createElement("td",null,i),u.a.createElement("td",null,s),u.a.createElement("td",null,r),u.a.createElement("td",null,u.a.createElement(Re,{satelliteId:n,onLoad:e.props.onSatelliteLoad,onUnload:e.props.onSatelliteUnload})))}))))}}]),t}(u.a.Component),Ve=a(87),Ue=a.n(Ve),ze="/api/";function Ye(e,t){return He.apply(this,arguments)}function He(){return(He=Object(B.a)(x.a.mark(function e(t,a){var n,i,r;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={},t&&(n["fields[norad_id][value]"]=t,n["fields[norad_id][relation]"]="="),a&&(n["fields[launch_date][value]"]=a,n["fields[launch_date][relation]"]="="),e.next=6,Ue.a.get(ze,{params:n});case 6:if("ok"!==(i=e.sent).data.status){e.next=12;break}return r=i.data.result,e.abrupt("return",{totalRows:r.total_rows,satellites:r.satellites});case 12:if("error"!==i.data.status){e.next=15;break}return alert(i.data.message),e.abrupt("return",{totalRows:1,satellites:[]});case 15:throw new Error("Unknown status code");case 18:e.prev=18,e.t0=e.catch(0),console.error(e.t0);case 21:case"end":return e.stop()}},e,this,[[0,18]])}))).apply(this,arguments)}a(183);var Ke=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(s.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(r)))).state={satId:"",launchDate:"",satellites:[]},a.handleSatIdChange=function(e){var t=e.target.value;a.setState({satId:t})},a.handleLaunchDateChange=function(e){var t=e.target.value;a.setState({launchDate:t})},a.handleSearch=Object(B.a)(x.a.mark(function e(){var t,n;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ye(a.state.satId,a.state.launchDate);case 3:t=e.sent,n=t.satellites,a.setState({satellites:n.map(function(e){return new Fe(e)})}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}},e,this,[[0,8]])})),a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this,t=this.props.className,a=this.state,n=a.satellites,i=a.satId,r=a.launchDate;return u.a.createElement(M,null,function(a){var s=a.store;return u.a.createElement(Oe,{className:z()("satellite-search-panel",t),caption:"Satellite search panel",hidden:!s.viewSettings.showSatelliteSearchPanel,collapseDirection:"right"},u.a.createElement("div",null,u.a.createElement("div",{className:"panel__field-set"},u.a.createElement("div",{className:"panel__field panel__field--left-aligned"},u.a.createElement("div",{className:"satellite-search-panel__searcher searcher"},u.a.createElement("div",{className:"searcher__filter"},u.a.createElement("div",{className:"searcher__column"},u.a.createElement("label",null,"Satellite Catalog Number",u.a.createElement("input",{className:"searcher__input",type:"number",value:i,step:1,placeholder:"NORAD ID",min:"1",onChange:e.handleSatIdChange}))),u.a.createElement("div",{className:"searcher__column"},u.a.createElement("label",null,"Launch date",u.a.createElement("input",{className:"searcher__input",type:"text",placeholder:"YYYY-MM-DD",value:r,onChange:e.handleLaunchDateChange})))),u.a.createElement("div",{className:"searcher__search-button-wrapper"},u.a.createElement(de,{className:"searcher__search-button",disabled:!e.isFilterValid,onClick:e.handleSearch},"search"))))),n.length>0&&u.a.createElement("div",{className:"panel__field-set"},u.a.createElement("div",{className:"panel__field panel__field-header"},"Satellites"),u.a.createElement("div",{className:"panel__field"},u.a.createElement(qe,{satellites:n,onSatelliteLoad:s.loadSatellite,onSatelliteUnload:s.unloadSatellite})))))})}},{key:"isFilterValid",get:function(){return Boolean(this.state.satId)||Boolean(this.state.launchDate)}}]),t}(u.a.Component),Qe=(a(185),function(e){var t=e.className;return u.a.createElement("main",{className:z()("main-view",t)},u.a.createElement("div",{id:"viewport-id",className:"main-view__viewport-container"}),u.a.createElement(he,{className:"main-view__left-side-bar"},u.a.createElement(Ae,{className:"main-view__creation-panel"}),u.a.createElement(Le,{className:"main-view__maneuver-panel"}),u.a.createElement(Pe,{className:"main-view__transfer-calculation-panel"})),u.a.createElement(he,{className:"main-view__right-side-bar",right:!0},u.a.createElement(Ie,null)),u.a.createElement(Ke,{className:"main-view__satellite-search-panel"}),u.a.createElement(Te,{className:"main-view__bottom-panel"}))}),Ge=a(88),We=a(89),Xe=(a(187),function(e){var t=e.className;return u.a.createElement("footer",{id:"app-footer",className:z()("footer",t)},u.a.createElement("div",{className:"footer__wrapper"},u.a.createElement("span",{className:"footer__description"},"\xa9 2016\u2013",(new Date).getFullYear()," Urbain - Traversing the Solar System"),u.a.createElement("span",{className:"footer__social-links"},u.a.createElement("a",{className:"footer__social-link",href:"https://github.com/tossha/urbain",target:"_blank",rel:"noopener noreferrer"},u.a.createElement(ne.a,{className:"footer__social-link-logo",icon:Ge})),u.a.createElement("a",{className:"footer__social-link",href:"https://t.me/more_yasnosti_chat",target:"_blank",rel:"noopener noreferrer"},u.a.createElement(ne.a,{className:"footer__social-link-logo",icon:We})))))}),Ze=(a(189),function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){!function(e){V.apply(this,arguments)}(N.GETTING_STARTED_WIZARD)}},{key:"render",value:function(){return u.a.createElement(u.a.Fragment,null,u.a.createElement(ue,{className:"app-layout__header"}),u.a.createElement(Qe,{className:"app-layout__main"}),u.a.createElement(Xe,{className:"app-layout__footer"}))}}]),t}(u.a.Component));m.b.add(p.d),m.b.add(p.f),m.b.add(p.e),m.b.add(p.c),m.b.add(p.b),m.b.add(p.a),m.b.add(f.a),m.b.add(f.b);var Je=function(){var e=new T.a;return e.dom.classList.add("stats-badge"),e}(),$e=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(s.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(r)))).state={stats:Je,store:a.props.store,updateStore:function(e){a.setState({store:e})}},a}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return u.a.createElement(w,{value:this.state},u.a.createElement(Ze,null))}}]),t}(u.a.Component);var et,tt=function(e){n.c.getModule("SolarSystem").loadTLE(n.c.starSystem,e)},at=function(){n.c.loadModule("KSP")},nt=new(function(){function e(t){Object(i.a)(this,e),this._store=new _(t,tt)}return Object(r.a)(e,[{key:"init",value:function(e){Object(n.b)(e)}},{key:"getInitialState",value:function(){return this._store}},{key:"getApi",value:function(){return{loadTLE:tt,loadKSP:at}}}]),e}())(n.c),it=nt.getInitialState();window.api=nt.getApi(),et=it,d.a.render(u.a.createElement($e,{store:et}),document.getElementById("root")),nt.init(Je)}],[[102,13,11]]]);
//# sourceMappingURL=main.353ddde5.chunk.js.map